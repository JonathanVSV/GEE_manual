<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>12 Clasificación supervisada | Cómo usar Google Earth Engine y no fallar en el intento</title>
  <meta name="description" content="12 Clasificación supervisada | Cómo usar Google Earth Engine y no fallar en el intento" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="12 Clasificación supervisada | Cómo usar Google Earth Engine y no fallar en el intento" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="12 Clasificación supervisada | Cómo usar Google Earth Engine y no fallar en el intento" />
  
  
  

<meta name="author" content="Jonathan Vidal Solórzano Villegas y Gabriel Alejandro Perilla Suárez" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="11-uso-conjunto-de-vectores-e-imágenes.html"/>
<link rel="next" href="13-cierre.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Cómo usar Google Earth Engine y no fallar en el intento</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="1-introducción.html"><a href="1-introducción.html"><i class="fa fa-check"></i><b>1</b> Introducción</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1-introducción.html"><a href="1-introducción.html#propósito-del-libro"><i class="fa fa-check"></i><b>1.1</b> Propósito del libro</a></li>
<li class="chapter" data-level="1.2" data-path="1-introducción.html"><a href="1-introducción.html#organización-del-libro"><i class="fa fa-check"></i><b>1.2</b> Organización del libro</a></li>
<li class="chapter" data-level="1.3" data-path="1-introducción.html"><a href="1-introducción.html#descripción-general-de-google-earth-engine"><i class="fa fa-check"></i><b>1.3</b> Descripción general de Google Earth Engine</a>
<ul>
<li class="chapter" data-level="" data-path="1-introducción.html"><a href="1-introducción.html#qué-es-google-earth-engine"><i class="fa fa-check"></i>¿Qué es Google Earth Engine?</a></li>
<li class="chapter" data-level="" data-path="1-introducción.html"><a href="1-introducción.html#ejemplos-de-aplicaciones-realizadas-con-gee"><i class="fa fa-check"></i>Ejemplos de aplicaciones realizadas con GEE</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-primeros-pasos.html"><a href="2-primeros-pasos.html"><i class="fa fa-check"></i><b>2</b> Primeros pasos</a>
<ul>
<li class="chapter" data-level="2.1" data-path="2-primeros-pasos.html"><a href="2-primeros-pasos.html#registro-para-el-uso-de-gee-javascript-api"><i class="fa fa-check"></i><b>2.1</b> Registro para el uso de GEE JavaScript API</a></li>
<li class="chapter" data-level="2.2" data-path="2-primeros-pasos.html"><a href="2-primeros-pasos.html#elementos-básicos-de-la-interfaz-gráfica"><i class="fa fa-check"></i><b>2.2</b> Elementos básicos de la interfaz gráfica</a>
<ul>
<li class="chapter" data-level="" data-path="2-primeros-pasos.html"><a href="2-primeros-pasos.html#pantalla-de-repositorios"><i class="fa fa-check"></i>Pantalla de repositorios</a></li>
<li class="chapter" data-level="" data-path="2-primeros-pasos.html"><a href="2-primeros-pasos.html#pantalla-de-rutinas"><i class="fa fa-check"></i>Pantalla de rutinas</a></li>
<li class="chapter" data-level="" data-path="2-primeros-pasos.html"><a href="2-primeros-pasos.html#search"><i class="fa fa-check"></i>Search</a></li>
<li class="chapter" data-level="" data-path="2-primeros-pasos.html"><a href="2-primeros-pasos.html#pantalla-de-mapa"><i class="fa fa-check"></i>Pantalla de Mapa</a></li>
<li class="chapter" data-level="" data-path="2-primeros-pasos.html"><a href="2-primeros-pasos.html#pantalla-de-control"><i class="fa fa-check"></i>Pantalla de control</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="2-primeros-pasos.html"><a href="2-primeros-pasos.html#programación-en-gee"><i class="fa fa-check"></i><b>2.3</b> Programación en GEE</a>
<ul>
<li class="chapter" data-level="" data-path="2-primeros-pasos.html"><a href="2-primeros-pasos.html#simbología"><i class="fa fa-check"></i>Simbología</a></li>
<li class="chapter" data-level="" data-path="2-primeros-pasos.html"><a href="2-primeros-pasos.html#lenguaje-javascript-en-gee"><i class="fa fa-check"></i>Lenguaje JavaScript en GEE</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-interfaz-de-usuario.html"><a href="3-interfaz-de-usuario.html"><i class="fa fa-check"></i><b>3</b> Interfaz de usuario</a>
<ul>
<li class="chapter" data-level="3.1" data-path="3-interfaz-de-usuario.html"><a href="3-interfaz-de-usuario.html#impresión-en-consola"><i class="fa fa-check"></i><b>3.1</b> Impresión en consola</a></li>
<li class="chapter" data-level="3.2" data-path="3-interfaz-de-usuario.html"><a href="3-interfaz-de-usuario.html#interacción-con-la-pantalla-de-mapa"><i class="fa fa-check"></i><b>3.2</b> Interacción con la pantalla de mapa</a></li>
<li class="chapter" data-level="3.3" data-path="3-interfaz-de-usuario.html"><a href="3-interfaz-de-usuario.html#creación-de-gráficos"><i class="fa fa-check"></i><b>3.3</b> Creación de gráficos</a></li>
<li class="chapter" data-level="3.4" data-path="3-interfaz-de-usuario.html"><a href="3-interfaz-de-usuario.html#exportación-de-objetos-fuera-de-gee"><i class="fa fa-check"></i><b>3.4</b> Exportación de objetos fuera de GEE</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-importación-de-información-a-gee.html"><a href="4-importación-de-información-a-gee.html"><i class="fa fa-check"></i><b>4</b> Importación de información a GEE</a></li>
<li class="chapter" data-level="5" data-path="5-tipos-de-objetos.html"><a href="5-tipos-de-objetos.html"><i class="fa fa-check"></i><b>5</b> Tipos de objetos</a>
<ul>
<li class="chapter" data-level="5.1" data-path="5-tipos-de-objetos.html"><a href="5-tipos-de-objetos.html#objetos-del-cliente-y-del-servidor"><i class="fa fa-check"></i><b>5.1</b> Objetos del cliente y del servidor</a></li>
<li class="chapter" data-level="5.2" data-path="5-tipos-de-objetos.html"><a href="5-tipos-de-objetos.html#tipos-de-objetos-del-lado-del-cliente"><i class="fa fa-check"></i><b>5.2</b> Tipos de objetos del lado del cliente</a>
<ul>
<li class="chapter" data-level="" data-path="5-tipos-de-objetos.html"><a href="5-tipos-de-objetos.html#cadenas-de-texto"><i class="fa fa-check"></i>Cadenas de texto</a></li>
<li class="chapter" data-level="" data-path="5-tipos-de-objetos.html"><a href="5-tipos-de-objetos.html#números"><i class="fa fa-check"></i>Números</a></li>
<li class="chapter" data-level="" data-path="5-tipos-de-objetos.html"><a href="5-tipos-de-objetos.html#listas"><i class="fa fa-check"></i>Listas</a></li>
<li class="chapter" data-level="" data-path="5-tipos-de-objetos.html"><a href="5-tipos-de-objetos.html#diccionarios"><i class="fa fa-check"></i>Diccionarios</a></li>
<li class="chapter" data-level="" data-path="5-tipos-de-objetos.html"><a href="5-tipos-de-objetos.html#funciones"><i class="fa fa-check"></i>Funciones</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="5-tipos-de-objetos.html"><a href="5-tipos-de-objetos.html#tipo-de-objetos-del-lado-del-servidor"><i class="fa fa-check"></i><b>5.3</b> Tipo de objetos del lado del servidor</a>
<ul>
<li class="chapter" data-level="" data-path="5-tipos-de-objetos.html"><a href="5-tipos-de-objetos.html#ee.string"><i class="fa fa-check"></i>ee.String</a></li>
<li class="chapter" data-level="" data-path="5-tipos-de-objetos.html"><a href="5-tipos-de-objetos.html#ee.number"><i class="fa fa-check"></i>ee.Number</a></li>
<li class="chapter" data-level="" data-path="5-tipos-de-objetos.html"><a href="5-tipos-de-objetos.html#ee.list"><i class="fa fa-check"></i>ee.List</a></li>
<li class="chapter" data-level="" data-path="5-tipos-de-objetos.html"><a href="5-tipos-de-objetos.html#ee.dictionary"><i class="fa fa-check"></i>ee.Dictionary</a></li>
<li class="chapter" data-level="" data-path="5-tipos-de-objetos.html"><a href="5-tipos-de-objetos.html#ee.date"><i class="fa fa-check"></i>ee.Date</a></li>
<li class="chapter" data-level="" data-path="5-tipos-de-objetos.html"><a href="5-tipos-de-objetos.html#ee.image"><i class="fa fa-check"></i>ee.Image</a></li>
<li class="chapter" data-level="" data-path="5-tipos-de-objetos.html"><a href="5-tipos-de-objetos.html#ee.imagecollection"><i class="fa fa-check"></i>ee.ImageCollection</a></li>
<li class="chapter" data-level="" data-path="5-tipos-de-objetos.html"><a href="5-tipos-de-objetos.html#ee.feature"><i class="fa fa-check"></i>ee.Feature</a></li>
<li class="chapter" data-level="" data-path="5-tipos-de-objetos.html"><a href="5-tipos-de-objetos.html#ee.featurecollection"><i class="fa fa-check"></i>ee.FeatureCollection</a></li>
<li class="chapter" data-level="" data-path="5-tipos-de-objetos.html"><a href="5-tipos-de-objetos.html#ee.algorithms"><i class="fa fa-check"></i>ee.Algorithms</a></li>
<li class="chapter" data-level="" data-path="5-tipos-de-objetos.html"><a href="5-tipos-de-objetos.html#ee.array"><i class="fa fa-check"></i>ee.Array</a></li>
<li class="chapter" data-level="" data-path="5-tipos-de-objetos.html"><a href="5-tipos-de-objetos.html#ee.classifier"><i class="fa fa-check"></i>ee.Classifier</a></li>
<li class="chapter" data-level="" data-path="5-tipos-de-objetos.html"><a href="5-tipos-de-objetos.html#ee.clusterer"><i class="fa fa-check"></i>ee.Clusterer</a></li>
<li class="chapter" data-level="" data-path="5-tipos-de-objetos.html"><a href="5-tipos-de-objetos.html#ee.filter"><i class="fa fa-check"></i>ee.Filter</a></li>
<li class="chapter" data-level="" data-path="5-tipos-de-objetos.html"><a href="5-tipos-de-objetos.html#ee.geometry"><i class="fa fa-check"></i>ee.Geometry</a></li>
<li class="chapter" data-level="" data-path="5-tipos-de-objetos.html"><a href="5-tipos-de-objetos.html#ee.join"><i class="fa fa-check"></i>ee.Join</a></li>
<li class="chapter" data-level="" data-path="5-tipos-de-objetos.html"><a href="5-tipos-de-objetos.html#ee.reducer"><i class="fa fa-check"></i>ee.Reducer</a></li>
<li class="chapter" data-level="" data-path="5-tipos-de-objetos.html"><a href="5-tipos-de-objetos.html#ee.terrain"><i class="fa fa-check"></i>ee.Terrain</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-ee.geometry-1.html"><a href="6-ee.geometry-1.html"><i class="fa fa-check"></i><b>6</b> ee.Geometry</a>
<ul>
<li class="chapter" data-level="6.1" data-path="6-ee.geometry-1.html"><a href="6-ee.geometry-1.html#información-y-metadatos"><i class="fa fa-check"></i><b>6.1</b> Información y metadatos</a></li>
<li class="chapter" data-level="6.2" data-path="6-ee.geometry-1.html"><a href="6-ee.geometry-1.html#creación-de-geometrías"><i class="fa fa-check"></i><b>6.2</b> Creación de geometrías</a></li>
<li class="chapter" data-level="6.3" data-path="6-ee.geometry-1.html"><a href="6-ee.geometry-1.html#métodos-comunes"><i class="fa fa-check"></i><b>6.3</b> Métodos comunes</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-ee.feature-1.html"><a href="7-ee.feature-1.html"><i class="fa fa-check"></i><b>7</b> ee.Feature</a>
<ul>
<li class="chapter" data-level="7.1" data-path="7-ee.feature-1.html"><a href="7-ee.feature-1.html#información-y-metadatos-1"><i class="fa fa-check"></i><b>7.1</b> Información y metadatos</a></li>
<li class="chapter" data-level="7.2" data-path="7-ee.feature-1.html"><a href="7-ee.feature-1.html#visualización-de-vectores"><i class="fa fa-check"></i><b>7.2</b> Visualización de vectores</a></li>
<li class="chapter" data-level="7.3" data-path="7-ee.feature-1.html"><a href="7-ee.feature-1.html#creación-de-vectores"><i class="fa fa-check"></i><b>7.3</b> Creación de vectores</a></li>
<li class="chapter" data-level="7.4" data-path="7-ee.feature-1.html"><a href="7-ee.feature-1.html#métodos-comunes-1"><i class="fa fa-check"></i><b>7.4</b> Métodos comunes</a>
<ul>
<li class="chapter" data-level="" data-path="7-ee.feature-1.html"><a href="7-ee.feature-1.html#selección-de-propiedades"><i class="fa fa-check"></i>Selección de propiedades</a></li>
<li class="chapter" data-level="" data-path="7-ee.feature-1.html"><a href="7-ee.feature-1.html#adición-de-nuevas-propiedades-o-modificación-de-propiedades-preexistentes"><i class="fa fa-check"></i>Adición de nuevas propiedades o modificación de propiedades preexistentes</a></li>
<li class="chapter" data-level="" data-path="7-ee.feature-1.html"><a href="7-ee.feature-1.html#extracción-y-edición-de-propiedades-de-vectores"><i class="fa fa-check"></i>Extracción y edición de propiedades de vectores</a></li>
<li class="chapter" data-level="" data-path="7-ee.feature-1.html"><a href="7-ee.feature-1.html#intersección-con-otros-vectores"><i class="fa fa-check"></i>Intersección con otros vectores</a></li>
<li class="chapter" data-level="" data-path="7-ee.feature-1.html"><a href="7-ee.feature-1.html#creación-de-un-buffer"><i class="fa fa-check"></i>Creación de un buffer</a></li>
<li class="chapter" data-level="" data-path="7-ee.feature-1.html"><a href="7-ee.feature-1.html#cálculo-de-área"><i class="fa fa-check"></i>Cálculo de área</a></li>
<li class="chapter" data-level="" data-path="7-ee.feature-1.html"><a href="7-ee.feature-1.html#cálculo-de-perímetro"><i class="fa fa-check"></i>Cálculo de perímetro</a></li>
<li class="chapter" data-level="" data-path="7-ee.feature-1.html"><a href="7-ee.feature-1.html#disolución-de-polígonos"><i class="fa fa-check"></i>Disolución de polígonos</a></li>
<li class="chapter" data-level="" data-path="7-ee.feature-1.html"><a href="7-ee.feature-1.html#unión-de-vectores"><i class="fa fa-check"></i>Unión de vectores</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="8-ee.featurecollection-1.html"><a href="8-ee.featurecollection-1.html"><i class="fa fa-check"></i><b>8</b> ee.FeatureCollection</a>
<ul>
<li class="chapter" data-level="8.1" data-path="8-ee.featurecollection-1.html"><a href="8-ee.featurecollection-1.html#información-y-metadatos-2"><i class="fa fa-check"></i><b>8.1</b> Información y metadatos</a></li>
<li class="chapter" data-level="8.2" data-path="8-ee.featurecollection-1.html"><a href="8-ee.featurecollection-1.html#creación-de-colecciones-de-vectores"><i class="fa fa-check"></i><b>8.2</b> Creación de colecciones de vectores</a></li>
<li class="chapter" data-level="8.3" data-path="8-ee.featurecollection-1.html"><a href="8-ee.featurecollection-1.html#visualización-de-colecciones-de-vectores"><i class="fa fa-check"></i><b>8.3</b> Visualización de colecciones de vectores</a></li>
<li class="chapter" data-level="8.4" data-path="8-ee.featurecollection-1.html"><a href="8-ee.featurecollection-1.html#métodos-comunes-2"><i class="fa fa-check"></i><b>8.4</b> Métodos comunes</a>
<ul>
<li class="chapter" data-level="" data-path="8-ee.featurecollection-1.html"><a href="8-ee.featurecollection-1.html#filtración-de-una-colección-de-vectores"><i class="fa fa-check"></i>Filtración de una colección de vectores</a></li>
<li class="chapter" data-level="" data-path="8-ee.featurecollection-1.html"><a href="8-ee.featurecollection-1.html#funciones-de-usuario"><i class="fa fa-check"></i>Funciones de usuario</a></li>
<li class="chapter" data-level="" data-path="8-ee.featurecollection-1.html"><a href="8-ee.featurecollection-1.html#selección-de-atributos"><i class="fa fa-check"></i>Selección de atributos</a></li>
<li class="chapter" data-level="" data-path="8-ee.featurecollection-1.html"><a href="8-ee.featurecollection-1.html#creación-de-puntos-aleatorios"><i class="fa fa-check"></i>Creación de puntos aleatorios</a></li>
<li class="chapter" data-level="" data-path="8-ee.featurecollection-1.html"><a href="8-ee.featurecollection-1.html#obtención-del-primer-vector"><i class="fa fa-check"></i>Obtención del primer vector</a></li>
<li class="chapter" data-level="" data-path="8-ee.featurecollection-1.html"><a href="8-ee.featurecollection-1.html#extracción-de-metadatos-de-una-colección-de-vectores"><i class="fa fa-check"></i>Extracción de metadatos de una colección de vectores</a></li>
<li class="chapter" data-level="" data-path="8-ee.featurecollection-1.html"><a href="8-ee.featurecollection-1.html#extracción-de-listas-con-atributos-de-vectores"><i class="fa fa-check"></i>Extracción de listas con atributos de vectores</a></li>
<li class="chapter" data-level="" data-path="8-ee.featurecollection-1.html"><a href="8-ee.featurecollection-1.html#ejecución-de-una-función-sobre-todos-los-vectores-de-una-colección"><i class="fa fa-check"></i>Ejecución de una función sobre todos los vectores de una colección</a></li>
<li class="chapter" data-level="" data-path="8-ee.featurecollection-1.html"><a href="8-ee.featurecollection-1.html#reducción-de-una-colección-de-vectores"><i class="fa fa-check"></i>Reducción de una colección de vectores</a></li>
<li class="chapter" data-level="" data-path="8-ee.featurecollection-1.html"><a href="8-ee.featurecollection-1.html#conversión-de-una-colección-de-vectores-en-una-imagen"><i class="fa fa-check"></i>Conversión de una colección de vectores en una imagen</a></li>
<li class="chapter" data-level="" data-path="8-ee.featurecollection-1.html"><a href="8-ee.featurecollection-1.html#unión-de-colecciones-de-vectores"><i class="fa fa-check"></i>Unión de colecciones de vectores</a></li>
<li class="chapter" data-level="" data-path="8-ee.featurecollection-1.html"><a href="8-ee.featurecollection-1.html#exportación-de-colecciones-de-vectores"><i class="fa fa-check"></i>Exportación de colecciones de vectores</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="9-ee.image-1.html"><a href="9-ee.image-1.html"><i class="fa fa-check"></i><b>9</b> ee.Image</a>
<ul>
<li class="chapter" data-level="9.1" data-path="9-ee.image-1.html"><a href="9-ee.image-1.html#información-y-metadatos-3"><i class="fa fa-check"></i><b>9.1</b> Información y metadatos</a></li>
<li class="chapter" data-level="9.2" data-path="9-ee.image-1.html"><a href="9-ee.image-1.html#visualización-de-una-imagen"><i class="fa fa-check"></i><b>9.2</b> Visualización de una imagen</a></li>
<li class="chapter" data-level="9.3" data-path="9-ee.image-1.html"><a href="9-ee.image-1.html#métodos-comunes-3"><i class="fa fa-check"></i><b>9.3</b> Métodos comunes</a>
<ul>
<li class="chapter" data-level="" data-path="9-ee.image-1.html"><a href="9-ee.image-1.html#selección-de-bandas"><i class="fa fa-check"></i>Selección de bandas</a></li>
<li class="chapter" data-level="" data-path="9-ee.image-1.html"><a href="9-ee.image-1.html#adición-de-nuevas-propiedades-o-modificación-de-propiedades-preexistentes-1"><i class="fa fa-check"></i>Adición de nuevas propiedades o modificación de propiedades preexistentes</a></li>
<li class="chapter" data-level="" data-path="9-ee.image-1.html"><a href="9-ee.image-1.html#sustitución-de-nombres-de-bandas"><i class="fa fa-check"></i>Sustitución de nombres de bandas</a></li>
<li class="chapter" data-level="" data-path="9-ee.image-1.html"><a href="9-ee.image-1.html#realización-de-cortes"><i class="fa fa-check"></i>Realización de cortes</a></li>
<li class="chapter" data-level="" data-path="9-ee.image-1.html"><a href="9-ee.image-1.html#cálculo-de-operaciones-matemáticas"><i class="fa fa-check"></i>Cálculo de operaciones matemáticas</a></li>
<li class="chapter" data-level="" data-path="9-ee.image-1.html"><a href="9-ee.image-1.html#uso-de-operaciones-relacionales-condicionales-y-booleanas"><i class="fa fa-check"></i>Uso de operaciones relacionales, condicionales y booleanas</a></li>
<li class="chapter" data-level="" data-path="9-ee.image-1.html"><a href="9-ee.image-1.html#enmascaramiento"><i class="fa fa-check"></i>Enmascaramiento</a></li>
<li class="chapter" data-level="" data-path="9-ee.image-1.html"><a href="9-ee.image-1.html#adición-de-bandas"><i class="fa fa-check"></i>Adición de bandas</a></li>
<li class="chapter" data-level="" data-path="9-ee.image-1.html"><a href="9-ee.image-1.html#conversión-de-una-imagen-en-un-vector"><i class="fa fa-check"></i>Conversión de una imagen en un vector</a></li>
<li class="chapter" data-level="" data-path="9-ee.image-1.html"><a href="9-ee.image-1.html#exportación-de-una-imagen"><i class="fa fa-check"></i>Exportación de una imagen</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-ee.imagecollection-1.html"><a href="10-ee.imagecollection-1.html"><i class="fa fa-check"></i><b>10</b> ee.ImageCollection</a>
<ul>
<li class="chapter" data-level="10.1" data-path="10-ee.imagecollection-1.html"><a href="10-ee.imagecollection-1.html#información-y-metadatos-4"><i class="fa fa-check"></i><b>10.1</b> Información y metadatos</a></li>
<li class="chapter" data-level="10.2" data-path="10-ee.imagecollection-1.html"><a href="10-ee.imagecollection-1.html#creación-de-colecciones-de-imágenes"><i class="fa fa-check"></i><b>10.2</b> Creación de colecciones de imágenes</a></li>
<li class="chapter" data-level="10.3" data-path="10-ee.imagecollection-1.html"><a href="10-ee.imagecollection-1.html#visualización-de-colecciones-de-imágenes"><i class="fa fa-check"></i><b>10.3</b> Visualización de colecciones de imágenes</a></li>
<li class="chapter" data-level="10.4" data-path="10-ee.imagecollection-1.html"><a href="10-ee.imagecollection-1.html#métodos-comunes-4"><i class="fa fa-check"></i><b>10.4</b> Métodos comunes</a>
<ul>
<li class="chapter" data-level="" data-path="10-ee.imagecollection-1.html"><a href="10-ee.imagecollection-1.html#filtración-de-colecciones-de-imágenes"><i class="fa fa-check"></i>Filtración de colecciones de imágenes</a></li>
<li class="chapter" data-level="" data-path="10-ee.imagecollection-1.html"><a href="10-ee.imagecollection-1.html#selección-de-bandas-1"><i class="fa fa-check"></i>Selección de bandas</a></li>
<li class="chapter" data-level="" data-path="10-ee.imagecollection-1.html"><a href="10-ee.imagecollection-1.html#ordenación-de-una-colección"><i class="fa fa-check"></i>Ordenación de una colección</a></li>
<li class="chapter" data-level="" data-path="10-ee.imagecollection-1.html"><a href="10-ee.imagecollection-1.html#obtención-de-la-primera-imagen"><i class="fa fa-check"></i>Obtención de la primera imagen</a></li>
<li class="chapter" data-level="" data-path="10-ee.imagecollection-1.html"><a href="10-ee.imagecollection-1.html#extracción-de-listas-con-atributos-de-imágenes"><i class="fa fa-check"></i>Extracción de listas con atributos de imágenes</a></li>
<li class="chapter" data-level="" data-path="10-ee.imagecollection-1.html"><a href="10-ee.imagecollection-1.html#conteo-de-observaciones-por-píxel"><i class="fa fa-check"></i>Conteo de observaciones por píxel</a></li>
<li class="chapter" data-level="" data-path="10-ee.imagecollection-1.html"><a href="10-ee.imagecollection-1.html#conocer-el-tamaño-de-la-colección"><i class="fa fa-check"></i>Conocer el tamaño de la colección</a></li>
<li class="chapter" data-level="" data-path="10-ee.imagecollection-1.html"><a href="10-ee.imagecollection-1.html#unión-de-más-de-una-colección"><i class="fa fa-check"></i>Unión de más de una colección</a></li>
<li class="chapter" data-level="" data-path="10-ee.imagecollection-1.html"><a href="10-ee.imagecollection-1.html#ejecución-de-una-función-sobre-todas-las-imágenes-de-una-colección"><i class="fa fa-check"></i>Ejecución de una función sobre todas las imágenes de una colección</a></li>
<li class="chapter" data-level="" data-path="10-ee.imagecollection-1.html"><a href="10-ee.imagecollection-1.html#reducción-de-una-colección-de-imágenes"><i class="fa fa-check"></i>Reducción de una colección de imágenes</a></li>
<li class="chapter" data-level="" data-path="10-ee.imagecollection-1.html"><a href="10-ee.imagecollection-1.html#creación-de-compuestos-y-mosaicos"><i class="fa fa-check"></i>Creación de compuestos y mosaicos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="11-uso-conjunto-de-vectores-e-imágenes.html"><a href="11-uso-conjunto-de-vectores-e-imágenes.html"><i class="fa fa-check"></i><b>11</b> Uso conjunto de vectores e imágenes</a>
<ul>
<li class="chapter" data-level="11.1" data-path="11-uso-conjunto-de-vectores-e-imágenes.html"><a href="11-uso-conjunto-de-vectores-e-imágenes.html#métodos-comunes-5"><i class="fa fa-check"></i><b>11.1</b> Métodos comunes</a>
<ul>
<li class="chapter" data-level="" data-path="11-uso-conjunto-de-vectores-e-imágenes.html"><a href="11-uso-conjunto-de-vectores-e-imágenes.html#muestreo-por-vectores"><i class="fa fa-check"></i>Muestreo por vector(es)</a></li>
<li class="chapter" data-level="" data-path="11-uso-conjunto-de-vectores-e-imágenes.html"><a href="11-uso-conjunto-de-vectores-e-imágenes.html#reducción-de-una-imagen-por-regiónes"><i class="fa fa-check"></i>Reducción de una imagen por región(es)</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="11-uso-conjunto-de-vectores-e-imágenes.html"><a href="11-uso-conjunto-de-vectores-e-imágenes.html#interpolación-de-un-vector-a-una-imagen"><i class="fa fa-check"></i><b>11.2</b> Interpolación de un vector a una imagen</a>
<ul>
<li class="chapter" data-level="" data-path="11-uso-conjunto-de-vectores-e-imágenes.html"><a href="11-uso-conjunto-de-vectores-e-imágenes.html#ponderación-de-distancia-inversa"><i class="fa fa-check"></i>Ponderación de distancia inversa</a></li>
<li class="chapter" data-level="" data-path="11-uso-conjunto-de-vectores-e-imágenes.html"><a href="11-uso-conjunto-de-vectores-e-imágenes.html#kriging"><i class="fa fa-check"></i>Kriging</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="12-clasificación-supervisada.html"><a href="12-clasificación-supervisada.html"><i class="fa fa-check"></i><b>12</b> Clasificación supervisada</a>
<ul>
<li class="chapter" data-level="12.1" data-path="12-clasificación-supervisada.html"><a href="12-clasificación-supervisada.html#clasificadores"><i class="fa fa-check"></i><b>12.1</b> Clasificadores</a></li>
<li class="chapter" data-level="12.2" data-path="12-clasificación-supervisada.html"><a href="12-clasificación-supervisada.html#realización-de-la-fase-de-entrenamiento"><i class="fa fa-check"></i><b>12.2</b> Realización de la fase de entrenamiento</a></li>
<li class="chapter" data-level="12.3" data-path="12-clasificación-supervisada.html"><a href="12-clasificación-supervisada.html#obtención-de-la-clasificación"><i class="fa fa-check"></i><b>12.3</b> Obtención de la clasificación</a></li>
<li class="chapter" data-level="12.4" data-path="12-clasificación-supervisada.html"><a href="12-clasificación-supervisada.html#evaluación-de-la-clasificación"><i class="fa fa-check"></i><b>12.4</b> Evaluación de la clasificación</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="13-cierre.html"><a href="13-cierre.html"><i class="fa fa-check"></i><b>13</b> Cierre</a></li>
<li class="chapter" data-level="14" data-path="14-referencias.html"><a href="14-referencias.html"><i class="fa fa-check"></i><b>14</b> Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Cómo usar Google Earth Engine y no fallar en el intento</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="clasificación-supervisada" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">12</span> Clasificación supervisada<a href="12-clasificación-supervisada.html#clasificación-supervisada" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Una clasificación supervisada se refiere al proceso en el cual se obtiene un mapa temático a partir de imágenes satelitales u otro tipo de información generada mediante sensores remotos. Este tipo de procedimiento tiene el objetivo de asociarle una etiqueta a cada píxel de una imagen, que puede constar de, por ejemplo, una clase de tipo de vegetación o uso de suelo (Chuvieco, 1995). Las clasificaciones se pueden ver como una interpretación de la reflectancia de una imagen en un sistema de clases de interés y normalmente constan de procedimientos en los cuales se entrena un algoritmo a reconocer estas clases, a partir de muestras otorgadas por el usuario (Chuvieco, 1995). Generalmente, el proceso de una clasificación supervisada implica los siguientes pasos: 1) obtención de los datos de entrenamiento, 2) selección del clasificador, 3) entrenamiento del clasificador basado en los datos de entrenamiento, 4) obtención de la clasificación, 5) registro de los datos de verificación y 6) verificación de la clasificación. En este capítulo, primero se describirá cada uno de estos pasos junto con las funciones y métodos utilizados y al final se integrarán dichos pasos en un ejercicio práctico.</p>
<p>Dentro de GEE se pueden hacer clasificaciones supervisadas con algunos algoritmos populares como CART (Classification and Regression Trees; Breiman <em>et al</em>., 1984), Random Forests (Breiman, 2001), Naive Bayes (Webb, 2011), Gradient Tree Boost (Friedman, 2001), Support Vector Machine (Cortes y Vapnik, 1995), MaxEnt (Maximum Entropy; Phillips <em>et al</em>., 2004) y Decision Trees (Quinlan, 1986). Como todos los demás objetos dentro de GEE, tienen su propio tipo de objetos del servidor.</p>
<div id="clasificadores" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> Clasificadores<a href="12-clasificación-supervisada.html#clasificadores" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>
Los objetos <span style="color: darkpurple;">ee.Classifier</span> son los que van a permitir trabajar con clasificadores dentro de GEE. Algunos ejemplos de estos son: <span style="color: darkpurple;">ee.Classifier.smileCART</span>, <span style="color: darkpurple;">ee.Classifier</span> <span style="color: darkpurple;">.smileRandomForest</span>, <span style="color: darkpurple;">ee.Classifier.amnhMaxent</span>, entre otros. De nuevo, todos los algoritmos disponibles en GEE, así como los argumentos que aceptan, se pueden consultar en la página de ayuda, en la pestaña de referencia (<strong>Reference</strong>) en el apartado de bibliotecas del cliente (<strong>Client libraries</strong>), o también en la pestaña <strong>Docs</strong> bajo <span style="color: darkpurple;">ee.Classifier</span>. Cabe destacar que cada clasificador tiene diferentes argumentos. Por ejemplo, para el clasificador de random forests, los argumentos incluyen: el número de árboles (<code>numberOfTrees</code>), las variables utilizadas por árbol aleatorio (<code>variablesPerSplit</code>), la población mínima de hoja (<code>minLeafPopulation</code>), la fracción de los datos de entrada para entrenar y verificar el algoritmo (<code>bagFraction</code>), el número máximo de nodos (<code>maxNodes</code>) y el número para hacer replicables los resultados (<code>seed</code>). Para consultar una descripción más detallada de este algoritmo y sus argumentos ver Breiman (2001).</p>
<p><span style="color: darkblue;">Ejercicio 32</span></p>
<div class="sourceCode" id="cb129"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb129-1"><a href="12-clasificación-supervisada.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> rfClassif <span class="op">=</span> ee<span class="op">.</span><span class="at">Classifier</span><span class="op">.</span><span class="fu">smileRandomForest</span>(<span class="dv">500</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
var rfClassif = ee.Classifier.smileRandomForest(500);
</script>
<div class="bluebox2">
<div class="awesomeblock">
<p>Usando al final el método <span style="color: darkpurple;">.setOutputMode</span> sobre un clasificador se puede cambiar la forma en la que el clasificador entrega los resultados. Para ello, dentro de los paréntesis del método hay que escribir cualquiera de las siguientes opciones:</p>
<ul>
<li>‘CLASSIFICATION’ (clasificación, por defecto): devuelve una variable nominal (clases).</li>
<li>‘REGRESSION’ (regresión): devuelve una variable numérica.</li>
<li>‘PROBABILITY’ (probabilidad): devuelve la probabilidad de que la clasificación sea correcta.</li>
<li>‘MULTIPROBABILITY’ (multiprobabilidad): devuelve un arreglo de probabilidades para cada una de las clases.</li>
<li>‘RAW’ (crudo): devuelve un arreglo con la representación interna del proceso de clasificación. Por ejemplo, los votos crudos de un modelo de múltiples árboles de decisión como random forests.</li>
<li>‘RAW_REGRESSION’ (regresión cruda): devuelve un arreglo con la representación interna del proceso de regresión. Por ejemplo, las predicciones crudas de los múltiples árboles de regresión.
Resulta importante recordar que, dependiendo del clasificador, algunas de estas opciones de resultado estarán disponibles o no.</li>
</ul>
</div>
</div>
</div>
<div id="realización-de-la-fase-de-entrenamiento" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> Realización de la fase de entrenamiento<a href="12-clasificación-supervisada.html#realización-de-la-fase-de-entrenamiento" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>
Debido a que estos clasificadores trabajan en un esquema supervisado, requieren de la provisión de muestras de entrenamiento para entrenar al algoritmo. Esto se puede hacer directamente en la API, aunque quizás no sea lo más cómodo para el usuario. En este paso se recomienda capturar los datos de entrenamiento en algún SIG, por ejemplo, QGIS, y luego importar el archivo vector a GEE (ver sección de importación de información a GEE). Una vez definido el clasificador que se va a utilizar, se utiliza el método <span style="color: darkpurple;">.train</span> para entrenarlo, utilizando las muestras provistas. Los argumentos de este método indican la colección de vectores que contiene las áreas de entrenamiento (<code>features</code>), el nombre del campo que indica el esquema de clasificación dentro de la colección de vectores (<code>classProperty</code>), así como las bandas a utilizar de la imagen (<code>inputProperties</code>).</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb130-1"><a href="12-clasificación-supervisada.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> trainedClassifier <span class="op">=</span> rfClassif<span class="op">.</span><span class="fu">train</span>({</span>
<span id="cb130-2"><a href="12-clasificación-supervisada.html#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">features</span><span class="op">:</span> training<span class="op">,</span></span>
<span id="cb130-3"><a href="12-clasificación-supervisada.html#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">classProperty</span><span class="op">:</span> <span class="st">&#39;clase&#39;</span><span class="op">,</span></span>
<span id="cb130-4"><a href="12-clasificación-supervisada.html#cb130-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">inputProperties</span><span class="op">:</span> [<span class="st">&#39;CB&#39;</span><span class="op">,</span><span class="st">&#39;B&#39;</span><span class="op">,</span><span class="st">&#39;G&#39;</span><span class="op">,</span><span class="st">&#39;R&#39;</span><span class="op">,</span><span class="st">&#39;NIR&#39;</span><span class="op">,</span><span class="st">&#39;SWIR1&#39;</span><span class="op">,</span><span class="st">&#39;SWIR2&#39;</span>]</span>
<span id="cb130-5"><a href="12-clasificación-supervisada.html#cb130-5" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
var trainedClassifier = rfClassif.train({
  features: training,
  classProperty: 'clase',
  inputProperties: ['CB','B','G','R','NIR','SWIR1','SWIR2']
});
</script>
</div>
<div id="obtención-de-la-clasificación" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> Obtención de la clasificación<a href="12-clasificación-supervisada.html#obtención-de-la-clasificación" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>
Una vez que se tiene entrenando el clasificador, el siguiente paso consta de clasificar la imagen completa en las clases de interés. Para ello, se utiliza el método <span style="color: darkpurple;">.classify</span>, el cual permite hacer predicciones sobre la clase de cada píxel a partir de las predicciones realizadas por el algoritmo entrenado. Por ejemplo:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb131-1"><a href="12-clasificación-supervisada.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> classifiedImg <span class="op">=</span> imagen<span class="op">.</span><span class="fu">classify</span>(trainedClassifier)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
var classifiedImg = imagen.classify(trainedClassifier);
</script>
</div>
<div id="evaluación-de-la-clasificación" class="section level2 hasAnchor" number="12.4">
<h2><span class="header-section-number">12.4</span> Evaluación de la clasificación<a href="12-clasificación-supervisada.html#evaluación-de-la-clasificación" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>
La última fase de una clasificación consta de la evaluación de los resultados utilizando otro conjunto de datos que no haya sido empleado en la fase de entrenamiento. A estos datos se les conoce como los datos de validación o verificación. Para evaluar una clasificación, primero se extrae la información de las clases predichas para los datos de validación y después se compara con la información de referencia. Comúnmente, se utiliza una matriz de confusión para realizar dicha evaluación, la cual se puede obtener mediante el método <span style="color: darkpurple;">.errorMatrix</span>. Además, para calcular la precisión total de la clasificación sobre los datos de validación se utiliza el método <span style="color: darkpurple;">.accuracy</span>. Por ejemplo:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb132-1"><a href="12-clasificación-supervisada.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> validErrMat <span class="op">=</span> validacion<span class="op">.</span><span class="fu">errorMatrix</span>(<span class="st">&#39;claseRef&#39;</span><span class="op">,</span> <span class="st">&#39;clasePred&#39;</span>)<span class="op">;</span></span>
<span id="cb132-2"><a href="12-clasificación-supervisada.html#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> validAcc <span class="op">=</span> validacion<span class="op">.</span><span class="fu">accuracy</span>()<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
var validErrMat = validacion.errorMatrix('claseRef', 'clasePred');
var validAcc = validacion.accuracy();
</script>
<div id="ejercicio-e-clasificación" class="section level4 unnumbered hasAnchor">
<h4>Ejercicio E: Clasificación<a href="12-clasificación-supervisada.html#ejercicio-e-clasificación" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>En este ejercicio se hará una clasificación supervisada utilizando el algoritmo random forests. Para ello se utilizarán siete polígonos como sitios de entrenamiento, pertenecientes a cuatro clases: Bosque, No bosque, Agua y Urbano. Estos polígonos se definirán directamente en la API a través de sus coordenadas como objetos <span style="color: darkpurple;">ee.Geometry</span> de tipo rectángulo. Posteriormente, cada polígono se transforma en un objeto de tipo vector (<span style="color: darkpurple;">ee.Feature</span>) y se le asigna la propiedad de ‘clase’ como número a través de un diccionario. Por último, se hace una colección de vectores (<span style="color: darkblue;">Fig.</span> <a href="12-clasificación-supervisada.html#fig:fc121">12.1</a>).</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb133-1"><a href="12-clasificación-supervisada.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Definición de datos de entrenamiento</span></span>
<span id="cb133-2"><a href="12-clasificación-supervisada.html#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> bosque1 <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">101.53892</span><span class="op">,</span> <span class="fl">19.74148</span><span class="op">,</span> </span>
<span id="cb133-3"><a href="12-clasificación-supervisada.html#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">101.51906</span><span class="op">,</span><span class="fl">19.72362</span>)<span class="op">;</span></span>
<span id="cb133-4"><a href="12-clasificación-supervisada.html#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> bosque2 <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">101.64826</span><span class="op">,</span> <span class="fl">19.49264</span><span class="op">,</span> </span>
<span id="cb133-5"><a href="12-clasificación-supervisada.html#cb133-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">101.62839</span><span class="op">,</span><span class="fl">19.47545</span>)<span class="op">;</span></span>
<span id="cb133-6"><a href="12-clasificación-supervisada.html#cb133-6" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> noBosque1 <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">101.35448</span><span class="op">,</span> <span class="fl">19.65992</span><span class="op">,</span> </span>
<span id="cb133-7"><a href="12-clasificación-supervisada.html#cb133-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">101.34509</span><span class="op">,</span><span class="fl">19.64990</span>)<span class="op">;</span></span>
<span id="cb133-8"><a href="12-clasificación-supervisada.html#cb133-8" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> noBosque2 <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">101.56907</span><span class="op">,</span> <span class="fl">19.58312</span><span class="op">,</span> </span>
<span id="cb133-9"><a href="12-clasificación-supervisada.html#cb133-9" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">101.54939</span><span class="op">,</span><span class="fl">19.56435</span>)<span class="op">;</span></span>
<span id="cb133-10"><a href="12-clasificación-supervisada.html#cb133-10" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> urbano <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">101.20999</span><span class="op">,</span> <span class="fl">19.71300</span><span class="op">,</span> </span>
<span id="cb133-11"><a href="12-clasificación-supervisada.html#cb133-11" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">101.19688</span><span class="op">,</span><span class="fl">19.70338</span>)<span class="op">;</span></span>
<span id="cb133-12"><a href="12-clasificación-supervisada.html#cb133-12" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> agua1 <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">101.60826</span><span class="op">,</span> <span class="fl">19.66885</span><span class="op">,</span> </span>
<span id="cb133-13"><a href="12-clasificación-supervisada.html#cb133-13" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">101.58569</span><span class="op">,</span><span class="fl">19.64316</span>)<span class="op">;</span></span>
<span id="cb133-14"><a href="12-clasificación-supervisada.html#cb133-14" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> agua2 <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">101.74686</span><span class="op">,</span> <span class="fl">19.43937</span><span class="op">,</span> </span>
<span id="cb133-15"><a href="12-clasificación-supervisada.html#cb133-15" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">101.733453</span><span class="op">,</span><span class="fl">19.427012</span>)<span class="op">;</span></span>
<span id="cb133-16"><a href="12-clasificación-supervisada.html#cb133-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-17"><a href="12-clasificación-supervisada.html#cb133-17" aria-hidden="true" tabindex="-1"></a><span class="co">// Definición de colección de vectores</span></span>
<span id="cb133-18"><a href="12-clasificación-supervisada.html#cb133-18" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> poligonos <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>([</span>
<span id="cb133-19"><a href="12-clasificación-supervisada.html#cb133-19" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="fu">Feature</span>(noBosque1<span class="op">,</span> {<span class="st">&#39;clase&#39;</span><span class="op">:</span> <span class="dv">0</span>})<span class="op">,</span></span>
<span id="cb133-20"><a href="12-clasificación-supervisada.html#cb133-20" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="fu">Feature</span>(noBosque2<span class="op">,</span> {<span class="st">&#39;clase&#39;</span><span class="op">:</span> <span class="dv">0</span>})<span class="op">,</span></span>
<span id="cb133-21"><a href="12-clasificación-supervisada.html#cb133-21" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="fu">Feature</span>(bosque1<span class="op">,</span> {<span class="st">&#39;clase&#39;</span><span class="op">:</span> <span class="dv">1</span>})<span class="op">,</span></span>
<span id="cb133-22"><a href="12-clasificación-supervisada.html#cb133-22" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="fu">Feature</span>(bosque2<span class="op">,</span> {<span class="st">&#39;clase&#39;</span><span class="op">:</span> <span class="dv">1</span>})<span class="op">,</span></span>
<span id="cb133-23"><a href="12-clasificación-supervisada.html#cb133-23" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="fu">Feature</span>(agua1<span class="op">,</span> {<span class="st">&#39;clase&#39;</span><span class="op">:</span> <span class="dv">2</span>})<span class="op">,</span></span>
<span id="cb133-24"><a href="12-clasificación-supervisada.html#cb133-24" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="fu">Feature</span>(agua2<span class="op">,</span> {<span class="st">&#39;clase&#39;</span><span class="op">:</span> <span class="dv">2</span>})<span class="op">,</span></span>
<span id="cb133-25"><a href="12-clasificación-supervisada.html#cb133-25" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="fu">Feature</span>(urbano<span class="op">,</span> {<span class="st">&#39;clase&#39;</span><span class="op">:</span> <span class="dv">3</span>})<span class="op">,</span></span>
<span id="cb133-26"><a href="12-clasificación-supervisada.html#cb133-26" aria-hidden="true" tabindex="-1"></a>])<span class="op">;</span></span>
<span id="cb133-27"><a href="12-clasificación-supervisada.html#cb133-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-28"><a href="12-clasificación-supervisada.html#cb133-28" aria-hidden="true" tabindex="-1"></a><span class="co">// Agregar a pantalla de mapas</span></span>
<span id="cb133-29"><a href="12-clasificación-supervisada.html#cb133-29" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(poligonos<span class="op">,</span> {}<span class="op">,</span> <span class="st">&#39;polígonosEntrenamiento&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Definición de datos de entrenamiento
var bosque1 = ee.Geometry.Rectangle(-101.53892, 19.74148, 
  -101.51906,19.72362);
var bosque2 = ee.Geometry.Rectangle(-101.64826, 19.49264, 
  -101.62839,19.47545);
var noBosque1 = ee.Geometry.Rectangle(-101.35448, 19.65992, 
  -101.34509,19.64990);
var noBosque2 = ee.Geometry.Rectangle(-101.56907, 19.58312, 
  -101.54939,19.56435);
var urbano = ee.Geometry.Rectangle(-101.20999, 19.71300, 
  -101.19688,19.70338);
var agua1 = ee.Geometry.Rectangle(-101.60826, 19.66885, 
  -101.58569,19.64316);
var agua2 = ee.Geometry.Rectangle(-101.74686, 19.43937, 
  -101.733453,19.427012);

// Definición de colección de vectores
var poligonos = ee.FeatureCollection([
  ee.Feature(noBosque1, {'clase': 0}),
  ee.Feature(noBosque2, {'clase': 0}),
  ee.Feature(bosque1, {'clase': 1}),
  ee.Feature(bosque2, {'clase': 1}),
  ee.Feature(agua1, {'clase': 2}),
  ee.Feature(agua2, {'clase': 2}),
  ee.Feature(urbano, {'clase': 3}),
]);

// Agregar a pantalla de mapas
Map.addLayer(poligonos, {}, 'polígonosEntrenamiento');
</script>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fc121"></span>
<img src="Img/polyTrain.png" alt="Visualización de los sitios de entrenamiento." width="80%" />
<p class="caption">
Figure 12.1: Visualización de los sitios de entrenamiento.
</p>
</div>
<p>Antes de pasar al filtrado de la colección de Landsat 8 y enmascarar las nubes, habrá que volver a definir la función <code>maskL8sr</code>, que es la misma que se definió en el capítulo 10 en el Ejercicio C: Enmascaramiento de nubes, cálculo de índices y reducción:
</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb134-1"><a href="12-clasificación-supervisada.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Crear función para enmascarar nubes</span></span>
<span id="cb134-2"><a href="12-clasificación-supervisada.html#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">maskL8sr</span>(image) {</span>
<span id="cb134-3"><a href="12-clasificación-supervisada.html#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> cloudShadowBitMask <span class="op">=</span> (<span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="dv">3</span>)<span class="op">;</span></span>
<span id="cb134-4"><a href="12-clasificación-supervisada.html#cb134-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> cloudsBitMask <span class="op">=</span> (<span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="dv">5</span>)<span class="op">;</span></span>
<span id="cb134-5"><a href="12-clasificación-supervisada.html#cb134-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> qa <span class="op">=</span> image<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;pixel_qa&#39;</span>)<span class="op">;</span></span>
<span id="cb134-6"><a href="12-clasificación-supervisada.html#cb134-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> mask <span class="op">=</span> qa<span class="op">.</span><span class="fu">bitwiseAnd</span>(cloudShadowBitMask)<span class="op">.</span><span class="fu">eq</span>(<span class="dv">0</span>)</span>
<span id="cb134-7"><a href="12-clasificación-supervisada.html#cb134-7" aria-hidden="true" tabindex="-1"></a>                 <span class="op">.</span><span class="fu">and</span>(qa<span class="op">.</span><span class="fu">bitwiseAnd</span>(cloudsBitMask)<span class="op">.</span><span class="fu">eq</span>(<span class="dv">0</span>))<span class="op">;</span></span>
<span id="cb134-8"><a href="12-clasificación-supervisada.html#cb134-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> image<span class="op">.</span><span class="fu">updateMask</span>(mask)<span class="op">;</span></span>
<span id="cb134-9"><a href="12-clasificación-supervisada.html#cb134-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<script type="text/javascript">
// Crear función para enmascarar nubes
function maskL8sr(image) {
  var cloudShadowBitMask = (1 << 3);
  var cloudsBitMask = (1 << 5);
  var qa = image.select('pixel_qa');
  var mask = qa.bitwiseAnd(cloudShadowBitMask).eq(0)
                 .and(qa.bitwiseAnd(cloudsBitMask).eq(0));
  return image.updateMask(mask);
}
</script>
<p>A continuación se vuelve a filtrar la colección de Landsat 8 por fecha, porcentaje de nubosidad sobre la superficie terrestre y un filtro espacial. En este caso se usa el método <span style="color: darkpurple;">.filterBounds</span>, que permite filtrar espacialmente la colección de acuerdo a la extensión del polígono de interés. Por último, se aplica la función para enmascarar nubes a todas las imágenes de la colección usando <span style="color: darkpurple;">.map</span>.
</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb135-1"><a href="12-clasificación-supervisada.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Filtrar colección y aplicar máscara de nubes</span></span>
<span id="cb135-2"><a href="12-clasificación-supervisada.html#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> L8imgCol <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&#39;LANDSAT/LC08/C01/T1_SR&#39;</span>)</span>
<span id="cb135-3"><a href="12-clasificación-supervisada.html#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filterBounds</span>(poligonos)</span>
<span id="cb135-4"><a href="12-clasificación-supervisada.html#cb135-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filterDate</span>(<span class="st">&#39;2015-01-01&#39;</span><span class="op">,</span><span class="st">&#39;2016-01-01&#39;</span>)</span>
<span id="cb135-5"><a href="12-clasificación-supervisada.html#cb135-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">lte</span>(<span class="st">&#39;CLOUD_COVER_LAND&#39;</span><span class="op">,</span><span class="dv">50</span>))</span>
<span id="cb135-6"><a href="12-clasificación-supervisada.html#cb135-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>(maskL8sr)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Filtrar colección y aplicar máscara de nubes
var L8imgCol = ee.ImageCollection('LANDSAT/LC08/C01/T1_SR')
  .filterBounds(poligonos)
  .filterDate('2015-01-01','2016-01-01')
  .filter(ee.Filter.lte('CLOUD_COVER_LAND',50))
  .map(maskL8sr);
</script>
<p>El siguiente paso consiste en reducir la colección para generar una sola imagen con el valor promedio para todas las bandas. Ya que no se van a utilizar todas las bandas de la imagen para la clasificación, se indica el nombre de las bandas que se van a utilizar dentro de una lista. Por último, se van a renombrar las bandas para recordar más fácilmente el espectro de cada una.
</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb136-1"><a href="12-clasificación-supervisada.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Reducir, cortar, seleccionar y renombrar bandas</span></span>
<span id="cb136-2"><a href="12-clasificación-supervisada.html#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> L8imgMean <span class="op">=</span> L8imgCol<span class="op">.</span><span class="fu">reduce</span>(ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">mean</span>())</span>
<span id="cb136-3"><a href="12-clasificación-supervisada.html#cb136-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">select</span>([<span class="st">&#39;B1_mean&#39;</span><span class="op">,</span><span class="st">&#39;B2_mean&#39;</span><span class="op">,</span><span class="st">&#39;B3_mean&#39;</span><span class="op">,</span><span class="st">&#39;B4_mean&#39;</span><span class="op">,</span><span class="st">&#39;B5_mean&#39;</span><span class="op">,</span></span>
<span id="cb136-4"><a href="12-clasificación-supervisada.html#cb136-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;B6_mean&#39;</span><span class="op">,</span><span class="st">&#39;B7_mean&#39;</span>])</span>
<span id="cb136-5"><a href="12-clasificación-supervisada.html#cb136-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">rename</span>([<span class="st">&#39;CB&#39;</span><span class="op">,</span><span class="st">&#39;B&#39;</span><span class="op">,</span><span class="st">&#39;G&#39;</span><span class="op">,</span><span class="st">&#39;R&#39;</span><span class="op">,</span><span class="st">&#39;NIR&#39;</span><span class="op">,</span><span class="st">&#39;SWIR1&#39;</span><span class="op">,</span><span class="st">&#39;SWIR2&#39;</span>])<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Reducir, cortar, seleccionar y renombrar bandas
var L8imgMean = L8imgCol.reduce(ee.Reducer.mean())
  .select(['B1_mean','B2_mean','B3_mean','B4_mean','B5_mean',
  'B6_mean','B7_mean'])
  .rename(['CB','B','G','R','NIR','SWIR1','SWIR2']);
</script>
<p>Posteriormente se corta la imagen para quedarnos únicamente con el área de interés. Para ello, primero se define un área de interés y después se corta la imagen con ese objeto.
</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb137-1"><a href="12-clasificación-supervisada.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Definir el área de interés</span></span>
<span id="cb137-2"><a href="12-clasificación-supervisada.html#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> geometry <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Polygon</span>(</span>
<span id="cb137-3"><a href="12-clasificación-supervisada.html#cb137-3" aria-hidden="true" tabindex="-1"></a>        [[[<span class="op">-</span><span class="fl">101.82737418916153</span><span class="op">,</span> <span class="fl">19.836437094032178</span>]<span class="op">,</span></span>
<span id="cb137-4"><a href="12-clasificación-supervisada.html#cb137-4" aria-hidden="true" tabindex="-1"></a>          [<span class="op">-</span><span class="fl">101.82737418916153</span><span class="op">,</span> <span class="fl">19.368119068204525</span>]<span class="op">,</span></span>
<span id="cb137-5"><a href="12-clasificación-supervisada.html#cb137-5" aria-hidden="true" tabindex="-1"></a>          [<span class="op">-</span><span class="fl">101.15171500947403</span><span class="op">,</span> <span class="fl">19.368119068204525</span>]<span class="op">,</span></span>
<span id="cb137-6"><a href="12-clasificación-supervisada.html#cb137-6" aria-hidden="true" tabindex="-1"></a>          [<span class="op">-</span><span class="fl">101.15171500947403</span><span class="op">,</span> <span class="fl">19.836437094032178</span>]]])<span class="op">;</span></span>
<span id="cb137-7"><a href="12-clasificación-supervisada.html#cb137-7" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb137-8"><a href="12-clasificación-supervisada.html#cb137-8" aria-hidden="true" tabindex="-1"></a><span class="co">// Cortar la imagen a la geometría del área de interés</span></span>
<span id="cb137-9"><a href="12-clasificación-supervisada.html#cb137-9" aria-hidden="true" tabindex="-1"></a>L8imgMean <span class="op">=</span> L8imgMean<span class="op">.</span><span class="fu">clip</span>(geometry)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Definir el área de interés
var geometry = ee.Geometry.Polygon(
        [[[-101.82737418916153, 19.836437094032178],
          [-101.82737418916153, 19.368119068204525],
          [-101.15171500947403, 19.368119068204525],
          [-101.15171500947403, 19.836437094032178]]]);
          
// Cortar la imagen a la geometría del área de interés
L8imgMean = L8imgMean.clip(geometry);
</script>
<p>Una vez que ya se tiene la imagen sobre la que se va a hacer la clasificación, se muestrean los valores de los píxeles que se encuentren dentro de cada polígono de los datos de entrenamiento utilizando el método <span style="color: darkpurple;">.sampleRegions</span>. Para este proceso hay que indicar la colección de vectores que se va a utilizar, así como su propiedad que indica la clase y la escala a la que se van a muestrear los píxeles en metros. El resultado de este procedimiento corresponde a una colección de vectores, en la cual cada vector corresponde a un píxel dentro de un polígono de entrenamiento. De tal manera, para cada vector se indica la clase a la que pertenece, así como el valor en cada una de las bandas en la imagen muestreada (<span style="color: darkblue;">Fig.</span> <a href="12-clasificación-supervisada.html#fig:fc122">12.2</a>).
</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb138-1"><a href="12-clasificación-supervisada.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Muestrear regiones </span></span>
<span id="cb138-2"><a href="12-clasificación-supervisada.html#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> training <span class="op">=</span> L8imgMean</span>
<span id="cb138-3"><a href="12-clasificación-supervisada.html#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">sampleRegions</span>({</span>
<span id="cb138-4"><a href="12-clasificación-supervisada.html#cb138-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// colección de vectores a utilizar</span></span>
<span id="cb138-5"><a href="12-clasificación-supervisada.html#cb138-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">collection</span><span class="op">:</span> poligonos<span class="op">,</span></span>
<span id="cb138-6"><a href="12-clasificación-supervisada.html#cb138-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// propiedad que se desea mantener en los vectores de la colección</span></span>
<span id="cb138-7"><a href="12-clasificación-supervisada.html#cb138-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">properties</span><span class="op">:</span> [<span class="st">&#39;clase&#39;</span>]<span class="op">,</span></span>
<span id="cb138-8"><a href="12-clasificación-supervisada.html#cb138-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// tamaño de píxel</span></span>
<span id="cb138-9"><a href="12-clasificación-supervisada.html#cb138-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">scale</span><span class="op">:</span> <span class="dv">30</span></span>
<span id="cb138-10"><a href="12-clasificación-supervisada.html#cb138-10" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Muestrear regiones 
var training = L8imgMean
  .sampleRegions({
    // colección de vectores a utilizar
    collection: poligonos,
    // propiedad que se desea mantener en los vectores de la colección
    properties: ['clase'],
    // tamaño de píxel
    scale: 30
  });
</script>
<p>El siguiente paso es entrenar al clasificador utilizando la colección de vectores anterior. En este caso, se va a utilizar el algoritmo random forests (Breiman, 2001), el cual se llama utilizando <span style="color: darkpurple;">ee.Classifier.smileRandomForest</span>. En este ejercicio se utilizarán 30 árboles de clasificación, que es el único argumento obligatorio. Los demás argumentos opcionales pueden ser consultados en la sección de <strong>Reference</strong> o en la pestaña de <strong>Docs</strong> e incluyen parámetros como el número de variables a utilizar por división y el número máximo de nodos, entre otros. Posteriormente, se entrena este algoritmo mediante el método <span style="color: darkpurple;">.train</span> y se pasan algunos argumentos adicionales dentro de un diccionario, como: la colección de vectores a utilizar para el entrenamiento (<code>features</code>), el nombre de la clase objetivo (<code>classProperty</code>) y el nombre de las propiedades de la imagen (<code>inputProperties</code>), es decir, el nombre de las bandas (<span style="color: darkblue;">Fig.</span> <a href="12-clasificación-supervisada.html#fig:fc122">12.2</a>).
</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb139-1"><a href="12-clasificación-supervisada.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Entrenamiento del clasificador</span></span>
<span id="cb139-2"><a href="12-clasificación-supervisada.html#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> trainedClassifier <span class="op">=</span> ee<span class="op">.</span><span class="at">Classifier</span><span class="op">.</span><span class="fu">smileRandomForest</span>(<span class="dv">30</span>)<span class="op">.</span><span class="fu">train</span>({</span>
<span id="cb139-3"><a href="12-clasificación-supervisada.html#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Vectores con la información extraída en el paso anterior</span></span>
<span id="cb139-4"><a href="12-clasificación-supervisada.html#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">features</span><span class="op">:</span> training<span class="op">,</span></span>
<span id="cb139-5"><a href="12-clasificación-supervisada.html#cb139-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Propiedad que indica la clase de cobertura</span></span>
<span id="cb139-6"><a href="12-clasificación-supervisada.html#cb139-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">classProperty</span><span class="op">:</span> <span class="st">&#39;clase&#39;</span><span class="op">,</span></span>
<span id="cb139-7"><a href="12-clasificación-supervisada.html#cb139-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Nombres de las propiedades de la imagen</span></span>
<span id="cb139-8"><a href="12-clasificación-supervisada.html#cb139-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">inputProperties</span><span class="op">:</span> [<span class="st">&#39;CB&#39;</span><span class="op">,</span><span class="st">&#39;B&#39;</span><span class="op">,</span><span class="st">&#39;G&#39;</span><span class="op">,</span><span class="st">&#39;R&#39;</span><span class="op">,</span><span class="st">&#39;NIR&#39;</span><span class="op">,</span><span class="st">&#39;SWIR1&#39;</span><span class="op">,</span><span class="st">&#39;SWIR2&#39;</span>]</span>
<span id="cb139-9"><a href="12-clasificación-supervisada.html#cb139-9" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Entrenamiento del clasificador
var trainedClassifier = ee.Classifier.smileRandomForest(30).train({
  // Vectores con la información extraída en el paso anterior
  features: training,
  // Propiedad que indica la clase de cobertura
  classProperty: 'clase',
  // Nombres de las propiedades de la imagen
  inputProperties: ['CB','B','G','R','NIR','SWIR1','SWIR2']
});
</script>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fc122"></span>
<img src="Img/polyTrainConsole.png" alt="Salida de la consola de los primeros veinte puntos de entrenamiento con la información del ráster, así como del clasificador entrenado. Nótese que el total de puntos de validación es de más de 5000 puntos, pero se muestran solo los primeros 20 para ejemplificar el tipo de salida." width="95%" />
<p class="caption">
Figure 12.2: Salida de la consola de los primeros veinte puntos de entrenamiento con la información del ráster, así como del clasificador entrenado. Nótese que el total de puntos de validación es de más de 5000 puntos, pero se muestran solo los primeros 20 para ejemplificar el tipo de salida.
</p>
</div>
<div class="bluebox2">
<div class="awesomeblock">
<p>Generalmente se menciona que el utilizar un mayor número de árboles en el algoritmo Random Forest permite obtener mejores resultados, sin embargo, dependiendo del conjunto de datos utilizado existe un umbral a partir del cual aumentar el número de árboles no resulta en una mejoría significativa de la clasificación. Consultar Oshiro <em>et al</em>. (2012) para ver una evaluación del efecto del número de árboles sobre las capacidades de clasificación.</p>
</div>
</div>
<p>Posteriormente, se puede clasificar la imagen completa utilizando el método <span style="color: darkpurple;">.classify</span> e indicando como argumento al algoritmo entrenado. El resultado de <span style="color: darkpurple;">.classify</span> va a ser un objeto de tipo <span style="color: darkpurple;">ee.Image</span> que contiene la clase predicha en la banda ‘classification’. Por último, se visualiza el resultado en la pantalla de mapas (<span style="color: darkblue;">Fig.</span> <a href="12-clasificación-supervisada.html#fig:fc123">12.3</a>).
</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb140-1"><a href="12-clasificación-supervisada.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Usar el clasificador entrenado sobre toda la imagen</span></span>
<span id="cb140-2"><a href="12-clasificación-supervisada.html#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> classifiedImg <span class="op">=</span> L8imgMean<span class="op">.</span><span class="fu">classify</span>(trainedClassifier)<span class="op">;</span></span>
<span id="cb140-3"><a href="12-clasificación-supervisada.html#cb140-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-4"><a href="12-clasificación-supervisada.html#cb140-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Visualizar resultado</span></span>
<span id="cb140-5"><a href="12-clasificación-supervisada.html#cb140-5" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(classifiedImg<span class="op">,</span>{<span class="dt">min</span><span class="op">:</span><span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span><span class="dv">3</span><span class="op">,</span> </span>
<span id="cb140-6"><a href="12-clasificación-supervisada.html#cb140-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">palette</span><span class="op">:</span>[<span class="st">&#39;#fcff21&#39;</span><span class="op">,</span><span class="st">&#39;#20da25&#39;</span><span class="op">,</span><span class="st">&#39;#05a9da&#39;</span><span class="op">,</span><span class="st">&#39;#dadada&#39;</span>]}<span class="op">,</span></span>
<span id="cb140-7"><a href="12-clasificación-supervisada.html#cb140-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;Clasificación RF L8&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Usar el clasificador entrenado sobre toda la imagen
var classifiedImg = L8imgMean.classify(trainedClassifier);

// Visualizar resultado
Map.addLayer(classifiedImg,{min:0, max:3, 
  palette:['#fcff21','#20da25','#05a9da','#dadada']},
  'Clasificación RF L8');
</script>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fc123"></span>
<img src="Img/RFClass.png" alt="Visualización de la clasificación." width="95%" />
<p class="caption">
Figure 12.3: Visualización de la clasificación.
</p>
</div>
<p>Después, se puede hacer un gráfico para analizar el perfil espectral de las clases de interés. Para hacer esto, primero se agrega la banda con la clasificación a la imagen que contiene la media de la reflectancia de la superficie (<code>L8imgMean</code>). Después, se utiliza la función <span style="color: darkpurple;">ui.Chart.image.byClass</span> para crear un gráfico por clase. Como argumentos a esta función se indica la imagen a utilizar (<code>image</code>), el nombre de la banda que contiene las categorías de la clasificación (<code>classBand</code>), el reductor que se va a utilizar para resumir los valores por clase (<code>reducer</code>), las regiones de las cuales se va a obtener esta información (<code>region</code>), las etiquetas de las clases (<code>classLabels</code>), la escala en m de trabajo para aplicar el reductor (<code>scale</code>) y algunas opciones para ponerle título y asignar los colores al gráfico (argumentos dentro de <span style="color: darkpurple;">.setOptions</span>). Por último, hay que imprimir el gráfico con la función de <span style="color: darkpurple;">print</span> y el gráfico aparecerá en la consola (<span style="color: darkblue;">Fig.</span> <a href="12-clasificación-supervisada.html#fig:fc124">12.4</a>).
</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb141-1"><a href="12-clasificación-supervisada.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Agregar clasificación como banda</span></span>
<span id="cb141-2"><a href="12-clasificación-supervisada.html#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> imgConClass <span class="op">=</span> L8imgMean<span class="op">.</span><span class="fu">addBands</span>(classifiedImg)<span class="op">;</span></span>
<span id="cb141-3"><a href="12-clasificación-supervisada.html#cb141-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-4"><a href="12-clasificación-supervisada.html#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Hacer gráfico de barras</span></span>
<span id="cb141-5"><a href="12-clasificación-supervisada.html#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> chartClassSpec <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">byClass</span>({</span>
<span id="cb141-6"><a href="12-clasificación-supervisada.html#cb141-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Imagen a utilizar para construir el gráfico</span></span>
<span id="cb141-7"><a href="12-clasificación-supervisada.html#cb141-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">image</span><span class="op">:</span> imgConClass<span class="op">,</span></span>
<span id="cb141-8"><a href="12-clasificación-supervisada.html#cb141-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Banda que contiene las clases</span></span>
<span id="cb141-9"><a href="12-clasificación-supervisada.html#cb141-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">classBand</span><span class="op">:</span> <span class="st">&#39;classification&#39;</span><span class="op">,</span></span>
<span id="cb141-10"><a href="12-clasificación-supervisada.html#cb141-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Reductor a utilizar</span></span>
<span id="cb141-11"><a href="12-clasificación-supervisada.html#cb141-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">mean</span>()<span class="op">,</span></span>
<span id="cb141-12"><a href="12-clasificación-supervisada.html#cb141-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Regiones a partir de las cuales se va a construir el </span></span>
<span id="cb141-13"><a href="12-clasificación-supervisada.html#cb141-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">// gráfico</span></span>
<span id="cb141-14"><a href="12-clasificación-supervisada.html#cb141-14" aria-hidden="true" tabindex="-1"></a>  <span class="dt">region</span><span class="op">:</span> poligonos<span class="op">,</span></span>
<span id="cb141-15"><a href="12-clasificación-supervisada.html#cb141-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Etiquetas de las clases</span></span>
<span id="cb141-16"><a href="12-clasificación-supervisada.html#cb141-16" aria-hidden="true" tabindex="-1"></a>  <span class="dt">classLabels</span><span class="op">:</span> [<span class="st">&#39;NoBosque&#39;</span><span class="op">,</span><span class="st">&#39;Bosque&#39;</span><span class="op">,</span><span class="st">&#39;Agua&#39;</span><span class="op">,</span><span class="st">&#39;Urbano&#39;</span>]<span class="op">,</span></span>
<span id="cb141-17"><a href="12-clasificación-supervisada.html#cb141-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Tamaño de píxel</span></span>
<span id="cb141-18"><a href="12-clasificación-supervisada.html#cb141-18" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">240</span></span>
<span id="cb141-19"><a href="12-clasificación-supervisada.html#cb141-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Definir más opciones para el gráfico</span></span>
<span id="cb141-20"><a href="12-clasificación-supervisada.html#cb141-20" aria-hidden="true" tabindex="-1"></a>})<span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb141-21"><a href="12-clasificación-supervisada.html#cb141-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Título del gráfico</span></span>
<span id="cb141-22"><a href="12-clasificación-supervisada.html#cb141-22" aria-hidden="true" tabindex="-1"></a>  <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Perfil espectral por clase&#39;</span><span class="op">,</span></span>
<span id="cb141-23"><a href="12-clasificación-supervisada.html#cb141-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Colores a utilizar</span></span>
<span id="cb141-24"><a href="12-clasificación-supervisada.html#cb141-24" aria-hidden="true" tabindex="-1"></a>  <span class="dt">colors</span><span class="op">:</span> [<span class="st">&#39;#fcff21&#39;</span><span class="op">,</span><span class="st">&#39;#20da25&#39;</span><span class="op">,</span><span class="st">&#39;#05a9da&#39;</span><span class="op">,</span><span class="st">&#39;#dadada&#39;</span>]</span>
<span id="cb141-25"><a href="12-clasificación-supervisada.html#cb141-25" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb141-26"><a href="12-clasificación-supervisada.html#cb141-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-27"><a href="12-clasificación-supervisada.html#cb141-27" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chartClassSpec)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Agregar clasificación como banda
var imgConClass = L8imgMean.addBands(classifiedImg);

// Hacer gráfico de barras
var chartClassSpec = ui.Chart.image.byClass({
  // Imagen a utilizar para construir el gráfico
  image: imgConClass,
  // Banda que contiene las clases
  classBand: 'classification',
  // Reductor a utilizar
  reducer: ee.Reducer.mean(),
  // Regiones a partir de las cuales se va a construir el 
  // gráfico
  region: poligonos,
  // Etiquetas de las clases
  classLabels: ['NoBosque','Bosque','Agua','Urbano'],
  // Tamaño de píxel
  scale: 240
  // Definir más opciones para el gráfico
}).setOptions({
  // Título del gráfico
  title: 'Perfil espectral por clase',
  // Colores a utilizar
  colors: ['#fcff21','#20da25','#05a9da','#dadada']
});

print(chartClassSpec);
</script>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fc124"></span>
<img src="Img/SpectralSignClass.png" alt="Perfil espectral promedio por clase." width="95%" />
<p class="caption">
Figure 12.4: Perfil espectral promedio por clase.
</p>
</div>
<p>Una vez que se tiene la clasificación del área de interés, se van a cargar los datos de verificación para calcular la matriz de error y la precisión total de la clasificación. Primero se carga la información de los polígonos de verificación.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb142-1"><a href="12-clasificación-supervisada.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Definción de áreas de verificación</span></span>
<span id="cb142-2"><a href="12-clasificación-supervisada.html#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> bosque3 <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">101.62016</span><span class="op">,</span><span class="fl">19.61895</span><span class="op">,</span> </span>
<span id="cb142-3"><a href="12-clasificación-supervisada.html#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">101.60543</span><span class="op">,</span><span class="fl">19.60492</span>)<span class="op">;</span></span>
<span id="cb142-4"><a href="12-clasificación-supervisada.html#cb142-4" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> noBosque3 <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">101.313746</span><span class="op">,</span><span class="fl">19.716531</span><span class="op">,</span> </span>
<span id="cb142-5"><a href="12-clasificación-supervisada.html#cb142-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">101.306380</span><span class="op">,</span><span class="fl">19.709505</span>)<span class="op">;</span></span>
<span id="cb142-6"><a href="12-clasificación-supervisada.html#cb142-6" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> urbano2 <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">101.609880</span><span class="op">,</span><span class="fl">19.517665</span><span class="op">,</span> </span>
<span id="cb142-7"><a href="12-clasificación-supervisada.html#cb142-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">101.602523</span><span class="op">,</span><span class="fl">19.510752</span>)<span class="op">;</span></span>
<span id="cb142-8"><a href="12-clasificación-supervisada.html#cb142-8" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> agua3 <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">101.272720</span><span class="op">,</span><span class="fl">19.612100</span><span class="op">,</span> </span>
<span id="cb142-9"><a href="12-clasificación-supervisada.html#cb142-9" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">101.272668</span><span class="op">,</span><span class="fl">19.611594</span>)<span class="op">;</span></span>
<span id="cb142-10"><a href="12-clasificación-supervisada.html#cb142-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-11"><a href="12-clasificación-supervisada.html#cb142-11" aria-hidden="true" tabindex="-1"></a><span class="co">// Creación de colección de verificación</span></span>
<span id="cb142-12"><a href="12-clasificación-supervisada.html#cb142-12" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> poligonosVerif <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>([</span>
<span id="cb142-13"><a href="12-clasificación-supervisada.html#cb142-13" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="fu">Feature</span>(noBosque3<span class="op">,</span> {<span class="st">&#39;clase&#39;</span><span class="op">:</span> <span class="dv">0</span>})<span class="op">,</span></span>
<span id="cb142-14"><a href="12-clasificación-supervisada.html#cb142-14" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="fu">Feature</span>(bosque3<span class="op">,</span> {<span class="st">&#39;clase&#39;</span><span class="op">:</span> <span class="dv">1</span>})<span class="op">,</span></span>
<span id="cb142-15"><a href="12-clasificación-supervisada.html#cb142-15" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="fu">Feature</span>(agua3<span class="op">,</span> {<span class="st">&#39;clase&#39;</span><span class="op">:</span> <span class="dv">2</span>})<span class="op">,</span></span>
<span id="cb142-16"><a href="12-clasificación-supervisada.html#cb142-16" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="fu">Feature</span>(urbano2<span class="op">,</span> {<span class="st">&#39;clase&#39;</span><span class="op">:</span> <span class="dv">3</span>})<span class="op">,</span></span>
<span id="cb142-17"><a href="12-clasificación-supervisada.html#cb142-17" aria-hidden="true" tabindex="-1"></a>])<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Definción de áreas de verificación
var bosque3 = ee.Geometry.Rectangle(-101.62016,19.61895, 
  -101.60543,19.60492);
var noBosque3 = ee.Geometry.Rectangle(-101.313746,19.716531, 
  -101.306380,19.709505);
var urbano2 = ee.Geometry.Rectangle(-101.609880,19.517665, 
  -101.602523,19.510752);
var agua3 = ee.Geometry.Rectangle(-101.272720,19.612100, 
  -101.272668,19.611594);

// Creación de colección de verificación
var poligonosVerif = ee.FeatureCollection([
  ee.Feature(noBosque3, {'clase': 0}),
  ee.Feature(bosque3, {'clase': 1}),
  ee.Feature(agua3, {'clase': 2}),
  ee.Feature(urbano2, {'clase': 3}),
]);
</script>
<p>El siguiente paso es extraer la información de la imagen clasificada, de acuerdo con la extensión de los datos de verificación. Este paso es exactamente igual al que se hizo con los datos de entrenamiento, pero ahora utilizando los datos de verificación y la imagen clasificada en lugar de la imagen de reflectancia. De igual manera, el resultado de este paso es una colección de vectores (<span style="color: darkblue;">Fig.</span> <a href="12-clasificación-supervisada.html#fig:fc125">12.5</a>).
</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb143-1"><a href="12-clasificación-supervisada.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Muestrear imagen</span></span>
<span id="cb143-2"><a href="12-clasificación-supervisada.html#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> validating <span class="op">=</span> classifiedImg</span>
<span id="cb143-3"><a href="12-clasificación-supervisada.html#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">sampleRegions</span>({</span>
<span id="cb143-4"><a href="12-clasificación-supervisada.html#cb143-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">collection</span><span class="op">:</span> poligonosVerif<span class="op">,</span></span>
<span id="cb143-5"><a href="12-clasificación-supervisada.html#cb143-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">properties</span><span class="op">:</span> [<span class="st">&#39;clase&#39;</span>]<span class="op">,</span></span>
<span id="cb143-6"><a href="12-clasificación-supervisada.html#cb143-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span></span>
<span id="cb143-7"><a href="12-clasificación-supervisada.html#cb143-7" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Muestrear imagen
var validating = classifiedImg
  .sampleRegions({
  collection: poligonosVerif,
  properties: ['clase'],
  scale: 30,
});
</script>
<p>A continuación, se calcula la matriz de error mediante el método <span style="color: darkpurple;">.errorMatrix</span> indicando, en primer lugar, el campo de la clase de referencia (‘clase’) y, en segundo lugar, el campo de la predicción (‘classification’). Posteriormente, se calcula la precisión total de clasificación a partir de esta matriz de error. Después, se van a mostrar estos dos objetos en la consola mediante <span style="color: darkpurple;">print</span> para inspeccionar su contenido (<span style="color: darkblue;">Fig.</span> <a href="12-clasificación-supervisada.html#fig:fc125">12.5</a>).
</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb144-1"><a href="12-clasificación-supervisada.html#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Obtener matriz de confusión y precisión</span></span>
<span id="cb144-2"><a href="12-clasificación-supervisada.html#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> validErrMat <span class="op">=</span> validating<span class="op">.</span><span class="fu">errorMatrix</span>(<span class="st">&#39;clase&#39;</span><span class="op">,</span> <span class="st">&#39;classification&#39;</span>)<span class="op">;</span></span>
<span id="cb144-3"><a href="12-clasificación-supervisada.html#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> validAcc <span class="op">=</span> validErrMat<span class="op">.</span><span class="fu">accuracy</span>()<span class="op">;</span></span>
<span id="cb144-4"><a href="12-clasificación-supervisada.html#cb144-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-5"><a href="12-clasificación-supervisada.html#cb144-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Validation error matrix: &#39;</span><span class="op">,</span> validErrMat)<span class="op">;</span></span>
<span id="cb144-6"><a href="12-clasificación-supervisada.html#cb144-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Validation overall accuracy: &#39;</span><span class="op">,</span> validAcc)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Obtener matriz de confusión y precisión
var validErrMat = validating.errorMatrix('clase', 'classification');
var validAcc = validErrMat.accuracy();

print('Validation error matrix: ', validErrMat);
print('Validation overall accuracy: ', validAcc);
</script>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fc125"></span>
<img src="Img/matrizError.png" alt="Salida de la consola de los primeros diez puntos de validación, matriz de error (error matrix) y precisión total (overall accuracy). Nótese que el total de puntos de validación es de 4290, pero se muestran solo los primeros diez para ejemplificar el tipo de salida." width="80%" />
<p class="caption">
Figure 12.5: Salida de la consola de los primeros diez puntos de validación, matriz de error (error matrix) y precisión total (overall accuracy). Nótese que el total de puntos de validación es de 4290, pero se muestran solo los primeros diez para ejemplificar el tipo de salida.
</p>
</div>
<div class="bluebox2">
<div class="awesomeblock">
<p>Por defecto, la imagen que se obtiene de un método <span style="color: darkpurple;">.classify</span> lleva el nombre de ‘classification’, por eso la propiedad que se muestrea en el paso de <span style="color: darkpurple;">.sampleRegions</span> y con la que se hace la matriz de error <span style="color: darkpurple;">.errorMatrix</span> se llama ‘classification’.</p>
</div>
</div>
<p>Para exportar estos resultados primero hay que pasar los datos a tipo vector. Para ello, se va a crear un vector sin geometría (que es lo que indica el <code>null</code> en el primer campo del <span style="color: darkpurple;">ee.Feature</span>), seguido de un diccionario que contiene los datos que se desea exportar (que podrían interpretarse como una tabla de atributos). En el caso de la matriz de error, primero se debe convertir a un arreglo mediante el método <span style="color: darkpurple;">.array</span>.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb145-1"><a href="12-clasificación-supervisada.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Transformarlos en vectores</span></span>
<span id="cb145-2"><a href="12-clasificación-supervisada.html#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> expConfMatrix <span class="op">=</span>  ee<span class="op">.</span><span class="fu">Feature</span>(<span class="kw">null</span><span class="op">,</span> {<span class="dt">matrix</span><span class="op">:</span> validErrMat<span class="op">.</span><span class="fu">array</span>()})<span class="op">;</span></span>
<span id="cb145-3"><a href="12-clasificación-supervisada.html#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> expAccuracy <span class="op">=</span> ee<span class="op">.</span><span class="fu">Feature</span>(<span class="kw">null</span><span class="op">,</span> ee<span class="op">.</span><span class="fu">Dictionary</span>({<span class="dt">Accuracy</span><span class="op">:</span> validAcc}))<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Transformarlos en vectores
var expConfMatrix =  ee.Feature(null, {matrix: validErrMat.array()});
var expAccuracy = ee.Feature(null, ee.Dictionary({Accuracy: validAcc}));
</script>
<p>Posteriormente, se define una función (<code>ExportTable</code>) para exportar la matriz de error y el valor de la precisión total. Esta función toma dos argumentos: el objeto a exportar y el nombre que se le va a dar al archivo a exportar. Debido a que la función <span style="color: darkpurple;">Export.table.toDrive</span> solo permite exportar objetos de tipo <span style="color: darkpurple;">ee.FeatureCollection</span>, se debe meter a los objetos de tipo <span style="color: darkpurple;">ee.Feature</span> en un contenedor <span style="color: darkpurple;">ee.FeatureCollection</span>. Por último, se debe indicar que el formato para guardar el archivo es uno separado por comas (CSV) y se puede indicar la carpeta dentro de la que se quiere guardar la tabla exportada.
</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb146-1"><a href="12-clasificación-supervisada.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Definir función de exportación</span></span>
<span id="cb146-2"><a href="12-clasificación-supervisada.html#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> exportTable <span class="op">=</span> <span class="kw">function</span>(feature<span class="op">,</span> name){</span>
<span id="cb146-3"><a href="12-clasificación-supervisada.html#cb146-3" aria-hidden="true" tabindex="-1"></a>  Export<span class="op">.</span><span class="at">table</span><span class="op">.</span><span class="fu">toDrive</span>({</span>
<span id="cb146-4"><a href="12-clasificación-supervisada.html#cb146-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Colección de vectores a exportar</span></span>
<span id="cb146-5"><a href="12-clasificación-supervisada.html#cb146-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">collection</span><span class="op">:</span> feature<span class="op">,</span></span>
<span id="cb146-6"><a href="12-clasificación-supervisada.html#cb146-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Nombre para guardar el archivo</span></span>
<span id="cb146-7"><a href="12-clasificación-supervisada.html#cb146-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">description</span><span class="op">:</span> name<span class="op">,</span></span>
<span id="cb146-8"><a href="12-clasificación-supervisada.html#cb146-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Carpeta donde se guardará el archivo</span></span>
<span id="cb146-9"><a href="12-clasificación-supervisada.html#cb146-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">folder</span><span class="op">:</span> <span class="st">&#39;Clasificacion_RF&#39;</span><span class="op">,</span></span>
<span id="cb146-10"><a href="12-clasificación-supervisada.html#cb146-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Formato del archivo</span></span>
<span id="cb146-11"><a href="12-clasificación-supervisada.html#cb146-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fileFormat</span><span class="op">:</span> <span class="st">&#39;CSV&#39;</span></span>
<span id="cb146-12"><a href="12-clasificación-supervisada.html#cb146-12" aria-hidden="true" tabindex="-1"></a> })<span class="op">;</span></span>
<span id="cb146-13"><a href="12-clasificación-supervisada.html#cb146-13" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb146-14"><a href="12-clasificación-supervisada.html#cb146-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-15"><a href="12-clasificación-supervisada.html#cb146-15" aria-hidden="true" tabindex="-1"></a><span class="co">// Exportar a Google Drive</span></span>
<span id="cb146-16"><a href="12-clasificación-supervisada.html#cb146-16" aria-hidden="true" tabindex="-1"></a><span class="co">// Usar la función exportTable</span></span>
<span id="cb146-17"><a href="12-clasificación-supervisada.html#cb146-17" aria-hidden="true" tabindex="-1"></a><span class="fu">exportTable</span>(ee<span class="op">.</span><span class="fu">FeatureCollection</span>(expConfMatrix)<span class="op">,</span> <span class="st">&#39;confMatrix&#39;</span>)<span class="op">;</span></span>
<span id="cb146-18"><a href="12-clasificación-supervisada.html#cb146-18" aria-hidden="true" tabindex="-1"></a><span class="fu">exportTable</span>(ee<span class="op">.</span><span class="fu">FeatureCollection</span>(expAccuracy)<span class="op">,</span> <span class="st">&#39;validAcc&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Definir función de exportación
var exportTable = function(feature, name){
  Export.table.toDrive({
    // Colección de vectores a exportar
    collection: feature,
    // Nombre para guardar el archivo
    description: name,
    // Carpeta donde se guardará el archivo
    folder: 'Clasificacion_RF',
    // Formato del archivo
    fileFormat: 'CSV'
 });
};

// Exportar a Google Drive
// Usar la función exportTable
exportTable(ee.FeatureCollection(expConfMatrix), 'confMatrix');
exportTable(ee.FeatureCollection(expAccuracy), 'validAcc');
</script>

<div style="page-break-after: always;"></div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="11-uso-conjunto-de-vectores-e-imágenes.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="13-cierre.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

</body>

</html>
