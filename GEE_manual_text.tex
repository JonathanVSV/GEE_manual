% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={GEE manual},
  pdfauthor={JVS GAP JFM},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\renewcommand{\contentsname}{Índice} \usepackage{tcolorbox}
\usepackage{awesomebox}

\title{GEE manual}
\author{JVS GAP JFM}
\date{}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{3}
\tableofcontents
}
% Para cambiar los parámetros por default de las cajas de tips o notas
\setlength{\aweboxleftmargin}{0.1\linewidth}.
\setlength{\aweboxcontentwidth}{0.85\linewidth}
\setlength{\aweboxvskip}{6mm}
\setlength{\aweboxrulewidth}{5pt}
\definecolor{abvrulecolor}{RGB}{48,90,255}

\newpage

\hypertarget{introducciuxf3n}{%
\section{Introducción}\label{introducciuxf3n}}

\hypertarget{quuxe9-es-google-earth-engine}{%
\subsection{¿Qué es Google Earth
Engine?}\label{quuxe9-es-google-earth-engine}}

Google Earth Engine (GEE) es una plataforma, desarrollada por Google,
que permite realizar procesamientos geoespaciales a gran escala,
utilizando bases de datos inmensas. Uno de los principales intereses de
esta plataforma es reducir el tiempo invertido en pre procesamiento y
facilitar los análisis realizados con información geoespacial.

\hypertarget{cuxf3mo-funciona-google-earth-engine-gee}{%
\subsection{¿Cómo Funciona Google Earth Engine
(GEE)?}\label{cuxf3mo-funciona-google-earth-engine-gee}}

\hypertarget{background}{%
\subsubsection{Background}\label{background}}

Desde hace varios años existen varias misiones espaciales que registran
datos de la Tierra a traves de distintos satelites, las cuales se han
almacenado en acervos de imágenes. Aunque esta información ha sido muy
útil para el desarrollo científico, siempre había existido el problema
de la ``Big-Data'' (bases de datos enormes). Es decir, que dichos
acervos de imágenes cuentan con millones de imágenes disponibles, lo
cual resultaba imposible de procesar y analizar en su totalidad. Esta
situación evitaba la posibilidad de aprovechar el potencial total de
esta información.

GEE nace entonces de la necesidad de aprovechar esa ``Big-Data'',
ofreciendo una herramienta que pueda lidiar tecnológicamente con la
parte más complicada y engorrosa del manejo de información, permitiendo
entonces que los usuarios se concentren en la generación de resultados,
y nuevos desarrollos científicos.

Para logar este objetivo, se creó una infraestructura con tres elementos
claves que son los que permiten el funcionameinto de GEE: el catálogo de
información, capacidad computacional y APIs.

\hypertarget{catuxe1logo-de-informaciuxf3n}{%
\paragraph{Catálogo de
información}\label{catuxe1logo-de-informaciuxf3n}}

GEE, recopiló la informacion geoespacial de diferentes fuentes alrededor
del mundo y creó copias de esos datos en su propio \emph{datacenter}
logrando asi almacenar mas de 20 petabytes (20 000 000 de gigabytes) de
informacion, en un solo lugar.

GEE ofrece un amplio repositorio de información geográfica global, cuya
información ya se encuentra cargada su catálogo, facilitando un sencillo
acceso a diferentes Datasets. entre la información que se puede
consultar directamente en GEE se encuentran: acervos para todo el mundo
de imágenes Landsat (1-8), MODIS, Sentinel (1-3, 5), SRTM, AVHRR, GOESS,
ALOS, mosaicos anuales de PALSAR/PALSAR 2 y algunos productos derivados
de estas imágenes u otros insumos como información climática global
(WorldClim), capas de cambios en la cobertura forestal (Global Forest
Cover Change), información de la altura del dosel global (Global Forest
Canopy height), mapas de densidad de carbono globales (Global
Aboveground and Belowground Biomass Carbon Density Map), datos de
precipitación globales (CHIRPS), límites políticos (FAO GAUL: Global
Administrative Unit Layers 2015, Country Boundaries), polígonos de áreas
protegidas mundiales (WDPA: World Database on Protected Areas
(polygons)), densidad poblacional (GPWv411: Population Density (Gridded
Population of the World Version 4.11)), cuencas (WWF HydroSHEDS
Hydrologically Conditioned DEM, 3 Arc-Seconds), entre otras.

\begin{tipblock}
Para consultar toda la información que esta disponible en GEE se puede
consultar la siguiente liga:
\url{https://developers.google.com/earth-engine/datasets}

\end{tipblock}

\hypertarget{capacidad-computacional}{%
\paragraph{Capacidad computacional}\label{capacidad-computacional}}

Paralelamente GEE puso a disposicion, junto al datacenter, unos
servidores (los cuales en 2010 tenian una capcidad más o menos
equivalente a 10 000 computadores personales), para poder realizar
rápida y eficazmente cálculos y computaciones sobre esos datos.

\begin{tipblock}
Se estima que GEE era capaz (en 2010) de en cuestión de días, ejecutar
funciones que en un computador personal habria tomado 15 años.

\end{tipblock}

\hypertarget{api}{%
\paragraph{API}\label{api}}

GEE es una API (Application Program Interface). Esto significa que es
una interfaz que permite la comunicación entre nosotros (usuarios) y los
servidores de Google, proporcionando el acceso Y uso de la capacidad
computacional de Google para nuestros análisis. GEE tiene el objetivo de
facilitar la creación de programas. Por ello, cuenta con una serie de
funciones, métodos y algoritmos preprogramados que se pueden llamar con
una simpe línea.

GEE ofrece dos APIs una en JavaScript la cual se accede online, es la
mas conocida, más actualizada, más amigable con los usuarios, con más
documentación disponible, y sobre la cual estaremos hablando; y una API
en Python, la cual se puede trabajar desde la consola de Pyhton y
permite entonces -hasta cierto punto- usar complementariamente librerias
de Python, permitiendo asi procesamientos mas complejos, o
funcionalidades que la API de Java no permite. la API de Python tiene
las desventajas que tiene menos documentación, y tiene algunas
diferencias (que pueden resutlar poco intuitivas) a la hora de
programar.

\#\#\#\#\#\#\#\#Grafico\#\#\#\#\#\#\#\#

\hypertarget{ventajas-de-la-api-de-java}{%
\subsection{Ventajas de la API de
Java}\label{ventajas-de-la-api-de-java}}

Entre las principales ventajas de utilizar esta API radica en:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Los datos pueden ser consultados directamente en la nube, por lo que
  no requieren ser descargados para trabajar con ellos (lo que ahorra
  tiempo y espacio de almacenamiento para el usuario). En cambio, si se
  quiere usar alguna librería de Python será necesaria la descarga de la
  informacion.
\item
  El procesamiento se hace en la nube, a través de internet, utilizando
  el poder de cómputo asignado para la API, lo cual reduce el gasto de
  memoria RAM (solo necesita una conexión estable y el consumo de RAM
  depende del comsuno del navegador). En la API de Python hay mayor
  consumo de memoria RAM (para ejecutar la consola de python y sus
  librerias) y requiere igualmente una conexion estable a internet.
\item
  Su interfaz es mucho más amigable con los ususarios, ofreciendo una
  plataforma más interactiva para programar, y más sencilla para
  enseñar.
\item
  Se pueden realizar fácilmente consultas de las colecciones de
  imágenes, y sus metadatos, antes de decidir importarlos. La API de
  Python no permite realizar ese tipo de consutas fácilmente, de modo
  que hay que tener previamente absoluta claridad sobre la colección de
  imágenes que se va a utilizar.
\item
  Otra gran ventaja de la plataforma radica en que los códigos se
  guardan en la sesión de cada usuario. Esto permite mantener un control
  de los códigos y automáticamente se genera un registro histórico
  (parecido al git), lo cual facilita el seguimiento y comparación de
  cambios entre las versiones (y permite revertir a versiones
  anteriores). Además, se pueden generar repositorios compartidos para
  generar proyectos colaborativos.
\end{enumerate}

\hypertarget{lenguaje-javascript}{%
\subsection{Lenguaje Javascript}\label{lenguaje-javascript}}

La sintaxis de JavaScript tiene algunas peculiaridades que deben
cumplirse para que se pueda correr el código sin problemas. Entre la
sintaxis básica se pueden considerar los siguientes puntos \emph{(de
igual forma iremos tocando la gramatica del código a lo largo de los
ejemplos)}:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Es un lenguaje sensible a mayúsculas y minúsculas. De tal manera que
  puede haber dos objetos diferentes uno llamado \texttt{a} y otro
  diferente llamado \texttt{A}.
\item
  Siempre se debe cerrar cualquier comando con un \texttt{;}. (aunque de
  no hacerlo el código funcionara igualmente).
\item
  Comúnmente en Javascript se utiliza el \emph{lower Camel Case} (unir
  palabras pero cada una comenzando con su respectiva mayúscula) para
  unir palabras, en lugar de guiones o guión bajo. Por ejemplo:
  \texttt{intervalMean} o \texttt{updateMask}.
\item
  Todas las variables, funciones, objetos deben ser definidos mediante
  la función \texttt{var}.
\item
  Para definir variables se utiliza el operador \texttt{=}.
\item
  Los operadores matemáticos son: \texttt{+\ -\ *\ /}.
\item
  Para concatenar dos cadenas de caracteres se utiliza el símbolo
  \texttt{+}.
\item
  Para realizar comentarios se puede utilizar \texttt{//} para
  comentarios de una línea o \texttt{/*\ \ldots{}\ */} para comentarios
  de varias líneas
\item
  Se puede utilizar el operador \texttt{.} para aplicar una función al
  objeto que lo precede. Por ejemplo,
  \texttt{imagen.updateMask(mascara);}
\item
  No es sensible a las tabulaciones, aunque son recomendadas para un
  código ordenado.
\item
  Son igualmente validas las comillas sencillas
  \texttt{\textquotesingle{}\textquotesingle{}} como las comillas dobles
  \texttt{""}, pero no deben mezclarse ambos tipos de comillas en una
  misma línea.
\end{enumerate}

\newpage

\hypertarget{primeros-pasos}{%
\section{Primeros pasos}\label{primeros-pasos}}

\hypertarget{registro-para-el-uso-de-gee-javascript-api}{%
\subsection{Registro para el uso de GEE Javascript
API}\label{registro-para-el-uso-de-gee-javascript-api}}

\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#graficos

Lo primero que hay que hacer para poder utlizar la API Javascript de
Google Earth Engine es ingresar a su sitio para registrarse como
usuario. Para ello, hay que acceder a la siguient liga:

\textbf{\url{https://earthengine.google.com/}}

Después le damos click en la esquina superior derecha donde dice
\textbf{Sign Up}. Se ingresan todos los datos que pide el formulario.
Recordar que para utilizar GEE requerimos de una cuenta de Google para
poder utilizar la API.

\begin{tipblock}
Se recomienda dar de alta una cuenta de Google que tenga suficiente
espacio disponible en Google Drive, ya que será la forma más fácil de
exportar los resultados generados en GEE.

\end{tipblock}

Una vez realizado el registro, hay que esperar un tiempo (puede ser
minutos o dias) hasta que llegue una confirmación por parte de GEE a
nuestro correo informando que ya se puede hacer uso de la API.

Una vez que tengamos dicha confirmación, podemos acceder a la API
accediendo a la siguiente liga:

\textbf{\url{https://code.earthengine.google.com/}}

y se accede con la cuenta de Google con la que nos registramos.

\hypertarget{elementos-buxe1sicos-de-la-interfaz-gruxe1fica}{%
\subsection{Elementos básicos de la interfaz
gráfica}\label{elementos-buxe1sicos-de-la-interfaz-gruxe1fica}}

Una vez abierto la Javascript API, se observa la siguiente pantalla

\includegraphics[width=500px]{Img/GEE_inicio_API}

Los elementos de la API se enlistan a continuación:

\textbf{Pantalla de Repositorios}

\includegraphics[width=500px]{Img/left_panel}

Es el espacio donde se guardan y ordenan los scripts del usuario. En
ella se pueden crear repositorios y folders para organizar los archivos
de código, como se muestra a continuación.

\includegraphics[width=500px]{Img/repositorio}

Dentro de este espacio existen varias categorías (los primeros tres se
pueden utilizar para determinar distintos niveles de acceso para
diversos usuarios): 1. Propietario (\textbf{Owner}): En esta sección se
guardan los codigos creados por el mismo usuario. 2. Editor
(\textbf{Writer}): En este apartado se guardan códigos que pueden ser
creados por otros usuarios, pero para los cuales tenemos autorización de
modificarlos.\\
3. Lector (\textbf{Reader}): En esta parte aparecen codigos que otros
usuarios nos han compartido acceso, pero no tenemos autorización de
modificarlos.\\
4. Ejemplos: se pueden consultar ejemplos de código para hacer algunas
tareas específicas. Por ejemplo, existe un apartado específico para
consultar las distintas maneras de enmascarar nubes utilizando distintas
colecciones de imágenes (i.e., Landsat 4-7, Landsat 8, Sentinel-2,
MODIS). 5. Archivo: se pueden guardar archivos de código que ya no se
utilicen, pero que no se desean eliminar.

\begin{tipblock}
El usuario puede compartir repositorios con otros usuarios de GEE como
lector o editor. De esta manera, todos los archivos que se encuentren
dentro de un repositorio serán compartidos con los usuarios indicados.
Esta opción está disponible al darle click en el símbolo del engranaje a
la derecha de cada repositorio (aparece una vez que se coloca el puntero
sobre el nombre del repositorio).

\includegraphics[width=500px]{Img/engranaje}

\end{tipblock}

\textbf{Docs}

\includegraphics[width=500px]{Img/docs}

Es un área donde se pueden consultar todas las funciones y algoritmos
que se encuentran preprogramados y cargados en GEE. Además, para cada
función se indica lo que hace, la entrada que requiere y el tipo de
objeto que se obtiene como salida, así como los argumentos de la
función. Estas funciones se encuentran agrupadas por objetos del
servidor (los objetos se explican más adelante). adicionalmente tiene un
buscador, donde se pueden consultar tambien las funciones.

\includegraphics[width=500px]{Img/doc_ejemplo}

\textbf{Assets}

\includegraphics[width=500px]{Img/assets}

En este apartado el usuario puede subir y guardar su propia información
para ser utilizada dentro de GEE. Se pueden subir archivos en formato
raster, vector (.shp con sus archivos auxiliares, o un .zip) o separado
por comas, únicamente.

\includegraphics[width=500px]{Img/newAssets}

para subir un nuevo archivo, dar click en el boton \textbf{NEW},
seleccionar el tipo de archivo, y seguir las instrucciones, 1. para los
archivos raster, solo hace falta seleccionar el archivo correspondiente
y dar click en upload. 2. para los archivos tipo \emph{.shp} es
necesario subir \textbf{los archivos auxiliares} ( \emph{dbf},
\emph{prj}, \emph{shx}, \emph{cpg}, \emph{fix}, \emph{qix}, \emph{sbn},
y/o \emph{shp.xml}) con el mismo nombre. para los archivos \emph{.zip}
es necesario que contenga \textbf{los archivos auxiliares}. 3. para los
archivos \emph{.csv} es nescesario que exista una columna de longitud y
otra de latitud, las coordenadas deben ser decimales y estar en
EPSG:4326 (WGS 84).El nombre de esas columnas se debe indicar en
\emph{Advanced options} / \emph{x column} - \emph{Y column}. Además, se
debe tener \textbf{absoluta claridad} del tipo de delimitador (ejemplo:
coma: \emph{,} punto y coma: \emph{;} u otro diferente) y este debe ser
especificado en \emph{Advanced options} / \emph{CSV delimiter}.

\begin{tipblock}
El usuario puede compartir sus archivos con otros usuarios de GEE como
lector o editor. De esta manera, el archivo compartido podra ser
consultado por los usuarios indicados. Esta opción está disponible al
darle click en el símbolo de compartir a la derecha de cada archivo
(aparece una vez que se coloca el puntero sobre el nombre del archivo).

\includegraphics[width=500px]{Img/shareAssets}

\end{tipblock}

\textbf{Pantalla de rutinas}

\includegraphics[width=500px]{Img/editor}

Esta ventana es donde se va a escribir el código en JavaScript. En la
parte superior de esta pantalla se encuentran varios botones. El
primero, \texttt{Get\ link} sirve para compartir el código que se tenga
abierto mediante una liga. Además, al darle click en la flecha de
despliegue (en la opcion \emph{Manage Links} ) se puede hacer un manejo
de las ligas que se tengan activas, así como borrar ligas que ya no se
utilicen.

\includegraphics[width=500px]{Img/links}

A su derecha se encuentra el botón de \texttt{Save} el cual permite
guardar el código con el que se esté trabajando. Además, al darle click
en la flecha de despliegue se puede usar la opcion \emph{Save as} para
crear una copia del código con otro nombre.

\includegraphics[width=500px]{Img/save}

A continuación está el botón de \texttt{Run} que sirve para correr el
código que se muestra en la pantalla de rutinas, de principio a fin. Al
darle click en este botón se envía el código a los servidores de Google
y se realiza el procedimiento indicado.

\includegraphics[width=500px]{Img/run}

A su derecha se encuentra el botón de \texttt{Reset} el cual sirve para
borrar todo el código que se tenga escrito en la pantalla de rutinas.

Después se encuentra el botón de Apps que sirve para crear Apps a partir
del código que se encuentra en la pantalla.

Por último, en el botón del engranaje se encuentran opciones para
prender y apagar funciones como subrayar sugerencias en la pantalla de
rutinas o autocompletar símbolos como ', ", ( y \{.

\begin{tipblock}
Cuando se corre un código en la consola con el botón de Run, éste no
corre directamente en los servidores de Google, sino que éstos se
transcriben a código GeoJSON, se envían a los servidores de Google y se
espera una respuesta.

\end{tipblock}

\begin{tipblock}
Para buscar un texto especifico dentro del código, se debe dar click en
la pantalla de rutinas y presionar ctrl+F (algunos atajos pueden variar
segun la configuracion del teclado). Esta pantalla permite buscar una
cadena de caracteres determinada dentro del código. Además, al volver a
presionar ctrl+F tambien se activa el recuadro de sustitución, el cual
resulta de gran ayuda para sustituir una cadena de caracteres
determinada por otra. Para consultar el listado completo de atajos se
puede presionar ctrl+shift+H.

\end{tipblock}

\textbf{Search}

\includegraphics[width=500px]{Img/search}

Es una barra de búsqueda en la que se pueden buscar fuentes de datos o
sitios. Resulta útil para encontrar la ruta de algun Dataset o colección
en particular, así como para consultar sus metadatos, bandas y
características.

\textbf{Map}

\includegraphics[width=500px]{Img/drawing}

En esta pantalla de mapa se pueden:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Dibujar y visualizar puntos, polígonos, líneas o rectángulos
\item
  Mostrar la información que se haya indicado mediante la función
  \texttt{Map.addLayer}.
\item
  Añadir un mapa base (google maps , o google earth).
\end{enumerate}

\textbf{Layer manager}

\includegraphics[width=500px]{Img/layer}

Permite prender y apagar las capas que se estén mostrando en el área del
mapa. Además, permite modificar las características necesarias para su
visualización (p.ej., transparencia, color, distribución del histograma,
compuesto de color, etc). Este menú aparece una vez que se cargan capas
a la pantalla de mapas.

\textbf{Consola}

\includegraphics[width=500px]{Img/rigthPanel}

La consola consiste en la pantalla de comunicación con el servidor. En
ella se muestran los errores que se obtienen al correr un código o se
pueden mostrar la información indicada por la función \texttt{print()}.

\textbf{Inspector}

\includegraphics[width=500px]{Img/inspector}

Permite consultar los valores de las capas que se muestran en el mapa,
al dar click sobre el punto de interés.

\textbf{Tasks}

\includegraphics[width=500px]{Img/task}

En esta pestaña se muestran los trabajos que se hayan exportado mediante
la función \texttt{Export.image} o \texttt{Export.table} y permite
correr el trabajo de exportación al sitio donde el usuario le haya
indicado (drive, assets). Además, en esta pestaña se:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Muestran las tareas para ejecutar (con el boton de run, el cual
  permite especificar detalles de la exportacion).
\item
  Muestran las tareas en ejecucion (gris).
\item
  Muestra el tiempo demorado en el trabajo.
\item
  Así como cuando el trabajo se ha finalizado (azul).
\item
  Cuando hay un error en algun objeto exportado, en esta ventana se verá
  el trabajo marcado en rojo, indicando el error. Por último, al dar
  click sobre el signo de interrogación que aparece al colocar el cursor
  sobre algún trabajo, permite obtener mayor información del trabajo,
  por ejemplo, el error que arrojó el servidor al tratar de realizar una
  exportación o la ubicación del archivo exportado.
\end{enumerate}

\newpage

\hypertarget{interfaz-de-usuario-visualizaciuxf3n-de-datos-gruxe1ficos-y-exportaciuxf3n}{%
\section{Interfaz de usuario: Visualización de datos, gráficos y
exportación}\label{interfaz-de-usuario-visualizaciuxf3n-de-datos-gruxe1ficos-y-exportaciuxf3n}}

\hypertarget{imprimir-en-consola}{%
\subsection{Imprimir en consola}\label{imprimir-en-consola}}

La interfaz más sencilla de la API es imprimir objetos en la consola.
Esto se realiza mediante la función \texttt{print}. Al llamar esta
función sobre algún objeto, éste se evalua y se imprime su estructura en
la consola. Esta función permite obtener información básica de los
objetos como su tipo de objeto, número de registros, características y
propiedades de los elementos que lo conforman. Además, esta función
resulta muy útil para eliminar errores de programación (\emph{bugs}) en
los códigos.

\begin{Shaded}
\begin{Highlighting}[]
\AttributeTok{print}\NormalTok{(Objeto)}\OperatorTok{;}
\AttributeTok{print}\NormalTok{(}\StringTok{'Hola Mundo'}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\hypertarget{map}{%
\subsection{Map}\label{map}}

Permite agregar objetos del lado del servidor a la pantalla de mapas,
así como controlar algunos parámetros de dicha pantalla.

\begin{tipblock}
Para revisar todas las funciones disponibles para la interfaz del
usuario, ver la sección de \textbf{Code Editor } en la siguiente liga:
\url{https://developers.google.com/earth-engine/apidocs}. Además, en
esta sección se indican los argumentos que acepta cada función, así como
el tipo de objeto de la salida.

\end{tipblock}

\textbf{Map.addLayer}

La función \texttt{Map.addLayer} permite mostrar elementos en la parte
de mapa de la API. Por lo tanto, permite mostrar objetos de tipo
\texttt{ee.Feature} o \texttt{ee.Image}. Adicionalmente, se pueden
indicar otros parámetros como la forma de visualización de los objetos y
el nombre de la capa. Los argumentos de la función \texttt{Map.addLayer}
incluyen el objeto a añadir a la pantalla de mapas, seguido de un
diccionario que señala las bandas a añadir y los valores máximos y
mínimos para el despliegue de la capa y por último, se puede indicar el
nombre de la capa.

Al utilizar \texttt{Map.addLayer} sobre una imagen se pueden indicar los
siguientes argumentos: \texttt{bands}, \texttt{min} o \texttt{max}.
Estos se deben pasar dentro de un par de llaves (\texttt{\{\}}) como un
diccionario. Esta función también permite asignar colores mediante el
argumento de \texttt{palette}. Dependiendo de las bandas que se elija
mostrar se puede mostrar únicamente una banda en tonos de gris o un
compuesto RGB. Por ejemplo, para cargar una imagen a la pantalla de
mapas:

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{Map}\NormalTok{.}\AttributeTok{addLayer}\NormalTok{(image}\OperatorTok{,} \OperatorTok{\{}\DataTypeTok{bands}\OperatorTok{:}\NormalTok{ [}\StringTok{'B1'}\OperatorTok{,} \StringTok{'B2'}\OperatorTok{,} \StringTok{'B3'}\NormalTok{]}\OperatorTok{,} \DataTypeTok{min}\OperatorTok{:} \DecValTok{0}\OperatorTok{,} \DataTypeTok{max}\OperatorTok{:} \DecValTok{2000}\OperatorTok{\},} \StringTok{'RGB'}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\begin{tipblock}
En algunas ocasiones, al intentar cargar objetos en la pantalla de
mapas, que sean producto de procesamientos demandantes, la consola puede
mostrar un error indicando que se superó el tiempo de espera o de el
límite de memoria disponible. En estos casos, se sugiere exportar el
resultado, en lugar de tratar de cargarlo en la pantalla de mapas y
después visualizarlo de manera local en algún SIG o software similar
(p.ej., QGIS)

\end{tipblock}

Para el caso de los vectores (\texttt{features}) se puede realizar una
operación similar como:

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{Map}\NormalTok{.}\AttributeTok{addLayer}\NormalTok{(feature}\OperatorTok{,} \OperatorTok{\{}\DataTypeTok{palette}\OperatorTok{:}\NormalTok{ [}\StringTok{'FF0000'}\OperatorTok{,} \StringTok{'FFFF00'}\OperatorTok{,}\StringTok{' 008000'}\NormalTok{]}\OperatorTok{,} \DataTypeTok{min}\OperatorTok{:} \DecValTok{0}\OperatorTok{,} \DataTypeTok{max}\OperatorTok{:} \DecValTok{10}\OperatorTok{\},}
\StringTok{'featuresColored'}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\begin{tipblock}
El código de los colores pasados al argumento de \emph{palette}
corresponden a códigos hexadecimales.

\end{tipblock}

\textbf{Map.centerObject}

Esta función permite centrar la pantalla de mapas en algún objeto.
Además, se puede indicar el zoom con el cual se quiere centrar el
objeto.

\hypertarget{chart}{%
\subsection{Chart}\label{chart}}

La función principal para realizar gráficos es \texttt{ui.Chart}. Esta
función tiene varios algoritmos para realizar diferentes tipos de
gráficos, sin embargo, existen diferentes opciones de gráficos para
distintos tipos de objetos. Los objetos básicos que permite graficar GEE
son: vectores (`\texttt{Feature}), colecciones de vectores
(\texttt{FeatureCollection}), imágenes (\texttt{Image}), colecciones de
imágenes (\texttt{ImageCollection}), arreglos (\texttt{Array}) y listas
(\texttt{List}). Por otro lado, para indicar los colores a utilizar en
el gráfico o el título del mismo se puede utilizar la función
\texttt{setOptions} sobre el objeto de tipo gráfico.

\textbf{Chart.feature}

Este conjunto de funciones permite obtener distintos tipos de gráficos a
partir de un vector o una colección de vectores. Algunas de las
funciones disponibles incluyen: \texttt{ui.Chart.feature.byFeature},
\texttt{ui.Chart.feature.byProperty}, \texttt{ui.Chart.feature.groups} y
\texttt{ui.Chart.feature.histogram}. Por ejemplo:

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{ui}\NormalTok{.}\VariableTok{Chart}\NormalTok{.}\VariableTok{feature}\NormalTok{.}\AttributeTok{byProperty}\NormalTok{(}\OperatorTok{\{}
  \DataTypeTok{feature}\OperatorTok{:}\NormalTok{ colecciónAtributos}\OperatorTok{,} 
  \DataTypeTok{xProperties}\OperatorTok{:} \StringTok{'Clase'}\OperatorTok{,}
\OperatorTok{\}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\textbf{Chart.image}

Este conjunto de funciones permiten obtener distintos tipos de gráficos
a partir de una imagen o colección de imágenes. Algunas de las funciones
que se encuentran disponibles incluyen: \texttt{ui.Chart.image.byClass},
\texttt{ui.Chart.image.byRegion}, \texttt{ui.Chart.image.doySeries},
\texttt{ui.Chart.image.histogram},
\texttt{ui.Chart.image.seriesByRegion}, entre otras.

Por ejemplo, para graficar una serie de tiempo a partir de una colección
de imágenes se utiliza la función
\texttt{ui.Chart.image.seriesByRegion}. Este tipo de gráficos permiten
graficar la serie de tiempo de algunas áreas determinadas utilizando una
colección de imágenes.

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{ui}\NormalTok{.}\VariableTok{Chart}\NormalTok{.}\VariableTok{image}\NormalTok{.}\AttributeTok{seriesByRegion}\NormalTok{(}\OperatorTok{\{}
  \DataTypeTok{imageCollection}\OperatorTok{:}\NormalTok{ colecciónImagenes}\OperatorTok{,} 
  \DataTypeTok{regions}\OperatorTok{:} \VariableTok{areas}\NormalTok{.}\AttributeTok{filter}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Filter}\NormalTok{.}\AttributeTok{eq}\NormalTok{(}\StringTok{'Tipo'}\OperatorTok{,}\StringTok{'Bosque'}\NormalTok{))}\OperatorTok{,}
  \DataTypeTok{reducer}\OperatorTok{:} \VariableTok{ee}\NormalTok{.}\VariableTok{Reducer}\NormalTok{.}\AttributeTok{mean}\NormalTok{()}\OperatorTok{,} 
  \DataTypeTok{band}\OperatorTok{:} \StringTok{'NDVI'}\OperatorTok{,} 
  \DataTypeTok{scale}\OperatorTok{:} \DecValTok{30}\OperatorTok{,} 
  \DataTypeTok{seriesProperty}\OperatorTok{:} \StringTok{'Tipo'}
\OperatorTok{\}}\NormalTok{)}
\NormalTok{  .}\AttributeTok{setOptions}\NormalTok{(}\OperatorTok{\{}
    \DataTypeTok{title}\OperatorTok{:} \StringTok{'Bosque'}\OperatorTok{,}
    \DataTypeTok{colors}\OperatorTok{:}\NormalTok{ [}\StringTok{'#EE3A19'}\NormalTok{]}
  \OperatorTok{\}}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\begin{tipblock}
El nombre de las funciones para generar gráficos en GEE dan una idea del
tipo de gráfica que se puede generar con dicha función y el tipo de
insumos que requiere cada tipo de gráfico.

\end{tipblock}

\hypertarget{export}{%
\subsection{Export}\label{export}}

Una vez que se haya obtenido el resultado de interés en GEE se puede
exportar para ser manejado en otro programa (p.ej., un SIG). Sin
embargo, sólo existen cuatro formatos válidos para exportar desde GEE:
raster, vector, mapa y video.

\textbf{Export.image}

En el caso de las imágenes, la función para exportar
es\texttt{Export.image}. Dentro de GEE hay 3 opciones para exportar los
resultados de una imagen: \texttt{Export.image.toAsset},
\texttt{Export.image.toDrive} o \texttt{Export.image.toCloudStorage}. El
primero permite exportar la imagen como una imagen a la sección de
\textbf{Assets}, es decir, la sección donde el usuario puede subir su
información a GEE. Esta opción es útil para cuando el resultado se va a
utilizar en otro procedimiento de GEE. La segunda opción permite
exportarlo al Google Drive de la cuenta con la que se tiene acceso a
GEE. Esta opción es útil para trabajar con las imágenes en algún entorno
local como algún SIG. La última opción permite exportar la imagen al
Google Cloud Storage para utilizarla en algún otro proceso a realizar en
Google Cloud. La opción que creemos es más común para cualquier usuario
será la de \texttt{Export.image.toDrive}.

Resulta obvio que el primero se va a utilizar para exportar imágenes en
formato raster, sin embargo, no siempre resulta obvio, ya que algunas
veces se pueden convertir imágenes a formato de arreglo (array), tras lo
cual hay que volver a convertir la información a formato de imagen
(Image) para poder exportarla. La aplicación permite exportar únicamente
en formato GTiff o TRFrecord (tensores).

Un ejemplo de cómo exportar una imagen se presenta a continuación.

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{Export}\NormalTok{.}\VariableTok{image}\NormalTok{.}\AttributeTok{toDrive}\NormalTok{(}\OperatorTok{\{}
  \DataTypeTok{image}\OperatorTok{:}\NormalTok{ imgDiff}\OperatorTok{,}
  \DataTypeTok{description}\OperatorTok{:} \StringTok{'DiferenciaNDVI_2016-2017'}\OperatorTok{,}
  \DataTypeTok{scale}\OperatorTok{:} \DecValTok{30}\OperatorTok{,}
  \DataTypeTok{fileFormat}\OperatorTok{:} \StringTok{'GeoTIFF'}\OperatorTok{,}
  \DataTypeTok{folder}\OperatorTok{:} \StringTok{'DiferenciaNDVIL8'}
\OperatorTok{\}}\NormalTok{)}\OperatorTok{;} 
\end{Highlighting}
\end{Shaded}

\begin{tipblock}
En GEE muchas operaciones utilizan el término de scale, sin embargo,
este no se refiere a la escala de trabajo en un sentido tradicional
(p.ej., 1:50 000), sino que se refiere al tamaño de pixel expresado en
m.

\end{tipblock}

\begin{tipblock}
En algunas ocasiones, al intentar exportar una imagen muy grande (mayor
a 10 000 000 de pixeles), la consola puede mostrar un error indicando
que el objeto a exportar tiene un número muy alto de pixeles. En este
caso, se debe aumentar el número de pixeles máximo permitido para la
exportación. Esto se logra indicando el argumento \texttt{maxPixels}
dentro del diccionario que se pasa a Export.image.toDrive. Por ejemplo,
\texttt{maxPixels:\ 1e10}, lo cual permite exportar una imagen con hasta
1 x 10\^{}10 pixeles.

\end{tipblock}

\textbf{Export.table}

Por su parte, el formato vector permite exportar información vector y
tablas sin información geográfica. De nuevo, para poder exportar en el
formato vector, el objeto exportado debe estar en formato vector
(\texttt{feature}). Al igual que en el caso de las imágenes, dentro de
GEE hay 3 opciones para exportar objetos de tipo vector:
\texttt{Export.table.toAsset}, \texttt{Export.table.toDrive} o
\texttt{Export.table.toCloudStorage}. Para el caso de tablas, sin
información geográfica asociada, se debe definir el objeto como un
objeto vector sin geometría (es decir, \texttt{null}) y en la tabla de
atributos anexar la información deseada. Un ejemplo del uso de esta
función se presenta a continuación:

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{Export}\NormalTok{.}\VariableTok{table}\NormalTok{.}\AttributeTok{toDrive}\NormalTok{(}\OperatorTok{\{}
    \DataTypeTok{collection}\OperatorTok{:}\NormalTok{ feature}\OperatorTok{,}
    \DataTypeTok{description}\OperatorTok{:} \StringTok{'nombreArchivo'}\OperatorTok{,}
    \DataTypeTok{folder}\OperatorTok{:} \StringTok{'mifolder'}\OperatorTok{,}
    \DataTypeTok{fileFormat}\OperatorTok{:} \StringTok{'CSV'}
 \OperatorTok{\}}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\textbf{Export.video}

Esta opción permite exportar una colección de imágenes como video ya sea
al almacenamiento de la nube de Google
\texttt{Export.video.toCloudStorage} o al Drive
\texttt{Export.video.toDrive}. Esta función puede resultar atractiva
para observar los cambios de un área de interés, a través del tiempo.
Para exportar una colección de imágenes a video se puede realizar de la
siguiente manera:

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{Export}\NormalTok{.}\VariableTok{video}\NormalTok{.}\AttributeTok{toDrive}\NormalTok{(}\OperatorTok{\{}
    \DataTypeTok{collection}\OperatorTok{:}\NormalTok{ colecciónImgs}\OperatorTok{,}
    \DataTypeTok{description}\OperatorTok{:} \StringTok{'videoTimelapse'}\OperatorTok{,}
    \DataTypeTok{folder}\OperatorTok{:} \StringTok{'mifolder'}\OperatorTok{,}
    \DataTypeTok{framesPerSecond}\OperatorTok{:} \DecValTok{24}
 \OperatorTok{\}}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\newpage

\hypertarget{tipos-de-objetos}{%
\section{Tipos de objetos}\label{tipos-de-objetos}}

\hypertarget{objetos-del-cliente-y-del-servidor}{%
\subsection{Objetos del cliente y del
servidor}\label{objetos-del-cliente-y-del-servidor}}

Existen dos lados de la programación de la API de GEE: el del servidor y
el del cliente. De tal manera, un objeto puede ser convertido entre los
dos tipos. Por ejemplo, mientras que del lado del cliente una cadena de
caracteres puede ser definida simplemente como: \texttt{“cadena”}, para
convertirla en objeto del lado del servidor deben utilizarse las
funciones del servidor, es decir: \texttt{ee.String(“cadena”)}. Muchos
de los algoritmos pre cargados en GEE únicamente corren sobre objetos
del lado del servidor, por lo cual, es recomendable utilizar dicha
sintaxis. Adicionalmente, algunas operaciones se pueden hacer utilizando
ambos tipos de sintaxis. Por ejemplo, una suma se puede realizar del
lado del cliente mediante \texttt{1\ +\ 2}, mientras que del lado del
servidor se utilizaría \texttt{ee.Number(1).add(ee.Number(2))}.

En la mayoría de los casos se va a utilizar la programación del lado del
servidor, ya que es la que permite hacer todo el procesamiento en GEE.
Por ejemplo, para el caso de los condiciones se sugiere utilizar en
lugar de \texttt{if} y \texttt{else}, \texttt{ee.Algorithms.If}. Sin
embargo, cabe aclarar que algunas funciones sólo corren del lado del
cliente. Por ejemplo, las funciones de la interfaz del usuario,
utilizadas para exportar la información a algún archivo (ya sea un
raster, un vector o una tabla) \texttt{ee.Export...}., agregar una capa
a la pantalla del mapa \texttt{Map.addLayer()}o crear gráficos, así como
imprimir información en la consola \texttt{print()}. El siguiente
diagrama permite visualizar el lado del usuario y del servidor en el
funcionamiento de GEE.

\includegraphics[width=500px]{Img/daigFunc}

\hypertarget{tipos-de-objetos-del-lado-del-cliente}{%
\subsection{Tipos de objetos del lado del
cliente}\label{tipos-de-objetos-del-lado-del-cliente}}

\begin{tipblock}
Vamos a utilizar mucho la función \texttt{print()} esta función, permite
visualizar en la \textbf{consola} diversos objetos. Por ejemplo, si se
quiere ver en la consola la palabra \emph{``Hola''} se usa el comando
\texttt{print(\textquotesingle{}Hola\textquotesingle{})}

\end{tipblock}

\textbf{Cadenas de texto}

Se refiere a objetos de cadenas de símbolos de tipo carácter
alfanumérico. Cualquier secuencia de caracteres puede ser un texto.
Estos se definen como cualquier cadena de caracteres que se encuentren
entre un par de comillas bien sean dobles ``'' o sencillas ''. Por
ejemplo; ejercicio 0:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ cadena }\OperatorTok{=}\NormalTok{ “Esto es una cadena de caracteres”}\OperatorTok{;}  \CommentTok{//cadena de texto de solo letras}
\KeywordTok{var}\NormalTok{ telefono}\OperatorTok{=} \StringTok{'1234567890'}\OperatorTok{;}                       \CommentTok{//cadena de texto de solo numeros}
\KeywordTok{var}\NormalTok{ direccion }\OperatorTok{=} \StringTok{'calle cuarta casa # 16'}\OperatorTok{;}         \CommentTok{//cadena de texto de letras, numeros y}
\CommentTok{//simbolos}
\end{Highlighting}
\end{Shaded}

\begin{tipblock}
Resulta importante notar que los números en una cadena de texto no serán
interpretados como valores numéricos sino como texto.

\end{tipblock}

\textbf{Números}

Se refiere a objetos numéricos que indican un valor. Cualquier secuencia
de números puede ser un número. Para números decimales se utiliza el
punto decimal y no la coma decimal. Por ejemplo; ejercicio 1:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ numero }\OperatorTok{=} \DecValTok{1}\OperatorTok{;}     \CommentTok{//numero entero}
\KeywordTok{var}\NormalTok{ numero2 }\OperatorTok{=} \FloatTok{2.5}\OperatorTok{;}  \CommentTok{//numero decimal con punto decimal}
\end{Highlighting}
\end{Shaded}

Nótese que al declarar un objeto como numero no se hace uso de comillas.

\textbf{Listas}

Se refieren a objetos que contienen varias entradas, las cuales pueden
ser numéricas (números), cadenas de texto (texto) o incluso otras
listas. Las listas se definen mediante el uso de corchetes
\texttt{{[}{]}} y cada entrada es separada mediante una coma
(\texttt{,}). Permiten encadenar una serie de valores. Por ejemplo;
ejercicio 2:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ lista }\OperatorTok{=}\NormalTok{ [}\DecValTok{1}\OperatorTok{,} \DecValTok{2}\OperatorTok{,} \DecValTok{3}\OperatorTok{,} \DecValTok{4}\OperatorTok{,} \DecValTok{5}\OperatorTok{,} \DecValTok{6}\OperatorTok{,} \DecValTok{7}\OperatorTok{,} \DecValTok{8}\NormalTok{]}\OperatorTok{;}                 \CommentTok{//lista numerica }
\KeywordTok{var}\NormalTok{ listaA }\OperatorTok{=}\NormalTok{ [“primero”}\OperatorTok{,}\NormalTok{ “segundo”}\OperatorTok{,}\NormalTok{ “tercero”]}\OperatorTok{;}       \CommentTok{//lista de texto}
\KeywordTok{var}\NormalTok{ listaB }\OperatorTok{=}\NormalTok{ [“primero”}\OperatorTok{,}\NormalTok{ “segundo”}\OperatorTok{,}\NormalTok{ “tercero”}\OperatorTok{,} \DecValTok{4}\NormalTok{]}\OperatorTok{;}    \CommentTok{//lista de texo y numeros}
\KeywordTok{var}\NormalTok{ listaC }\OperatorTok{=}\NormalTok{ [lista}\OperatorTok{,}\NormalTok{ listaA}\OperatorTok{,}\NormalTok{ listaB]}\OperatorTok{;}                 \CommentTok{//lista de listas}
\end{Highlighting}
\end{Shaded}

Todas las listas automáticamente asignan, en orden, un número a cada
elemento dentro de ellas, \textbf{siempre empezando desde 0}. Entonces
se puede consultar un solo elemento dentro de una lista, aportando el
número de su posición dentro de ella. Ejercicio 2.1:

\begin{Shaded}
\begin{Highlighting}[]
\AttributeTok{print}\NormalTok{(lista[}\DecValTok{0}\NormalTok{])}\OperatorTok{;}  \CommentTok{//primer objeto de la lista llamada "lista"}
\AttributeTok{print}\NormalTok{(listaA[}\DecValTok{1}\NormalTok{])}\OperatorTok{;} \CommentTok{//segundo objeto de la lista llamada "listaA"}
\AttributeTok{print}\NormalTok{(listaB[}\DecValTok{2}\NormalTok{])}\OperatorTok{;} \CommentTok{//tercer objeto de la lista llamada "listaB"}
\AttributeTok{print}\NormalTok{(listaC)}\OperatorTok{;}    \CommentTok{//lista completa con todos sus elementos}
\end{Highlighting}
\end{Shaded}

\textbf{Diccionarios (Dictionaries)}

Los diccionarios son objetos que contienen claves (objetos o entradas) y
valores asociados a estas claves (definicion del objeto). Los
diccionarios se definen mediante el uso de llaves (\texttt{\{\}}) donde
se define cada clave seguida de dos puntos (\texttt{:}) y la definición
del valor, cadena de caracteres, o lista asociada a esa clave. Para
ingresar varias entradas, éstas deben ir separadas por una coma. Las
claves o entradas siempre seran leídas como cadenas de texto. Se
recomienda que no tengan espacios dentro de ellas, si es nescesario es
mejor usar guión bajo \texttt{\_}. Al hacer \texttt{print()} se
ordenarán alfabeticamente.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ dicc }\OperatorTok{=} \OperatorTok{\{}    \CommentTok{//se declara un nuevo diccionario}
  \DataTypeTok{clave1}\OperatorTok{:} \DecValTok{1}\OperatorTok{,}    \CommentTok{//la primera entrada es el texto "clave1" que esta definido con el valor}
  \CommentTok{//de 1 (tipo numero)  }
  \DataTypeTok{clave2}\OperatorTok{:} \StringTok{"A"}   \CommentTok{//la segunda entrada es el texto "clave2", y su definicion es la letra}
  \CommentTok{//"A" (tipo cadena de texto)}
\OperatorTok{\};}            
\end{Highlighting}
\end{Shaded}

Para consultar los valores dentro de un diccionario se puede hacer
llamando directamente el nombre de la clave deseada dentro de corchetes.
Adicionalmente para los diccionarios se recomienda utilizar la notación
de \texttt{.} seguido del nombre de la clave. la notacion con punto, es
recomendada.Por ejemplo; ejercicio 3.1:

\begin{Shaded}
\begin{Highlighting}[]
\AttributeTok{print}\NormalTok{(dicc[}\StringTok{"clave1"}\NormalTok{])}\OperatorTok{;}  \CommentTok{//notacion de lista, se mostrara en la consola la definicion de }
\CommentTok{//"clave1", es decir el valor 1 }
\AttributeTok{print}\NormalTok{(dicc[}\StringTok{"clave2"}\NormalTok{])}\OperatorTok{;}  \CommentTok{//notacion de lista, se mostrara en la consola la definicion de }
\CommentTok{//"clave2", es decir la letra "A"}

\AttributeTok{print}\NormalTok{(}\VariableTok{dicc}\NormalTok{.}\AttributeTok{clave1}\NormalTok{)}\OperatorTok{;}  \CommentTok{//notacion con punto, se mostrara en la consola la definicion de }
\CommentTok{//"clave1", es decir el valor 1 }
\AttributeTok{print}\NormalTok{(}\VariableTok{dicc}\NormalTok{.}\AttributeTok{clave2}\NormalTok{)}\OperatorTok{;}  \CommentTok{//notacion con punto, se mostrara en la consola la definicion de }
\CommentTok{//"clave2", es decir la letra "A"}
\end{Highlighting}
\end{Shaded}

\textbf{Funciones (Functions)}

las funciones seran revisadas a mayor profundidad después.

Se refieren a objetos que contienen algún proceso que se realizará a
alguna variable. Siempre comienzan con la función \texttt{function}
seguida por el objeto al que se le aplicará la función, este objeto
entre paréntesis, y entre corchetes se coloca el procedimiento que va a
realizar la función. Por último, deben regresar un objeto mediante la
función \texttt{return}. Por ejemplo:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ maskIm }\OperatorTok{=} \KeywordTok{function}\NormalTok{(objeto)}\OperatorTok{\{}              \CommentTok{//maskIm es una nueva función, y su }
\CommentTok{//argumento de entrada es "objeto"}
  \KeywordTok{var}\NormalTok{ image }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{Image}\NormalTok{(objeto)              }\CommentTok{//se define que "objeto" es una imagen }
\CommentTok{//raster, y se guarda en la variable image}
  \KeywordTok{var}\NormalTok{ qaImage }\OperatorTok{=} \VariableTok{image}\NormalTok{.}\AttributeTok{select}\NormalTok{(}\StringTok{'pixel_qa'}\NormalTok{)}\OperatorTok{;}   \CommentTok{//se selecciona solamente la banda de nombre}
\CommentTok{//"pixel_qa" de la imagen image}
  \KeywordTok{var}\NormalTok{ clearData }\OperatorTok{=} \VariableTok{qaImage}\NormalTok{.}\AttributeTok{eq}\NormalTok{(}\DecValTok{322}\NormalTok{)}\OperatorTok{;}          \CommentTok{//se crea una nueva imagen binaria donde }
\CommentTok{//sera 1 los pixeles con valor igual a 322, y 0 los demas}
  \ControlFlowTok{return} \VariableTok{image}\NormalTok{.}\AttributeTok{updateMask}\NormalTok{(clearData)}\OperatorTok{;}       \CommentTok{//se crea una mascara con la imagen binaria,}
\CommentTok{//y se entreda la imagen original enmascarada}
\OperatorTok{\};}
\end{Highlighting}
\end{Shaded}

Aunque las funciones son propiamente objetos del lado del cliente, deben
contener únicamente funciones del lado del servidor para que funcionen
apropiadamente al trabajar en GEE. Esto permite definir cualquier serie
de procesos como una función y que GEE la interprete de manera adecuada
en sus servidores. Esto quedará más claro después de repasar la
siguiente sección.

\begin{tipblock}
Las funciones que se ejecuten sobre una colección de iamgenes o
vectores, sólo funcionan si regresan un objeto de tipo \texttt{Feature},
\texttt{FeatureCollection}, \texttt{Image} o \texttt{ImageCollections},
por lo cual, a veces se deben realizar ciertas conversiones para evitar
un error.

\end{tipblock}

\hypertarget{tipo-de-objetos-del-lado-del-servidor}{%
\subsection{Tipo de objetos del lado del
servidor}\label{tipo-de-objetos-del-lado-del-servidor}}

Estas funciones permiten definir objetos en el lado del servidor o
convertir objetos en el lado del cliente al servidor. También, en
algunos casos los objetos que se obtienen a partir de ciertas funciones
retornan un objeto de tipo indefinido (tipo objeto, \texttt{ee.Object}),
por lo cual, se recomienda convertir dicho objeto al lado del servidor
antes de proseguir con su uso.

\begin{tipblock}
Como resultado de algunas operaciones realizadas en GEE, por ejemplo,
\texttt{first} o \texttt{get}, el objeto resultante no tiene un tipo
definido, por lo cual, resulta necesario meterlo en un contenedor que
indique el tipo de objeto. Este tipo de errores suelen mostrar un
mensaje ``\texttt{...is\ not\ a\ function}''

\end{tipblock}

Por otro lado, toda la información que se encuentra disponible en GEE
corresponderá a objetos del servidor. Por ende, la mayoría de los
métodos disponibles en GEE trabajarán únicamente con objetos del lado
del servidor.

\begin{tipblock}
Para revisar todos los métodos disponibles en GEE clasificados por tipo
de objeto del servidor visitar la sección de \textbf{Client libraries}
en la siguiente liga:
\url{https://developers.google.com/earth-engine/apidocs}. Además, en
esta sección se indican los argumentos que acepta cada función, así como
el tipo de objeto de la salida.

\end{tipblock}

Los objetos del lado del servidor se pueden conceptualizar como
contenedores que le indican al servidor qué tipo de objeto es el que se
está enviando. Además, cuando se trabaja del lado del servidor, los
objetos necesariamente son enviados al servidor para ser evaluados.

\begin{tipblock}
Para recordar cuáles objetos son del servidor, resulta útil recordar que
todos ellos cuentan con el prefijo \texttt{ee} (del servidor de
\textbf{Earth Engine}), seguido del nombre del tipo de objeto con
inicial mayúscula.

\end{tipblock}

\textbf{ee.String()}

Es equivalente a la cadena de texto pero del lado del servidor, ya que
permite enviar un objeto como cadena de caracteres al servidor. Además,
al definir un objeto de este tipo, se puede utilizar cualquier función
indicada bajo la librería de \textbf{ee.String} en la API (ver liga
anterior).

Ejercicio 4:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ cadena2 }\OperatorTok{=} \StringTok{"Esto es una cadena de caracteres"}\OperatorTok{;}           \CommentTok{//esta es una cadena de }
\CommentTok{//texto del lado del cliente}
\KeywordTok{var}\NormalTok{ cadenaServ }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{String}\NormalTok{(cadena2)}\OperatorTok{;}                        \CommentTok{//aca se convierte el texto }
\CommentTok{//del lado del cliente a un ee.String del lado dle servidor}
\AttributeTok{print}\NormalTok{(}\StringTok{"Esto está evaluado en el servidor"}\OperatorTok{,}\NormalTok{ cadenaServ)}\OperatorTok{;}     \CommentTok{//se muestra primero un }
\CommentTok{//texto de cliente, y segundo un ee.String del servidor  }
\end{Highlighting}
\end{Shaded}

\textbf{ee.Number()}

Permite enviar un numero como objeto al servidor. Además, al definir un
objeto de este tipo, se puede utilizar cualquier función indicada bajo
la librería de \textbf{ee.Number()} en la API (ver liga anterior).

Ejercicio 5:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ numServ }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{Number}\NormalTok{(}\DecValTok{1900}\NormalTok{)}\OperatorTok{;}                                    \CommentTok{//se define un numero }
\CommentTok{//como ee.Number del servidor}
\AttributeTok{print}\NormalTok{(}\StringTok{"numero como un objeto ee.Number del servidor"}\OperatorTok{,}\NormalTok{ numServ)}\OperatorTok{;}   \CommentTok{//se muestra primero }
\CommentTok{//un texto de cliente, y segundo el ee.Number del servidor}
\end{Highlighting}
\end{Shaded}

\textbf{ee.List()}

Permite enviar un objeto como lista al servidor. Al definir un objeto de
este tipo, se puede utilizar cualquier función indicada bajo la librería
de \textbf{ee.List} (ver liga anterior).

Ejercicio 6:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ lista }\OperatorTok{=}\NormalTok{ [}\StringTok{'hola'}\OperatorTok{,}\StringTok{'12'}\OperatorTok{,}\StringTok{'5%'}\OperatorTok{,} \VariableTok{ee}\NormalTok{.}\AttributeTok{String}\NormalTok{(}\StringTok{'servidor'}\NormalTok{)}\OperatorTok{,} \VariableTok{ee}\NormalTok{.}\AttributeTok{Number}\NormalTok{(}\DecValTok{64}\NormalTok{)}\OperatorTok{,} \FloatTok{8.32}\NormalTok{]}\OperatorTok{;} \CommentTok{//se }
\CommentTok{//construye una nueva lista con diferentes tipos de objetos del lado del usuario y }
\CommentTok{//servidor}
\KeywordTok{var}\NormalTok{ listaServ }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{List}\NormalTok{(lista)}\OperatorTok{;}                                       \CommentTok{//se define una }
\CommentTok{//lista como ee.List del servidor }

\AttributeTok{print}\NormalTok{(}\StringTok{"Esto está evaluado como una lista del servidor"}\OperatorTok{,}\NormalTok{ listaServ)}\OperatorTok{;}    \CommentTok{//se muestra }
\CommentTok{//primero un texto del cliente, y segundo el ee.List del servidor}
\end{Highlighting}
\end{Shaded}

Para acceder a un elemento de tipo \texttt{ee.List} se utiliza la
función \texttt{get}. Ejercicio 6.1:

\begin{Shaded}
\begin{Highlighting}[]
\AttributeTok{print}\NormalTok{(}\VariableTok{listaServ}\NormalTok{.}\AttributeTok{get}\NormalTok{(}\DecValTok{0}\NormalTok{))}\OperatorTok{;}   \CommentTok{//se llama solamente al primero objeto de la ee.List del }
\CommentTok{//servidor}
\AttributeTok{print}\NormalTok{(}\VariableTok{listaServ}\NormalTok{.}\AttributeTok{get}\NormalTok{(}\DecValTok{1}\NormalTok{))}\OperatorTok{;}   \CommentTok{//se llama solamente al segundo objeto de la ee.List del }
\CommentTok{//servidor}
\end{Highlighting}
\end{Shaded}

\textbf{ee.Dictionary}

Permite enviar un objeto como diccionario al servidor. Además, al
definir un objeto de este tipo, se pueden utilizar cualquier función
indicada bajo la librería de \textbf{ee.Dictionary} al revisar las
librerías disponibles en la API (ver liga anterior).

ejercicio 7

\begin{Shaded}
\begin{Highlighting}[]

\KeywordTok{var}\NormalTok{ dicc }\OperatorTok{=} \OperatorTok{\{}                                                  \CommentTok{//se construye un }
\CommentTok{//diccionario de usuario con diferentes tipos de objetos del lado del usuario y servidor}
  \StringTok{'texto de usuario'}\OperatorTok{:}\StringTok{'usuario'}\OperatorTok{,}
  \StringTok{'string del servidor'}\OperatorTok{:} \VariableTok{ee}\NormalTok{.}\AttributeTok{String}\NormalTok{(}\StringTok{'texto de servidor # 2'}\NormalTok{)}\OperatorTok{,}
  \StringTok{'numero de usuario'}\OperatorTok{:} \DecValTok{4}\OperatorTok{,}
  \StringTok{'numero de servidor'}\OperatorTok{:} \VariableTok{ee}\NormalTok{.}\AttributeTok{Number}\NormalTok{(}\FloatTok{3.1416}\NormalTok{)}\OperatorTok{,}
  \StringTok{'lista de usuario'}\OperatorTok{:}\NormalTok{ [}\DecValTok{1}\OperatorTok{,} \StringTok{'ejemplo'}\NormalTok{]}\OperatorTok{,}
  \StringTok{'lista de servidor'}\OperatorTok{:} \VariableTok{ee}\NormalTok{.}\AttributeTok{List}\NormalTok{([}\VariableTok{ee}\NormalTok{.}\AttributeTok{String}\NormalTok{(}\StringTok{'texto de servidor # 3'}\NormalTok{)}\OperatorTok{,} \VariableTok{ee}\NormalTok{.}\AttributeTok{Number}\NormalTok{(}\FloatTok{1.44}\NormalTok{)])}
\OperatorTok{\};} 

\KeywordTok{var}\NormalTok{ diccServ }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{Dictionary}\NormalTok{(dicc)}\OperatorTok{;}                           \CommentTok{//se define el diccionario}
\CommentTok{//de usuario anterior como ee.Dictionary del servidor }

\AttributeTok{print}\NormalTok{(}\StringTok{"Esto está evaluado como una lista del servidor"}\OperatorTok{,}\NormalTok{ diccServ)}\OperatorTok{;}    \CommentTok{//se muestra }
\CommentTok{//primero un texto del cliente, y segundo el ee.Dictionary del servidor, notese que se }
\CommentTok{//ordenaron las claves alfabeticamente}
\end{Highlighting}
\end{Shaded}

Se puede consultar utilizando también la función \texttt{get} y el
nombre de la clave. ejercicio 7.1

\begin{Shaded}
\begin{Highlighting}[]
\AttributeTok{print}\NormalTok{(}\VariableTok{diccServ}\NormalTok{.}\AttributeTok{get}\NormalTok{(}\StringTok{'lista_de_servidor'}\NormalTok{))}\OperatorTok{;}        \CommentTok{//se muestra el valor que contiene la }
\CommentTok{//clave "lista_de_servidor"}
\AttributeTok{print}\NormalTok{(}\VariableTok{diccServ}\NormalTok{.}\AttributeTok{get}\NormalTok{(}\StringTok{'numero_de_usuario'}\NormalTok{))}\OperatorTok{;}        \CommentTok{//se muestra el valor que contiene el }
\CommentTok{//elemento "numero_de_usuario"}
\end{Highlighting}
\end{Shaded}

Por último, si se desea obtener las claves disponibles en un
\texttt{ee.Dictionary} se utiliza la función \texttt{.keys}. esta
función devuelve una lista. De igual forma, si se desea obtener los
valores disponibles en un \texttt{ee.Dictionary} se utiliza la función
\texttt{.values}. esta función devuelve una lista

\begin{Shaded}
\begin{Highlighting}[]
\AttributeTok{print}\NormalTok{(}\VariableTok{diccServe}\NormalTok{.}\AttributeTok{keys}\NormalTok{())}\OperatorTok{;}    \CommentTok{//muesta una lista con todas las claves del ee.Dictionary}
\AttributeTok{print}\NormalTok{(}\VariableTok{diccServe}\NormalTok{.}\AttributeTok{values}\NormalTok{())}\OperatorTok{;}  \CommentTok{//muestra una lista con todos los valores del ee.Dictionary}
\end{Highlighting}
\end{Shaded}

\textbf{ee.Date}

Este es la forma en la que GEE permite trabajar con fechas. Permite
enviar un objeto como fecha al servidor. Además, al definir un objeto de
este tipo, se puede utilizar cualquier función indicada bajo la librería
de \textbf{ee.Date} (ver liga anterior).

Hay varias formas de construir una fecha especifica:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Se puede usar un texto de usuario indicando la fecha en el
  \textbf{siguiente formato:} ``YYYY-MM-DD'', esta fecha
  \textbf{obligatoriamente} debe:
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Usar la función \texttt{ee.Date()}.
\item
  Estar en orden Año Mes Dia (AAAA-MM-DD).
\item
  Usar guiones como separadores \texttt{-}.
\item
  Tener meses numéricos (01, 02, 03, 04, 05, 06, 07, 08, 09, 10, 11,
  12).
\item
  Tener días de dos digitos (01, 02, 03 \ldots{} 09, 10, 11, \ldots{}
  30).
\item
  Estar entre comillas.
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Se pueden usar números de usuario, en este caso se debe:
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Usar la función \texttt{ee.DatefromYMD()}.
\item
  Ingresar dentro del parentesis el año, el mes y el dia (en ese orden),
  separados por comas.
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  Se puede usar un texto de usuario especificando el formato, para esto
  se debe:
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Especificar el formato de la fecha con la siguiente clave (YYYY=año,
  MM=mes, D=dia).
\item
  Especificar el tipo de separador.
\item
  Especificar el orden en el que se ingresará el texto.
\item
  Especificar la cantidad de digitos esperada para cada item (año, mes y
  dia).
\item
  El formato debe estar entre comillas.
\item
  Luego de especificar el formato, se ingresa \textbf{dentro de
  comillas} el texto a convertir a \texttt{ee.Date} (entre el formato y
  el texto debe ir una coma).
\end{itemize}

ejercicio 8

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ fechaString }\OperatorTok{=} \StringTok{'2001-10'}\OperatorTok{;}                 \CommentTok{//fecha como un texto de cliente}
\KeywordTok{var}\NormalTok{ fecha }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{Date}\NormalTok{(fechaString)}\OperatorTok{;}             \CommentTok{//convierte la fecha de texto de cliente a}
\CommentTok{//ee.Date del servidor}

\KeywordTok{var}\NormalTok{ fecha2 }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Date}\NormalTok{.}\AttributeTok{fromYMD}\NormalTok{(}\DecValTok{2015}\OperatorTok{,}\DecValTok{03}\OperatorTok{,}\DecValTok{28}\NormalTok{)}\OperatorTok{;}     \CommentTok{//crea una ee.Date a partir de definir }
\CommentTok{//año, mes y dia con numeros del cliente}

\KeywordTok{var}\NormalTok{ fecha3 }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Date}\NormalTok{.}\AttributeTok{parse}\NormalTok{(}\StringTok{'DD_YYYY/MMM'}\OperatorTok{,} \StringTok{'14_1827/jul'}\NormalTok{)}\OperatorTok{;} \CommentTok{//crea una fecha a partir de }
\CommentTok{//un formato especificado y un texto que cumple con dicho formato, notese que se }
\CommentTok{//especifica el orden del dia año y mes, se especifica cada separados, y si se usan años}
\CommentTok{//como texto deben ser las 3 primeras iniciales del mes en ingles }

\AttributeTok{print}\NormalTok{(}\StringTok{"Fecha como ee.Date a partir de texto"}\OperatorTok{,}\NormalTok{ fecha)}\OperatorTok{;}            \CommentTok{//se muestra la fecha }
\CommentTok{//como texto de cliente, notese que la fecha se completa automaticamente al primer dia }
\CommentTok{//del mes con hora 00:00:00 }
\AttributeTok{print}\NormalTok{(}\StringTok{"Fecha como ee.Date a partir de numeros indicando el año mes y dia"}\OperatorTok{,}\NormalTok{fecha2)}\OperatorTok{;}      
\CommentTok{//muestra la ee.Date creada con texto del cliente}
\AttributeTok{print}\NormalTok{(}\StringTok{"Fecha como ee.Date a partir de un formato especificado y texto que lo cumple"}\OperatorTok{,}\NormalTok{fecha3)}\OperatorTok{;}   \CommentTok{//muestra la ee.Date creada con numeros que definen año, mes y dia }
\CommentTok{//del cliente}
\end{Highlighting}
\end{Shaded}

\textbf{ee.Image}

Permite leer un objeto \textbf{individual} tipo Raster en el servidor.
Además, al definir un objeto de este tipo, se pueden utilizar cualquier
función indicada bajo la librería de \textbf{ee.Image}. Este va a ser el
tipo de objetos para trabajar con cualquier elemento de tipo raster en
GEE. Más adelante se explican con mayor detalle.

\textbf{ee.ImageCollection}

Al definir un objeto de este tipo, se pueden utilizar cualquier función
indicada bajo la librería de \textbf{ee.ImageCollection}. Las
colecciones de imágenes están formadas por imágenes. Más adelante se
explican con mayor detalle.

\textbf{ee.Feature}

Permite leer un objeto como vector en el servidor. Además, al definir un
objeto de este tipo, se pueden utilizar cualquier función indicada bajo
la librería de \textbf{ee.Feature}. Este va a ser el tipo de objetos
para trabajar con cualquier objeto de tipo vector o tabla. Más adelante
se explican con mayor detalle.

\textbf{ee.FeatureCollection}

Permite enviar un objeto como colección de vectores al servidor. Además,
al definir un objeto de este tipo, se pueden utilizar cualquier función
indicada bajo la librería de \textbf{ee.FeatureCollection}. Las
colecciones de features están formadas por varios vectores. Más adelante
se explican con mayor detalle.

\textbf{ee.Algorithms}

Este tipo de objetos contienen algoritmos precargados en GEE. Estos
algoritmos tienen una gran variedad de aplicaciones, desde operaciones
sencillas como una evaluación lógica, p.ej., \texttt{ee.Algorithms.If},
hasta algoritmos de segmentación temporal de una serie de imágenes,
p.ej., \texttt{ee.Algorithms.TemporalSegmentation.Ccdc}.

\textbf{ee.Array}

Este tipo de objetos corresponden a arreglos multidimensionales. Los
arreglos se pueden interpretar como matrices de más de dos dimensiones
(p.ej., filas y columnas). Su uso más común se da en el análisis de
series de tiempo o con ordenaciones espectrales. Este tipo de objetos
cuentan con una serie de funciones, las cuales se pueden consultar bajo
la librería de \textbf{ee.Array} (ver liga anterior).

\textbf{ee.Classifier}

Este tipo de objetos corresponden a algoritmos de clasificación de datos
que se encuentran pre cargados en GEE. Por ejemplo, se encuentra el
algoritmo de \emph{random forest}, disponible mediante la función
\texttt{ee.Classifier.smileRandomForest} o \emph{MaxEnt}, disponible
mediante la función \texttt{ee.Classifier.amnhMaxent}. entre otros.

\textbf{ee.Clusterer}

Este tipo de objetos corresponden a algoritmos de clasificaicon no
supervisada de datos que se encuentran pre cargados en GEE. Por ejemplo,
se encuentra el algoritmo de \emph{k-means}, disponible mediante la
función \texttt{ee.Clusterer.wekaKMeans} o \emph{Cobweb}, disponible
mediante la función \texttt{ee.Clusterer.wekaCobweb}.

\textbf{ee.Filter}

Este tipo de objetos que normalmente se utilizan para filtrar
colecciones ya sean de vectores o de imágenes. Este tipo de objetos
permiten definir filtros de distintos tipos, ya sean espaciales,
temporales o en función de características de las imágenes o vectores
(p.ej., metadatos). Por otro lado, también contienen funciones para
combinar filtros.

\textbf{ee.Geometry}

Este tipo de objetos corresponden a distintos tipos de geometrías, que
incluyen líneas, polígonos y puntos. Además, en GEE se encuentran varias
funciones pre cargadas que se pueden aplicar a este tipo de objetos,
p.ej., \texttt{ee.Geometry.MultiPolygon.Simplify} para simplificar
polígonos múltiples o calcular el área
\texttt{ee.Geometry.Polygon.area}.

\textbf{ee.Join}

Este conjunto de funciones permite realizar uniones entre colecciones de
vectores, utilizando los campos de éstos como las claves para realizar
las uniones. Por ejemplo, se pueden unir dos colecciones de vectores
mediante \texttt{ee.Join.merge} o unir los campos de una primera
colección con los de una segunda mediante \texttt{ee.Join.inner}

\textbf{ee.Reducer}

Los reductores permite agregar datos basados en una regla o utilizando
una función determinada. Este tipo funciones son las utilizados para
generar, por ejemplo, una sola imagen a partir de varias imágenes que
comparten una misma extensión espacial. El tipo de reductor define el
tipo de agregacion que se aplique, Por ejemplo, se puede reducir con una
sencilla estadística (mínimo, máximo, moda, media, mediana, etc.), o
reductores áas complejos (histogramas, enlistar, regresion líneal).
Tambien pueden reducirse datos con dimensión temporal (colección de
imágenes de diferentes fechas), dimensión espacial, según las bandas de
las imágenes, o incluso segun los atributos de los vectores.

\textbf{ee.Terrain}

Este conjunto de funciones permite calcular algunas operaciones
topográficas, a partir de un modelo digital de elevación (DEM). Por
ejemplo, en GEE se encuentran las funciones \texttt{ee.Terrain.Aspect}
para calcular el aspecto o \texttt{ee.Terrain.slope} para calcular la
pendiente,

\begin{tipblock}
Resulta útil recordar que normalmente los argumentos de cualquier
función del servidor se pasan como un diccionario.

\end{tipblock}

\newpage

\hypertarget{geometruxedas}{%
\section{Geometrías}\label{geometruxedas}}

GEE utiliza el objeto ee.Geometry para leer y manejar formas
geométricas, estos incluyen geometrías sin area, como son:
\textbf{Punto} (\texttt{ee.Geometry.Point}): una coordenada en X \& Y.
\textbf{Multi punto} (\texttt{ee.Geometry.MultiPoint}): una lista de
puntos. \textbf{línea} (\texttt{ee.Geometry.LineString}): una línea.
\textbf{Multi línea} (\texttt{ee.Geometry.MultiLineString}): una lista
de líneas. \textbf{perímetro} (\texttt{ee.Geometry.línearRing}): un
perímetro (una línea cerrada).

Ejercicio X

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ punto }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Point}\NormalTok{(}\OperatorTok{-}\FloatTok{99.14}\OperatorTok{,} \FloatTok{19.47}\NormalTok{)}\OperatorTok{;} \CommentTok{//un punto definido con su coordenada  }

\KeywordTok{var}\NormalTok{ MultiPunto }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{MultiPoint}\NormalTok{([     }\CommentTok{//un Multi Punto }
  \FloatTok{-74.072}\OperatorTok{,} \FloatTok{4.754}\OperatorTok{,}                               \CommentTok{//definidio a partir de una LISTA}
  \FloatTok{-75.545}\OperatorTok{,} \FloatTok{6.285}\OperatorTok{,}                              \CommentTok{//de coordenadas de puntos}
  \FloatTok{-76.533}\OperatorTok{,} \FloatTok{3.461}\OperatorTok{,}
  \FloatTok{-74.819}\OperatorTok{,} \FloatTok{10.997}\OperatorTok{,}
  \FloatTok{-75.501}\OperatorTok{,} \FloatTok{10.393}\NormalTok{])}\OperatorTok{;}

\KeywordTok{var}\NormalTok{ línea }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{LineString}\NormalTok{([  }\CommentTok{//una línea definida a partir}
  \FloatTok{-117.08}\OperatorTok{,} \FloatTok{32.04}\OperatorTok{,}                     \CommentTok{//de una LISTA de}
  \FloatTok{-104.25}\OperatorTok{,} \FloatTok{31.74}\OperatorTok{,}                     \CommentTok{//las cordenadas de sus vertices}
  \FloatTok{-96.69}\OperatorTok{,} \FloatTok{25.58}\OperatorTok{,}
  \FloatTok{-95.99}\OperatorTok{,} \FloatTok{19.74}\OperatorTok{,}
  \FloatTok{-87.2}\OperatorTok{,} \FloatTok{21.39}\OperatorTok{,}
  \FloatTok{-87.2}\OperatorTok{,} \FloatTok{16.91}\OperatorTok{,}
  \FloatTok{-82.28}\OperatorTok{,} \FloatTok{14.88}\OperatorTok{,}
  \FloatTok{-83.15}\OperatorTok{,} \FloatTok{10.07}\OperatorTok{,}
  \FloatTok{-77.35}\OperatorTok{,} \FloatTok{8.86}\OperatorTok{,}
  \FloatTok{-71.55}\OperatorTok{,} \FloatTok{12.66}\NormalTok{])}\OperatorTok{;} 

\KeywordTok{var}\NormalTok{ Multilínea }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{MultiLineString}\NormalTok{([  }\CommentTok{//una Multi línea definida a}
   \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{LineString}\NormalTok{(                      }\CommentTok{//a partir de una LISTA de}
\NormalTok{     [}\OperatorTok{-}\FloatTok{76.017}\OperatorTok{,} \FloatTok{26.173}\OperatorTok{,} \FloatTok{-76.017}\OperatorTok{,} \FloatTok{16.173}\NormalTok{])}\OperatorTok{,}       \CommentTok{//líneas ee.LineString, que a}
  \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{LineString}\NormalTok{(                       }\CommentTok{//su ves estan definidas por una}
\NormalTok{    [}\OperatorTok{-}\FloatTok{73.017}\OperatorTok{,} \FloatTok{26.173}\OperatorTok{,} \FloatTok{-73.017}\OperatorTok{,} \FloatTok{16.173}\NormalTok{])}\OperatorTok{,}        \CommentTok{//lista de las coordenadas de}
  \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{LineString}\NormalTok{(                       }\CommentTok{//sus vertices}
\NormalTok{    [}\OperatorTok{-}\FloatTok{78.434}\OperatorTok{,} \FloatTok{20.926}\OperatorTok{,} \FloatTok{-70.04}\OperatorTok{,} \FloatTok{24.401}\NormalTok{])}\OperatorTok{,}
  \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{LineString}\NormalTok{(}
\NormalTok{    [}\OperatorTok{-}\FloatTok{78.434}\OperatorTok{,} \FloatTok{18.926}\OperatorTok{,} \FloatTok{-70.04}\OperatorTok{,} \FloatTok{22.401}\NormalTok{])])}\OperatorTok{;}

\KeywordTok{var}\NormalTok{ perímetro }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{línearRing}\NormalTok{([  }\CommentTok{//un perímetro definido a partir de}
  \FloatTok{-105.732}\OperatorTok{,} \FloatTok{20.627}\OperatorTok{,}                       \CommentTok{//una LISTA  de las coordenadas de}
  \FloatTok{-109.336}\OperatorTok{,} \FloatTok{26.544}\OperatorTok{,}                       \CommentTok{//los vertices}
  \FloatTok{-113.291}\OperatorTok{,} \FloatTok{31.274}\OperatorTok{,}
  \FloatTok{-114.829}\OperatorTok{,} \FloatTok{31.274}\OperatorTok{,}
  \FloatTok{-109.468}\OperatorTok{,} \FloatTok{23.317}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

tambien hay geometrías que tienen el componente de area, como son:
\textbf{Rectangulo} (\texttt{ee.Geometry.Rectangle}): un rectángulo.
\textbf{polígono} (\texttt{ee.Geometry.Polygon}): un polígono
\textbf{Multi polígono} (\texttt{ee.Geometry.MultiPolygon}): un lista de
polígonos.

Ejercicio X.1

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ rectangulo }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Rectangle}\NormalTok{(  }\CommentTok{//un rectángulo definido por las coordenadas }
\CommentTok{//de los vértices opuestos}
  \FloatTok{-104.12}\OperatorTok{,} \FloatTok{5.73}\OperatorTok{,}
  \FloatTok{-88.21}\OperatorTok{,} \FloatTok{-0.15}\NormalTok{)}\OperatorTok{;} 

\KeywordTok{var}\NormalTok{ polígono }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Polygon}\NormalTok{(  }\CommentTok{//un polígono definido por las coordenadas de }
\CommentTok{//sus vértices}
  \FloatTok{-80.348}\OperatorTok{,} \FloatTok{-3.36}\OperatorTok{,}
  \FloatTok{-80.348}\OperatorTok{,} \FloatTok{-3.36}\OperatorTok{,}
  \FloatTok{-78.985}\OperatorTok{,} \FloatTok{-5.113}\OperatorTok{,}
  \FloatTok{-78.019}\OperatorTok{,} \FloatTok{-3.228}\OperatorTok{,}
  \FloatTok{-75.997}\OperatorTok{,} \FloatTok{-2.394}\OperatorTok{,}
  \FloatTok{-75.25}\OperatorTok{,} \FloatTok{-0.901}\OperatorTok{,}
  \FloatTok{-75.865}\OperatorTok{,} \FloatTok{0.11}\OperatorTok{,}
  \FloatTok{-78.941}\OperatorTok{,} \FloatTok{1.428}\OperatorTok{,}
  \FloatTok{-80.26}\OperatorTok{,} \FloatTok{0.725}\OperatorTok{,}
  \FloatTok{-80.919}\OperatorTok{,} \FloatTok{-1.911}\OperatorTok{,}
  \FloatTok{-79.776}\OperatorTok{,} \FloatTok{-2.614}
\NormalTok{  )}\OperatorTok{;}

\KeywordTok{var}\NormalTok{ Multipolígono }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{MultiPolygon}\NormalTok{(  }\CommentTok{//un multipolígono definido por una }
\CommentTok{//LISTA de polígonos}
\NormalTok{  [}
    \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Polygon}\NormalTok{(                                                        }\CommentTok{//el }
\CommentTok{//primer polígono esta definido a partir de dos permietros }
\NormalTok{      [}\VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{línearRing}\NormalTok{(}\OperatorTok{-}\FloatTok{113.53}\OperatorTok{,} \FloatTok{18.81}\OperatorTok{,} \FloatTok{-101.66}\OperatorTok{,} \FloatTok{10.83}\OperatorTok{,-}\FloatTok{114.93}\OperatorTok{,} \FloatTok{8.93}\NormalTok{)}\OperatorTok{,}    \CommentTok{//el }
\CommentTok{//primer perimitro define el polígono }
      \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{línearRing}\NormalTok{(}\OperatorTok{-}\FloatTok{111.15}\OperatorTok{,} \FloatTok{14.52}\OperatorTok{,} \FloatTok{-113.09}\OperatorTok{,} \FloatTok{11.61}\OperatorTok{,} \FloatTok{-115.72}\OperatorTok{,} \FloatTok{13.58}\NormalTok{)])}\OperatorTok{,} \CommentTok{//el }
\CommentTok{//segundo perímetro define los huecos dentro del polígono}
\NormalTok{    [}\OperatorTok{-}\FloatTok{95.77}\OperatorTok{,} \FloatTok{17.2}\OperatorTok{,}          \CommentTok{//el segundo polígono es una LISTA de coordenadas que forman }
\CommentTok{//un triángulo}
      \FloatTok{-108.7}\OperatorTok{,} \FloatTok{17.8}\OperatorTok{,}
      \FloatTok{-110.0}\OperatorTok{,} \FloatTok{8.32}\NormalTok{]}\OperatorTok{,}
\NormalTok{    [}\OperatorTok{-}\FloatTok{105.6}\OperatorTok{,} \FloatTok{15.5}\OperatorTok{,}          \CommentTok{//el tercer polígono es una LISTA de coordenadas que forman }
\CommentTok{//un triángulo}
      \FloatTok{-105.9}\OperatorTok{,} \FloatTok{14.2}\OperatorTok{,}
      \FloatTok{-103.7}\OperatorTok{,} \FloatTok{13.2}\NormalTok{]}\OperatorTok{,}
\NormalTok{    [}\OperatorTok{-}\FloatTok{94.98}\OperatorTok{,} \FloatTok{14.6}\OperatorTok{,}          \CommentTok{//el cuarto polígono es una LISTA de coordenadas que forman }
\CommentTok{//un triángulo}
      \FloatTok{-95.50}\OperatorTok{,} \FloatTok{13.8}\OperatorTok{,}
      \FloatTok{-93.13}\OperatorTok{,} \FloatTok{11.8}\NormalTok{]}\OperatorTok{,}
\NormalTok{    [}\OperatorTok{-}\FloatTok{84.52}\OperatorTok{,} \FloatTok{7.62}\OperatorTok{,}          \CommentTok{//el quinto polígono es una LISTA de coordenadas que forman }
\CommentTok{//un triángulo}
      \FloatTok{-85.84}\OperatorTok{,} \FloatTok{0.17}\OperatorTok{,}
      \FloatTok{-78.10}\OperatorTok{,} \FloatTok{4.74}\NormalTok{]}\OperatorTok{,}
\NormalTok{    [}\OperatorTok{-}\FloatTok{67.03}\OperatorTok{,} \FloatTok{11.0}\OperatorTok{,}          \CommentTok{//el sexto polígono es una LISTA de coordenadas que forman }
\CommentTok{//un triángulo}
      \FloatTok{-67.64}\OperatorTok{,} \FloatTok{6.49}\OperatorTok{,}
      \FloatTok{-62.11}\OperatorTok{,} \FloatTok{2.63}\NormalTok{]}
\NormalTok{      ])}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\newpage

\hypertarget{vectores-ee.features}{%
\section{Vectores (ee.Features)}\label{vectores-ee.features}}

Los vectores en GEE son los objetos predeterminados para leer
informacion vectorial o de tablas. Un vector estará compuesto por una
geometría (punto, línea, polígono, multipolígono), y los atributos
asociados a esa geometría (estos atributos son llamados propiedades y
estan almacenados en un diccionario).

\hypertarget{creando-vectores-ee.features}{%
\subsection{Creando Vectores
(ee.Features)}\label{creando-vectores-ee.features}}

Para crear un Vector desde cero es necesario definir una geometría y
opcionalmente un diccionario de propiedades (atributos) asociados a esa
geometría. Por ejemplo,

Ejercicio XX:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ polígono }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Polygon}\NormalTok{([ }\CommentTok{//crear un polígono}
  \FloatTok{-119.24}\OperatorTok{,} \FloatTok{32.73}\OperatorTok{,}
  \FloatTok{-115.02}\OperatorTok{,} \FloatTok{-3.29}\OperatorTok{,}
  \FloatTok{-66.5}\OperatorTok{,} \FloatTok{-3.29}\OperatorTok{,}
  \FloatTok{-68.43}\OperatorTok{,} \FloatTok{32.14}
\NormalTok{])}\OperatorTok{;}

\CommentTok{// Crear un vector a partir del polígono y un diccionario de atributos.}
\KeywordTok{var}\NormalTok{ vector }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{Feature}\NormalTok{(}
\NormalTok{  polígono}\OperatorTok{,}                       \CommentTok{//polígono del vector}
  \OperatorTok{\{}\DataTypeTok{año}\OperatorTok{:} \DecValTok{1500}\OperatorTok{,}                     \CommentTok{//diccionario de atributos con 3 atributos}
  \DataTypeTok{tamaño}\OperatorTok{:} \StringTok{'865 kilometros'}\OperatorTok{,}
  \DataTypeTok{nombres}\OperatorTok{:}\NormalTok{[}\StringTok{'hugo'}\OperatorTok{,}\StringTok{'paco'}\OperatorTok{,}\StringTok{'luis'}\NormalTok{]}
  \OperatorTok{\}}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

Además, usando la función \texttt{.set} se pueden modificar los
atributos, o escribir nuevos atributos sobre el vector.

ejercicio xx.1

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ vector1 }\OperatorTok{=} \VariableTok{vector}\NormalTok{.}\AttributeTok{set}\NormalTok{(}\StringTok{'tamaño'}\OperatorTok{,}\StringTok{'neotropico'}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\newpage

\hypertarget{feature-collections}{%
\section{Feature Collections}\label{feature-collections}}

Úna colección de vectores es un grupo de vectores individuales
combinados en un solo conjunto. esto permite ejecutar operaciones sobre
todo el conjunto de vectores.

\begin{tipblock}
Una colección de vectores, puede contener como elementos: vectores,
geometrías, otras colecciones de vectores.

\end{tipblock}

\begin{tipblock}
Una colección de vectores, puede contener un solo vector o una sola
geometría.

\end{tipblock}

ejercicio xxXx

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ colección }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{FeatureCollection}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Point}\NormalTok{(}\FloatTok{16.37}\OperatorTok{,} \FloatTok{48.225}\NormalTok{))}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

ejercicio xxx

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ Punto }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{Feature}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Point}\NormalTok{(}\OperatorTok{-}\FloatTok{99.1362}\OperatorTok{,} \FloatTok{19.4352}\NormalTok{)}\OperatorTok{,}
    \OperatorTok{\{}\DataTypeTok{pais}\OperatorTok{:}\StringTok{'Mexico'}\OperatorTok{,}\DataTypeTok{capital}\OperatorTok{:}\StringTok{'cdmx'}\OperatorTok{\}}\NormalTok{)}\OperatorTok{;}

\KeywordTok{var}\NormalTok{ Multipunto }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{Feature}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{MultiPoint}\NormalTok{([     }
    \FloatTok{-90.496}\OperatorTok{,} \FloatTok{14.605}\OperatorTok{,}                               
    \FloatTok{-88.717}\OperatorTok{,} \FloatTok{17.245}\OperatorTok{,}                              
    \FloatTok{-87.157}\OperatorTok{,} \FloatTok{14.094}\OperatorTok{,}
    \FloatTok{-89.2275}\OperatorTok{,} \FloatTok{13.6937}\OperatorTok{,}
    \FloatTok{-86.273}\OperatorTok{,} \FloatTok{12.115}
    \FloatTok{-84.097}\OperatorTok{,} \FloatTok{9.958}
    \FloatTok{-79.527}\OperatorTok{,} \FloatTok{8.983}\NormalTok{])}\OperatorTok{,}
    \OperatorTok{\{} \DataTypeTok{pais}\OperatorTok{:} 
\NormalTok{      [}\StringTok{'Guatemala'}\OperatorTok{,} 
      \StringTok{'Belice'}\OperatorTok{,} 
      \StringTok{'Honduras'}\OperatorTok{,} 
      \StringTok{'El Salvador'}\OperatorTok{,} 
      \StringTok{'Nicaragua'}\OperatorTok{,} 
      \StringTok{'Costa Rica'}\OperatorTok{,} 
      \StringTok{'Panama'}\NormalTok{]}\OperatorTok{,}
      \DataTypeTok{capital}\OperatorTok{:} 
\NormalTok{      [}\StringTok{'cdad. de Guatemala'}\OperatorTok{,} 
      \StringTok{'Belmopan'}\OperatorTok{,} 
      \StringTok{'Tegucigalpa'}\OperatorTok{,} 
      \StringTok{'San Salvador'}\OperatorTok{,} 
      \StringTok{'Managua'}\OperatorTok{,} 
      \StringTok{'San Jose'}\OperatorTok{,} 
      \StringTok{'cdad. de Panama'}\NormalTok{]}\OperatorTok{\}}\NormalTok{)}\OperatorTok{;}

\KeywordTok{var}\NormalTok{ línea }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{Feature}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{LineString}\NormalTok{([  }\CommentTok{//una línea definida a partir}
  \FloatTok{-66.865}\OperatorTok{,} \FloatTok{10.479}\OperatorTok{,}                     \CommentTok{//de una LISTA de}
  \FloatTok{-74.072}\OperatorTok{,} \FloatTok{4.732}\NormalTok{])}\OperatorTok{,}
    \OperatorTok{\{}\DataTypeTok{pais}\OperatorTok{:} \StringTok{'Venezuela - Colombia'}\OperatorTok{,} \DataTypeTok{capital}\OperatorTok{:} \StringTok{'Caracas - Bogota'}\OperatorTok{\}}\NormalTok{)}\OperatorTok{;} 

\KeywordTok{var}\NormalTok{ Multilínea }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{Feature}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{MultiLineString}\NormalTok{([  }
   \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{LineString}\NormalTok{(                      }
\NormalTok{     [}\OperatorTok{-}\FloatTok{76.803}\OperatorTok{,} \FloatTok{18.021}\OperatorTok{,} \FloatTok{-82.362}\OperatorTok{,} \FloatTok{23.121}\NormalTok{])}\OperatorTok{,}      
  \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{LineString}\NormalTok{(                       }
\NormalTok{    [}\OperatorTok{-}\FloatTok{72.311}\OperatorTok{,} \FloatTok{18.619}\OperatorTok{,} \FloatTok{-69.938}\OperatorTok{,} \FloatTok{18.494}\NormalTok{])}\OperatorTok{,}        
  \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{LineString}\NormalTok{(                       }
\NormalTok{    [}\OperatorTok{-}\FloatTok{66.103}\OperatorTok{,} \FloatTok{18.4597}\OperatorTok{,} \FloatTok{-61.8558}\OperatorTok{,} \FloatTok{17.1315}\NormalTok{])}\OperatorTok{,}
  \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{LineString}\NormalTok{(}
\NormalTok{    [}\OperatorTok{-}\FloatTok{55.165}\OperatorTok{,} \FloatTok{5.861}\OperatorTok{,} \FloatTok{-58.149}\OperatorTok{,} \FloatTok{6.822}\NormalTok{])])}\OperatorTok{,}
    \OperatorTok{\{}\DataTypeTok{pais}\OperatorTok{:}\NormalTok{[}\StringTok{'Jamacia - Cuba'}\OperatorTok{,}
    \StringTok{'Haiti - republica Doinicana'}\OperatorTok{,}
    \StringTok{'Puerto Rico - Antigua y Barbuda'}\OperatorTok{,}
    \StringTok{'Surinam - Guyana'}\NormalTok{]}\OperatorTok{,}
    \DataTypeTok{capital}\OperatorTok{:}\NormalTok{[}\StringTok{'Kingston - La Habana'}\OperatorTok{,}
    \StringTok{'Puerto Principe - Santo Domingo'}\OperatorTok{,}
    \StringTok{'San Juan - saint John'}\OperatorTok{,}
    \StringTok{'Paramaribo - Georgetown'}\NormalTok{]}
    \OperatorTok{\}}\NormalTok{)}\OperatorTok{;}

\KeywordTok{var}\NormalTok{ perímetro }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{Feature}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{línearRing}\NormalTok{([  }
  \FloatTok{-79.354}\OperatorTok{,} \FloatTok{27.32}\OperatorTok{,}
  \FloatTok{-79.332}\OperatorTok{,} \FloatTok{23.661}\OperatorTok{,}
  \FloatTok{-74.19}\OperatorTok{,} \FloatTok{21.161}\OperatorTok{,}
  \FloatTok{-72.235}\OperatorTok{,} \FloatTok{23.165}\OperatorTok{,}
  \FloatTok{-78.039}\OperatorTok{,} \FloatTok{27.859}\NormalTok{])}\OperatorTok{,}
    \OperatorTok{\{}\DataTypeTok{pais}\OperatorTok{:}\StringTok{'Bahamas'}\OperatorTok{,} \DataTypeTok{capital}\OperatorTok{:} \StringTok{'Nasau'}\OperatorTok{\}}\NormalTok{)}\OperatorTok{;}

\KeywordTok{var}\NormalTok{ rectangulo }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{Feature}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Rectangle}\NormalTok{(}
  \FloatTok{-127.97}\OperatorTok{,} \FloatTok{50.25}\OperatorTok{,}
  \FloatTok{-68.2}\OperatorTok{,} \FloatTok{27.63}\NormalTok{)}\OperatorTok{,}
    \OperatorTok{\{}\DataTypeTok{pais}\OperatorTok{:}\StringTok{'eeuu'}\OperatorTok{,} \DataTypeTok{capital}\OperatorTok{:}\StringTok{'Washington'}\OperatorTok{\}}\NormalTok{)}\OperatorTok{;} 

\KeywordTok{var}\NormalTok{ polígono }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{Feature}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Polygon}\NormalTok{(  }
  \FloatTok{-80.348}\OperatorTok{,} \FloatTok{-3.36}\OperatorTok{,}
  \FloatTok{-80.348}\OperatorTok{,} \FloatTok{-3.36}\OperatorTok{,}
  \FloatTok{-78.985}\OperatorTok{,} \FloatTok{-5.113}\OperatorTok{,}
  \FloatTok{-78.019}\OperatorTok{,} \FloatTok{-3.228}\OperatorTok{,}
  \FloatTok{-75.997}\OperatorTok{,} \FloatTok{-2.394}\OperatorTok{,}
  \FloatTok{-75.25}\OperatorTok{,} \FloatTok{-0.901}\OperatorTok{,}
  \FloatTok{-75.865}\OperatorTok{,} \FloatTok{0.11}\OperatorTok{,}
  \FloatTok{-78.941}\OperatorTok{,} \FloatTok{1.428}\OperatorTok{,}
  \FloatTok{-80.26}\OperatorTok{,} \FloatTok{0.725}\OperatorTok{,}
  \FloatTok{-80.919}\OperatorTok{,} \FloatTok{-1.911}\OperatorTok{,}
  \FloatTok{-79.776}\OperatorTok{,} \FloatTok{-2.614}
\NormalTok{  )}\OperatorTok{,\{}\DataTypeTok{pais}\OperatorTok{:}\StringTok{'Ecuador'}\OperatorTok{,} \DataTypeTok{capital}\OperatorTok{:}\StringTok{'Quito'}\OperatorTok{\}}\NormalTok{)}\OperatorTok{;}

\KeywordTok{var}\NormalTok{ Multipolígono }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{Feature}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{MultiPolygon}\NormalTok{(   }
\NormalTok{  [}\VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Polygon}\NormalTok{([}\OperatorTok{-}\FloatTok{61.955}\OperatorTok{,} \FloatTok{10.146}\OperatorTok{,}         
      \FloatTok{-61.713}\OperatorTok{,} \FloatTok{10.967}\OperatorTok{,}
      \FloatTok{-60.593}\OperatorTok{,} \FloatTok{10.881}\OperatorTok{,}
    \FloatTok{-60.68}\OperatorTok{,} \FloatTok{10.081}\NormalTok{])}\OperatorTok{,}
    \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Polygon}\NormalTok{([}\OperatorTok{-}\FloatTok{61.779}\OperatorTok{,} \FloatTok{12.269}\OperatorTok{,}     
      \FloatTok{-61.504}\OperatorTok{,} \FloatTok{12.205}\OperatorTok{,}
      \FloatTok{-61.57}\OperatorTok{,} \FloatTok{11.968}\OperatorTok{,}
      \FloatTok{-61.845}\OperatorTok{,} \FloatTok{12.044}\NormalTok{])}\OperatorTok{,}
    \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Polygon}\NormalTok{([}\OperatorTok{-}\FloatTok{59.703}\OperatorTok{,} \FloatTok{13.042}\OperatorTok{,}         
      \FloatTok{-59.417}\OperatorTok{,} \FloatTok{13.032}\OperatorTok{,}
      \FloatTok{-59.45}\OperatorTok{,} \FloatTok{13.32}\OperatorTok{,}
      \FloatTok{-59.736}\OperatorTok{,} \FloatTok{13.342}\NormalTok{])}\OperatorTok{,}
    \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Polygon}\NormalTok{([}\OperatorTok{-}\FloatTok{61.526}\OperatorTok{,} \FloatTok{15.671}\OperatorTok{,}          
      \FloatTok{-61.087}\OperatorTok{,} \FloatTok{15.512}\OperatorTok{,}
      \FloatTok{-61.274}\OperatorTok{,} \FloatTok{15.194}\OperatorTok{,}
      \FloatTok{-61.438}\OperatorTok{,} \FloatTok{15.279}\NormalTok{])])}\OperatorTok{,}
    \OperatorTok{\{}\DataTypeTok{pais}\OperatorTok{:}\NormalTok{[}\StringTok{'Trinidad y Tobago'}\OperatorTok{,}
    \StringTok{'Granada'}\OperatorTok{,}
    \StringTok{'Barbados'}\OperatorTok{,}
    \StringTok{'Dominica'}\NormalTok{]}\OperatorTok{,}
    \DataTypeTok{capital}\OperatorTok{:}\NormalTok{[}\StringTok{'Puerto España'}\OperatorTok{,}
    \StringTok{'Chantimelle'}\OperatorTok{,}
    \StringTok{'Bridgetown'}\OperatorTok{,}
    \StringTok{'Roseau'}\NormalTok{]}
    \OperatorTok{\}}\NormalTok{)}\OperatorTok{;}


\KeywordTok{var}\NormalTok{ colecciónVectores }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{FeatureCollection}\NormalTok{([ }\CommentTok{//crear una LISTA que incluya todos los }
\CommentTok{//vectores}
\NormalTok{  Multipolígono}\OperatorTok{,}
\NormalTok{  polígono}\OperatorTok{,}
\NormalTok{  rectangulo}\OperatorTok{,}
\NormalTok{  perímetro}\OperatorTok{,}
\NormalTok{  Multilínea}\OperatorTok{,}
\NormalTok{  línea}\OperatorTok{,}
\NormalTok{  Multipunto}\OperatorTok{,}
\NormalTok{  Punto])}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\begin{tipblock}
adicionalmente se pueden crear geometrias directamente dibujando con el
mouse en el mapa, para ello se utilizan las herramientas de la esquina
superior izquierda del panle del mapa:

\includegraphics[width=500px]{Img/geometrias} para crear puntos:

\includegraphics[width=500px]{Img/punto} para crear lineas:

\includegraphics[width=500px]{Img/linea} para crear poligonos:

\includegraphics[width=500px]{Img/poligono} para crear rectangulos:

\includegraphics[width=500px]{Img/rec} todas las geometrias creadas con
estas herrameintas se importaran automaticamente al codigo y se podran
ver sobre las lineas del codigo

\includegraphics[width=500px]{Img/import} estas se les puede cambiar el
nombre dando click en el nombre de la geometria importada

usando la mano se pueden mover y modificar las geometrias
\textbf{DIBUJADAS}

\includegraphics[width=500px]{Img/mano}

todas las geometrias dibujadas se importaran como una sola coleccion,
pero si se quiere tener geometrias separadas en diferentes colecciones
se debe dar click en \texttt{new\ layer}. este meno aparecera cuando se
pase el mouse sobre la pestaña de geometias dibujadas

\includegraphics[width=500px]{Img/nuevaGeo} pasando el moouse sobre cada
una de las geometrias (en la pestana de geometrias dibujadas), se podra
bloquear la capa para evitar modificaciones (con el candado), o cambiar
la su configuracion (en el engranaje)

\includegraphics[width=500px]{Img/dibujarGeo}

al dar click en el engranaje se abrira un menu donde se podra: cambiar
el nombre de la geometria (por default es \emph{geometry}) cambiar el
tipo de geometria (geometria, vector o coleccion de vectores) vector y
coleccion de vectores permiten añadir manualmente propiedades cambiar el
color de la geometria dibujada eliminar la geometria

\includegraphics[width=500px]{Img/menuGeo}

\end{tipblock}

\hypertarget{vectores-de-gee}{%
\subsection{Vectores de GEE}\label{vectores-de-gee}}

GEE ofrece un catálogo de colecciones de vectores, se pueden buscar en
la barra de búsqueda. estas colecciones de vectores de GEE se llaman
\texttt{tables}.

ejercicio Y

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ paises }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{FeatureCollection}\NormalTok{(}\StringTok{'USDOS/LSIB_SIMPLE/2017'}\NormalTok{) }\CommentTok{//en el buscador se busca }
\CommentTok{//una tabla de paises 'countries', y se escribe el ID de la tabla, en este caso es una }
\CommentTok{//colección de vectores del departamento de estado de Estados unidos, que contiene las }
\CommentTok{//divisiones politicas de los paises del mundo  }
\end{Highlighting}
\end{Shaded}

\hypertarget{puntos-aleatorios}{%
\subsection{Puntos Aleatorios}\label{puntos-aleatorios}}

GEE ofrece la herramienta para generar una colección de vectores,
compuesta por puntos aleatorios en una región especificada.

ejercico yy

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{//determiniar una region especifica donde se quiere lanzar puntos aleatorios}
\KeywordTok{var}\NormalTok{ region }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Rectangle}\NormalTok{(}\OperatorTok{-}\FloatTok{61.36}\OperatorTok{,} \FloatTok{31.2}\OperatorTok{,} \FloatTok{-16.54}\OperatorTok{,} \FloatTok{1.93}\NormalTok{)}\OperatorTok{;}

\CommentTok{// crear 1000 puntos aleatorios en la region especificada}
\KeywordTok{var}\NormalTok{ puntos }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{FeatureCollection}\NormalTok{.}\AttributeTok{randomPoints}\NormalTok{(region}\OperatorTok{,}\DecValTok{1000}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\hypertarget{visualizaciuxf3n-de-vectores-y-colecciones-de-vectores}{%
\subsection{Visualización de vectores y colecciones de
vectores}\label{visualizaciuxf3n-de-vectores-y-colecciones-de-vectores}}

Las geometrías, vectores y colección de vectores pueden ser visualizados
en el mapa de GEE. la configuración predeterminada para estos elementos
es verlos con líneas sólidas negras y un relleno semi-opaco gris. Sin
embargo se puede especificar el parametro \texttt{color}, dentro de un
diccionario en la función \texttt{Map.addLayer}, sólo que el color debe
ingresarse como código hexadecimal.

\begin{tipblock}
los cambios de los parametros de vizualizacion de los vectores no pueden
hacerse en las herramientas de capa del mapa \emph{layers}, solo puede
hacerse desde el editor de código. Para consultar el código hexadecimal
del color deseado se puede acceder a la siguiente liga:
\url{https://htmlcolorcodes.com/es/}

\end{tipblock}

ejercico xy

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ ecoregiones }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{FeatureCollection}\NormalTok{(}\StringTok{"RESOLVE/ECOREGIONS/2017"}\NormalTok{)}\OperatorTok{;}

\CommentTok{// especificar el color de la capa }
\VariableTok{Map}\NormalTok{.}\AttributeTok{addLayer}\NormalTok{(ecoregiones}\OperatorTok{,} \OperatorTok{\{\},} \StringTok{'capa p\}por default'}\NormalTok{)}\OperatorTok{;}
\VariableTok{Map}\NormalTok{.}\AttributeTok{addLayer}\NormalTok{(ecoregiones}\OperatorTok{,} \OperatorTok{\{}\DataTypeTok{color}\OperatorTok{:} \StringTok{'2AF116'}\OperatorTok{\},} \StringTok{'capa color verde'}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

Adicionalmente y \textbf{SOLO PARA} colecciones de vectores se pueden
especificar parametros adicionales como tañamo del punto
\texttt{pointRadius} y grosor \texttt{strokeWidth} de la línea. esto se
logra con la función \texttt{ee.FeatureCollection.draw()}

ejercicio xy.1

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{Map}\NormalTok{.}\AttributeTok{addLayer}\NormalTok{(}\VariableTok{ecoregiones}\NormalTok{.}\AttributeTok{draw}\NormalTok{(}\OperatorTok{\{}\DataTypeTok{color}\OperatorTok{:} \StringTok{'2AF116'}\OperatorTok{,} \DataTypeTok{strokeWidth}\OperatorTok{:}\DecValTok{5} \OperatorTok{\}}\NormalTok{)}\OperatorTok{,} \OperatorTok{\{\},} \StringTok{'capa color verde'}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\begin{tipblock}
La función \texttt{draw} convierte la colección de vectores en una
imagen y por eso permite especificar grosor de la línea y de los puntos
(este grosor esta medido en pixeles)

\end{tipblock}

Si uno quiere visualizar solo los contornos de los vectorespuede usar la
siguiente función: ejercicio xy.2

ejercicio xy.2

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ vacia }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{Image}\NormalTok{().}\AttributeTok{byte}\NormalTok{()}\OperatorTok{;}\CommentTok{//crear una imagen vacia}

\KeywordTok{var}\NormalTok{ contornos }\OperatorTok{=} \VariableTok{vacia}\NormalTok{.}\AttributeTok{paint}\NormalTok{(}\OperatorTok{\{}       \CommentTok{//sonbre la imagen vacia, dibujar los bordes de los vectores}
  \DataTypeTok{featureCollection}\OperatorTok{:}\NormalTok{ ecoregiones}\OperatorTok{,}   \CommentTok{//definir los vectores a dibujar}
  \DataTypeTok{color}\OperatorTok{:}\StringTok{'BIOME_NUM'}\OperatorTok{,}                \CommentTok{//definir un atributo de los vectores, para agrupar vectores por color segun ese atributo (puede omitirse)}
  \DataTypeTok{width}\OperatorTok{:} \DecValTok{3}                          \CommentTok{//definir el grosor (si no se especifica este parametro se dibujaran los vectores con color solido)}
\OperatorTok{\}}\NormalTok{)}\OperatorTok{;}

\VariableTok{Map}\NormalTok{.}\AttributeTok{addLayer}\NormalTok{(contornos}\OperatorTok{,} \OperatorTok{\{}\DataTypeTok{palette}\OperatorTok{:} \StringTok{'6e00ff'}\OperatorTok{,} \DataTypeTok{max}\OperatorTok{:} \DecValTok{14}\OperatorTok{\},} \StringTok{'bordes morados'}\NormalTok{)}\OperatorTok{;} \CommentTok{//mostrar la imagen con los vectores dibujados, y especificar la paleta de color (la cual en este caso es de n solo color por lo tanto todos los contornos seran del mismo color)}

\VariableTok{Map}\NormalTok{.}\AttributeTok{addLayer}\NormalTok{(contornos}\OperatorTok{,} \OperatorTok{\{}\DataTypeTok{palette}\OperatorTok{:}\NormalTok{ [}\StringTok{'FF0000'}\OperatorTok{,} \StringTok{'00FF00'}\OperatorTok{,} \StringTok{'0000FF'}\NormalTok{]}\OperatorTok{,} \DataTypeTok{max}\OperatorTok{:} \DecValTok{14}\OperatorTok{\},} \StringTok{'bordes de colores'}\NormalTok{)}\OperatorTok{;} \CommentTok{//mostrar la imagen con los vectores dibujados, y especificar la paleta de color en una lista [rojo, verde, azul], esto permite que los vectores se dibujen de diferentes colores segun el atributo 'color' de la variable 'contorno'}
\end{Highlighting}
\end{Shaded}

\hypertarget{filtrando-una-coleccion-de-vectores-ee.featurecollection}{%
\subsection{filtrando una coleccion de vectores
(ee.FeatureCollection)}\label{filtrando-una-coleccion-de-vectores-ee.featurecollection}}

filtrar una coleccion de vectores permite seleccionar los vectores
deseados. Hay filtros comunes como filtrar por fecha o por localizacion.
perp de todas formas si se necesitan filtros mas avanzados se pueden
configurar.

filtro por localizacion se puede filtrar los vectores usando
\texttt{.filterBounds()} esto permite insertar una \textbf{geometria}, y
todos los vectortes de la coleccion que se intersecten con dicha
geometria seran seleccionados

ejercicio z

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ areasProtegidas }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{FeatureCollection}\NormalTok{(}\StringTok{'WCMC/WDPA/current/polygons'}\NormalTok{)}\OperatorTok{;} \CommentTok{//table dentro de GEE que contiene vectores de areas protegidas globales}

\KeywordTok{var}\NormalTok{ RecCostaRica }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Rectangle}\NormalTok{(}\OperatorTok{-}\FloatTok{86.16}\OperatorTok{,} \FloatTok{11.235}\OperatorTok{,} \FloatTok{-82.601}\OperatorTok{,} \FloatTok{8.073}\NormalTok{)}\OperatorTok{;} \CommentTok{//dibujar una geometria (puede ser cualquier tipo de geometria \}, en este caso escogimos un rectangulo, mas o menos sobre Costa Rica)}

\KeywordTok{var}\NormalTok{ filtro }\OperatorTok{=} \VariableTok{areasProtegidas}\NormalTok{.}\AttributeTok{filterBounds}\NormalTok{(RecCostaRica)}\OperatorTok{;} \CommentTok{//areas protegidas que se intersectan con el rectangulo dibujado}
\end{Highlighting}
\end{Shaded}

filtro por atributos se puede filtrar los vectores usando
\texttt{.filterMetadata()} esto permite filtrar los vectores segun un
\textbf{atributo de los mismos}, y todos los vectortes de la coleccion
que se cumplan con la condicion seran seleccionados. para usar
\texttt{.filterMetadata()} dentro del parentesis se debe indicar
(separado por comas): el nombre \textbf{entre comillas} del atributo a
evaluar, el tipo de comparacion a hacer los valores aceptados son:
``equals'', ``less\_than'', ``greater\_than'', ``not\_equals'',
``not\_less\_than'', ``not\_greater\_than'', ``starts\_with'',
``ends\_with'', ``not\_starts\_with'', ``not\_ends\_with'',
``contains'', ``not\_contains''. y finalmente el valor con el que se
hara la comparacion

ejercicio z.1

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ AreasProCRI }\OperatorTok{=} \VariableTok{areasProtegidas}\NormalTok{.}\AttributeTok{filterMetadata}\NormalTok{(}\StringTok{'ISO3'}\OperatorTok{,}\StringTok{'equals'}\OperatorTok{,}\StringTok{'CRI'}\NormalTok{)}\OperatorTok{;} \CommentTok{//en este caso cada vector de la coleccion de areas protegidas, tiene un atributo llamado 'ISO3', basandonos en ese atributo, vamos a buscar todos los vectores que tengan (para ese atributo) un valor exactamente igual a 'CRI' (abreviacion de Costa Rica) }
\end{Highlighting}
\end{Shaded}

\begin{tipblock}

La funcion para filtrar por fecha \texttt{.filterDate()} solo aplica en
caso que los vectores tengan un atributo llamado
\emph{`system:time\_start'} y en ese atributo se encuentre la fecha en
fomato \emph{`AAAA-MM-DD'}. en caso que los vectores no tengan ese
atributo pero si tengan un atributo de fecha, entonces será nescesario
renombrar dicho atributo de fecha a \emph{`system:time\_start'} para
ello se puede usar la funcion \texttt{.set()} y la funcion
\texttt{.map()} (la funcion \texttt{.map()} se explicara mejor luego)

ejercicio z.2

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ Areasfecha }\OperatorTok{=} \VariableTok{AreasProCRI}\NormalTok{.}\AttributeTok{map}\NormalTok{( }\KeywordTok{function}\NormalTok{(vector)}\OperatorTok{\{} \CommentTok{//map es un afuncion que nos permite ejecturar una operacion sobre todos los vectores de la coleccion}
  \KeywordTok{var}\NormalTok{ fecha }\OperatorTok{=} \VariableTok{vector}\NormalTok{.}\AttributeTok{get}\NormalTok{(}\StringTok{'STATUS_YR'}\NormalTok{)}\OperatorTok{;} \CommentTok{//fecha extrae el valor del atributo 'STATUS_YEAR'}
  \ControlFlowTok{return} \VariableTok{vector}\NormalTok{.}\AttributeTok{set}\NormalTok{(}\StringTok{'system:time_start'}\OperatorTok{,}\NormalTok{fecha)}\OperatorTok{\}}\NormalTok{)}\OperatorTok{;} \CommentTok{//cada vector se entrega con una nueva propiedad 'system:time_start' que tiene fecha}

\KeywordTok{var}\NormalTok{ filtroFechas }\OperatorTok{=} \VariableTok{Areasfecha}\NormalTok{.}\AttributeTok{filterDate}\NormalTok{(}\DecValTok{2020}\OperatorTok{,}\DecValTok{2021}\NormalTok{)}\OperatorTok{;} \CommentTok{//ahora ya se puede aplicar el filtro de fecha filtrando solo las areas protegidas de Costa Rica declaradas en el año 2020 }
\end{Highlighting}
\end{Shaded}


\end{tipblock}

finalmente estan los filtros compuestos. estos filtros usan los filtros
diponibles bajo la librería de \textbf{ee.Filter}

en el ejercicio z.3 se mostrara solo un ejemplo de este filtro, para
filtrar vectores que cumplan con todas las condiciones

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ areasProMar }\OperatorTok{=} \VariableTok{areasProtegidas}\NormalTok{.}\AttributeTok{filter}\NormalTok{( }\CommentTok{//se delcara que se ejecutara un filtro compuesto}
    \VariableTok{ee}\NormalTok{.}\VariableTok{Filter}\NormalTok{.}\AttributeTok{and}\NormalTok{(  }\CommentTok{// se crea un filtro compuesto en donde se debne cumplir las siguintes condiciones}
      \VariableTok{ee}\NormalTok{.}\VariableTok{Filter}\NormalTok{.}\AttributeTok{gte}\NormalTok{(}\StringTok{'MARINE'}\OperatorTok{,}\DecValTok{1}\NormalTok{)}\OperatorTok{,} \CommentTok{//un filtro donde se filtran los vectores que en el atributo marino tengan un valor de 1 o mas (areas protegidas con territorio marino)}
      \VariableTok{ee}\NormalTok{.}\VariableTok{Filter}\NormalTok{.}\AttributeTok{stringContains}\NormalTok{(}\StringTok{'NAME'}\OperatorTok{,} \StringTok{'Manglar'}\NormalTok{)}\OperatorTok{,}\CommentTok{//se filtran las areas protegidas que en su nombre contengan la palabra manglar}
      \VariableTok{ee}\NormalTok{.}\VariableTok{Filter}\NormalTok{.}\AttributeTok{rangeContains}\NormalTok{(}\StringTok{'GIS_M_AREA'}\OperatorTok{,} \DecValTok{10}\OperatorTok{,}\DecValTok{100}\NormalTok{)))}\OperatorTok{;} \CommentTok{//se filtran las areas que tengan un area marina protegida de entre 50 y 100 km2}
\end{Highlighting}
\end{Shaded}

\hypertarget{ejecutar-loops-mapping}{%
\subsection{ejecutar Loops (Mapping)}\label{ejecutar-loops-mapping}}

se pueden ejecutar operaciones dentro de una coleccion de vectores, que
se ejecuten para cada vector de la coleccion. para aplicar una operacion
en todos los vectores de una coleccion se usa la funcion \texttt{.map()}

para poder ejecutar la funcion \texttt{.map()} es necesario antes
definir una funcion (del usuario)

para definir una funcion es necesario tener en cuenta varias coas: -usar
el comando \textbf{function} -luego de \textbf{function} y dentro de
parentesis () definir un nombre cualquiera, que representara el objeto
de entrada de la funcion (insumo) -luego definir un diccionario dentro
del cual se especifiquen los procedimientos a realizar sobre el insumo
-finalmente antes de cerrar el diccionario especificar el producto de
salida (resultado de la funcion) usando el comando \textbf{return}

ejercicio P

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ paises }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{FeatureCollection}\NormalTok{(}\StringTok{"USDOS/LSIB/2017"}\NormalTok{)}\OperatorTok{;} \CommentTok{//se llama una tabla de GEE con coleccion de vectores de paises }

\KeywordTok{var}\NormalTok{ peru }\OperatorTok{=} \VariableTok{paises}\NormalTok{.}\AttributeTok{filterMetadata}\NormalTok{(}\StringTok{'COUNTRY_NA'}\OperatorTok{,}\StringTok{'equals'}\OperatorTok{,}\StringTok{'Peru'}\NormalTok{)}\OperatorTok{;} \CommentTok{//se hace un filtro para seleccionar solo a Peru }

\KeywordTok{var}\NormalTok{ puntos }\OperatorTok{=}\VariableTok{ee}\NormalTok{.}\VariableTok{FeatureCollection}\NormalTok{.}\AttributeTok{randomPoints}\NormalTok{(peru}\OperatorTok{,} \DecValTok{100}\NormalTok{).}\AttributeTok{randomColumn}\NormalTok{(}\StringTok{'aleatorio'}\NormalTok{)}\OperatorTok{;} \CommentTok{//creamos una coleccion de vectores de 100 puntos aleatorios en peru, y usando la funcion .randomColumn le asignamos un valor aleatorio (entre 0-1) a cada punto de la coleccion  }

\KeywordTok{var}\NormalTok{ bufferAleatorio }\OperatorTok{=} \KeywordTok{function}\NormalTok{(punto)}\OperatorTok{\{}   \CommentTok{// definimos una funcion llamada buffer cuyo insumo de entrada es un objeto que llamamos 'punto'}
  \KeywordTok{var}\NormalTok{ numero }\OperatorTok{=} \VariableTok{punto}\NormalTok{.}\AttributeTok{get}\NormalTok{(}\StringTok{'aleatorio'}\NormalTok{)}\OperatorTok{;} \CommentTok{//aca si tomamos el objeto de entrada 'vector' y le extraemos el valor del atributo 'aleatorio´' (que es un numero del usuario)}
  \KeywordTok{var}\NormalTok{ NumServidor }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{Number}\NormalTok{(numero)}\OperatorTok{;} \CommentTok{//convertimos el numero de usuario en un ee.Number del servidor}
  \KeywordTok{var}\NormalTok{ multiplicar }\OperatorTok{=} \VariableTok{NumServidor}\NormalTok{.}\AttributeTok{multiply}\NormalTok{(}\DecValTok{100000}\NormalTok{)}\OperatorTok{;} \CommentTok{//multiplicamos dicho numero por 100000}
  \KeywordTok{var}\NormalTok{ redondear }\OperatorTok{=} \VariableTok{multiplicar}\NormalTok{.}\AttributeTok{ceil}\NormalTok{()}\OperatorTok{;} \CommentTok{//aproximamos el resultado de la multiplicacion al numero entero mas cercano (igual o mayor)}
  \KeywordTok{var}\NormalTok{ area }\OperatorTok{=} \VariableTok{punto}\NormalTok{.}\AttributeTok{buffer}\NormalTok{(redondear)}\OperatorTok{;} \CommentTok{//ejecutamos la funcion .buffer para el objeto llamado 'vector' y el tamaño esta determinado por el numero en 'redondear'}
  \KeywordTok{var}\NormalTok{ tamaño }\OperatorTok{=} \VariableTok{area}\NormalTok{.}\AttributeTok{set}\NormalTok{(}\StringTok{'radio del buffer'}\OperatorTok{,}\NormalTok{redondear)}\OperatorTok{;} \CommentTok{//le añadimos un atributo en donde especificamos el tamaño del radio del buffer en metros}
  \KeywordTok{var}\NormalTok{ circulo }\OperatorTok{=} \VariableTok{tamaño}\NormalTok{.}\AttributeTok{set}\NormalTok{(}\StringTok{'area'}\OperatorTok{,}\VariableTok{tamaño}\NormalTok{.}\AttributeTok{area}\NormalTok{())}\OperatorTok{;} \CommentTok{//le añadimos otro ar\}tributo llamado 'area' el cual, esta definido calculando el area (con la funcion.area) en metros cuadrados del buffer }
  \ControlFlowTok{return}\NormalTok{ circulo}\OperatorTok{;} \CommentTok{//el resultado de la funcion es entonces el objeto circulo que es un vector poligonal}
\OperatorTok{\};}

\KeywordTok{var}\NormalTok{ circulos }\OperatorTok{=} \VariableTok{puntos}\NormalTok{.}\AttributeTok{map}\NormalTok{(bufferAleatorio)}\OperatorTok{;} \CommentTok{//ejecutamos la funcion 'bufferAleatorio' sobre todos los vectores de la coleccion, cada punto de la coleccion entonces entrara como insumo de la funcion bufferAleatorio}
\end{Highlighting}
\end{Shaded}

\#\#Informacion y metadatos

los vectores y a su vez las colecciones de vectores, contienen
informacion y metadatos los cuales pueden ser consultados con la funcion
\texttt{print} y ser utiles para los usuarios

\begin{tipblock}

al usar \texttt{print} con las colecciones de vectores, la consola tiene
un limite de mostrar maximo 5000 vectores. en caso que uno neceite usar
\texttt{print} wn una coleccion de mas de 5000 vectores, será necesario
filtrar la coleccion previamente. otra opcion es limitar la cantidad de
vectores que se vayan a mostrar en la \textbf{consola}. Para ello se
puede usar la funcion \texttt{.limit()} la cual se le especifica la
cantidad de vectores que queremos ver (siempre que sean \textless= 5000)

ejercicio o

\begin{Shaded}
\begin{Highlighting}[]

\KeywordTok{var}\NormalTok{ cuencas }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{FeatureCollection}\NormalTok{(}\StringTok{"WWF/HydroSHEDS/v1/Basins/hybas_12"}\NormalTok{)}\OperatorTok{;} \CommentTok{//llamamos uuna capa de cuencas de alta resolucion de GEE}

\CommentTok{// }

\AttributeTok{print}\NormalTok{(}\VariableTok{cuencas}\NormalTok{.}\AttributeTok{size}\NormalTok{())}\OperatorTok{;}  \CommentTok{//cantidad de vectores en la coleccion (1034083)}

\AttributeTok{print}\NormalTok{(cuencas)}\OperatorTok{;} \CommentTok{//este comando resultara en un error, porque excede los 5000 vectores}

\AttributeTok{print}\NormalTok{(}\VariableTok{cuencas}\NormalTok{.}\AttributeTok{limit}\NormalTok{(}\DecValTok{50}\NormalTok{))}\OperatorTok{;} \CommentTok{//solo vamos a mostrar los primero 50 vectores}

\VariableTok{Map}\NormalTok{.}\AttributeTok{addLayer}\NormalTok{(cuencas}\OperatorTok{,\{\},}\StringTok{'todas las cuencas'}\NormalTok{)}\OperatorTok{;} \CommentTok{//esta capa contiene todos los vectores 1034083. notese que en el mapa si se pueden proyectar mas de 5000 vectores, notese tambien que cargar esta capa es un poco lento y pesado}

\VariableTok{Map}\NormalTok{.}\AttributeTok{addLayer}\NormalTok{(}\VariableTok{cuencas}\NormalTok{.}\AttributeTok{limit}\NormalTok{(}\DecValTok{1000}\NormalTok{)}\OperatorTok{,\{}\DataTypeTok{color}\OperatorTok{:}\StringTok{'00ff00'}\OperatorTok{\},}\StringTok{'1000 cuencas filtradas'}\NormalTok{)}\OperatorTok{;} \CommentTok{//esta capa solo contiene las primeras 1000 cuencas, y carga mucho mas rapido (NorOccidente de Africa)}
\end{Highlighting}
\end{Shaded}


\end{tipblock}

ejemplos para la extraccion de informacion de vectores

ejercicio L

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ CUENCAS_MUNDIAL }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{FeatureCollection}\NormalTok{(}\StringTok{"WWF/HydroSHEDS/v1/Basins/hybas_12"}\NormalTok{)}\OperatorTok{;} \CommentTok{//llamamos uuna capa de cuencas de alta resolucion de GEE}

\KeywordTok{var}\NormalTok{ cuenca }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{Feature}\NormalTok{(}\VariableTok{CUENCAS_MUNDIAL}\NormalTok{.}\AttributeTok{first}\NormalTok{())}\OperatorTok{;} \CommentTok{//filtramos la coleccion solo al primer vector, l\}y lo convertimos de una coleccion de un solo elemanto (ee.FeatureCollection) a un vector independiente (ee.Feature)}

\AttributeTok{print}\NormalTok{(}\StringTok{'toda la informacion del vector'}\OperatorTok{,}\NormalTok{cuenca)}\OperatorTok{;} \CommentTok{//mostramos toda la informacion del vector}

\AttributeTok{print}\NormalTok{(}\StringTok{'nombres de los atributos del vector'}\OperatorTok{,}\VariableTok{cuenca}\NormalTok{.}\AttributeTok{propertyNames}\NormalTok{())}\OperatorTok{;} \CommentTok{//generamos una lista con los nombres de los atributos del vector}

\AttributeTok{print}\NormalTok{(}\StringTok{'dicionario de atributos de la cuenca'}\OperatorTok{,}\VariableTok{cuenca}\NormalTok{.}\AttributeTok{toDictionary}\NormalTok{())}\OperatorTok{;} \CommentTok{// generamos un diccionario con todos los atributos y sus valores del vector}

\AttributeTok{print}\NormalTok{(}\StringTok{'tiene costa maritima 1=si 0=no'} \OperatorTok{,}\VariableTok{cuenca}\NormalTok{.}\AttributeTok{get}\NormalTok{(}\StringTok{'COAST'}\NormalTok{))}\OperatorTok{;} \CommentTok{// extraemos el valor de un atributo}

\AttributeTok{print}\NormalTok{(}\StringTok{'vector solo con atributos seleccionados'}\OperatorTok{,}\VariableTok{cuenca}\NormalTok{.}\AttributeTok{select}\NormalTok{([}\StringTok{'COAST'}\NormalTok{]}\OperatorTok{,}\NormalTok{[}\StringTok{'costa maritima'}\NormalTok{]))}\OperatorTok{;} \CommentTok{//seleccionamos solo un atributo y lo renombramos}

\AttributeTok{print}\NormalTok{(}\StringTok{'perimetro'}\OperatorTok{,}\VariableTok{cuenca}\NormalTok{.}\AttributeTok{perimeter}\NormalTok{())}\OperatorTok{;} \CommentTok{//calculamos el perimetro del vector}

\AttributeTok{print}\NormalTok{(}\StringTok{'area'}\OperatorTok{,}\VariableTok{cuenca}\NormalTok{.}\AttributeTok{area}\NormalTok{())}\OperatorTok{;} \CommentTok{//calculamos el area del vector}

\CommentTok{//}

\VariableTok{Map}\NormalTok{.}\AttributeTok{setCenter}\NormalTok{(}\OperatorTok{-}\FloatTok{14.7777}\OperatorTok{,} \FloatTok{24.1173}\OperatorTok{,} \DecValTok{11}\NormalTok{)}\OperatorTok{;}  \CommentTok{//centramos el mapa en las coordenadas especificadas, y con el zoom indicado}

\VariableTok{Map}\NormalTok{.}\AttributeTok{addLayer}\NormalTok{(cuenca}\OperatorTok{,\{}\DataTypeTok{color}\OperatorTok{:}\StringTok{'000000'}\OperatorTok{,\},}\StringTok{'cuenca'}\NormalTok{)}\OperatorTok{;} \CommentTok{//mostramos la cuenca}

\VariableTok{Map}\NormalTok{.}\AttributeTok{addLayer}\NormalTok{(}\VariableTok{cuenca}\NormalTok{.}\AttributeTok{bounds}\NormalTok{()}\OperatorTok{,\{}\DataTypeTok{color}\OperatorTok{:}\StringTok{'ff00ff'}\OperatorTok{\},}\StringTok{'recuadro de extension'}\NormalTok{)}\OperatorTok{;} \CommentTok{//mostramos el recuadro que abarca todo el vector}

\VariableTok{Map}\NormalTok{.}\AttributeTok{addLayer}\NormalTok{(}\VariableTok{cuenca}\NormalTok{.}\AttributeTok{convexHull}\NormalTok{()}\OperatorTok{,\{}\DataTypeTok{color}\OperatorTok{:}\StringTok{'ffff00'}\OperatorTok{\},}\StringTok{'poligono minimo convexo'}\NormalTok{)}\OperatorTok{;} \CommentTok{// mostramos el poligono minimo convexco de la cuenca}

\VariableTok{Map}\NormalTok{.}\AttributeTok{addLayer}\NormalTok{(}\VariableTok{cuenca}\NormalTok{.}\AttributeTok{simplify}\NormalTok{(}\DecValTok{2000}\NormalTok{)}\OperatorTok{,\{}\DataTypeTok{color}\OperatorTok{:}\StringTok{'FFffff'}\OperatorTok{\},}\StringTok{'cuenca simplificada'}\NormalTok{)}\OperatorTok{;} \CommentTok{//simplificamos el vector a una figura con menos vertices}

\VariableTok{Map}\NormalTok{.}\AttributeTok{addLayer}\NormalTok{(}\VariableTok{cuenca}\NormalTok{.}\AttributeTok{centroid}\NormalTok{()}\OperatorTok{,\{}\DataTypeTok{color}\OperatorTok{:}\StringTok{'00FF00'}\OperatorTok{\},}\StringTok{'centroide'}\NormalTok{)}\OperatorTok{;} \CommentTok{//mostramos el centroide del vector}
\end{Highlighting}
\end{Shaded}

Para las colecciones de vectores se puede tambien extraer los metadatos
(\textbf{los metadatos de la coleccion no son los mismos de los vectores
que la conforman})

ejercicio L.1

\begin{Shaded}
\begin{Highlighting}[]
\AttributeTok{print}\NormalTok{(}\StringTok{'nombres de los metadatos de la coleccion de vectores'}\OperatorTok{,}\VariableTok{CUENCAS_MUNDIAL}\NormalTok{.}\AttributeTok{propertyNames}\NormalTok{())}\OperatorTok{;} \CommentTok{//se muestran los metadatos de la coleccion de vectores}

\AttributeTok{print}\NormalTok{(}\StringTok{'ID de la coleccion'}\OperatorTok{,} \VariableTok{CUENCAS_MUNDIAL}\NormalTok{.}\AttributeTok{get}\NormalTok{(}\StringTok{'system:id'}\NormalTok{))}\OperatorTok{;} \CommentTok{//mostrar un metadato de la coleccion de vectores}
\end{Highlighting}
\end{Shaded}

adicionalmente en las colecciones de vectores se puede resumir la
informacion segun los atributos de sus vectores

ejercicio L.2

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ canaria }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Rectangle}\NormalTok{(}\OperatorTok{-}\FloatTok{18.89}\OperatorTok{,}\FloatTok{27.46}\OperatorTok{,} \FloatTok{-13.26}\OperatorTok{,}\FloatTok{29.93}\NormalTok{)}\OperatorTok{;} \CommentTok{// rectangulo que abarca las islas canarias}

\AttributeTok{print}\NormalTok{(}\StringTok{'ID cuencas islas canarias'}\OperatorTok{,}\VariableTok{CUENCAS_MUNDIAL}\NormalTok{.}\AttributeTok{filterBounds}\NormalTok{(canaria).}\AttributeTok{aggregate_array}\NormalTok{(}\StringTok{'HYBAS_ID'}\NormalTok{))}\OperatorTok{;} \CommentTok{// arroja un alsita con todos los ID de las cuencas de esta zona}
\AttributeTok{print}\NormalTok{(}\StringTok{'area subsuperficial promedio de las cuencas islas canarias'}\OperatorTok{,}\VariableTok{CUENCAS_MUNDIAL}\NormalTok{.}\AttributeTok{filterBounds}\NormalTok{(canaria).}\AttributeTok{aggregate_mean}\NormalTok{(}\StringTok{'SUB_AREA'}\NormalTok{))}\OperatorTok{;} \CommentTok{// arroja el dato del area subsuperficial promedio de las cuencas de esta zona}
\AttributeTok{print}\NormalTok{(}\StringTok{'frecuencias de cuencas islas canarias con o sin costa'}\OperatorTok{,}\VariableTok{CUENCAS_MUNDIAL}\NormalTok{.}\AttributeTok{filterBounds}\NormalTok{(canaria).}\AttributeTok{aggregate_histogram}\NormalTok{(}\StringTok{'COAST'}\NormalTok{))}\OperatorTok{;} \CommentTok{// arroja el dato de frecuencias de cada uno de los posibles valores de COAST (1=si tiene costa, 0 =no tiene costa)}
\AttributeTok{print}\NormalTok{(}\StringTok{'estadisticas descriptivas del area superficial de las cuencas islas canarias'}\OperatorTok{,}\VariableTok{CUENCAS_MUNDIAL}\NormalTok{.}\AttributeTok{filterBounds}\NormalTok{(canaria).}\AttributeTok{aggregate_stats}\NormalTok{(}\StringTok{'UP_AREA'}\NormalTok{))}\OperatorTok{;} \CommentTok{// arroja las estatisticas descriptivas del area supercicial de las cuencas de la zona}
\end{Highlighting}
\end{Shaded}

\#\#reducir una coleccion de vectores

las colecciones tambien permiten agregar atributos de sus vectores en
los metadatos de la coleccion, esta agregacion se llama Reducir

los reductores de atributos, tomaran el valor del atributo de todos los
vectores y los convertiran en un solo valor para toda la coleccion
(depende el usuario, escoger prmedio, minimo,maximo, mediana, etc).
estos reductores entragaran como resultado un diccionario

ejercicio m

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{// importar una capa de cuencas}
\KeywordTok{var}\NormalTok{ cuencasHawaii }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{FeatureCollection}\NormalTok{(}\StringTok{'USGS/WBD/2017/HUC06'}\NormalTok{)}
\NormalTok{  .}\AttributeTok{filterBounds}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Rectangle}\NormalTok{(}\OperatorTok{-}\FloatTok{160.969}\OperatorTok{,} \FloatTok{23.104}\OperatorTok{,} \FloatTok{-154.136}\OperatorTok{,} \FloatTok{18.733}\NormalTok{))}\OperatorTok{;}

\CommentTok{// definir una funcion que ejecute la diferencia entre el area reportada en el atributo vector y la calculada en GEE}
\KeywordTok{var}\NormalTok{ areaDife }\OperatorTok{=} \KeywordTok{function}\NormalTok{(cuenca) }\OperatorTok{\{}
  \CommentTok{// calcular el area de la cuenca en km2 (por default area siempre se calcula en m2)}
  \KeywordTok{var}\NormalTok{ area }\OperatorTok{=} \VariableTok{cuenca}\NormalTok{.}\AttributeTok{area}\NormalTok{().}\AttributeTok{divide}\NormalTok{(}\DecValTok{1000000}\NormalTok{)}\OperatorTok{;}
  \CommentTok{// calcular la diferencie de areas, para ello se extrae del vector el valor del atributo 'areasqkm', y lo convertimos en un ee.Number}
  \KeywordTok{var}\NormalTok{ dife }\OperatorTok{=} \VariableTok{area}\NormalTok{.}\AttributeTok{subtract}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Number}\NormalTok{.}\AttributeTok{parse}\NormalTok{(}\VariableTok{cuenca}\NormalTok{.}\AttributeTok{get}\NormalTok{(}\StringTok{'areasqkm'}\NormalTok{)))}\OperatorTok{;}
  \CommentTok{// el resultado es añadir un nuevo atributo 'diferencia' que contenga el valor calculado elevado al cuadrado. (esto para calcular el error cuadratico medio)}
  \ControlFlowTok{return} \VariableTok{cuenca}\NormalTok{.}\AttributeTok{set}\NormalTok{(}\StringTok{'diferencia'}\OperatorTok{,} \VariableTok{dife}\NormalTok{.}\AttributeTok{pow}\NormalTok{(}\DecValTok{2}\NormalTok{))}\OperatorTok{;}
\OperatorTok{\};}

\CommentTok{// calcular el error cuadratico medio de toda la coleccion.}
\KeywordTok{var}\NormalTok{ RECM }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{Number}\NormalTok{(}
  \CommentTok{// ejecutar la funcion 'areaDife' para todos los vectores de la coleccion}
  \VariableTok{cuencasHawaii}\NormalTok{.}\AttributeTok{map}\NormalTok{(areaDife)}
  \CommentTok{// agregar el atributo de 'diferencia' que contiene el error cuadratico medio de cada vector, para obtener el error cuadratico medio promedio de toda la coleccion}
\NormalTok{  .}\AttributeTok{reduceColumns}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Reducer}\NormalTok{.}\AttributeTok{mean}\NormalTok{()}\OperatorTok{,}\NormalTok{ [}\StringTok{'diferencia'}\NormalTok{])}
  \CommentTok{//esto entrega un dicionario, pero solo nos interesa el valor que queda en la clave 'mean'}
\NormalTok{  .}\AttributeTok{get}\NormalTok{(}\StringTok{'mean'}\NormalTok{)}
\NormalTok{)}
\CommentTok{//finalmente calculamos la raiz cuadrada del error cuadratico medio promedio de toda la coleccion.}
\CommentTok{//para obetener la raiz del error cuadratico medio}
\NormalTok{.}\AttributeTok{sqrt}\NormalTok{()}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

tambien se puede usar coleccion de vectores para reducir las informacion
raster de una imagen por ejemplo se puede tomar una imagen de
precipitacion y ver cual es precipitacion total para cada vector

ejercicio n

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{//importar una imagen de clima de WorldClim y renombrar sus bandas}
\KeywordTok{var}\NormalTok{ clima }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{Image}\NormalTok{(}\StringTok{"WORLDCLIM/V1/BIO"}\NormalTok{).}\AttributeTok{rename}\NormalTok{([}
  \StringTok{'Annual_mean_temperature'}\OperatorTok{,}
  \StringTok{'Mean_diurnal_range'}\OperatorTok{,}
  \StringTok{'Isothermality'}\OperatorTok{,}
  \StringTok{'Temperature_seasonality'}\OperatorTok{,}
  \StringTok{'Max_temperature_of_warmest_month'}\OperatorTok{,}
  \StringTok{'Min_temperature_of_coldest_month'}\OperatorTok{,}
  \StringTok{'Temperature_annual_range'}\OperatorTok{,}
  \StringTok{'Mean_temperature_of_wettest_quarter'}\OperatorTok{,}
  \StringTok{'Mean_temperature_of_driest_quarter'}\OperatorTok{,}
  \StringTok{'Mean_temperature_of_warmest_quarter'}\OperatorTok{,}
  \StringTok{'Mean_temperature_of coldest_quarter'}\OperatorTok{,}
  \StringTok{'Annual_precipitation'}\OperatorTok{,}
  \StringTok{'Precipitation_of_wettest month'}\OperatorTok{,}
  \StringTok{'Precipitation_of_driest month'}\OperatorTok{,}
  \StringTok{'Precipitation_seasonality'}\OperatorTok{,}
  \StringTok{'Precipitation_of_wettest_quarter'}\OperatorTok{,}
  \StringTok{'Precipitation_of_driest_quarter'}\OperatorTok{,}
  \StringTok{'Precipitation_of_warmest_quarter'}\OperatorTok{,}
  \StringTok{'Precipitation_of_coldest_quarter'}\NormalTok{])}\OperatorTok{;}

\AttributeTok{print}\NormalTok{(}\StringTok{'bandas de la imagen de clima '}\OperatorTok{,}\VariableTok{clima}\NormalTok{.}\AttributeTok{bandNames}\NormalTok{())}\OperatorTok{;}

\CommentTok{// importar una capa de cuencas filtrada a Puerto Rico}
\KeywordTok{var}\NormalTok{ cuencasPuertorRico }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{FeatureCollection}\NormalTok{(}\StringTok{'USGS/WBD/2017/HUC06'}\NormalTok{)}
\NormalTok{  .}\AttributeTok{filterBounds}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Rectangle}\NormalTok{(}\OperatorTok{-}\FloatTok{79.906}\OperatorTok{,} \FloatTok{25.196}\OperatorTok{,} \FloatTok{-59.6}\OperatorTok{,} \FloatTok{9.776}\NormalTok{))}\OperatorTok{;}

\AttributeTok{print}\NormalTok{(}\StringTok{'propiedades de los vectores de cuencas'}\OperatorTok{,}\VariableTok{cuencasPuertorRico}\NormalTok{.}\AttributeTok{first}\NormalTok{().}\AttributeTok{propertyNames}\NormalTok{())}\OperatorTok{;}

\KeywordTok{var}\NormalTok{ cuencaClima }\OperatorTok{=} \VariableTok{clima}\NormalTok{.}\AttributeTok{reduceRegions}\NormalTok{(cuencasPuertorRico}\OperatorTok{,} \VariableTok{ee}\NormalTok{.}\VariableTok{Reducer}\NormalTok{.}\AttributeTok{sum}\NormalTok{())}\OperatorTok{;}

\AttributeTok{print}\NormalTok{(}\StringTok{'vectores con informacion de clima'}\OperatorTok{,}\NormalTok{ cuencaClima)}\OperatorTok{;}
\AttributeTok{print}\NormalTok{(}\StringTok{'propiedades de los vectores de cuencas con clima '}\OperatorTok{,}\VariableTok{cuencaClima}\NormalTok{.}\AttributeTok{first}\NormalTok{().}\AttributeTok{propertyNames}\NormalTok{())}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\#\#interpolar de vector a Imagen

interpolar de vector a imagen , consiste en tomar los datos numericos de
un vector e interpolarlos a areas fuera de los vectores. resultando en
una imagen con el valor numerico interpolado del vector.

\#\#\#ponderación de distancia inversa

es un metodo descrito por (Basso et al.~1999
\url{https://ieeexplore.ieee.org/abstract/document/805606})

ejercicio K

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{// importamos datos de metano de 5 dias, los filtramos y sacamos el promedio.}
\KeywordTok{var}\NormalTok{ ch4 }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{ImageCollection}\NormalTok{(}\StringTok{'COPERNICUS/S5P/OFFL/L3_CH4'}\NormalTok{)}
\NormalTok{  .}\AttributeTok{select}\NormalTok{(}\StringTok{'CH4_column_volume_mixing_ratio_dry_air'}\NormalTok{)}
\NormalTok{  .}\AttributeTok{filterDate}\NormalTok{(}\StringTok{'2020-01-01'}\OperatorTok{,} \StringTok{'2020-01-05'}\NormalTok{)}
\NormalTok{  .}\AttributeTok{mean}\NormalTok{()}
\NormalTok{  .}\AttributeTok{rename}\NormalTok{(}\StringTok{'ch4'}\NormalTok{)}\OperatorTok{;}

\CommentTok{// Definimos un rectang\}ulo de area de estudio al norte de Mexico.}
\KeywordTok{var}\NormalTok{ norteMex }\OperatorTok{=}
  \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Rectangle}\NormalTok{(}\OperatorTok{-}\FloatTok{117.33}\OperatorTok{,} \FloatTok{32.753}\OperatorTok{,} \FloatTok{-97.773}\OperatorTok{,} \FloatTok{22.634}\NormalTok{)}\OperatorTok{;}

\CommentTok{// crear una coleccion de vectores para interpolar.}
\KeywordTok{var}\NormalTok{ muestras }\OperatorTok{=} \VariableTok{ch4}\NormalTok{.}\AttributeTok{addBands}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Image}\NormalTok{.}\AttributeTok{pixelLonLat}\NormalTok{()) }\CommentTok{//se crean dos bandas adicionales para la imagen indicando la longitud y latitud de cada pixel }
\NormalTok{  .}\AttributeTok{sample}\NormalTok{(}\OperatorTok{\{}\DataTypeTok{region}\OperatorTok{:}\NormalTok{ norteMex}\OperatorTok{,} \DataTypeTok{numPixels}\OperatorTok{:} \DecValTok{10000}\OperatorTok{,} \CommentTok{//se crean una coleccion de vectores (sin geometria) en la region norteMex y aproximandamente cuantos puntos generar}
    \DataTypeTok{scale}\OperatorTok{:}\DecValTok{1000}\OperatorTok{\}}\NormalTok{) }\CommentTok{//resolucion de la imagen en metros por pixel}
\NormalTok{  .}\AttributeTok{map}\NormalTok{(}\KeywordTok{function}\NormalTok{(sample) }\OperatorTok{\{} \CommentTok{//funcion para cada punto generado}
    \KeywordTok{var}\NormalTok{ lat }\OperatorTok{=} \VariableTok{sample}\NormalTok{.}\AttributeTok{get}\NormalTok{(}\StringTok{'latitude'}\NormalTok{)}\OperatorTok{;} \CommentTok{//tomar el valor del punto de latitud}
    \KeywordTok{var}\NormalTok{ lon }\OperatorTok{=} \VariableTok{sample}\NormalTok{.}\AttributeTok{get}\NormalTok{(}\StringTok{'longitude'}\NormalTok{)}\OperatorTok{;} \CommentTok{//tomar el valor del punto de Longitud}
    \KeywordTok{var}\NormalTok{ ch4 }\OperatorTok{=} \VariableTok{sample}\NormalTok{.}\AttributeTok{get}\NormalTok{(}\StringTok{'ch4'}\NormalTok{)}\OperatorTok{;} \CommentTok{//tomar el valor del punto de metano}
    \ControlFlowTok{return} \VariableTok{ee}\NormalTok{.}\AttributeTok{Feature}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Point}\NormalTok{([lon}\OperatorTok{,}\NormalTok{ lat])}\OperatorTok{,} \OperatorTok{\{}\DataTypeTok{ch4}\OperatorTok{:}\NormalTok{ ch4}\OperatorTok{\}}\NormalTok{)}\OperatorTok{;}\CommentTok{//crear una geometria para el vector asignandole el valor de metano}
  \OperatorTok{\}}\NormalTok{)}\OperatorTok{;}

\CommentTok{// Combinaar un reductor de promedio y desviacion estandar}
\KeywordTok{var}\NormalTok{ Reductores }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Reducer}\NormalTok{.}\AttributeTok{mean}\NormalTok{().}\AttributeTok{combine}\NormalTok{(}\OperatorTok{\{}
  \DataTypeTok{reducer2}\OperatorTok{:} \VariableTok{ee}\NormalTok{.}\VariableTok{Reducer}\NormalTok{.}\AttributeTok{stdDev}\NormalTok{()}\OperatorTok{,}
  \DataTypeTok{sharedInputs}\OperatorTok{:} \KeywordTok{true}\OperatorTok{\}}\NormalTok{)}\OperatorTok{;}

\CommentTok{// Estimar el promedio y la desviacion estandarde metano de los puntos.}
\KeywordTok{var}\NormalTok{ stats }\OperatorTok{=} \VariableTok{muestras}\NormalTok{.}\AttributeTok{reduceColumns}\NormalTok{(}\OperatorTok{\{}
  \DataTypeTok{reducer}\OperatorTok{:}\NormalTok{ Reductores}\OperatorTok{,}
  \DataTypeTok{selectors}\OperatorTok{:}\NormalTok{ [}\StringTok{'ch4'}\NormalTok{]}\OperatorTok{\}}\NormalTok{)}\OperatorTok{;}

\CommentTok{// interpolar para 70 km.}
\KeywordTok{var}\NormalTok{ interpolado }\OperatorTok{=} \VariableTok{muestras}\NormalTok{.}\AttributeTok{inverseDistance}\NormalTok{(}\OperatorTok{\{}
  \DataTypeTok{range}\OperatorTok{:} \DecValTok{70000}\OperatorTok{,} \CommentTok{//rango p\}de interpolacion para cada punto}
  \DataTypeTok{propertyName}\OperatorTok{:} \StringTok{'ch4'}\OperatorTok{,} \CommentTok{//atributo numerico a inerpolar}
  \DataTypeTok{mean}\OperatorTok{:} \VariableTok{stats}\NormalTok{.}\AttributeTok{get}\NormalTok{(}\StringTok{'mean'}\NormalTok{)}\OperatorTok{,} \CommentTok{//promedio (parametro para la funcion)}
  \DataTypeTok{stdDev}\OperatorTok{:} \VariableTok{stats}\NormalTok{.}\AttributeTok{get}\NormalTok{(}\StringTok{'stdDev'}\NormalTok{)}\OperatorTok{,} \CommentTok{//desviacion estandar (parametro para la funcion)}
  \OperatorTok{\}}\NormalTok{)}\OperatorTok{;} 
\end{Highlighting}
\end{Shaded}

\#\#\#kriging

es un metodo de interpolacion que utiliza un estimativo de la
semi-varianza, para crear un aimagen de valores interpolados que sea una
combinacion optima de los datos conocidos. necesita unos parametros que
describan la forma de la funcion de semi-varianza, ajustada a los datos
conocidos. ejercicio j

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{// importar una imagen de temperatura marina superficial}
\KeywordTok{var}\NormalTok{ temperatura }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{Image}\NormalTok{(}\StringTok{'NOAA/AVHRR_Pathfinder_V52_L3/20120802025048'}\NormalTok{)}
\NormalTok{  .}\AttributeTok{select}\NormalTok{(}\StringTok{'sea_surface_temperature'}\NormalTok{)}
\NormalTok{  .}\AttributeTok{rename}\NormalTok{(}\StringTok{'temperatura'}\NormalTok{)}
\NormalTok{  .}\AttributeTok{divide}\NormalTok{(}\DecValTok{100}\NormalTok{)}\OperatorTok{;}

\CommentTok{// Definir una geometria donde muestrear puntos}
\KeywordTok{var}\NormalTok{ geometria }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Rectangle}\NormalTok{([}\OperatorTok{-}\FloatTok{65.60}\OperatorTok{,} \FloatTok{31.75}\OperatorTok{,} \FloatTok{-52.18}\OperatorTok{,} \FloatTok{43.12}\NormalTok{])}\OperatorTok{;}

\CommentTok{// Muestrear las temperaturas en 1000 localizaciones aleatoria.}
\KeywordTok{var}\NormalTok{ muestras }\OperatorTok{=} \VariableTok{temperatura}\NormalTok{.}\AttributeTok{addBands}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Image}\NormalTok{.}\AttributeTok{pixelLonLat}\NormalTok{())}
\NormalTok{  .}\AttributeTok{sample}\NormalTok{(}\OperatorTok{\{}\DataTypeTok{region}\OperatorTok{:}\NormalTok{ geometria}\OperatorTok{,} \DataTypeTok{numPixels}\OperatorTok{:} \DecValTok{1000}\OperatorTok{\}}\NormalTok{)}
\NormalTok{  .}\AttributeTok{map}\NormalTok{(}\KeywordTok{function}\NormalTok{(sample) }\OperatorTok{\{}
    \KeywordTok{var}\NormalTok{ lat }\OperatorTok{=} \VariableTok{sample}\NormalTok{.}\AttributeTok{get}\NormalTok{(}\StringTok{'latitude'}\NormalTok{)}\OperatorTok{;}
    \KeywordTok{var}\NormalTok{ lon }\OperatorTok{=} \VariableTok{sample}\NormalTok{.}\AttributeTok{get}\NormalTok{(}\StringTok{'longitude'}\NormalTok{)}\OperatorTok{;}
    \KeywordTok{var}\NormalTok{ temperatura1 }\OperatorTok{=} \VariableTok{sample}\NormalTok{.}\AttributeTok{get}\NormalTok{(}\StringTok{'temperatura'}\NormalTok{)}\OperatorTok{;}
    \ControlFlowTok{return} \VariableTok{ee}\NormalTok{.}\AttributeTok{Feature}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Point}\NormalTok{([lon}\OperatorTok{,}\NormalTok{ lat])}\OperatorTok{,} \OperatorTok{\{}\DataTypeTok{temperaturaMarina}\OperatorTok{:}\NormalTok{ temperatura1}\OperatorTok{\}}\NormalTok{)}\OperatorTok{;}
  \OperatorTok{\}}\NormalTok{)}\OperatorTok{;}

\CommentTok{// Interpolate SST from the sampled points.}
\KeywordTok{var}\NormalTok{ interpolar }\OperatorTok{=} \VariableTok{muestras}\NormalTok{.}\AttributeTok{kriging}\NormalTok{(}\OperatorTok{\{}
  \DataTypeTok{propertyName}\OperatorTok{:} \StringTok{'temperaturaMarina'}\OperatorTok{,}
  \DataTypeTok{shape}\OperatorTok{:} \StringTok{'exponential'}\OperatorTok{,} \CommentTok{//forma de la funcion de la varianza de los datos}
  \DataTypeTok{range}\OperatorTok{:} \DecValTok{100} \OperatorTok{*} \DecValTok{1000}\OperatorTok{,} \CommentTok{//rango de la varianza}
  \DataTypeTok{sill}\OperatorTok{:} \FloatTok{1.0}\OperatorTok{,}
  \DataTypeTok{nugget}\OperatorTok{:} \FloatTok{0.1}\OperatorTok{,}
  \DataTypeTok{maxDistance}\OperatorTok{:} \DecValTok{100} \OperatorTok{*} \DecValTok{1000}\OperatorTok{,}
  \DataTypeTok{reducer}\OperatorTok{:} \StringTok{'mean'}\OperatorTok{,}
\OperatorTok{\}}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\#\#convertir de vector a imagen

para resterizar un vector se usa el metodo \texttt{reduceToImage()}.
este metodo asigna pixeles del valor del atributo especificado, bajo
cada vector

ejercicio T

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{// definir un area en la antartida}
\KeywordTok{var}\NormalTok{ rectangulo }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Rectangle}\NormalTok{(}\OperatorTok{-}\FloatTok{158.63}\OperatorTok{,-}\FloatTok{81.47}\OperatorTok{,-}\FloatTok{40.51}\OperatorTok{,-}\FloatTok{59.12}\NormalTok{)}\OperatorTok{;}

\CommentTok{//importar una coleccion de vectores de GEe con datos de glaciares}
\KeywordTok{var}\NormalTok{ hielo }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{FeatureCollection}\NormalTok{(}\StringTok{"GLIMS/current"}\NormalTok{).}\AttributeTok{filterBounds}\NormalTok{(rectangulo)}\OperatorTok{;}

\CommentTok{// crear una imagen raster de las areas de los glaciares.}
\KeywordTok{var}\NormalTok{ areaGlaciar }\OperatorTok{=}\NormalTok{ hielo}
\NormalTok{  .}\AttributeTok{filter}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Filter}\NormalTok{.}\AttributeTok{notNull}\NormalTok{([}\StringTok{'area'}\NormalTok{])) }\CommentTok{//seleccionar vectores cuyo atributo area no este vacio }
\NormalTok{  .}\AttributeTok{reduceToImage}\NormalTok{(}\OperatorTok{\{} \CommentTok{//rasterizar}
    \DataTypeTok{properties}\OperatorTok{:}\NormalTok{ [}\StringTok{'area'}\NormalTok{]}\OperatorTok{,} \CommentTok{//atributo del vector para rasterizar}
    \DataTypeTok{reducer}\OperatorTok{:} \VariableTok{ee}\NormalTok{.}\VariableTok{Reducer}\NormalTok{.}\AttributeTok{first}\NormalTok{() }\CommentTok{//tomar el primer valor }
\OperatorTok{\}}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\#\#unir colecciones de vectores \#\#exportar vectores

\newpage

\hypertarget{imagen}{%
\section{Imagen}\label{imagen}}

\hypertarget{caracteruxedsticas}{%
\subsection{Características}\label{caracteruxedsticas}}

Las imágenes que se encuentran disponibles en colecciones de imágenes en
GEE, corresponden a información en formato raster que cuenta con una
resolución espacial, espectral, radiométrica particular. Los metadatos
de cada imagen se encuentran como propiedades de ésta. A diferencia de
las imágenes a las que posiblemente el usuario esté acostumbrado a
manejar, GEE permite el manejo de imágenes donde cada banda puede tener
una resolución de pixel o tipo de datos distinta (Integer, Float, 16
bits, etc.). Esto no afecta el uso de estas imágenes pero puede ser
importante a considerar para exportar imágenes cuyas bandas tienen
distinta resolución espacial (p.ej., Sentinel-2).

\hypertarget{informaciuxf3n-y-metadatos}{%
\subsection{Información y metadatos}\label{informaciuxf3n-y-metadatos}}

Los metadatos de la imagen se encuentran como propiedades. Para
consultarlas se puede utilizar el siguiente comando:
\texttt{ee.Image.propertyNames()}. Otros comandos que facilitan la
consulta de algunos elementos particulares son: \texttt{.bandNames()},
\texttt{.projection()}, \texttt{.projection().nominalScale()}, para
conocer el nombre de las bandas de la imágenes, su proyección y el
tamaño de pixel en m que presenta, respectivamente.

\begin{tipblock}
La proyección de trabajo para todas las capas es de EPSG:3857 WGS84
pseudomercator. Si se requiere cambiar de proyección se puede utilizar
la función \texttt{reproject}, aunque no se recomienda utilizarla, a
menos que sea estrictamente necesario.

\end{tipblock}

\hypertarget{funciones-comunes}{%
\subsection{Funciones comunes}\label{funciones-comunes}}

\hypertarget{selecciuxf3n-de-bandas}{%
\subsubsection{Selección de bandas}\label{selecciuxf3n-de-bandas}}

Una vez, revisado los nombres de las bandas de una imagen, se pueden
seleccionar ciertas bandas mediante la función \texttt{select}. Para
seleccionar una única banda sólo se requiere indicar el nombre de la
banda, mientras que si se desea seleccionar varias bandas, éstas deben
indicarse dentro de una lista. Por ejemplo:

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{ee}\NormalTok{.}\VariableTok{Image}\NormalTok{.}\AttributeTok{select}\NormalTok{(}\StringTok{'B1'}\NormalTok{)}\OperatorTok{;}
\VariableTok{ee}\NormalTok{.}\VariableTok{Image}\NormalTok{.}\AttributeTok{select}\NormalTok{([}\StringTok{'B1'}\OperatorTok{,}\StringTok{'B2'}\OperatorTok{,}\StringTok{'B3'}\NormalTok{])}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\hypertarget{cambio-de-nombres-de-bandas}{%
\subsubsection{Cambio de nombres de
bandas}\label{cambio-de-nombres-de-bandas}}

Por default, el nombre de las bandas de las imágenes suelen corresponder
a la letra `B' más un número que indica el número de banda. Por ejemplo,
`B1', `B2',`B3', etc. En algunos casos, el usuario puede preferir
sustituir estos nombres con letras que indiquen la longitud de onda que
contiene cada banda. En estos casos, se puede utilizar la función
\texttt{rename} para cambiar los nombres de las bandas. Por ejemplo:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ seleccionBandas }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Image}\NormalTok{.}\AttributeTok{select}\NormalTok{([}\StringTok{'B2'}\OperatorTok{,}\StringTok{'B3'}\OperatorTok{,}\StringTok{'B4'}\NormalTok{])}\OperatorTok{;}
\NormalTok{seleccionBandas }\OperatorTok{=} \VariableTok{seleccionBands}\NormalTok{.}\AttributeTok{rename}\NormalTok{([}\StringTok{'B'}\OperatorTok{,}\StringTok{'G'}\OperatorTok{,}\StringTok{'R'}\NormalTok{])}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\hypertarget{cortes}{%
\subsubsection{Cortes}\label{cortes}}

Se pueden realizar cortes de una imagen para quedarse con un área
específica utilizando la función:

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{ee}\NormalTok{.}\VariableTok{Image}\NormalTok{.}\AttributeTok{clip}\NormalTok{(roi)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

Esto permite trabajar únicamente con la región de interés (en el ejemplo
anterior, específicada en el objeto \emph{roi}).

\begin{tipblock}
Se sugiere evitar el uso de la función \texttt{clip} a menos que sea
estrictamente necesario, ya que aumenta el tiempo de procesamiento.

\end{tipblock}

\hypertarget{operaciones-matemuxe1ticas}{%
\subsubsection{Operaciones
matemáticas}\label{operaciones-matemuxe1ticas}}

Dentro de GEE se puede realizar cualquier operación matemática entre
bandas o entre imágenes. Los operadores para realizar esta operaciones
son: \texttt{.subtract(),\ .add(),\ .divide(),\ .multiply()}. Además,
GEE cuenta con una función de \texttt{.normalizedDifference()} para
calcular un índice normalizado, a partir de las bandas que se indiquen
como: \texttt{.normalizedDifference()}. Por ejemplo, para calcular el
NDVI primero se indica la banda del infrarrojo y luego la del rojo. Si
se quiere realizar un índice un poco más complicado se puede calcular
mediante la función de \texttt{.expression()}. En esta función se indica
primero la fórmula del cálculo que se va a realizar y posteriormente se
indica en un diccionario la equivalencia de los términos utilizados en
la fórmula y los nombres de las bandas de la imagen:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ NDVI }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Image}\NormalTok{.}\AttributeTok{expression}\NormalTok{( }\StringTok{'(NIR - R) / (NIR + R)'}\OperatorTok{,} \OperatorTok{\{}
  \StringTok{'NIR'} \OperatorTok{=} \VariableTok{image}\NormalTok{.}\AttributeTok{select}\NormalTok{(}\StringTok{'B4'}\NormalTok{)}\OperatorTok{,}
  \StringTok{'R'} \OperatorTok{=} \VariableTok{image}\NormalTok{.}\AttributeTok{select}\NormalTok{(}\StringTok{'B3)}
\OperatorTok{\}}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

Dentro de las fórmulas utilizadas dentro de expression se puede utilizar
la notación estándar matemática (\texttt{+,\ -,\ /,\ *}), modulo
(\texttt{\%}), exponente (\texttt{**}),
relacionales(\texttt{\textgreater{},\ \textless{},\ \textgreater{}=,\ \textless{}=,\ !=,\ ==}),
lógicos (\texttt{\&\&,\ \textbar{}\textbar{},\ !,\ \^{}}), o if then
else (\texttt{?:}).

\hypertarget{operaciones-relacionales-condicionales-y-booleanas}{%
\subsubsection{Operaciones relacionales, condicionales y
booleanas}\label{operaciones-relacionales-condicionales-y-booleanas}}

Se pueden utilizar operadores relacionales, condicionales, booleanos
sobre las imágenes para crear clases o máscaras. Se pueden utilizar las
siguientes notaciones para hacer comparaciones de los valores una imagen
con cierto valor \texttt{.lt()}, \texttt{.lte()}, \texttt{.gt()},
\texttt{.gte()}, \texttt{.eq()}, \texttt{.neq()}, que equivalen a menor
que (\emph{less than}), menor que o igual (\emph{less than or equal}),
mayor que (\emph{greater than}), mayor que o igual (\emph{greater than
or equal}), igual (\emph{equal}) o no igual (\emph{not equal}),
respectivamente. Además se pueden utilizar operadores relacionales para
unir dos condiciones mediante \texttt{.and()} u \texttt{.or()}, es
decir, y u o. Por ejemplo, la siguiente línea permite crear una máscara
de las áreas que tengan valores menores o iguales a 0.2 y mayores o
iguales a 0:

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{ee}\NormalTok{.}\VariableTok{Image}\NormalTok{.}\AttributeTok{lte}\NormalTok{(}\FloatTok{0.2}\NormalTok{).}\AttributeTok{and}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Image}\NormalTok{.}\AttributeTok{gte}\NormalTok{(}\DecValTok{0}\NormalTok{))}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

Otra forma de crear máscaras es indicando valores por bits. En este
caso, se indica el valor del bit de interés y después se evalua una
condición sobre una banda determinada. Por ejemplo, para Landsat 8, la
banda de evaluación de la calidad de la imagen corresponde a la banda
`pixel\_qa'. En esta banda, el bit 5 indica cobertura de nubes, así que
primero se define una variable que indique que el bit 5 es el que será
evaluado. Después se selecciona la banda `pixel\_qa' para después
evaluar una condición sobre ella. En este caso, se crea una máscara que
tenga valores a conservar (1) en áreas donde el bit 5 sea 0; por el
contrario, contendrá valores a eliminar (0) en áreas donde el bit 5 no
sea 0.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ nubesBit }\OperatorTok{=}\NormalTok{ (}\DecValTok{1} \OperatorTok{<<} \DecValTok{5}\NormalTok{)}\OperatorTok{;}
\KeywordTok{var}\NormalTok{ qa }\OperatorTok{=} \VariableTok{image}\NormalTok{.}\AttributeTok{select}\NormalTok{(}\StringTok{'pixel_qa'}\NormalTok{)}\OperatorTok{;}
\KeywordTok{var}\NormalTok{ mask }\OperatorTok{=} \VariableTok{qa}\NormalTok{.}\AttributeTok{bitwiseAnd}\NormalTok{(nubesBit).}\AttributeTok{eq}\NormalTok{(}\DecValTok{0}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\hypertarget{enmascaramiento}{%
\subsubsection{Enmascaramiento}\label{enmascaramiento}}

La función \texttt{updateMask} permite enmascarar los pixeles de una
imagen, utilizando otra imagen como máscara que indique cuáles pixeles
se deben conservar (valores de 1) y cuáles enmscarar (valores de 0).

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{ee}\NormalTok{.}\VariableTok{Image}\NormalTok{.}\AttributeTok{updateMask}\NormalTok{(mascara)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\begin{tipblock}
Aunque en GEE existe la función \texttt{mask} para enmascarar áreas de
una imagen, se sugiere siempre utilizar \texttt{updateMask}. La función
\texttt{mask} simplemente substituye la máscara original de la imagen,
mientras que \texttt{updateMask} combina la máscara anterior con la
nueva. Por ello, el usar \texttt{updateMask} evita desenmascarar áreas
que podrían no ser de interés para el usuario.

\end{tipblock}

\hypertarget{agregar-bandas}{%
\subsubsection{Agregar bandas}\label{agregar-bandas}}

El usuario puede estar interesado en agregar una banda al conjunto de
bandas que contiene por default una imagen. Por ejemplo, se podría
agregar una banda que contenga algún índice calculado con las bandas
originales de la imagen. Esto se puede lograr utilizando la función
\texttt{addBands}. Por ejemplo:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ ndvi }\OperatorTok{=} \VariableTok{imagen}\NormalTok{.}\AttributeTok{normalizedDifference}\NormalTok{([}\StringTok{'B5'} \OperatorTok{,} \StringTok{'B4'}\NormalTok{])}\OperatorTok{;}
\NormalTok{imagen }\OperatorTok{=} \VariableTok{imagen}\NormalTok{.}\AttributeTok{addBands}\NormalTok{(ndvi)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\hypertarget{ejercicio-consulta-y-procesamiento-de-imagen}{%
\paragraph{Ejercicio: Consulta y procesamiento de
imagen}\label{ejercicio-consulta-y-procesamiento-de-imagen}}

En GEE hay algunos objetos que constan de imágenes únicas, por lo tanto,
se pueden utilizar directamente los métodos para el procesamiento de
imágenes. Un ejemplo muy utilizado de este tipo de objetos es el modelo
digital de elevación (DEM) producido por la misión SRTM. Para buscar
cuál es la localización para acceder a esta información se puede ir a la
barra de búsqueda (\textbf{Search}) y escribir SRTM. Debería aparecer
una ventana así:

\includegraphics[width=500px]{Img/SRTM}

Posteriormente se da click sobre el primer resultado y debería abrirse
la siguiente ventana.

\includegraphics[width=500px]{Img/SRTM_prop}

En dicha ventana, se puede copiar la ubicación de la imagen del DEM de
SRTM en los servidores de Google. Posteriormente, en la pantalla de
rutinas se puede escribir la siguiente línea para guardar la imagen SRTM
en un objeto nuevo llamado dem.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ dem }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{Image}\NormalTok{(}\StringTok{"CGIAR/SRTM90_V4"}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

Posteriormente, se puede cortar el dem a la extensión que nos interesa.
En este caso se utilizará la colección con los límites políticos del
mundo que se encuentra cargada en GEE. Ésta se puede buscar de igual
manera que la capa de SRTM en la barra de búsqueda. Posteriormente, se
puede consultar la información que contiene la capa en la pestaña de
`TABLE SCHEMA'. Por último, se aplica un filtro para seleccionar el país
que nos interesa, en este caso México.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ MX }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{FeatureCollection}\NormalTok{(}\StringTok{"USDOS/LSIB_SIMPLE/2017"}\NormalTok{)}
\NormalTok{  .}\AttributeTok{filter}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Filter}\NormalTok{.}\AttributeTok{eq}\NormalTok{(}\StringTok{'country_co'}\OperatorTok{,}\StringTok{'MX'}\NormalTok{))}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

Y por último, se corta la imagen a la extensión del polígono de interés.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ demCortado }\OperatorTok{=} \VariableTok{dem}\NormalTok{.}\AttributeTok{clip}\NormalTok{(geometry)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

Para comparar el dem antes y después de cortar la imagen a la extensión
del polígono de interés, se pueden cargar los dos objetos: \texttt{dem}
y \texttt{demCortado}

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{Map}\NormalTok{.}\AttributeTok{addLayer}\NormalTok{(dem}\OperatorTok{,} \OperatorTok{\{}\DataTypeTok{min}\OperatorTok{:} \DecValTok{0}\OperatorTok{,} \DataTypeTok{max}\OperatorTok{:}\DecValTok{4000}\OperatorTok{\},} \StringTok{'dem'}\NormalTok{)}\OperatorTok{;}
\VariableTok{Map}\NormalTok{.}\AttributeTok{addLayer}\NormalTok{(demCortado}\OperatorTok{,} \OperatorTok{\{}\DataTypeTok{min}\OperatorTok{:} \DecValTok{0}\OperatorTok{,} \DataTypeTok{max}\OperatorTok{:}\DecValTok{4000}\OperatorTok{\},} \StringTok{'demMX'}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

Posteriormente, se define una máscara de todas las áreas que tengan una
elevación menor o igual a 2500 m s.n.m. y mayor o igual a 1000 m s.n.m.
Después, se aplica esta máscara al DEM cotado para mantener únicamente
las áreas que cumplan con el criterio anterior.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ mascara }\OperatorTok{=} \VariableTok{demCortado}\NormalTok{.}\AttributeTok{lte}\NormalTok{(}\DecValTok{2500}\NormalTok{).}\AttributeTok{and}\NormalTok{(}\VariableTok{demCortado}\NormalTok{.}\AttributeTok{gte}\NormalTok{(}\DecValTok{1000}\NormalTok{))}\OperatorTok{;}
\KeywordTok{var}\NormalTok{ imgEnmascarada }\OperatorTok{=} \VariableTok{demCortado}\NormalTok{.}\AttributeTok{updateMask}\NormalTok{(mascara)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

A continuación, se puede renombrar la banda de la imagen de `elevation'
a `elevación' y se agrega la imagen a la pantalla de mapas.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{imgEnmascarada }\OperatorTok{=} \VariableTok{imgEnmascarada}\NormalTok{.}\AttributeTok{rename}\NormalTok{(}\StringTok{'elevacion'}\NormalTok{)}\OperatorTok{;}
\VariableTok{Map}\NormalTok{.}\AttributeTok{addLayer}\NormalTok{(imgEnmascarada}\OperatorTok{,\{}\DataTypeTok{min}\OperatorTok{:} \DecValTok{1000}\OperatorTok{,} \DataTypeTok{max}\OperatorTok{:} \DecValTok{2500}\OperatorTok{\},} \StringTok{'imgEnmascarada'}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

Por último, se puede generar un gráfico para obtener un histograma de
los valores de elevación del DEM. Para hacer esto, se utiliza la función
\texttt{ui.Chart.image.histogram} y se indica la imagen de la cual se
quiere obtener el histograma (\texttt{image}), la escala en m a la que
se quiere obtener los valores del histograma (\texttt{scale}) y el
número máximo de clases (\texttt{maxBuckets}). Por último, se agrega
este gráfico a la consola con un \texttt{print}.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ graficoHistorgrama }\OperatorTok{=} \VariableTok{ui}\NormalTok{.}\VariableTok{Chart}\NormalTok{.}\VariableTok{image}\NormalTok{.}\AttributeTok{histogram}\NormalTok{(}\OperatorTok{\{}
  \DataTypeTok{image}\OperatorTok{:}\NormalTok{ imgEnmascarada}\OperatorTok{,}
  \DataTypeTok{scale}\OperatorTok{:} \DecValTok{9000}\OperatorTok{,}
  \DataTypeTok{maxBuckets}\OperatorTok{:} \DecValTok{10}
  \OperatorTok{\}}\NormalTok{)}\OperatorTok{;}

\AttributeTok{print}\NormalTok{(graficoHistorgrama}\OperatorTok{,}\StringTok{'graficoHistorgrama'}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=500px]{Img/histElevacion}

\newpage

\hypertarget{colecciones-de-imuxe1genes}{%
\section{colecciones de imágenes}\label{colecciones-de-imuxe1genes}}

Las imágenes que se encuentran disponibles en los servidores de GEE se
encuentran en forma de colecciones, es decir, dentro de una
\texttt{ImageCollection}. Estas se pueden definir como colecciones de
objetos \texttt{ee.Image}. Normalmente, el primer paso para trabajar con
estas colecciones radica en delimitar el área y periodo de estudio, para
lo cual se utilizan las funciones de filter. Por ejemplo, para delimitar
un área se puede utilizar \texttt{ImageCollection.filterBounds()},
mientras que para delimitar por fecha
\texttt{ImageCollection.filterDate()}. Además, se pueden filtrar, de
acuerdo con otros criterios contenidos en los metadatos de las imágenes.
Por ejemplo, se puede definir un valor umbral de porcentaje de nubosidad
de las imágenes con las que se desean trabajar o ciertos parámetros de
la geometría del registro.

Adicionalmente, si se desea calcular una nueva banda para todas las
imágenes de la colección, se debe aplicar una función que agregue la
nueva banda a cada imagen y aplicar dicha función a cada imagen de la
colección mediante la función \texttt{map}.

\hypertarget{caracteruxedsticas-1}{%
\subsection{Características}\label{caracteruxedsticas-1}}

Las colecciones de imágenes son objetos de GEE que contienen un conjunto
de imágenes. La mayoría de los acervos de imágenes disponibles en GEE
van a ser definidos como colecciones de imágenes. Para el manejo de
varias imágenes se recomienda utilizar esta estructura, en lugar de
listas u otro tipo de objetos.

\hypertarget{informaciuxf3n-y-metadatos-1}{%
\subsection{Información y
metadatos}\label{informaciuxf3n-y-metadatos-1}}

Las colecciones de imágenes contienen los metadatos e información de
todas las imágenes que contienen. De tal manera, se puede utilizar esta
información para filtrar y utilizar únicamente las imágenes que cumplen
con ciertos criterios.

\begin{tipblock}
No se puede escribir o cambiar los objetos que se encuentran
directamente hospedados en GEE. Por ejemplo, si se quiere mapear una
función que sobreescriba alguna característica de las colecciones de
imágenes en GEE, se debe hacer una copia de éstas para que se pueda
sobreescribir la característica de interés.

\end{tipblock}

\hypertarget{funciones-comunes-1}{%
\subsection{Funciones comunes}\label{funciones-comunes-1}}

\hypertarget{filtros-sobre-colecciones-de-imuxe1genes}{%
\subsubsection{Filtros sobre colecciones de
imágenes}\label{filtros-sobre-colecciones-de-imuxe1genes}}

Los filtros permiten filtrar las colecciones de imágenes a partir de los
metadatos de las imágenes que contiene. De tal manera, se puede filtrar
por: superposición con algún polígono de interés, fecha de registro,
metadatos de las escenas (path, row, porcentaje de nubosidad), entre
otras.

Para filtrar una colección de imágenes se van a utilizar los objetos
\texttt{ee.Filter}. Existen diversos tipos de filtros, algunos ya se
encuentran precargados, pero otros se pueden definir manualmente. Por
ejemplo, para filtrar por fecha se puede utilizar \texttt{.filterDate}:

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{ee}\NormalTok{.}\VariableTok{ImageCollection}\NormalTok{.}\AttributeTok{filterDate}\NormalTok{(}\StringTok{'2015-01-01'}\OperatorTok{,}\StringTok{'2016-01-01'}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

Por otro lado para filtrar espacialmente con la extensión de un polígono
se puede realizar mediante \texttt{.filterBounds}:

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{ee}\NormalTok{.}\VariableTok{ImageCollection}\NormalTok{.}\AttributeTok{filterBounds}\NormalTok{(polygon1)}\OperatorTok{;} 
\end{Highlighting}
\end{Shaded}

Si se desea filtrar por alguna característica de los metadatos se puede
hacer mediante \texttt{filter} y después definiendo el filtro del
metadaro con \texttt{ee.Filter}. Otra forma de realizar este proceso es
mediante \texttt{filterMetadata}. Las siguientes dos líneas obtienen el
mismo resultado.

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{ee}\NormalTok{.}\VariableTok{ImageCollection}\NormalTok{.}\AttributeTok{filter}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Filter}\NormalTok{.}\AttributeTok{lt}\NormalTok{(}\StringTok{'CLOUD_COVER'}\OperatorTok{,} \DecValTok{20}\NormalTok{))}\OperatorTok{;}
\VariableTok{ee}\NormalTok{.}\VariableTok{ImageCollection}\NormalTok{.}\AttributeTok{filterMetadata}\NormalTok{(}\StringTok{'CLOUD_COVER'}\OperatorTok{,}\StringTok{'less_than'}\OperatorTok{,} \DecValTok{20}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\hypertarget{selecciuxf3n-de-bandas-1}{%
\subsubsection{Selección de bandas}\label{selecciuxf3n-de-bandas-1}}

Al igual que con las imágenes, se puede utilizar la función
\texttt{select} para seleccionar un conjunto de bandas de todas las
imágenes que se encuentran en la colección. De igual manera que con las
imágenes individuales, para seleccionar una única banda sólo se requiere
indicar el nombre de la banda, mientras que si se desea seleccionar
varias bandas, éstas deben indicarse dentro de una lista. Notése que el
nombre de las bandas. Por ejemplo:

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{ee}\NormalTok{.}\VariableTok{ImageCollection}\NormalTok{.}\AttributeTok{select}\NormalTok{(}\StringTok{'B1'}\NormalTok{)}\OperatorTok{;}
\VariableTok{ee}\NormalTok{.}\VariableTok{ImageCollection}\NormalTok{.}\AttributeTok{select}\NormalTok{([}\StringTok{'B1'}\OperatorTok{,}\StringTok{'B2'}\OperatorTok{,}\StringTok{'B3'}\NormalTok{])}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\hypertarget{ordenar-colecciuxf3n}{%
\subsubsection{Ordenar colección}\label{ordenar-colecciuxf3n}}

La función \texttt{sort} permite ordenar una colección de imágenes por
alguna propiedad de las imágenes. Por default, las colecciones de
imágenes están ordenadas cronológicamente. Sin embargo, se puede cambiar
este orden para que las ordene por alguna característica de las
imágenes, por ejemplo, por orden de menor a mayor cobertura de nubes.
Por default, la función \texttt{sort} ordena la colección de imágenes en
orden ascendente, de acuerdo al valor de la característica de las
imágenes indicadas. Sin embargo, si se desea ordenar de manera
descendente, esto se puede indicar utilizando el argumento
\texttt{ascending:\ false}. En el siguiente ejemplo, primero se ordena
la colección en orden ascendente y en el segundo, descendente.

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{ee}\NormalTok{.}\VariableTok{ImageCollection}\NormalTok{.}\AttributeTok{sort}\NormalTok{(}\StringTok{'PropiedadImagenes'}\NormalTok{)}\OperatorTok{;}
\VariableTok{ee}\NormalTok{.}\VariableTok{ImageCollection}\NormalTok{.}\AttributeTok{sort}\NormalTok{(}\StringTok{'PropiedadImagenes'}\OperatorTok{,} \KeywordTok{false}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\hypertarget{obtener-primera-imagen}{%
\subsubsection{Obtener primera imagen}\label{obtener-primera-imagen}}

En algunas ocasiones resulta útil obtener la primera imagen de una
colección de imágenes para ver si se llevó a cabo el procedimiento
deseado sobre la colección. Para ello, se utiliza la función
\texttt{first} que devuelve la primera imagen que se encuentra en la
colección y permite agregarla en la pantalla de mapas para analizarla
más a detalle.

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{ee}\NormalTok{.}\VariableTok{ImageCollection}\NormalTok{.}\AttributeTok{first}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\hypertarget{nuxfamero-de-valores-sin-enmascarar-por-pixel}{%
\subsubsection{Número de valores sin enmascarar por
pixel}\label{nuxfamero-de-valores-sin-enmascarar-por-pixel}}

Para conocer el número de valores sin enmascarar por pixel en la
colección de imágenes se utiliza la función \texttt{count}.

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{ee}\NormalTok{.}\VariableTok{ImageCollection}\NormalTok{.}\AttributeTok{count}\NormalTok{()}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\hypertarget{uniuxf3n-de-colecciones}{%
\subsubsection{Unión de colecciones}\label{uniuxf3n-de-colecciones}}

Para unir una colección de imágenes con otra se utiliza la función
\texttt{merge}. Un caso típico de tal operación sería el unir dos
colecciones de Landsat, por ejemplo, Landsat 7 y 8.

\begin{tipblock}
Las colecciones Landsat 7 y 8 no tienen las mismas bandas, ni los
nombres de las bandas corresponden entre sí. Por ejemplo, la banda 1 de
Landsat 7 corresponde al espectro del azul (blue), mientras que en
Landsat 8, la banda 1 corresponde al azul de costa (coastal blue). En
este caso, conviene primero filtrar y renombrar las bandas a unir para
asegurarse que el nombre las bandas a unir en una colección corresponda
con las de la otra.

\end{tipblock}

La unión de una colección de landsat 7 y con una landsat 8 se podría
hacer de la siguiente manera:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ l7 }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{ImageCollection}\NormalTok{(}\StringTok{"LANDSAT/LE07/C01/T1_SR"}\NormalTok{)}\OperatorTok{;}
\KeywordTok{var}\NormalTok{ l8 }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{ImageCollection}\NormalTok{(}\StringTok{"LANDSAT/LC08/C01/T1_SR"}\NormalTok{)}\OperatorTok{;}

\NormalTok{l7 }\OperatorTok{=} \VariableTok{l7}\NormalTok{.}\AttributeTok{select}\NormalTok{(}\StringTok{'B4'}\NormalTok{)}
\NormalTok{  .}\AttributeTok{rename}\NormalTok{(}\StringTok{'NIR'}\NormalTok{)}\OperatorTok{;}
\NormalTok{l8 }\OperatorTok{=} \VariableTok{l8}\NormalTok{.}\AttributeTok{select}\NormalTok{(}\StringTok{'B5'}\NormalTok{)}
\NormalTok{  .}\AttributeTok{rename}\NormalTok{(}\StringTok{'NIR'}\NormalTok{)}\OperatorTok{;}

\KeywordTok{var}\NormalTok{ l7y8 }\OperatorTok{=} \VariableTok{l7}\NormalTok{.}\AttributeTok{merge}\NormalTok{(l8)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\hypertarget{mapeo}{%
\subsubsection{Mapeo}\label{mapeo}}

Para realizar alguna operación sobre todas las imágenes de una
\texttt{ee.ImageCollection} se utilizar la función \texttt{map}. Esto va
a aplicar la función que se defina en el interior de ella a cada imagen
dentro de la colección. Por ejemplo, si quisieramos agregar una banda
con un índice de vegetación a todas las imágenes se podría hacer de la
siguiente manera:

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{ee}\NormalTok{.}\VariableTok{ImageCollection}\NormalTok{.}\AttributeTok{map}\NormalTok{(}\KeywordTok{function}\NormalTok{(image)}\OperatorTok{\{}
    \ControlFlowTok{return} \VariableTok{image}\NormalTok{.}\AttributeTok{normalizedDifference}\NormalTok{(}\StringTok{'NIR'}\OperatorTok{,}\StringTok{'R'}\NormalTok{)}\OperatorTok{;}
\OperatorTok{\}}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\begin{tipblock}
Notar que la función \texttt{map} es distinta de la función \texttt{Map}
que permite agregar objetos a la pantalla de mapas. Recordar que
Javascript es un lenguaje sensible a mayúsculas y minúsculas.

\end{tipblock}

Este tipo de operación es la sugerida para realizar operaciones de tipo
ciclo, en lugar de otras funciones de ciclo (e.g., \texttt{for}).

\begin{tipblock}
La función \texttt{map} sólo funciona con funciones del lado del
servidor, así que se recomienda evitar el uso de funciones del lado del
cliente como \texttt{print}, \texttt{Map}, \texttt{Export},
\texttt{Chart}.

\end{tipblock}

\hypertarget{reducciuxf3n}{%
\subsubsection{Reducción}\label{reducciuxf3n}}

Los reductores permiten crear un mosaico (una sola imagen), a partir de
una colección de imágenes. Estos son muy útiles para hacer mosaicos
multitemporales u obtener información de la colección de imágenes (por
ejemplo, cuántas observaciones válidas tiene cada pixel en un año). Para
reducir una colección de imágenes se utilizará la función
\texttt{reduce} e indicando el método a utilizar mediante un objeto tipo
\texttt{ee.Reducer}.

De tal manera, se puede indicar si el resultado corresponderá a la media
\texttt{ee.Reducer.mean()}, mediana \texttt{ee.Reducer.median()}, moda
\texttt{ee.Reducer.mode()}, mínimo \texttt{ee.Reducer.min()}, máximo
\texttt{ee.Reducer.max()} o inclusive la media de un intervalo
determinado de observaciones \texttt{ee.Reducer.intervalMean()}. Otra
forma de realizar estas mismas reducciones es utilizando directamente
las funciones \texttt{min}, \texttt{max}, \texttt{mean}, \texttt{mode},
\texttt{median}. Las siguientes dos líneas realizan exactamente el mismo
proceso:

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{ee}\NormalTok{.}\VariableTok{ImageCollection}\NormalTok{.}\AttributeTok{reduce}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Reducer}\NormalTok{.}\AttributeTok{mean}\NormalTok{())}\OperatorTok{;}
\VariableTok{ee}\NormalTok{.}\VariableTok{ImageCollection}\NormalTok{.}\AttributeTok{mean}\NormalTok{()}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\begin{tipblock}
Al aplicar una reducción a una colección de imágenes, el nombre de las
bandas será el mismo que el de las bandas de cada imagen con un sufijo
que indica la función utilizada para hacer la reducción. Por ejemplo, al
utilizar \texttt{ee.Reducer.mean()} sobre una colección de imágenes
cuyas bandas se llaman \texttt{B1} y \texttt{B2}, las bandas de la
imagen producto de la reducción se llamarán \texttt{B1\_mean} y
\texttt{B2\_mean}.

\end{tipblock}

\hypertarget{compuestos-y-mosaicos}{%
\subsubsection{Compuestos y mosaicos}\label{compuestos-y-mosaicos}}

Si se desean hacer mosaicos a partir de varias imágenes se puede
realizar en GEE mediante dos funciones:
\texttt{ee.ImageCollection.mosaic()} y
\texttt{ee.ImageCollection.qualityMosaic()}. La principal diferencia
entre estas dos funciones radica en que la primera simplemente pega las
imágenes de acuerdo al orden que tienen en la colección (es decir, la
última hasta arriba). Por el contrario, la función de
\texttt{qualityMosaic()} permite priorizar el pixel que quedará en el
mosaico final a partir del valor más alto de alguna banda. Esto puede
ser útil para realizar por ejemplo un mosaico del pixel con mayor valor
de NDVI. En el caso de \texttt{qualityMosaic()} hay que indicar la banda
que se utilizará como la banda de calidad para crear el mosaico.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ mosaicImg }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{ImageCollection}\NormalTok{.}\AttributeTok{mosaic}\NormalTok{()}\OperatorTok{;}
\KeywordTok{var}\NormalTok{ mosaicQualImg }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{ImageCollection}\NormalTok{.}\AttributeTok{qualityMosaic}\NormalTok{(}\OperatorTok{\{}\DataTypeTok{qualityBand}\OperatorTok{:} \StringTok{'ndvi'}\OperatorTok{\}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{tipblock}
El utilizar la función \texttt{mosaic()} siempre le dará preferencia a
los pixeles más recientes ya que la colección por default se encuentra
ordenada por fechas de adquisición de la imagen.

\end{tipblock}

\hypertarget{ejercicio-filtro-de-colecciuxf3n-de-imuxe1genes-y-visualizaciuxf3n}{%
\paragraph{Ejercicio: Filtro de colección de imágenes y
visualización}\label{ejercicio-filtro-de-colecciuxf3n-de-imuxe1genes-y-visualizaciuxf3n}}

Para filtrar la colección de reflectancia de la superficie de imágenes
de Landsat 8 de mayor calidad (tier 1) por fecha, porcentaje de
cobertura de nubes de las imágenes, así como por su ``path'' y ``row''
se puede realizar en un solo paso aplicando múltiples filtros. En este
caso, primero se indica la ruta de la colección que se desea utilizar.
Para encontrar esta ruta se puede buscar la colección de interés en la
barra de \textbf{Search}, después se le da click y del lado izquierdo
aparecerá la ruta de la colección. Por otro lado, en esta misma ventana,
en la pestaña de `BANDS' se puede consultar las bandas y los nombres de
las bandas que contiene cada imagen. Por su parte, en la pestaña de
`IMAGE PROPERTIES' se pueden consultar los metadatos que contienen las
imágenes de esta colección.

\includegraphics[width=500px]{Img/Ruta_coleccion}

Una vez que se conoce la ruta de la colección de interés, se llama dicha
colección. Después se especifican los filtros. En este caso, primero se
filta por fecha, en formato YYYY-MM-DD (año, mes, día), seguido de
filtros de los metadatos de las imágenes: `CLOUD\_COVER\_LAND',
`WRS\_PATH', `WRS\_ROW'. En este caso se debe escribir exactamente igual
el campo de los metadatos (CLOUD\_COVER\_LAND) y en la definición del
filtro se debe explicitar si se desea utilizar los valores que sean
iguales (eq), distintos (neq), mayores (gt), menores (lt), mayores o
igual (gte) o menores o iguales(lte).

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ L8imgCol }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{ImageCollection}\NormalTok{(}\StringTok{"LANDSAT/LC08/C01/T1_SR"}\NormalTok{)}
\NormalTok{  .}\AttributeTok{filterDate}\NormalTok{(}\StringTok{'2015-01-01'}\OperatorTok{,}\StringTok{'2016-01-01'}\NormalTok{)}
\NormalTok{  .}\AttributeTok{filter}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Filter}\NormalTok{.}\AttributeTok{lte}\NormalTok{(}\StringTok{'CLOUD_COVER_LAND'}\OperatorTok{,}\DecValTok{50}\NormalTok{))}
\NormalTok{  .}\AttributeTok{filter}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Filter}\NormalTok{.}\AttributeTok{eq}\NormalTok{(}\StringTok{'WRS_PATH'}\OperatorTok{,}\DecValTok{28}\NormalTok{))}
\NormalTok{  .}\AttributeTok{filter}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Filter}\NormalTok{.}\AttributeTok{eq}\NormalTok{(}\StringTok{'WRS_ROW'}\OperatorTok{,}\DecValTok{46}\NormalTok{))}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

Para explorar algunas características de la colección de imágenes
filtradas podemos escribir el siguiente comando para ver sus
características en la consola.

\begin{Shaded}
\begin{Highlighting}[]
\AttributeTok{print}\NormalTok{(L8imgCol)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

Una vez corrido el comando anterior, en la consola se puede consultar
cuántas imágenes cumplieron con los filtros indicados. En este ejemplo,
la colección filtrada incluye 17 imágenes. Después, se pueden consultar
las características de las imágenes incluidas en la colección. Para
ello, en la consola se le da un click a la flecha ubicada a la isquierda
de la colección en la consola a \textbf{Features}, después a cualquier
imagen (\textbf{Image}) y por último a \textbf{Properties}. Ahí se
pueden ver los metadatos de cada imagen y por lo tanto, los campos de
información que se pueden utilizar para filtrar una colección de
imágenes, basado en los metadatos de las imágenes. Esta información es
la misma que se puede obtener en la barra de \textbf{Search}.

\includegraphics[width=500px]{Img/CamposImgCol}

A continuación podemos ordenar la colección en orden ascendente de
acuerdo al metadato de `CLOUD\_COVER\_LAND'. Posteriormente, se
selecciona la primera imagen, es decir, la de menor cobertura de nubes.
Nótese que en este paso al definir la variable \texttt{L8imgFirst}, ya
únicamente seleccionamos una sola imagen, por lo tanto, éste va a ser un
objeto \texttt{ee.Image}. La función \texttt{first()} devuelve la
primera imagen de una colección y es útil para visualizar el tipo de
información que está en la colección de imágenes.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{L8imgCol }\OperatorTok{=} \VariableTok{L8imgCol}\NormalTok{.}\AttributeTok{sort}\NormalTok{(}\StringTok{'CLOUD_COVER_LAND'}\NormalTok{)}\OperatorTok{;}
\KeywordTok{var}\NormalTok{ L8imgFirst }\OperatorTok{=} \VariableTok{L8imgCol}\NormalTok{.}\AttributeTok{first}\NormalTok{()}\OperatorTok{;} 
\AttributeTok{print}\NormalTok{(L8imgFirst)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

Por último, se puede agregar esta imagen a la ventana de mapas para
visualizar la información. En el primer caso se agrega la información
sin pasar más argumentos. En el segundo caso, se indican las bandas y el
orden que se desea cargar, así como los valores mínimos y máximos del
histograma, y un nombre para la capa.

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{Map}\NormalTok{.}\AttributeTok{addLayer}\NormalTok{(L8imgFirst)}\OperatorTok{;}
\VariableTok{Map}\NormalTok{.}\AttributeTok{addLayer}\NormalTok{(L8imgFirst}\OperatorTok{,\{}\DataTypeTok{bands}\OperatorTok{:}\NormalTok{ [}\StringTok{'B4'}\OperatorTok{,}\StringTok{'B3'}\OperatorTok{,}\StringTok{'B2'}\NormalTok{]}\OperatorTok{,} \DataTypeTok{min}\OperatorTok{:} \DecValTok{95}\OperatorTok{,} \DataTypeTok{max}\OperatorTok{:} \DecValTok{1288}\OperatorTok{\},} \StringTok{'RGB menos nubes L8'}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=500px]{Img/RGBIm}

\hypertarget{ejercicio-enmascaramiento-de-nubes-cuxe1lculo-de-uxedndices-y-reducciuxf3n}{%
\paragraph{Ejercicio: Enmascaramiento de nubes, cálculo de índices y
reducción}\label{ejercicio-enmascaramiento-de-nubes-cuxe1lculo-de-uxedndices-y-reducciuxf3n}}

Utilizando la colección que ya se filtró en el ejercicio anterior se
hará un mapeo y una reducción. En este ejercicio se obtendrá el ndvi
promedio entre 2015 y 2016.

Para calcular el ndvi promedio lo primero que hay que hacer es aplicar
la máscara de nubes que viene en la misma colección de imágenes de
Landsat 8. Al aplicar esta máscara se eliminarán los pixeles cuya
información provenga de nubes. Después se definirá una función para
calcular el ndvi para cada imagen contenida en la colección de imágenes.
Para ello se utiliza la función \texttt{normalizedDifference}, indicando
las bandas del infrarrojo cercano (NIR) y rojo (R). También, se
utilizará la función \texttt{rename} para cambiar el nombre dado por
default a la nueva banda calculada. Posteriormente, se agrega esta banda
a la imagen con \texttt{addBands} Después, se utiliza la función
\texttt{map} para aplicarla a cada una de las imágenes.

Primero se define la función para enmascarar las nubes. En este caso, se
indican los bits que corresponden a nubes y a sombras, es decir, los
bits 5 y 3 respectivamente. Después se selecciona la banda que contiene
la información de la máscara de nubes, la cual en landsat 8 se llama
`pixel\_qa'. Posteriormente se selecciona esta banda y se evalua que en
los dos bits antes mencionados el valor sea igual a cero, es decir, que
sea un pixel clasificado como despejado. En este procedimiento se indica
que la consulta de los valores se debe hacer por bits
(\texttt{bitwiseAnd}) y que las dos evaluaciones deben de ser cero
(\texttt{and}). Posteriormente, se define una máscara en función de esos
valores y se actualiza la máscara (\texttt{updateMask}).

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{function} \AttributeTok{maskL8sr}\NormalTok{(image) }\OperatorTok{\{}
  \KeywordTok{var}\NormalTok{ cloudShadowBitMask }\OperatorTok{=}\NormalTok{ (}\DecValTok{1} \OperatorTok{<<} \DecValTok{3}\NormalTok{)}\OperatorTok{;}
  \KeywordTok{var}\NormalTok{ cloudsBitMask }\OperatorTok{=}\NormalTok{ (}\DecValTok{1} \OperatorTok{<<} \DecValTok{5}\NormalTok{)}\OperatorTok{;}
  \KeywordTok{var}\NormalTok{ qa }\OperatorTok{=} \VariableTok{image}\NormalTok{.}\AttributeTok{select}\NormalTok{(}\StringTok{'pixel_qa'}\NormalTok{)}\OperatorTok{;}
  \KeywordTok{var}\NormalTok{ mask }\OperatorTok{=} \VariableTok{qa}\NormalTok{.}\AttributeTok{bitwiseAnd}\NormalTok{(cloudShadowBitMask).}\AttributeTok{eq}\NormalTok{(}\DecValTok{0}\NormalTok{)}
\NormalTok{                 .}\AttributeTok{and}\NormalTok{(}\VariableTok{qa}\NormalTok{.}\AttributeTok{bitwiseAnd}\NormalTok{(cloudsBitMask).}\AttributeTok{eq}\NormalTok{(}\DecValTok{0}\NormalTok{))}\OperatorTok{;}
  \ControlFlowTok{return} \VariableTok{image}\NormalTok{.}\AttributeTok{updateMask}\NormalTok{(mask)}\OperatorTok{;}
\OperatorTok{\}}
\end{Highlighting}
\end{Shaded}

Posteriormente se define la función para calcular el NDVI de todas las
imágenes.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ ndviCalc }\OperatorTok{=} \KeywordTok{function}\NormalTok{(image)}\OperatorTok{\{}
  \KeywordTok{var}\NormalTok{ ndvi }\OperatorTok{=} \VariableTok{image}\NormalTok{.}\AttributeTok{normalizedDifference}\NormalTok{([}\StringTok{'B5'}\OperatorTok{,}\StringTok{'B4'}\NormalTok{])}\OperatorTok{;}
\NormalTok{  ndvi }\OperatorTok{=} \VariableTok{ndvi}\NormalTok{.}\AttributeTok{rename}\NormalTok{(}\StringTok{'ndvi'}\NormalTok{)}\OperatorTok{;}
    \ControlFlowTok{return} \VariableTok{image}\NormalTok{.}\AttributeTok{addBands}\NormalTok{(ndvi)}\OperatorTok{;}
\OperatorTok{\};}
\end{Highlighting}
\end{Shaded}

\begin{tipblock}
Si no se cambia el nombre de la banda producida por
\texttt{normalizedDifference}, por default, ésta va a recibir el nombre
de \texttt{nd}.

\end{tipblock}

Para ver una muestra de cómo se ve la primer imagen con y sin la máscara
de nubes, primero se agregará la imagen con nubes a la pantalla de mapa.

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{Map}\NormalTok{.}\AttributeTok{addLayer}\NormalTok{(}\VariableTok{L8imgCol}\NormalTok{.}\AttributeTok{first}\NormalTok{()}\OperatorTok{,} 
  \OperatorTok{\{}\DataTypeTok{bands}\OperatorTok{:}\NormalTok{[}\StringTok{'B4'}\OperatorTok{,}\StringTok{'B3'}\OperatorTok{,}\StringTok{'B2'}\NormalTok{]}\OperatorTok{,} \DataTypeTok{min}\OperatorTok{:} \DecValTok{0}\OperatorTok{,} \DataTypeTok{max}\OperatorTok{:} \DecValTok{1300}\OperatorTok{\},}
  \StringTok{'Imagen con nubes'}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=500px]{Img/imNubes}

A continuación se aplican las dos funciones utilizando \texttt{map} y
sobreescribir el objeto L8imgCol.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{L8imgCol }\OperatorTok{=}\NormalTok{ L8imgCol}
\NormalTok{  .}\AttributeTok{map}\NormalTok{(maskL8sr)}
\NormalTok{  .}\AttributeTok{map}\NormalTok{(ndviCalc)}\OperatorTok{;}
\AttributeTok{print}\NormalTok{(L8imgCol)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

Después se muestra la primera imagen sin nubes.

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{Map}\NormalTok{.}\AttributeTok{addLayer}\NormalTok{(}\VariableTok{L8imgCol}\NormalTok{.}\AttributeTok{first}\NormalTok{()}\OperatorTok{,} 
  \OperatorTok{\{}\DataTypeTok{bands}\OperatorTok{:}\NormalTok{[}\StringTok{'B4'}\OperatorTok{,}\StringTok{'B3'}\OperatorTok{,}\StringTok{'B2'}\NormalTok{]}\OperatorTok{,} \DataTypeTok{min}\OperatorTok{:} \DecValTok{0}\OperatorTok{,} \DataTypeTok{max}\OperatorTok{:} \DecValTok{1300}\OperatorTok{\},}
  \StringTok{'Imagen sin nubes'}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=500px]{Img/imSinNubes}

En la consola se puede observar que todas las imágenes ahora contienen
una nueva banda llamada ndvi.

\includegraphics[width=500px]{Img/imConNDVI}

Posteriormente, se puede reducir la colección de imágenes para formar
una sola imagen que represente el valor promedio de ndvi en el periodo
de la colección (2015 - 2016). Para ello se utiliza la función
\texttt{reduce}. También se calculará la desviación estándar de los
valores de NDVI. Estas dos imágenes se guardarán en dos nuevos objetos.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ L8imgMean }\OperatorTok{=} \VariableTok{L8imgCol}\NormalTok{.}\AttributeTok{reduce}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Reducer}\NormalTok{.}\AttributeTok{mean}\NormalTok{())}\OperatorTok{;}
\KeywordTok{var}\NormalTok{ L8imgSD }\OperatorTok{=} \VariableTok{L8imgCol}\NormalTok{.}\AttributeTok{reduce}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Reducer}\NormalTok{.}\AttributeTok{stdDev}\NormalTok{())}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

Por último, agregamos los dos resultados a la pantalla de mapas.

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{Map}\NormalTok{.}\AttributeTok{addLayer}\NormalTok{(L8imgMean}\OperatorTok{,} \OperatorTok{\{}\DataTypeTok{min}\OperatorTok{:-}\FloatTok{0.14}\OperatorTok{,} \DataTypeTok{max}\OperatorTok{:}\FloatTok{0.15}\OperatorTok{\},} \StringTok{'NDVI mean 2015 - 2016'}\NormalTok{)}\OperatorTok{;}
\VariableTok{Map}\NormalTok{.}\AttributeTok{addLayer}\NormalTok{(L8imgSD}\OperatorTok{,} \OperatorTok{\{}\DataTypeTok{min}\OperatorTok{:}\DecValTok{0}\OperatorTok{,} \DataTypeTok{max}\OperatorTok{:}\FloatTok{0.13}\OperatorTok{\},} \StringTok{'NDVI SD 2015 - 2016'}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

El resultado se ve así:

\includegraphics[width=500px]{Img/imNDVI}

Se pueden prender y apagar las capas de la pantalla de mapas utilizando
el menú que se despliega al posicionar el puntero sobre el letrero de
layers y prendiendo y apagando las capas con las palomitas a la
izquierda de cada capa.

Estás funciones van a ser de mucha utilidad para juntar resultados de
varias imágenes en una sola colección o unir dos colecciones (p.ej.,
Landsat 7 y 8).

El último paso será cortar la imagen a una extensión de interés. En este
caso primero se define un área de interés mediante coordenadas:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ geometry }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Polygon}\NormalTok{(}
\NormalTok{        [[[}\OperatorTok{-}\FloatTok{101.82737418916153}\OperatorTok{,} \FloatTok{19.836437094032178}\NormalTok{]}\OperatorTok{,}
\NormalTok{          [}\OperatorTok{-}\FloatTok{101.82737418916153}\OperatorTok{,} \FloatTok{19.368119068204525}\NormalTok{]}\OperatorTok{,}
\NormalTok{          [}\OperatorTok{-}\FloatTok{101.15171500947403}\OperatorTok{,} \FloatTok{19.368119068204525}\NormalTok{]}\OperatorTok{,}
\NormalTok{          [}\OperatorTok{-}\FloatTok{101.15171500947403}\OperatorTok{,} \FloatTok{19.836437094032178}\NormalTok{]]]}\OperatorTok{,} \KeywordTok{null}\OperatorTok{,} \KeywordTok{false}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

Para cortar las dos imágenes que se crearon y mostrarlas en la pantalla
de mapas.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{L8imgMean }\OperatorTok{=} \VariableTok{L8imgMean}\NormalTok{.}\AttributeTok{clip}\NormalTok{(geometry)}\OperatorTok{;}
\NormalTok{L8imgSD }\OperatorTok{=} \VariableTok{L8imgSD}\NormalTok{.}\AttributeTok{clip}\NormalTok{(geometry)}\OperatorTok{;}

\VariableTok{Map}\NormalTok{.}\AttributeTok{addLayer}\NormalTok{(L8imgMean}\OperatorTok{,} \OperatorTok{\{}\DataTypeTok{min}\OperatorTok{:}\FloatTok{0.2}\OperatorTok{,} \DataTypeTok{max}\OperatorTok{:}\FloatTok{0.8}\OperatorTok{\},} \StringTok{'NDVI mean 2015 - 2016 clip'}\NormalTok{)}\OperatorTok{;}
\VariableTok{Map}\NormalTok{.}\AttributeTok{addLayer}\NormalTok{(L8imgSD}\OperatorTok{,} \OperatorTok{\{}\DataTypeTok{min}\OperatorTok{:}\DecValTok{0}\OperatorTok{,} \DataTypeTok{max}\OperatorTok{:}\FloatTok{0.3}\OperatorTok{\},} \StringTok{'NDVI SD 2015 - 2016 clip'}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\hypertarget{ejercicio-cuxe1culo-de-diferencia-de-dos-imuxe1genes-y-exportaciuxf3n-de-resultado.}{%
\paragraph{Ejercicio: Cáculo de diferencia de dos imágenes y exportación
de
resultado.}\label{ejercicio-cuxe1culo-de-diferencia-de-dos-imuxe1genes-y-exportaciuxf3n-de-resultado.}}

Se reutilizarán las funciones previamente definidas para generar un
mosaico igual al ya generado, pero ahora con fechas de 2016-01-01 al
2017-01-01. Primero se filtra la colección de imágenes y se mapean las
funciones para enmascarar las nubes y agregar el NDVI a las imágenes.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ L8imgColT2 }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{ImageCollection}\NormalTok{(}\StringTok{"LANDSAT/LC08/C01/T1_SR"}\NormalTok{)}
\NormalTok{  .}\AttributeTok{filterDate}\NormalTok{(}\StringTok{'2016-01-01'}\OperatorTok{,}\StringTok{'2017-01-01'}\NormalTok{)}
\NormalTok{  .}\AttributeTok{filter}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Filter}\NormalTok{.}\AttributeTok{lte}\NormalTok{(}\StringTok{'CLOUD_COVER_LAND'}\OperatorTok{,}\DecValTok{50}\NormalTok{))}
\NormalTok{  .}\AttributeTok{filter}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Filter}\NormalTok{.}\AttributeTok{eq}\NormalTok{(}\StringTok{'WRS_PATH'}\OperatorTok{,}\DecValTok{28}\NormalTok{))}
\NormalTok{  .}\AttributeTok{filter}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Filter}\NormalTok{.}\AttributeTok{eq}\NormalTok{(}\StringTok{'WRS_ROW'}\OperatorTok{,}\DecValTok{46}\NormalTok{))}\OperatorTok{;}

\NormalTok{L8imgColT2 }\OperatorTok{=}\NormalTok{ L8imgColT2}
\NormalTok{  .}\AttributeTok{map}\NormalTok{(maskL8sr)}
\NormalTok{  .}\AttributeTok{map}\NormalTok{(ndviCalc)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\begin{tipblock}
Para trabajar con una colección de imágenes se sugiere que primero se
apliquen los filtros espaciales y temporales (\texttt{filter}), así como
la selección de las bandas a utilizar (\texttt{select}), antes de
realizar operaciones sobre todas las imágenes de la colección
(\texttt{map}).

\end{tipblock}

Después se selecciona únicamente las bandas de NDVI y se reduce la
colección de imágenes para generar una imagen del valor promedio de
NDVI. Posteriormente, se recorta la imagen a la extensión del polígono
del área de interés. Finalmente, a esta imagen se le restarán los
valores de la imagen del 2015-01-01 al 2016-01-01. De esta manera, los
valores más negativos representarán valores más bajos de NDVI en el año
2 respecto al año 1.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{L8imgColT2 }\OperatorTok{=} \VariableTok{L8imgColT2}\NormalTok{.}\AttributeTok{select}\NormalTok{(}\StringTok{'ndvi'}\NormalTok{)}\OperatorTok{;}
\KeywordTok{var}\NormalTok{ L8imgMeanT2 }\OperatorTok{=} \VariableTok{L8imgColT2}\NormalTok{.}\AttributeTok{reduce}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Reducer}\NormalTok{.}\AttributeTok{mean}\NormalTok{())}\OperatorTok{;}

\NormalTok{L8imgMeanT2 }\OperatorTok{=} \VariableTok{L8imgMeanT2}\NormalTok{.}\AttributeTok{clip}\NormalTok{(geometry)}\OperatorTok{;}

\KeywordTok{var}\NormalTok{ imgDiff }\OperatorTok{=} \VariableTok{L8imgMeanT2}\NormalTok{.}\AttributeTok{subtract}\NormalTok{(L8imgMean)}\OperatorTok{;}  
\end{Highlighting}
\end{Shaded}

Posteriormente, se agrega el resultado a la pantalla de mapas.

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{Map}\NormalTok{.}\AttributeTok{addLayer}\NormalTok{(imgDiff}\OperatorTok{,\{}\DataTypeTok{min}\OperatorTok{:-}\FloatTok{0.3}\OperatorTok{,} \DataTypeTok{max}\OperatorTok{:} \FloatTok{0.1}\OperatorTok{,} 
  \DataTypeTok{palette}\OperatorTok{:}\NormalTok{[}\StringTok{'FF0000'}\OperatorTok{,} \StringTok{'FFFF00'}\OperatorTok{,} \StringTok{'008000'}\NormalTok{] }\OperatorTok{\},} 
  \StringTok{'Diferencia NDVI 2015 vs 2016'}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=500px]{Img/imDifNDVI}

Por último, para exportar el resultado se ingresan varios parámetros a
la función que incluyen: la imagen a exportar, el nombre para guardar el
archivo, la escala de la imagen (tamaño de pixel en metros), formato a
utilizar y si se desea guardar dentro de un folder del Google Drive.
Estos argumentos, al igual que otras funciones en GEE se pasa dentro de
un diccionario.

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{Export}\NormalTok{.}\VariableTok{image}\NormalTok{.}\AttributeTok{toDrive}\NormalTok{(}\OperatorTok{\{}
  \DataTypeTok{image}\OperatorTok{:}\NormalTok{ imgDiff}\OperatorTok{,}
  \DataTypeTok{description}\OperatorTok{:} \StringTok{'DiferenciaNDVI_2016-2017'}\OperatorTok{,}
  \DataTypeTok{scale}\OperatorTok{:} \DecValTok{30}\OperatorTok{,}
  \DataTypeTok{fileFormat}\OperatorTok{:} \StringTok{'GeoTIFF'}\OperatorTok{,}
  \DataTypeTok{folder}\OperatorTok{:} \StringTok{'DiferenciaNDVIL8'}
\OperatorTok{\}}\NormalTok{)}\OperatorTok{;} 
\end{Highlighting}
\end{Shaded}

\newpage

\hypertarget{importaciuxf3n-de-informaciuxf3n-a-gee-assets}{%
\section{Importación de información a GEE
(Assets)}\label{importaciuxf3n-de-informaciuxf3n-a-gee-assets}}

Se pueden importar varios tipos de archivos a GEE para utilizarlos en la
API: imágenes, archivos vector (shapefiles), archivos separados por
comas (csv), colecciones de imágenes exportadas por el mismo GEE y
folders. Para importar cualquier de estos tipos de archivos simplemente
se tiene que ingresar a la pestaña de \textbf{Assets} en al panel
izquierdo y después dar click en \textbf{NEW} e indicar el archivo que
se quiere importar a GEE.

\includegraphics[width=500px]{Img/Asset1}

Posteriormente se da click en \textbf{SELECT} y se seleccionan los
arhivos que se quieren subir. Además, directamente en esta ventana se
pueden agregar algunos campos a la información. Por último, se da click
en \textbf{UPLOAD} (ubicado en la esquina inferior derecha de esta
ventana) para subir los archivos a la cuenta de GEE (ocupando espacio en
Google Drive). Recordar que para archivos shapefile sólo se aceptan
archivos con las extensiones: shp, zip, dbf, prj, shx, cpg, fix, qix,
sbn o shp.xml.

\begin{tipblock}
Si se agrega algún otro archivo que tenga una extensión distinta a las
aceptadas (shp, zip, dbf, prj, shx, cpg, fix, qix, sbn o shp.xml) la
consola va a arrojar un error. En este caso hay que evitar seleccionar
el archivo con la extensión que está provocando el error (p.ej., sbx).

\end{tipblock}

\includegraphics[width=500px]{Img/Asset2}

Una vez que se haya dado click en \textbf{UPLOAD}, el progreso en la
subida del archivo a GEE se puede consultar en la pestaña de
\textbf{TASKS}. Un vez terminado, el archivo podrá ser accesado dentro
de la pestaña de \textbf{Assets}. A veces no aparece el archivo recién
importado, por lo cual se sugiere refrescar los elementos de esta
sección presionando el botón que se encuentra a la derecha de NEW.

\includegraphics[width=500px]{Img/Asset3}

\begin{tipblock}
Al igual que en la pestaña donde se organizan los repositorios y los
códigos, en la pestaña de \textbf{Assets} se puede organizar la
información en folders.

\end{tipblock}

\newpage

\hypertarget{uso-conjunto-de-vectores-e-imuxe1genes}{%
\section{Uso conjunto de vectores e
imágenes}\label{uso-conjunto-de-vectores-e-imuxe1genes}}

Además de las funciones que existen en GEE para realizar operaciones
sobre imágenes, colecciones de imágenes, vectores o colecciones de
vectores, existen algunas funciones que permiten combinar estos dos
tipos de información para realizar ciertos procesos. Los dos tipos de
procesos más comúnmente utilizados son el muestro de una imagen por
vectores o la reducción de una imagen por vectores.

\hypertarget{funciones-comunes-2}{%
\subsection{Funciones comunes}\label{funciones-comunes-2}}

\hypertarget{muestreo-por-informaciuxf3n-vectores}{%
\subsubsection{Muestreo por información
vector(es)}\label{muestreo-por-informaciuxf3n-vectores}}

Este tipo de operaciones normalmente se utilizan para muestrear los
datos de una imagen y obtener por ejemplo, muestras por clases de
coberturas para después entrenar un clasificador o para obtener los
valores de un raster en formato de vector (como puntos). En GEE, existen
tres funciones para hacer este proceso, para un raster completo,
\texttt{ee.Image.sample} o para un rectángulo
\texttt{ee.Image.sampleRectangle} o para varias regiones
\texttt{ee.Image.sampleRegions}. Por ejemplo, la función
\texttt{ee.Image.sample} toma como argumentos el vector utilizado para
determinar el área de muestreo, así como la escala a la que se desea
realizar el muestreo. En este ejemplo, primero se define una geometría y
después se hace el muestreo.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ bosque1 }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Rectangle}\NormalTok{(}\OperatorTok{-}\FloatTok{101.53892}\OperatorTok{,} \FloatTok{19.74148}\OperatorTok{,} 
  \FloatTok{-101.51906}\OperatorTok{,}\FloatTok{19.72362}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ muestreo }\OperatorTok{=}\NormalTok{ L8imgMean}
\NormalTok{  .}\AttributeTok{sample}\NormalTok{(}\OperatorTok{\{}
    \DataTypeTok{region}\OperatorTok{:}\NormalTok{ bosque1}\OperatorTok{,}
    \DataTypeTok{scale}\OperatorTok{:}\DecValTok{30}
  \OperatorTok{\}}\NormalTok{)}\OperatorTok{;}

\AttributeTok{print}\NormalTok{(muestreo}\OperatorTok{,} \StringTok{'muestreo'}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\begin{tipblock}
Si se desea obtener la información de un muestreo de una imagen con su
correspondiente información espacial, se puede utilizar el argumento
\texttt{geometries:\ true}. Esto dará como resultado una tabla con la
misma información, pero con las coordenadas geográficas de los centros
de los pixeles de la imagen muestreada.

\end{tipblock}

\hypertarget{reducciuxf3n-de-una-imagen-por-regiuxf3nes}{%
\subsubsection{Reducción de una imagen por
región(es)}\label{reducciuxf3n-de-una-imagen-por-regiuxf3nes}}

Este tipo de operaciones normalmente se utilizan para resumir los
valores de algún raster por áreas de interés. En GEE, existen dos
funciones para realizar este proceso, para una única región
\texttt{ee.Image.reduceRegion} o para varias regiones
\texttt{ee.Image.reduceRegions}. Por ejemplo, la función
\texttt{ee.Image.reduceRegion} permite obtener estadísticas de la imagen
en la extensión indicada por el vector. En este caso, además hay que
indicar el reductor que se desea utilizar.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ reduccion }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{Image}\NormalTok{(L8imgMean)}
\NormalTok{  .}\AttributeTok{reduceRegion}\NormalTok{(}\OperatorTok{\{}
    \DataTypeTok{reducer}\OperatorTok{:} \VariableTok{ee}\NormalTok{.}\VariableTok{Reducer}\NormalTok{.}\AttributeTok{mean}\NormalTok{()}\OperatorTok{,}
    \DataTypeTok{geometry}\OperatorTok{:}\NormalTok{ bosque1}\OperatorTok{,}
    \DataTypeTok{scale}\OperatorTok{:} \DecValTok{30}
  \OperatorTok{\}}\NormalTok{)}\OperatorTok{;}
  
\AttributeTok{print}\NormalTok{(reduccion}\OperatorTok{,} \StringTok{'reduccion'}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\begin{tipblock}
En algunas ocasiones, los procesos de \texttt{reduceRegions} o
\texttt{sampleRegions} pueden demandar muchos recursos computacionales y
arrojar un error de `computation timed out'. En estos casos, se pueden
utilizar los argumentos de \texttt{scale} o \texttt{tileScale} para
lograr que este corra. \texttt{Scale} permite aumentar el tamaño de
pixel al que se va a resumir la información, por lo cual permite reducir
los costos computacionales. De igual manera, \texttt{tileScale} permite
definir un factor de reescalamiento que permite reducir la carga
computacional de un proceso.

\end{tipblock}

\newpage

\hypertarget{clasificaciuxf3n-supervisada}{%
\section{Clasificación supervisada}\label{clasificaciuxf3n-supervisada}}

Dentro de GEE se pueden hacer clasificaciones supervisadas con algunos
algoritmos populares como CART (Classification and Regression Trees),
Random Forests, Naive Bayes, Gradient Tree Boost, Support Vector
Machine, MaxEnt (Maximum Entropy) y Decistion Trees. Como todos los
demás objetos dentro de GEE tienen su propio tipo de objetos contenedor.

\hypertarget{classifier}{%
\subsection{Classifier}\label{classifier}}

Los objetos \texttt{ee.Classifier} son los objetos que van a permitir
trabajar con clasificadores dentro de GEE. Algunos ejemplos de estos
son: \texttt{ee.Classifier.smileCART},
\texttt{ee.Classifier.smileRandomForest},
\texttt{ee.Classifier.amnhMaxent}, entre otros. De nuevo, todos los
algoritmos disponibles en GEE, así como los argumentos que aceptan, se
pueden consultar en la página de ayuda, en la pestaña de referencia
(Reference) en el apartado de librerías del cliente (Client libraries).

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ rfClassif }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Classifier}\NormalTok{.}\AttributeTok{smileRandomForest}\NormalTok{()}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\hypertarget{entrenamiento}{%
\subsection{Entrenamiento}\label{entrenamiento}}

Debido a que estos clasificadores trabajan en un esquema supervisado,
requieren de la provisión de muestras de entrenamiento para entrenar al
algoritmo. Esto se puede hacer directamente en la API, aunque quizás no
sea lo más cómodo para el usuario. En este paso se recomienda capturar
los datos de entrenamiento en algún SIG, p.ej., QGIS, y luego importar
el archivo vector a GEE (ver sección importar datos a GEE).

Una vez definido el clasificador que se va a utilizar, para entrenar al
clasificador se utiliza la función \texttt{train}. Los argumentos de
esta función indican los vectores utilizados como áreas de
entrenamiento, el nombre del campo que indica el esquema de
clasificación dentro de la colección de vectores, así como las bandas a
utilizar de la imagen.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ trainedClassifier }\OperatorTok{=} \VariableTok{rfClassif}\NormalTok{.}\AttributeTok{train}\NormalTok{(}\OperatorTok{\{}
  \DataTypeTok{features}\OperatorTok{:}\NormalTok{ training}\OperatorTok{,}
  \DataTypeTok{classProperty}\OperatorTok{:} \StringTok{'clase'}\OperatorTok{,}
  \DataTypeTok{inputProperties}\OperatorTok{:}\NormalTok{ [}\StringTok{'CB'}\OperatorTok{,}\StringTok{'B'}\OperatorTok{,}\StringTok{'G'}\OperatorTok{,}\StringTok{'R'}\OperatorTok{,}\StringTok{'NIR'}\OperatorTok{,}\StringTok{'SWIR1'}\OperatorTok{,}\StringTok{'SWIR2'}\NormalTok{]}
\OperatorTok{\}}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\hypertarget{clasificaciuxf3n}{%
\subsection{Clasificación}\label{clasificaciuxf3n}}

Una vez que se tiene entrenado el clasificador, el siguiente paso consta
de clasificar la imagen completa en las clases de interés. Para ello, se
utiliza la función \texttt{classify}, la cual permite hacer predicciones
sobre la clase de cada pixel, a partir de los insumos indicados en la
fase de entrenamiento. Por ejemplo:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ classifiedImg }\OperatorTok{=} \VariableTok{imagen}\NormalTok{.}\AttributeTok{classify}\NormalTok{(trainedClassifier)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\hypertarget{evaluaciuxf3n}{%
\subsection{Evaluación}\label{evaluaciuxf3n}}

La última fase de una clasificación consta de la evaluación de los
resultados utilizando otro conjunto de datos que no haya sido utilizado
en la fase de entrenamiento. Comúnmente a estos datos se le conoce como
los datos de validación o verificación. En este caso, primero se extrae
la información de las clases predichas para los datos de validación y
después se compara con la información de referencia. Comúnmnete se
utiliza una matriz de confusión para realizar dicha evaluación. En GEE
se puede obtener dicha matriz mediante la función \texttt{errorMatrix}.
Además, para calcular la precisión total de la clasificación sobre los
datos de validación se utiliza la función \texttt{accuracy}. Por
ejemplo:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ validErrMat }\OperatorTok{=} \VariableTok{validacion}\NormalTok{.}\AttributeTok{errorMatrix}\NormalTok{(}\StringTok{'claseRef'}\OperatorTok{,} \StringTok{'clasePred'}\NormalTok{)}\OperatorTok{;}
\KeywordTok{var}\NormalTok{ validAcc }\OperatorTok{=} \VariableTok{validacion}\NormalTok{.}\AttributeTok{accuracy}\NormalTok{()}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\hypertarget{ejercicio-clasificaciuxf3n}{%
\subsubsection{Ejercicio:
Clasificación}\label{ejercicio-clasificaciuxf3n}}

En este ejercicio se hará una clasificación supervisada utilizando el
algoritmo Random Forests. Para ello se utilizarán 7 polígonos como
sitios de entrenamiento, pertenecientes a 4 clases: Bosque, No bosque,
Agua y Urbano. Estos polígonos se definirán directamente en la API a
través de sus coordenadas como objetos \texttt{ee.Geometry} de tipo
rectangulo. Posteriormente, cada polígono se transforma en un objeto de
tipo vector (\texttt{Feature}) y se le asigna la propiedad de `clase'
como número a través de un diccionario. Por último, se hace una
colección de vectores.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ bosque1 }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Rectangle}\NormalTok{(}\OperatorTok{-}\FloatTok{101.53892}\OperatorTok{,} \FloatTok{19.74148}\OperatorTok{,} 
  \FloatTok{-101.51906}\OperatorTok{,}\FloatTok{19.72362}\NormalTok{)}\OperatorTok{;}
\KeywordTok{var}\NormalTok{ bosque2 }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Rectangle}\NormalTok{(}\OperatorTok{-}\FloatTok{101.64826}\OperatorTok{,} \FloatTok{19.49264}\OperatorTok{,} 
  \FloatTok{-101.62839}\OperatorTok{,}\FloatTok{19.47545}\NormalTok{)}\OperatorTok{;}
\KeywordTok{var}\NormalTok{ noBosque1 }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Rectangle}\NormalTok{(}\OperatorTok{-}\FloatTok{101.35448}\OperatorTok{,} \FloatTok{19.65992}\OperatorTok{,} 
  \FloatTok{-101.34509}\OperatorTok{,}\FloatTok{19.65990}\NormalTok{)}\OperatorTok{;}
\KeywordTok{var}\NormalTok{ noBosque2 }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Rectangle}\NormalTok{(}\OperatorTok{-}\FloatTok{101.56907}\OperatorTok{,} \FloatTok{19.58312}\OperatorTok{,} 
  \FloatTok{-101.54939}\OperatorTok{,}\FloatTok{19.56435}\NormalTok{)}\OperatorTok{;}
\KeywordTok{var}\NormalTok{ urbano }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Rectangle}\NormalTok{(}\OperatorTok{-}\FloatTok{101.20999}\OperatorTok{,} \FloatTok{19.71300}\OperatorTok{,} 
  \FloatTok{-101.19688}\OperatorTok{,}\FloatTok{19.70338}\NormalTok{)}\OperatorTok{;}
\KeywordTok{var}\NormalTok{ agua1 }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Rectangle}\NormalTok{(}\OperatorTok{-}\FloatTok{101.60826}\OperatorTok{,} \FloatTok{19.66885}\OperatorTok{,} 
  \FloatTok{-101.58569}\OperatorTok{,}\FloatTok{19.64316}\NormalTok{)}\OperatorTok{;}
\KeywordTok{var}\NormalTok{ agua2 }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Rectangle}\NormalTok{(}\OperatorTok{-}\FloatTok{101.74686}\OperatorTok{,} \FloatTok{19.43937}\OperatorTok{,} 
  \FloatTok{-101.733453}\OperatorTok{,}\FloatTok{19.427012}\NormalTok{)}\OperatorTok{;}

\KeywordTok{var}\NormalTok{ polígonos }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{FeatureCollection}\NormalTok{([}
  \VariableTok{ee}\NormalTok{.}\AttributeTok{Feature}\NormalTok{(noBosque1}\OperatorTok{,} \OperatorTok{\{}\StringTok{'clase'}\OperatorTok{:} \DecValTok{0}\OperatorTok{\}}\NormalTok{)}\OperatorTok{,}
  \VariableTok{ee}\NormalTok{.}\AttributeTok{Feature}\NormalTok{(noBosque2}\OperatorTok{,} \OperatorTok{\{}\StringTok{'clase'}\OperatorTok{:} \DecValTok{0}\OperatorTok{\}}\NormalTok{)}\OperatorTok{,}
  \VariableTok{ee}\NormalTok{.}\AttributeTok{Feature}\NormalTok{(bosque1}\OperatorTok{,} \OperatorTok{\{}\StringTok{'clase'}\OperatorTok{:} \DecValTok{1}\OperatorTok{\}}\NormalTok{)}\OperatorTok{,}
  \VariableTok{ee}\NormalTok{.}\AttributeTok{Feature}\NormalTok{(bosque2}\OperatorTok{,} \OperatorTok{\{}\StringTok{'clase'}\OperatorTok{:} \DecValTok{1}\OperatorTok{\}}\NormalTok{)}\OperatorTok{,}
  \VariableTok{ee}\NormalTok{.}\AttributeTok{Feature}\NormalTok{(agua1}\OperatorTok{,} \OperatorTok{\{}\StringTok{'clase'}\OperatorTok{:} \DecValTok{2}\OperatorTok{\}}\NormalTok{)}\OperatorTok{,}
  \VariableTok{ee}\NormalTok{.}\AttributeTok{Feature}\NormalTok{(agua2}\OperatorTok{,} \OperatorTok{\{}\StringTok{'clase'}\OperatorTok{:} \DecValTok{2}\OperatorTok{\}}\NormalTok{)}\OperatorTok{,}
  \VariableTok{ee}\NormalTok{.}\AttributeTok{Feature}\NormalTok{(urbano}\OperatorTok{,} \OperatorTok{\{}\StringTok{'clase'}\OperatorTok{:} \DecValTok{3}\OperatorTok{\}}\NormalTok{)}\OperatorTok{,}
\NormalTok{])}\OperatorTok{;}

\VariableTok{Map}\NormalTok{.}\AttributeTok{addLayer}\NormalTok{(polígonos}\OperatorTok{,} \OperatorTok{\{\},} \StringTok{'polígonosEntrenamiento'}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

A continuación se vuelve a filtrar la colección de Landsat 8 por fecha,
porcentaje de nubosidad sobre la superficie terrestre, y un filtro
espacial. En este caso, se usó la función \texttt{filterBounds} que
permite filtrar espacialmente la colección de acuerdo a la extensión del
polígono de interés. Por último, se aplica la función para enmascarar
nubes a todas las imágenes de la colección usando \texttt{map}.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ L8imgCol }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{ImageCollection}\NormalTok{(}\StringTok{"LANDSAT/LC08/C01/T1_SR"}\NormalTok{)}
\NormalTok{  .}\AttributeTok{filterBounds}\NormalTok{(polígonos)}
\NormalTok{  .}\AttributeTok{filterDate}\NormalTok{(}\StringTok{'2015-01-01'}\OperatorTok{,}\StringTok{'2016-01-01'}\NormalTok{)}
\NormalTok{  .}\AttributeTok{filter}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Filter}\NormalTok{.}\AttributeTok{lte}\NormalTok{(}\StringTok{'CLOUD_COVER_LAND'}\OperatorTok{,}\DecValTok{50}\NormalTok{))}
\NormalTok{  .}\AttributeTok{map}\NormalTok{(maskL8sr)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

El siguiente paso consta de reducir la colección para generar una sola
imagen con el valor promedio para todas las bandas. Después, se corta la
imagen a la extensión del área de estudio. Ya que no se van a utilizar
todas las bandas de la imagen para la clasificación, se indica el nombre
de las bandas que se van a utilizar dentro de una lista. Por último, se
van a renombrar las bandas para recordar más fácilmente el espectro de
cada banda.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ L8imgMean }\OperatorTok{=} \VariableTok{L8imgCol}\NormalTok{.}\AttributeTok{reduce}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\VariableTok{Reducer}\NormalTok{.}\AttributeTok{mean}\NormalTok{())}
\NormalTok{  .}\AttributeTok{select}\NormalTok{([}\StringTok{'B1_mean'}\OperatorTok{,}\StringTok{'B2_mean'}\OperatorTok{,}\StringTok{'B3_mean'}\OperatorTok{,}\StringTok{'B4_mean'}\OperatorTok{,}\StringTok{'B5_mean'}\OperatorTok{,}\StringTok{'B6_mean'}\OperatorTok{,}\StringTok{'B7_mean'}\NormalTok{])}
\NormalTok{  .}\AttributeTok{rename}\NormalTok{([}\StringTok{'CB'}\OperatorTok{,}\StringTok{'B'}\OperatorTok{,}\StringTok{'G'}\OperatorTok{,}\StringTok{'R'}\OperatorTok{,}\StringTok{'NIR'}\OperatorTok{,}\StringTok{'SWIR1'}\OperatorTok{,}\StringTok{'SWIR2'}\NormalTok{])}
\NormalTok{  .}\AttributeTok{clip}\NormalTok{(geometry)}\OperatorTok{;}

\AttributeTok{print}\NormalTok{(L8imgMean)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

Una vez que ya se tiene la imagen sobre la que se va a hacer la
clasificación, se muestrean los valores de los pixeles que se encuentren
dentro de cada polígono de los datos de entrenamiento utilizando la
función \texttt{sampleRegions}. A esta función hay que indicar la
colección de vectores que se va a utilizar, así como la propiedad de los
vectores que indica la clase y la escala a la que se van a muesrear los
pixeles en m. El resultado de este procedimiento corresponde a una
colección de vectores, en la cual cada vector corresponde a un pixel
dentro de un polígono de entrenamiento. De tal manera, para cada vector
se indica la clase a la que pertenece, así como el valor en cada una de
las bandas en la imagen muestreada.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ training }\OperatorTok{=}\NormalTok{ L8imgMean}
\NormalTok{  .}\AttributeTok{sampleRegions}\NormalTok{(}\OperatorTok{\{}
    \DataTypeTok{collection}\OperatorTok{:}\NormalTok{ polígonos}\OperatorTok{,}
    \DataTypeTok{properties}\OperatorTok{:}\NormalTok{ [}\StringTok{'clase'}\NormalTok{]}\OperatorTok{,}
    \DataTypeTok{scale}\OperatorTok{:} \DecValTok{30}
  \OperatorTok{\}}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

El siguiente paso es entrenar al clasificador utilizando la colección de
vectores anterior. En este caso, se va a utilizar el algoritmo Random
Forests. Para llamar este algoritmo se utiliza
\texttt{ee.Classifier.smileRandomForest()}. En este caso, se utilizarán
30 árboles de clasificación. Posteriormente, se entrena este algoritmo
mediante la función \texttt{train}. Los argumentos para la función
\texttt{train} se pasan como un diccionario el cual indica la colección
de vectores a utilizar para el entrenamiento, el nombre de la clase
objetivo y el nombre de las propiedades de la imagen, es decir, el
nombre de las bandas.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ trainedClassifier }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Classifier}\NormalTok{.}\AttributeTok{smileRandomForest}\NormalTok{(}\DecValTok{30}\NormalTok{).}\AttributeTok{train}\NormalTok{(}\OperatorTok{\{}
  \DataTypeTok{features}\OperatorTok{:}\NormalTok{ training}\OperatorTok{,}
  \DataTypeTok{classProperty}\OperatorTok{:} \StringTok{'clase'}\OperatorTok{,}
  \DataTypeTok{inputProperties}\OperatorTok{:}\NormalTok{ [}\StringTok{'CB'}\OperatorTok{,}\StringTok{'B'}\OperatorTok{,}\StringTok{'G'}\OperatorTok{,}\StringTok{'R'}\OperatorTok{,}\StringTok{'NIR'}\OperatorTok{,}\StringTok{'SWIR1'}\OperatorTok{,}\StringTok{'SWIR2'}\NormalTok{]}
\OperatorTok{\}}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

Una vez entrenado el clasificador, se puede clasificar la imagen
completa utilizando la función \texttt{classify}. Como argumentos de
esta función se indica el clasificador entrenado que se desea utilizar.
El resultado de la función \texttt{classify} va a ser un objeto de tipo
\texttt{ee.Image} que contiene la clase predicha en el campo
\texttt{classification}. Por último, se agrega a la pantalla de mapas
para ver los resultados.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ classifiedImg }\OperatorTok{=} \VariableTok{L8imgMean}\NormalTok{.}\AttributeTok{classify}\NormalTok{(trainedClassifier)}\OperatorTok{;}

\VariableTok{Map}\NormalTok{.}\AttributeTok{addLayer}\NormalTok{(classifiedImg}\OperatorTok{,\{}\DataTypeTok{min}\OperatorTok{:}\DecValTok{0}\OperatorTok{,} \DataTypeTok{max}\OperatorTok{:}\DecValTok{3}\OperatorTok{,} 
  \DataTypeTok{palette}\OperatorTok{:}\NormalTok{[}\StringTok{'#fcff21'}\OperatorTok{,}\StringTok{'#20da25'}\OperatorTok{,}\StringTok{'#05a9da'}\OperatorTok{,}\StringTok{'#dadada'}\NormalTok{]}\OperatorTok{\},}
  \StringTok{'Clasificación RF L8'}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=500px]{Img/RFClass}

Posteriormente, se puede hacer un gráfico para analizar el perfil
espectral de las clases de interés. Para hacer esto, primero se agrega
la banda con la clasificación a la imagen que contiene la media de la
reflectancia de la superficie (\texttt{L8imgMean}). Después, se utiliza
la función \texttt{ui.Chart.image.byClass} para crear un gráfico por
clase. Como argumentos a esta función se indica el nombre de la banda
que contiene las categorías de la clasificación
(\texttt{\textquotesingle{}classification\textquotesingle{}}), el
reductor que se va a utilizar para resumir los valores por clase
(\texttt{ee.Reducer.mean()}), las regiones de las cuales se va a obtener
esta información (\texttt{polígonos}), las etiquetas de las clases
\texttt{{[}\textquotesingle{}NoBosque\textquotesingle{},\textquotesingle{}Bosque\textquotesingle{},\textquotesingle{}Agua\textquotesingle{},\textquotesingle{}Urbano\textquotesingle{}{]}},
la escala en m de trabajo para aplicar el reductor (\texttt{240}) y
algunas opciones para ponerle título y asignar los colores al gráfico.
Por último, hay que imprimir el gráfico con la función de \texttt{print}
y el gráfico aparecerá en la consola.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ imgConClass }\OperatorTok{=} \VariableTok{L8imgMean}\NormalTok{.}\AttributeTok{addBands}\NormalTok{(classifiedImg)}\OperatorTok{;}
  
\KeywordTok{var}\NormalTok{ chartClassSpec }\OperatorTok{=} \VariableTok{ui}\NormalTok{.}\VariableTok{Chart}\NormalTok{.}\VariableTok{image}\NormalTok{.}\AttributeTok{byClass}\NormalTok{(}\OperatorTok{\{}
  \DataTypeTok{image}\OperatorTok{:}\NormalTok{ imgConClass}\OperatorTok{,}
  \DataTypeTok{classBand}\OperatorTok{:} \StringTok{'classification'}\OperatorTok{,}
  \DataTypeTok{reducer}\OperatorTok{:} \VariableTok{ee}\NormalTok{.}\VariableTok{Reducer}\NormalTok{.}\AttributeTok{mean}\NormalTok{()}\OperatorTok{,}
  \DataTypeTok{region}\OperatorTok{:}\NormalTok{ polígonos}\OperatorTok{,}
  \DataTypeTok{classLabels}\OperatorTok{:}\NormalTok{ [}\StringTok{'NoBosque'}\OperatorTok{,}\StringTok{'Bosque'}\OperatorTok{,}\StringTok{'Agua'}\OperatorTok{,}\StringTok{'Urbano'}\NormalTok{]}\OperatorTok{,}
  \DataTypeTok{scale}\OperatorTok{:} \DecValTok{240}
\OperatorTok{\}}\NormalTok{).}\AttributeTok{setOptions}\NormalTok{(}\OperatorTok{\{}
  \DataTypeTok{title}\OperatorTok{:} \StringTok{'Perfil espectral por clase'}\OperatorTok{,}
  \DataTypeTok{colors}\OperatorTok{:}\NormalTok{ [}\StringTok{'#fcff21'}\OperatorTok{,}\StringTok{'#20da25'}\OperatorTok{,}\StringTok{'#05a9da'}\OperatorTok{,}\StringTok{'#dadada'}\NormalTok{]}
\OperatorTok{\}}\NormalTok{)}\OperatorTok{;}

\AttributeTok{print}\NormalTok{(chartClassSpec)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=500px]{Img/SpectralSignClass}

Una vez que se tiene la clasificación del área de interés se van a
cargar los datos de verificación para calcular la matriz de error y la
precisión total de la clasificación. Primero se carga la información de
los polígonos de verificación.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ bosque3 }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Rectangle}\NormalTok{(}\OperatorTok{-}\FloatTok{101.62016}\OperatorTok{,}\FloatTok{19.61895}\OperatorTok{,} 
  \FloatTok{-101.60543}\OperatorTok{,}\FloatTok{19.60492}\NormalTok{)}\OperatorTok{;}
\KeywordTok{var}\NormalTok{ noBosque3 }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Rectangle}\NormalTok{(}\OperatorTok{-}\FloatTok{101.313746}\OperatorTok{,}\FloatTok{19.716531}\OperatorTok{,} 
  \FloatTok{-101.306380}\OperatorTok{,}\FloatTok{19.709505}\NormalTok{)}\OperatorTok{;}
\KeywordTok{var}\NormalTok{ urbano2 }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Rectangle}\NormalTok{(}\OperatorTok{-}\FloatTok{101.609880}\OperatorTok{,}\FloatTok{19.517665}\OperatorTok{,} 
  \FloatTok{-101.602523}\OperatorTok{,}\FloatTok{19.510752}\NormalTok{)}\OperatorTok{;}
\KeywordTok{var}\NormalTok{ agua3 }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\VariableTok{Geometry}\NormalTok{.}\AttributeTok{Rectangle}\NormalTok{(}\OperatorTok{-}\FloatTok{101.272720}\OperatorTok{,}\FloatTok{19.612100}\OperatorTok{,} 
  \FloatTok{-101.272668}\OperatorTok{,}\FloatTok{19.611594}\NormalTok{)}\OperatorTok{;}

\KeywordTok{var}\NormalTok{ polígonosVerif }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{FeatureCollection}\NormalTok{([}
  \VariableTok{ee}\NormalTok{.}\AttributeTok{Feature}\NormalTok{(noBosque3}\OperatorTok{,} \OperatorTok{\{}\StringTok{'clase'}\OperatorTok{:} \DecValTok{0}\OperatorTok{\}}\NormalTok{)}\OperatorTok{,}
  \VariableTok{ee}\NormalTok{.}\AttributeTok{Feature}\NormalTok{(bosque3}\OperatorTok{,} \OperatorTok{\{}\StringTok{'clase'}\OperatorTok{:} \DecValTok{1}\OperatorTok{\}}\NormalTok{)}\OperatorTok{,}
  \VariableTok{ee}\NormalTok{.}\AttributeTok{Feature}\NormalTok{(agua3}\OperatorTok{,} \OperatorTok{\{}\StringTok{'clase'}\OperatorTok{:} \DecValTok{2}\OperatorTok{\}}\NormalTok{)}\OperatorTok{,}
  \VariableTok{ee}\NormalTok{.}\AttributeTok{Feature}\NormalTok{(urbano2}\OperatorTok{,} \OperatorTok{\{}\StringTok{'clase'}\OperatorTok{:} \DecValTok{3}\OperatorTok{\}}\NormalTok{)}\OperatorTok{,}
\NormalTok{])}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

El siguiente paso es extraer la información de la imagen clasificada, de
acuerdo con la extensión de los datos de verificación. Este paso es
exactamente igual al que se hizo con los datos de entrenamiento, pero
ahora utilizando los datos de verificación y la imagen clasificada en
lugar de la imagen de reflectancia. De igual manera, el resultado de
este paso es una colección de vectores.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ validating }\OperatorTok{=}\NormalTok{ classifiedImg}
\NormalTok{  .}\AttributeTok{sampleRegions}\NormalTok{(}\OperatorTok{\{}
  \DataTypeTok{collection}\OperatorTok{:}\NormalTok{ polígonosVerif}\OperatorTok{,}
  \DataTypeTok{properties}\OperatorTok{:}\NormalTok{ [}\StringTok{'clase'}\NormalTok{]}\OperatorTok{,}
  \DataTypeTok{scale}\OperatorTok{:} \DecValTok{30}\OperatorTok{,}
\OperatorTok{\}}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

El siguiente paso es calcular la matriz de error mediante la función
\texttt{errorMatrix} indicando en primer lugar el campo de la clase
``verdadera'' (`clase') y en segundo lugar el campo de la predicción
(`classification'). Después, se van a mostrar estos dos objetos en la
consola mediante print para inspeccionar su contenido.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ validErrMat }\OperatorTok{=} \VariableTok{validating}\NormalTok{.}\AttributeTok{errorMatrix}\NormalTok{(}\StringTok{'clase'}\OperatorTok{,} \StringTok{'classification'}\NormalTok{)}\OperatorTok{;}
\KeywordTok{var}\NormalTok{ validAcc }\OperatorTok{=} \VariableTok{validErrMat}\NormalTok{.}\AttributeTok{accuracy}\NormalTok{()}\OperatorTok{;}

\AttributeTok{print}\NormalTok{(}\StringTok{'Validation error matrix: '}\OperatorTok{,}\NormalTok{ validErrMat)}\OperatorTok{;}
\AttributeTok{print}\NormalTok{(}\StringTok{'Validation overall accuracy: '}\OperatorTok{,}\NormalTok{ validAcc)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\begin{tipblock}
Por default la imagen que se obtiene de una función \texttt{.classify}
obtiene el nombre de `classification', por eso la propiedad que se
muestrea en el paso de \texttt{sampleRegions} y con la que se hace la
matriz de error \texttt{errorMatrix} se llama `classification'.

\end{tipblock}

Para exportar estos resultados primero hay que pasar los datos a tipo
vector. Para ello, se va a crear una vector sin geometría (que es lo que
indica el \texttt{null} en el primer campo del \texttt{ee.Feature}),
seguido de un diccionario que contiene los datos que se desean exportar
(que podrían interpretarse como una tabla de atributos). En el caso de
la matriz de error, primero se debe convertir a un arreglo mediante la
función \texttt{.array()}.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ expConfMatrix }\OperatorTok{=}  \VariableTok{ee}\NormalTok{.}\AttributeTok{Feature}\NormalTok{(}\KeywordTok{null}\OperatorTok{,} \OperatorTok{\{}\DataTypeTok{matrix}\OperatorTok{:} \VariableTok{validErrMat}\NormalTok{.}\AttributeTok{array}\NormalTok{()}\OperatorTok{\}}\NormalTok{)}\OperatorTok{;}
\KeywordTok{var}\NormalTok{ expAccuracy }\OperatorTok{=} \VariableTok{ee}\NormalTok{.}\AttributeTok{Feature}\NormalTok{(}\KeywordTok{null}\OperatorTok{,} \VariableTok{ee}\NormalTok{.}\AttributeTok{Dictionary}\NormalTok{(}\OperatorTok{\{}\DataTypeTok{Accuracy}\OperatorTok{:}\NormalTok{ validAcc}\OperatorTok{\}}\NormalTok{))}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

Posteriormente se define una función para exportar
(\texttt{ExportTable}) y se utiliza para exportar la matriz de error y
el valor de precisión total. Esta función toma dos argumentos, el objeto
a exportar y el nombre que se le va a dar al archivo a exportar. Debido
a que la función \texttt{Export.table.toDrive} sólo permite exportar
objetos de tipo \texttt{ee.FeatureCollection}, se debe meter a los
objetos de tipo \texttt{ee.Feature} en un contenedor
\texttt{ee.FeatureCollection}. Por último, se debe indicar que el
formato para guardar el archivo es uno separado por comas (CSV) y se
puede indicar el folder dentro del que se quiere guardar la tabla
exportada.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{var}\NormalTok{ exportTable }\OperatorTok{=} \KeywordTok{function}\NormalTok{(feature}\OperatorTok{,}\NormalTok{ name)}\OperatorTok{\{}
  \VariableTok{Export}\NormalTok{.}\VariableTok{table}\NormalTok{.}\AttributeTok{toDrive}\NormalTok{(}\OperatorTok{\{}
    \DataTypeTok{collection}\OperatorTok{:}\NormalTok{ feature}\OperatorTok{,}
    \DataTypeTok{description}\OperatorTok{:}\NormalTok{ name}\OperatorTok{,}
    \DataTypeTok{folder}\OperatorTok{:} \StringTok{'Clasificacion_RF'}\OperatorTok{,}
    \DataTypeTok{fileFormat}\OperatorTok{:} \StringTok{'CSV'}
 \OperatorTok{\}}\NormalTok{)}\OperatorTok{;}
\OperatorTok{\};}

\AttributeTok{exportTable}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\AttributeTok{FeatureCollection}\NormalTok{(expConfMatrix)}\OperatorTok{,} \StringTok{'confMatrix'}\NormalTok{)}\OperatorTok{;}
\AttributeTok{exportTable}\NormalTok{(}\VariableTok{ee}\NormalTok{.}\AttributeTok{FeatureCollection}\NormalTok{(expAccuracy)}\OperatorTok{,} \StringTok{'validAcc'}\NormalTok{)}\OperatorTok{;}
\end{Highlighting}
\end{Shaded}

\end{document}
