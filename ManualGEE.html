<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Manual de Google Earth Engine" />
<meta property="og:type" content="book" />





<meta name="author" content="Jonathan Vidal Solórzano Villegas y Gabriel Alejandro Perilla Suárez" />



<meta name="description" content="Manual de Google Earth Engine">

<title>Manual de Google Earth Engine</title>

<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
/* show arrow before summary tag as in bootstrap
TODO: remove if boostrap in updated in html_document (rmarkdown#1485) */
details > summary {
  display: list-item;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<!--bookdown:title:start-->
<div id="header">
<h1 class="title">Manual de Google Earth Engine</h1>
<h4 class="author"><em>Jonathan Vidal Solórzano Villegas y Gabriel Alejandro Perilla Suárez</em></h4>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
<div id="TOC">
yes
</div>
<!--bookdown:toc:end-->

<!--bookdown:body:start-->
<!--chapter:end:index.Rmd-->
<div id="introducción" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Introducción</h1>
<div id="propósito-del-libro" class="section level2" number="1.1">
<h2 number="1.1"><span class="header-section-number">1.1</span> Propósito del libro</h2>
<p>La idea del presente manual es fungir como una guía introductoria que ayude a los nuevos usuarios de Google Earth Engine (GEE) a entender su estructura, funcionamiento y capacidades y facilitar el uso de esta poderosa herramienta gratuita. Existen algunos artículos previos que han presentado las características básicas de GEE, sin embargo, la mayoría están escritas en inglés (Gorelick et al, 2017; Amani et al., 2020), aunque en español existen algunas publicaciones también (ver Perilla y Mas, [2020]). La documentación propia de GEE ya existe en inglés, pero con este manual escrito en español se busca ampliar el público objetivo y aumentar el alcance del programa hacia países hispanoparlantes.</p>
<p>Es importante aclarar que esta guía es solamente introductoria, por lo tanto, hay muchas funciones que se pueden realizar en GEE que quedan fuera de este documento (por ejemplo, los análisis de series de tiempo o la creación de aplicaciones). Además, debido a su carácter introductorio, este manual está dirigido a usuarios con y sin conocimientos previos de programación. GEE está en constante actualización, por lo que este manual se enfoca en el corazón del funcionamiento de la API de GEE, que es lo que menos cambia en el tiempo. Sin embargo, aconsejamos buscar información adicional sobre las actualizaciones de GEE, así como revisar su documentación oficial.</p>
<p>Para aprender a usar GEE, como todos los programas de programación, se debe llevar a cabo un proceso de prueba y error, mediante el desarrollo de códigos propios. Los autores esperamos que esta herramienta ayude a los nuevos usuarios a comenzar a utilizar GEE y a alcanzar sus objetivos particulares de investigación.</p>
<div class="bluebox2">
<div class="awesomeblock">
<p>Idealmente, para sacar el máximo provecho, los lectores de este manual deben contar con una formación mínima en programación básica, para comprender la aplicación de términos relacionados con el uso de variables, estructuras de datos como las listas, diccionarios, etc, que se usan en los ejemplos. De no tenerlo, sugerimos que paralelamente a la lectura del manual, se vayan instruyendo de bases de programación.</p>
</div>
</div>
</div>
<div id="organización-del-libro" class="section level2" number="1.2">
<h2 number="1.2"><span class="header-section-number">1.2</span> Organización del libro</h2>
<p>El manual está organizado en doce capítulos que cubren diferentes aspectos de esta API (“Application Programming Interface”, o interfaz de programación de aplicaciones). El primer capítulo describe algunos aspectos generales de GEE. El siguiente capítulo detalla los pasos a seguir para poder usar GEE, así como los elementos básicos de dicha herramienta. Posteriormente, se presentan algunas funciones básicas para ayudar al usuario a interactuar con la API y las diferencias entre la programación del lado del servidor y del usuario. A continuación, en cinco capítulos, se describen los tipos de objetos más frecuentemente utilizados en GEE: geometrías, vectores, colecciones de vectores, imágenes y colecciones de imágenes, así como sus métodos. Posteriormente, se describe con detalle cómo subir información a GEE para poder utilizarla en GEE. Después, se describen algunos métodos más avanzados para utilizar en conjunto información vectorial y ráster. El último capítulo muestra el procedimiento para realizar una clasificación supervisada en la API.</p>
<p>El manual incluye ejemplos que ayudarán a entender la sintaxis y experimentar con distintos tipos de datos, provenientes de distintas fuentes. De manera particular, en los capítulos sobre imágenes y colecciones de imágenes se incluyen ejemplos más prácticos con aplicaciones reales que tratan de integrar varios de los métodos revisados. Por último, este manual cuenta con una serie de ejercicios complementarios y explicativos los cuales pueden ser implementados directamente en línea. El enlace para acceder a este material se encontrará más adelante.</p>
</div>
<div id="descripción-general-de-google-earth-engine" class="section level2" number="1.3">
<h2 number="1.3"><span class="header-section-number">1.3</span> Descripción general de Google Earth Engine</h2>
<div id="qué-es-google-earth-engine" class="section level3 unnumbered">
<h3 class="unnumbered">¿Qué es Google Earth Engine?</h3>
<p>Google Earth Engine (GEE) es una plataforma desarrollada por Google que permite realizar procesamientos geoespaciales a gran escala, utilizando bases de datos con millones de datos. Uno de los principales intereses de esta plataforma es reducir el tiempo invertido en el pre-procesamiento y facilitar los análisis realizados con información geoespacial.</p>
<p>Desde hace varios años existen distintas misiones espaciales que registran datos de la Tierra a través de satélites, los cuales se almacenan en acervos de imágenes. Aunque esta información ha sido muy útil para el desarrollo científico, siempre ha existido el problema de la “Big-Data” (bases de datos enormes). Es decir, que dichos acervos de imágenes cuentan con millones de imágenes disponibles que resultan imposibles de procesar y analizar en su totalidad utilizando una computadora personal. Esta situación evitaba la posibilidad de aprovechar el potencial total de esta información.</p>
<p>GEE nace de la necesidad de aprovechar esa “Big-Data”, ofreciendo una herramienta que pueda lidiar tecnológicamente con el manejo de enromes volúmenes de información, permitiendo entonces que los usuarios se concentren en la generación de resultados y nuevos desarrollos científicos. Para lograr este objetivo, se creó una infraestructura con tres elementos claves, que son los que permiten el funcionamiento de GEE: el catálogo de información, la capacidad computacional y las APIs.</p>
<p>GEE recopiló la información geoespacial de diferentes fuentes alrededor del mundo y creó copias de esos datos en su propio “datacenter” logrando así almacenar más de 20 petabytes (20 000 000 de gigabytes) de información en un solo lugar. El programa ofrece un amplio repositorio de información geográfica global que ya se encuentra cargada en su catálogo, lo cual facilita el acceso a diferentes fuentes de datos (Fig. 1.1). Entre la información que se puede consultar directamente en GEE se encuentran: acervos para todo el mundo de imágenes Landsat (1-8), MODIS, Sentinel (1-3, 5), SRTM, AVHRR, GOESS, ALOS, mosaicos anuales de PALSAR/PALSAR 2 y algunos productos derivados de estas imágenes u otros insumos como información climática global (WorldClim), capas de cambios en la cobertura forestal (Global Forest Cover Change), información de la altura del dosel global (Global Forest Canopy height), mapas de densidad de carbono globales (Global Aboveground and Belowground Biomass Carbon Density Map), datos de precipitación globales (CHIRPS), límites políticos (FAO GAUL: Global Administrative Unit Layers 2015, Country Boundaries), polígonos de áreas protegidas mundiales (WDPA: World Database on Protected Areas (polygons)), densidad poblacional (GPWv411: Population Density (Gridded Population of the World Version 4.11)), cuencas (WWF HydroSHEDS Hydrologically Conditioned DEM, 3 Arc-Seconds), entre otras.</p>
<div class="figure" style="text-align: center">
<img src="Img/Datasets.png" alt="Algunos ejemplos de fuentes de información disponibles en GEE." width="100%" />
<p class="caption">
(#fig:unnamed-chunk-1)Algunos ejemplos de fuentes de información disponibles en GEE.
</p>
</div>
<div class="bluebox2">
<div class="awesomeblock">
<p>Para consultar toda la información que esta disponible en GEE se puede dirigir al siguiente enlace: <a href="https://developers.google.com/earth-engine/datasets" class="uri">https://developers.google.com/earth-engine/datasets</a></p>
</div>
</div>
<p>De manera paralela al catálogo de información, GEE puso a disposición un conjunto de servidores para poder realizar rápida y eficazmente cálculos y computaciones sobre esos datos. En 2010, estos servidores tenían una capacidad más o menos equivalente a 10000 computadores personales.</p>
<div class="bluebox2">
<div class="awesomeblock">
<p>Se estima que en 2010 GEE era capaz de ejecutar en cuestión de días procesamientos que en un computador personal habría tardado 15 años.</p>
</div>
</div>
<p>El tercer componente clave para el funcionamiento de GEE son las API (“Application Program Interface”). Una API es una interfaz que permite la comunicación entre nosotros (los usuarios) y los servidores de Google, proporcionando el acceso y el uso de la capacidad computacional de Google para nuestros análisis. Las API de GEE tienen el objetivo de facilitar la creación de programas, por lo cual, cuentan con una serie de funciones, métodos y algoritmos preprogramados que se pueden llamar con una simple línea de código. La idea central de las API de GEE es brindar una interfaz que permita crear códigos y programas claros y concisos.</p>
<p>GEE ofrece dos APIs, una en JavaScript, la cual se accede vía internet, mediante un explorador y es la más conocida, actualizada y amigable con los usuarios. Además, es la que contiene más documentación y ayuda disponible. Por esta razón, el manual se enfocará a hablar sobre la API de Javascript. Por otro lado, existe la API en Python, la cual se puede trabajar desde la consola de Python y permite -hasta cierto punto- usar complementariamente bibliotecas de Python, para así hacer procesamientos más complejos, o funcionalidades que la API de Java no permite. Sin embargo, las desventajas de la API de Python incluyen: el tener que instalar varias bibliotecas en la computadora para poder trabajar con GEE, existe mucho menos documentación y ayuda disponible para esta API y requiere de la actualización constante de algunas bibliotecas para su uso apropiado. A continuación se mencionan algunas de las principales ventajas de la API de Javascript:</p>
<ol style="list-style-type: decimal">
<li>Los datos pueden ser consultados directamente en la nube (no requieren ser descargados para trabajar con ellos), lo que ahorra tiempo y espacio de almacenamiento para el usuario. En cambio, si se quiere usar alguna biblioteca de Python será necesaria descargar la información.</li>
<li>El procesamiento se hace en la nube, a través de internet, utilizando el poder de cómputo asignado para la API, lo cual reduce el gasto de memoria RAM (solo necesita una conexión estable y el consumo de RAM depende del consumo del navegador). En la API de Python hay un mayor consumo de memoria RAM (para ejecutar la consola de python y sus bibliotecas) y requiere igualmente una conexión estable a internet.</li>
<li>Su interfaz es mucho más amigable con los usuarios, ya que ofrece una plataforma más interactiva para programar y más sencilla para enseñar.</li>
<li>Se pueden realizar fácilmente consultas de las colecciones de imágenes y sus metadatos, antes de decidir importarlos. La API de Python no permite realizar ese tipo de consultas fácilmente, de modo que hay que tener una absoluta claridad de las propiedades del conjunto de datos que se va a utilizar.</li>
<li>Otra gran ventaja de la plataforma radica en que los códigos se guardan en la sesión de cada usuario. Esto permite mantener un control de los códigos y automáticamente se genera un registro histórico (parecido al control de versiones de git), lo cual facilita el seguimiento y comparación de cambios entre las versiones (y permite revertir a versiones anteriores). Además, se pueden generar repositorios compartidos para generar proyectos colaborativos.</li>
</ol>
</div>
<div id="ejemplos-de-aplicaciones-realizadas-con-gee" class="section level3 unnumbered">
<h3 class="unnumbered">Ejemplos de aplicaciones realizadas con GEE</h3>
<p>GEE se ha utilizado para diversos estudios enfocados en estudiar la superficie terrestre mediante sensores remotos, especialmente imágenes multiespectrales (por ejemplo, Landsat, Sentinel-2, MODIS) y en algunos casos imágenes de radar de apertura sintética (por ejemplo, Sentinel-1). Algunos ejemplos de sus usos son:</p>
<ul>
<li>Realizar análisis de series de tiempo para detectar cambios de cobertura (Arévalo et al., 2020; Hamunyela et al., 2020).</li>
<li>Evaluar los cambios de la cobertura boscosa global, en alta resolución, para periodos superiores a una década (Hansen et al., 2013).</li>
<li>Estimar de variables biofísicas de la superficie terrestre (Campos-Taberner et al., 2018).</li>
<li>Enmascarar nubes de imágenes (Mateo-García et al., 2018).</li>
<li>Monitorear asentamientos humanos (Trianni et al., 2014).</li>
<li>Analizar la disponibilidad de imágenes y observaciones despejadas (Solórzano et al., 2020a; Solórzano et al., 2020b).</li>
<li>Mapear campos de cultivo (Xiong et al., 2017; Dong et al., 2016)</li>
<li>Identificar plantaciones de palma de aceite (Lee et al., 2016).</li>
<li>Mapear cicatrices de incendios (Arruda et al., 2021).</li>
<li>Evaluar el grado sequía de la superficie terrestre (Sazib et al., 2018).</li>
<li>Mapear características de humedales (Slagter et al., 2018).</li>
<li>Caracterizar islas de calor (Ravanelli et al., 2018), entre muchas otras.</li>
</ul>
<p>Además, es una herramienta cuyo uso ha ido en aumento gracias a sus enormes capacidades de procesamiento y su corto tiempo para realizar análisis con información geoespacial (Kumar et al., 2018).</p>
<div class="bluebox2">
<div class="awesomeblock">
<p>GEE sugiere que para citar su herramienta en cualquier tipo de trabajo se haga referencia a Gorelick et al. (2017).</p>
</div>
</div>
<!--chapter:end:01-intro.Rmd-->
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div id="primeros-pasos" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Primeros pasos</h1>
<div id="registro-para-el-uso-de-gee-javascript-api" class="section level2" number="2.1">
<h2 number="2.1"><span class="header-section-number">2.1</span> Registro para el uso de GEE Javascript API</h2>
<p>Lo primero que hay que hacer para poder utilizar la API de Javascript de GEE es ingresar a su sitio web para registrarse como usuario. Para ello, hay que acceder a la siguiente liga:</p>
<p><strong><a href="https://earthengine.google.com/" class="uri">https://earthengine.google.com/</a></strong></p>
<p>Después, le damos clic en la esquina superior derecha donde dice <strong>Sign Up</strong> (inscribirse; Fig. 2.1).</p>
<div class="figure" style="text-align: center">
<img src="Img/Signup.png" alt="Pantalla de incio en la página de registro de GEE." width="90%" />
<p class="caption">
(#fig:unnamed-chunk-2)Pantalla de incio en la página de registro de GEE.
</p>
</div>
<p>Luego se ingresan todos los datos que pide el formulario. Recordar que para utilizar GEE se requiere de una cuenta de Google (Fig. 2.2).</p>
<div class="bluebox2">
<div class="awesomeblock">
<p>Se recomienda usar una cuenta de Google que tenga suficiente espacio disponible en Google Drive, ya que será la forma más fácil de exportar los resultados generados en GEE.</p>
</div>
</div>
<div class="figure" style="text-align: center">
<img src="Img/formulario.png" alt="Formulario de datos a llenar para registrarse en GEE." width="40%" />
<p class="caption">
(#fig:unnamed-chunk-3)Formulario de datos a llenar para registrarse en GEE.
</p>
</div>
<p>Una vez realizado el registro, hay que esperar un tiempo (puede ser desde minutos a días) hasta que llegue una confirmación por parte de GEE a nuestro correo informando que ya se puede hacer uso de la API (Fig. 2.3).</p>
<div class="figure" style="text-align: center">
<img src="Img/correo.png" alt="Ejemplo de correo de confirmación por parte de GEE para poder utilizar la API." width="60%" />
<p class="caption">
(#fig:unnamed-chunk-4)Ejemplo de correo de confirmación por parte de GEE para poder utilizar la API.
</p>
</div>
<p>Una vez que tengamos dicha confirmación, podemos acceder a la API a través del siguiente enlace:</p>
<p><strong><a href="https://code.earthengine.google.com/" class="uri">https://code.earthengine.google.com/</a></strong></p>
<p>y se accede con la cuenta de Google con la que nos registramos.</p>
<p>Una vez registrados, se podrá acceder al material de todos los ejercicios entrando al siguiente enlace: <a href="https://code.earthengine.google.com/?accept_repo=users/JonathanVSV/GEE_manual" class="uri">https://code.earthengine.google.com/?accept_repo=users/JonathanVSV/GEE_manual</a></p>
</div>
<div id="elementos-básicos-de-la-interfaz-gráfica" class="section level2" number="2.2">
<h2 number="2.2"><span class="header-section-number">2.2</span> Elementos básicos de la interfaz gráfica</h2>
<p>Una vez abierta la API de Javascript, se observan cuatro pantallas (Fig. 2.4): la pantalla de repositorios, la pantalla de rutinas, la pantalla de mapa y la pantalla de control.</p>
<div class="figure" style="text-align: center">
<img src="Img/GEE_inicio_API2.png" alt="Vistazo inicial de la API de GEE." width="100%" />
<p class="caption">
(#fig:unnamed-chunk-5)Vistazo inicial de la API de GEE.
</p>
</div>
<p>Los elementos de la API se enlistan a continuación:</p>
<div id="scripts" class="section level4 unnumbered">
<h4 class="unnumbered">Scripts</h4>
<p>La pantalla de repositorios es el espacio donde se guardan y ordenan las rutinas o scripts (en inglés) del usuario. En ella se pueden crear repositorios y carpetas para organizar los archivos de código, como se muestra a continuación (Fig. 2.5):</p>
<div class="figure" style="text-align: center">
<img src="Img/repofolderfile.png" alt="Opciones disponibles dentro de la pestaña de Nuevo." width="80%" />
<p class="caption">
(#fig:unnamed-chunk-6)Opciones disponibles dentro de la pestaña de Nuevo.
</p>
</div>
<p>Dentro de este espacio existen varias categorías. Las primeras tres se pueden utilizar para determinar distintos niveles de acceso para diversos usuarios (Fig. 2.6):</p>
<ol style="list-style-type: decimal">
<li><strong>Owner</strong> (Propietario): en esta sección se guardan los códigos creados por el mismo usuario.</li>
<li><strong>Writer</strong> (Editor): en este apartado se guardan códigos que pueden ser creados por otros usuarios, pero para los cuales tenemos autorización de modificarlos.</li>
<li><strong>Reader</strong> (Lector): en esta parte aparecen códigos que otros usuarios nos han compartido, pero que no tenemos autorización de modificarlos.</li>
<li><strong>Examples</strong> (Ejemplos): se pueden consultar ejemplos de código para hacer algunas tareas específicas. Por ejemplo, existe un apartado específico para consultar las distintas maneras de enmascarar nubes utilizando diferentes colecciones de imágenes (por ejemplo: Landsat 4-7, Landsat 8, Sentinel-2, MODIS).</li>
<li><strong>Archive</strong> (Archivo): se pueden guardar archivos de código que ya no se utilicen, pero que no se desean eliminar.</li>
</ol>
<div class="figure" style="text-align: center">
<img src="Img/left_panel.png" alt="Vista del panel de repositorios dentro de GEE." width="40%" />
<p class="caption">
(#fig:unnamed-chunk-7)Vista del panel de repositorios dentro de GEE.
</p>
</div>
<div class="bluebox2">
<div class="awesomeblock">
<p>El usuario puede compartir repositorios con otros usuarios de GEE como lector o editor. De esta manera, todos los archivos que se encuentren dentro de un repositorio serán compartidos con los usuarios indicados. Esta opción está disponible al darle clic en el símbolo del engranaje a la derecha de cada repositorio (aparece una vez que se coloca el puntero sobre el nombre del repositorio; Fig. 2.7).</p>
</div>
</div>
<div class="figure" style="text-align: center">
<img src="Img/engranaje.png" alt="Vista del espacio de propietario." width="40%" />
<p class="caption">
(#fig:unnamed-chunk-8)Vista del espacio de propietario.
</p>
</div>
</div>
<div id="docs" class="section level4 unnumbered">
<h4 class="unnumbered">Docs</h4>
<p>Es un área donde se pueden consultar todos los métodos y algoritmos que se encuentran preprogramados y cargados en GEE (Fig. 2.8). Además, para cada método se indica lo que hace, la entrada que requiere y el tipo de objeto que se obtiene como salida, así como los argumentos del método (Fig. 2.9). Estos métodos se encuentran agrupados por objetos del servidor (los objetos se explican más adelante). Adicionalmente, tiene un buscador donde también se pueden consultar los métodos.</p>
<div class="figure" style="text-align: center">
<img src="Img/docs.png" alt="Ejemplo de la pestaña de documentación dentro de GEE." width="40%" />
<p class="caption">
(#fig:unnamed-chunk-9)Ejemplo de la pestaña de documentación dentro de GEE.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Img/doc_ejemplo.png" alt="Ejemplo de consulta de un método dentro de la sección de documentación." width="40%" />
<p class="caption">
(#fig:unnamed-chunk-10)Ejemplo de consulta de un método dentro de la sección de documentación.
</p>
</div>
</div>
<div id="assets" class="section level4 unnumbered">
<h4 class="unnumbered">Assets</h4>
<p>La primera vez que se accede a la pestaña de Assets hay que crear una carpeta principal (“Home Folder”) para almacenar la información que se desee importar a GEE. Se recomienda nombrar esta carpeta con el mismo nombre de usuario (Fig. 2.10).</p>
<div class="figure" style="text-align: center">
<img src="Img/homeFolder.png" alt="Folder de inicio dentro de la API." width="60%" />
<p class="caption">
(#fig:unnamed-chunk-11)Folder de inicio dentro de la API.
</p>
</div>
<p>En este apartado el usuario puede subir y guardar su propia información para ser utilizada dentro de GEE (Fig. 2.11). Se pueden subir archivos en formato ráster, vector (.shp con sus archivos auxiliares, o un .zip) o separado por comas, únicamente (Fig. 2.12).</p>
<div class="figure" style="text-align: center">
<img src="Img/assets.png" alt="Vistazo de la sección de información del usuario." width="40%" />
<p class="caption">
(#fig:unnamed-chunk-12)Vistazo de la sección de información del usuario.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Img/newAssets.png" alt="Ejemplos de pantallas para subir diferentes tipos de datos a GEE." width="100%" />
<p class="caption">
(#fig:unnamed-chunk-13)Ejemplos de pantallas para subir diferentes tipos de datos a GEE.
</p>
</div>
</div>
<div id="pantalla-de-rutinas" class="section level4 unnumbered">
<h4 class="unnumbered">Pantalla de rutinas</h4>
<p>Esta ventana es donde se va a escribir el código en JavaScript (Fig. 2.13). En la parte superior de esta pantalla se encuentran varios botones. El primero, <code>Get link</code> sirve para compartir el código que se tenga abierto mediante una liga. Además, al darle clic en la flecha de despliegue (en la opcion <code>Manage Links</code>) se puede hacer un manejo de las ligas que se tengan activas, así como borrar ligas que ya no se utilicen (Fig. 2.14).</p>
<div class="figure" style="text-align: center">
<img src="Img/editor.png" alt="Vistazo de la pantalla de rutinas o scripts." width="50%" />
<p class="caption">
(#fig:unnamed-chunk-14)Vistazo de la pantalla de rutinas o scripts.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Img/links.png" alt="Ubicación del botón para obtener enlaces para compartir rutinas." width="30%" />
<p class="caption">
(#fig:unnamed-chunk-15)Ubicación del botón para obtener enlaces para compartir rutinas.
</p>
</div>
<p>A su derecha se encuentra el botón de <code>Save</code> el cual permite guardar el código con el que se esté trabajando (Fig. 2.15). Además, al darle clic en la flecha de despliegue se puede usar la opción <code>Save</code> as para crear una copia del código con otro nombre.</p>
<div class="figure" style="text-align: center">
<img src="Img/save.png" alt="Ubicación del botón para guardar el código." width="30%" />
<p class="caption">
(#fig:unnamed-chunk-16)Ubicación del botón para guardar el código.
</p>
</div>
<p>A continuación está el botón<code>Run</code> que sirve para correr el código que se muestra en la pantalla de rutinas, de principio a fin (Fig. 2.16). Al darle clic a este botón se envía el código a los servidores de Google y se realiza el procedimiento indicado.</p>
<div class="figure" style="text-align: center">
<img src="Img/run.png" alt="Ubicación del botón para correr el código." width="30%" />
<p class="caption">
(#fig:unnamed-chunk-17)Ubicación del botón para correr el código.
</p>
</div>
<p>A su derecha se encuentra el botón de <code>Reset</code> el cual sirve para borrar todo el código que se tenga escrito en la pantalla de rutinas.</p>
<p>Después se encuentra el botón de <code>Apps</code> que sirve para crear aplicaciones a partir del código que se encuentra en la pantalla. La creación de aplicaciones no se cubrirá en este manual, pero se refiere a programas que permiten crear una interfaz amigable con un usuario que no tenga conocimientos de GEE. De esta manera, se puede facilitar el uso de un código programado sin necesidad de acceder directamente al código. Para consultar algunos ejemplos de aplicaciones construidas en GEE se puede visitar el siguiente enlace: <a href="https://www.earthengine.app/" class="uri">https://www.earthengine.app/</a></p>
<p>Por último, en el botón del engranaje se encuentran opciones para prender y apagar líneas de código como subrayar sugerencias en la pantalla de rutinas o autocompletar símbolos como <code>’</code>, <code>"</code>, <code>(</code> y <code>{</code>.</p>
<div class="bluebox2">
<div class="awesomeblock">
<p>Cuando se corre un código en la consola con el botón de <code>Run</code>, este no corre directamente en los servidores de Google, sino que se transcriben a código GeoJSON, se envían a los servidores de Google y se espera una respuesta.</p>
</div>
</div>
<div class="bluebox2">
<div class="awesomeblock">
<p>Para buscar un texto específico dentro del código, se debe dar clic en la pantalla de rutinas y presionar ctrl+F (algunos atajos pueden variar según la configuración del teclado). Esta pantalla permite buscar una cadena de caracteres determinada dentro del código. Además, al volver a presionar ctrl+F, también se activa el recuadro de sustitución, el facilita el sustituir una cadena de caracteres determinada por otra. Para consultar el listado completo de atajos se puede presionar ctrl+shift+H.</p>
</div>
</div>
</div>
<div id="search" class="section level4 unnumbered">
<h4 class="unnumbered">Search</h4>
<p>Es una barra de búsqueda (Search) en la que se pueden buscar fuentes de datos o sitios (Fig. 2.17). Resulta útil para encontrar la ruta de alguna fuente de datos o una colección en particular, así como para consultar sus metadatos, bandas y características.</p>
<div class="figure" style="text-align: center">
<img src="Img/search.png" alt="Vista de la barra de búsqueda." width="80%" />
<p class="caption">
(#fig:unnamed-chunk-18)Vista de la barra de búsqueda.
</p>
</div>
</div>
<div id="pantalla-de-mapa" class="section level4 unnumbered">
<h4 class="unnumbered">Pantalla de Mapa</h4>
<p>En esta pantalla de mapas se puede (Fig. 2.18):</p>
<ol style="list-style-type: decimal">
<li>Dibujar y visualizar puntos, polígonos, líneas o rectángulos.</li>
<li>Mostrar la información que se haya indicado mediante la función <code>Map.addLayer</code>.</li>
<li>Añadir un mapa base (Google maps o Google earth).</li>
</ol>
<div class="figure" style="text-align: center">
<img src="Img/drawing.png" alt="Vista de la pantalla de mapas, indicando las diferentes herramientas que se pueden utilizar en ella." width="80%" />
<p class="caption">
(#fig:unnamed-chunk-19)Vista de la pantalla de mapas, indicando las diferentes herramientas que se pueden utilizar en ella.
</p>
</div>
</div>
<div id="gestor-de-capas" class="section level4 unnumbered">
<h4 class="unnumbered">Gestor de capas</h4>
<p>El gestor de capas permite prender y apagar las capas que se estén mostrando en el área del mapa (Fig. 2.19). Además, sirve para modificar las características de su visualización (por ejemplo, transparencia, color, distribución del histograma, compuesto de color, etc). Este menú aparece una vez que se cargan capas a la pantalla de mapas.</p>
<div class="figure" style="text-align: center">
<img src="Img/layer.png" alt="Ejemplo del uso del administrador de capas." width="80%" />
<p class="caption">
(#fig:unnamed-chunk-20)Ejemplo del uso del administrador de capas.
</p>
</div>
</div>
<div id="pantalla-de-control" class="section level4 unnumbered">
<h4 class="unnumbered">Pantalla de control</h4>
<p>La pantalla de control contiene tres pestañas: console (consola), inspector (inspector) y de tasks (tareas). Esta pantalla le va a permitir al usuario hacer algunas consultas de la información con la que se está trabajando o finalizar tareas de exportación de información. A continuación se describe cada una de estas pestañas.</p>
</div>
<div id="console" class="section level4 unnumbered">
<h4 class="unnumbered">Console</h4>
<p>La consola consiste en la pantalla de comunicación con el servidor (Fig. 2.20). En ella se muestran los errores que se obtienen al correr un código o se puede mostrar la información indicada por la función <code>print</code>.</p>
<div class="figure" style="text-align: center">
<img src="Img/rigthPanel.png" alt="Vista de la consola en GEE." width="80%" />
<p class="caption">
(#fig:unnamed-chunk-21)Vista de la consola en GEE.
</p>
</div>
</div>
<div id="inspector" class="section level4 unnumbered">
<h4 class="unnumbered">Inspector</h4>
<p>Permite consultar los valores de las capas que se muestran en el mapa, al dar clic sobre el punto de interés (Fig. 2.21).</p>
<div class="figure" style="text-align: center">
<img src="Img/inspector.png" alt="Vista de la pestaña de la herramienta de Inspector." width="80%" />
<p class="caption">
(#fig:unnamed-chunk-22)Vista de la pestaña de la herramienta de Inspector.
</p>
</div>
</div>
<div id="tasks" class="section level4 unnumbered">
<h4 class="unnumbered">Tasks</h4>
<p>En esta pestaña se muestran las tareas que se hayan exportado mediante la función <code>Export</code> y permite correr el trabajo de exportación al sitio donde el usuario le haya indicado (drive, assets; Fig. 2.22). Además, esta pestaña tiene otras funcionalidades:</p>
<ol style="list-style-type: decimal">
<li>Mostrar las tareas para ejecutar (con el botón de <code>Run</code>, el cual permite especificar detalles de la exportación).</li>
<li>Presentar las tareas en ejecución (color gris).</li>
<li>Señalar el tiempo demorado en el trabajo.</li>
<li>Indicar cuándo el trabajo se ha finalizado (color azul).</li>
<li>Cuando hay un error en algún objeto exportado, se verá el trabajo marcado en rojo, indicando el error. Por último, al dar clic sobre el signo de interrogación que aparece al colocar el cursor sobre algún trabajo, se puede obtener mayor información del trabajo como, por ejemplo, el error que arrojó el servidor al tratar de realizar una exportación o la ubicación del archivo exportado.</li>
</ol>
<div class="figure" style="text-align: center">
<img src="Img/task.png" alt="Vista de la pestaña de tareas dentro de GEE." width="80%" />
<p class="caption">
(#fig:unnamed-chunk-23)Vista de la pestaña de tareas dentro de GEE.
</p>
</div>
</div>
</div>
<div id="programación-en-gee" class="section level2" number="2.3">
<h2 number="2.3"><span class="header-section-number">2.3</span> Programación en GEE</h2>
<p>La programación dentro de la API de GEE es una orientada a objetos, siguiendo la sintaxis del lenguaje de programación Javascript. Los objetos se pueden interpretar como contenedores de información sobre los cuales se van a aplicar diferentes funciones o métodos para crear nuevos objetos o sobreescribir objetos preexistentes. Cada tipo de objeto tiene una serie de métodos propios que le permiten realizar diferentes tipos de operaciones. Estos se revisan en el capítulo 4.</p>
<div id="simbología" class="section level3 unnumbered">
<h3 class="unnumbered">Simbología</h3>
<ul>
<li><code>‘ ’</code> : comillas simples.</li>
<li><code>“ ”</code> : comillas dobles.</li>
<li><code>[ ]</code> : corchetes.</li>
<li><code>{ }</code> : llaves.</li>
<li><code>( )</code> : paréntesis.</li>
<li><code>-</code> : guion.</li>
<li><code>_</code> : guion bajo.</li>
<li><code>,</code> : coma.</li>
</ul>
</div>
<div id="lenguaje-javascript-en-gee" class="section level3 unnumbered">
<h3 class="unnumbered">Lenguaje Javascript en GEE</h3>
<p>La sintaxis de Javascript tiene algunas peculiaridades que deben cumplirse para que se pueda correr el código sin problemas. Entre la sintaxis básica se pueden considerar los siguientes puntos (de igual forma iremos tocando la gramática del código a lo largo de los ejemplos):</p>
<ol style="list-style-type: decimal">
<li>Es un lenguaje sensible a las mayúsculas y minúsculas. De tal manera que puede haber dos objetos diferentes, uno llamado <code>a</code> y otro llamado <code>A</code>.</li>
<li>Siempre se debe cerrar cualquier comando con un <code>;</code> (aunque de no hacerlo el código funcionará igualmente; sin embargo, se recomienda utilizarlo para tener un código más claro y ordenado).</li>
<li>Comúnmente en Javascript se utiliza la notación “lowerCamelCase” para unir palabras (unir palabras sin espacio pero cada una comenzando con su respectiva mayúscula) , en lugar de guiones <code>-</code> o guión bajo <code>_</code>. Por ejemplo: <code>intervalMean</code> o <code>updateMask</code>.</li>
<li>Todas las variables, funciones y objetos deben ser definidos mediante la función <code>var</code>.</li>
<li>El operador <code>=</code>asigna un valor a una variable.</li>
<li>Los operadores matemáticos son: <code>+ - * /</code>.</li>
<li>Para concatenar dos cadenas de caracteres se utiliza el símbolo <code>+</code>.</li>
<li>Para realizar comentarios se puede utilizar <code>//</code> para comentarios de una línea, o también <code>/* … */</code> para comentarios de varias líneas.</li>
<li>Se suele utilizar el operador <code>.</code> (punto) para aplicar un método al objeto que lo precede. En este manual, todos los métodos aplicados a algún objeto se escribirán precedidos por el operador <code>.</code> para evitar errores de sintaxis.</li>
<li>Son igualmente válidas las comillas sencillas <code>''</code> como las comillas dobles <code>""</code>, pero no deben mezclarse ambos tipos de comillas en una misma línea.</li>
</ol>
<div class="bluebox2">
<div class="awesomeblock">
<p>El término correcto para llamar a los procesos aplicados con el operador <code>.</code> es el de método (“method”), lo cual quiere decir que son procedimientos ligados a un tipo de objeto. Por ejemplo, en <code>ee.Image.updateMask</code>, el método <code>updateMask</code> es uno ligado a un objeto de tipo imagen (<code>ee.Image</code>). Por el contrario, las funciones en un sentido estricto se aplican a un objeto mediante la sintaxis: <code>function(objeto){}</code>. Distintos tipos de objetos tienen diferentes métodos ligados a ellos.</p>
</div>
</div>
<!--chapter:end:02-primerospasos.Rmd-->
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div id="interfaz-de-usuario" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Interfaz de usuario</h1>
<p>Dentro de GEE hay un grupo de funciones que permiten interactuar con los objetos y obtener información sobre sus características o propiedades. A este conjunto de funciones le llamaremos funciones de interfaz de usuario, ya que permiten obtener información sobre los objetos, visualizarlos o exportarlos para trabajar con ellos en un entorno distinto a GEE. Estas funciones resultan muy útiles para ayudar al usuario a entender los procesos que está programando, así como verificar que los procesos realicen la tarea deseada. Dentro de este grupo de funciones se distinguen cuatro grupos de funciones que se detallan en las siguientes secciones.</p>
<div id="impresión-en-consola" class="section level2" number="3.1">
<h2 number="3.1"><span class="header-section-number">3.1</span> Impresión en consola</h2>
<p>La función más sencilla de la interfaz es la de imprimir objetos en la consola. Esto se realiza mediante la función <code>print</code> (imprimir). Al llamar esta función e indicar cualquier objeto como argumento, éste se evalúa y se imprime su estructura en la consola. Esta función permite obtener información básica de los objetos como el tipo de objeto, número de registros, características y propiedades de los elementos que lo conforman. Además, esta función resulta muy útil para rastrear errores de programación (“bugs”) en los códigos. El resultado de la siguiente línea de código se puede apreciar en la Fig. 3.1.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Hola Mundo&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
print('Hola Mundo');
</script>
<div class="figure" style="text-align: center">
<img src="Img/holaMundo.png" alt="Ejemplo del uso de la función print para imprimir en la consola" width="30%" />
<p class="caption">
(#fig:unnamed-chunk-25)Ejemplo del uso de la función print para imprimir en la consola
</p>
</div>
<div class="bluebox2">
<div class="awesomeblock">
<p>Se recomienda utilizar varias impresiones en la consola (mediante <code>print</code>) por programa para verificar el resultado de procesos intermedios.</p>
</div>
</div>
</div>
<div id="interacción-con-la-pantalla-de-mapas" class="section level2" number="3.2">
<h2 number="3.2"><span class="header-section-number">3.2</span> Interacción con la pantalla de mapas</h2>
<p>Este grupo de funciones permiten agregar objetos del lado del servidor a la pantalla de mapas, así como controlar algunos parámetros de dicha pantalla. Todas las funciones encargadas del manejo de la pantalla de mapas se encuentran dentro de la biblioteca <code>Map</code>.</p>
<div class="bluebox2">
<div class="awesomeblock">
<p>Para revisar todas las funciones disponibles para la interfaz del usuario, ver la sección de <strong>Code Editor</strong> en la siguiente liga: <a href="https://developers.google.com/earth-engine/apidocs" class="uri">https://developers.google.com/earth-engine/apidocs</a>. Además, en esta sección se indican los argumentos que acepta cada función, así como el tipo de objeto de la salida.</p>
</div>
</div>
<div id="map.addlayer" class="section level4 unnumbered">
<h4 class="unnumbered">Map.addLayer</h4>
<p><code>Map.addLayer</code> permite mostrar elementos en la pantalla de mapa de la API. Por lo tanto, permite mostrar objetos de tipo vector (<code>ee.Feature</code>) o imagen (<code>ee.Image</code>; estos objetos se presentan con mayor detalle más adelante). Los argumentos de la función <code>Map.addLayer</code> incluyen el objeto a añadir a la pantalla de mapas, seguido de un diccionario con información para el despliegue de la capa. Por último, se puede indicar el nombre de la capa con el que se desea mostrar la capa en la pantalla de mapas.</p>
<p>Al utilizar <code>Map.addLayer</code> sobre una imagen se pueden indicar los siguientes argumentos: <code>bands</code> (bandas), <code>min</code> y <code>max</code> (valores mínimos y máximos de para visualizar la información). Estos se deben pasar dentro de un par de llaves <code>{}</code> como un diccionario (ver Capítulo 4 para una descripción de lo que es un diccionario). Las bandas se deben agregar en el orden RGB, es decir, primero la banda que corresponde al canal rojo, seguida del verde y del azul. Esta función también permite asignar colores mediante el argumento de <code>palette</code> (paleta de colores). Dependiendo de las bandas que se elija mostrar se puede mostrar únicamente una banda en tonos de gris o un compuesto RGB. Por ejemplo, para cargar una imagen a la pantalla de mapas (Fig. 3.2):</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(image<span class="op">,</span> {<span class="dt">bands</span><span class="op">:</span> [<span class="st">&#39;B4&#39;</span><span class="op">,</span> <span class="st">&#39;B3&#39;</span><span class="op">,</span> <span class="st">&#39;B2&#39;</span>]<span class="op">,</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                      <span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">2000</span>}<span class="op">,</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&#39;RGB&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
Map.addLayer(image, {bands: ['B4', 'B3', 'B2'], 
                      min: 0, max: 2000}, 
                      'RGB');
</script>
<div class="figure" style="text-align: center">
<img src="Img/LTerminos.png" alt="Ejemplo de visualización de un compuesto RGB de una imagen Landsat 8 sobre Laguna de Términos, México" width="100%" />
<p class="caption">
(#fig:unnamed-chunk-27)Ejemplo de visualización de un compuesto RGB de una imagen Landsat 8 sobre Laguna de Términos, México
</p>
</div>
<div class="bluebox2">
<div class="awesomeblock">
<p>En algunas ocasiones, al intentar cargar objetos en la pantalla de mapas, que sean producto de procesamientos demandantes, la consola puede mostrar un error indicando que se superó el tiempo de espera o del límite de memoria disponible. En estos casos, se sugiere exportar el resultado, en lugar de tratar de cargarlo en la pantalla de mapas y después visualizarlo de manera local en algún SIG o software similar (por ejemplo, QGIS).</p>
</div>
</div>
<div class="bluebox2">
<div class="awesomeblock">
<p>La proyección por defecto para mostrar la información en la pantalla de mapas corresponde a EPSG:3857. Los códigos EPSG se pueden consultar en el siguiente enlace: <a href="https://epsg.io/" class="uri">https://epsg.io/</a>. Dicha proyección únicamente se hace para poder visualizar la información, mas no transforma la información con la que el usuario trabaja.</p>
</div>
</div>
<p>Para el caso de los vectores (<code>ee.Feature</code>) se puede realizar una operación similar a las imágenes, aunque el único argumento válido es <code>color</code> (Fig. 3.3.):</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(feature<span class="op">,</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;FF0000&#39;</span>}<span class="op">,</span> <span class="st">&#39;featuresColored&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
Map.addLayer(feature, {color: 'FF0000'}, 'featuresColored');
</script>
<div class="figure" style="text-align: center">
<img src="Img/SAmerica.png" alt="Ejemplo de visualización de un vector con los límites políticos de los países de Sudamérica donde se indica su color" width="100%" />
<p class="caption">
(#fig:unnamed-chunk-29)Ejemplo de visualización de un vector con los límites políticos de los países de Sudamérica donde se indica su color
</p>
</div>
<div class="bluebox2">
<div class="awesomeblock">
<p>El código de los colores pasados al argumento de <code>palette</code> o <code>color</code> corresponden a códigos hexadecimales. El siguiente enlace puede ser útil para consultar los códigos decimales de distintos colores: <a href="https://htmlcolorcodes.com/es/" class="uri">https://htmlcolorcodes.com/es/</a></p>
</div>
</div>
</div>
<div id="map.centerobject" class="section level4 unnumbered">
<h4 class="unnumbered">Map.centerObject</h4>
<p>Esta función permite centrar la pantalla de mapas en algún objeto o coordenada (longitud, latitud). Además, se puede indicar el zoom con el cual se quiere centrar el objeto.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">setCenter</span>(<span class="op">-</span><span class="fl">39.86</span><span class="op">,</span> <span class="fl">20.52</span><span class="op">,</span> <span class="dv">5</span>)</span></code></pre></div>
<script type="text/javascript">
Map.setCenter(-39.86, 20.52, 5)
</script>
</div>
</div>
<div id="creación-de-gráficos" class="section level2" number="3.3">
<h2 number="3.3"><span class="header-section-number">3.3</span> Creación de gráficos</h2>
<p>Este grupo de funciones permiten realizar gráficos de diversos tipos. Sin embargo, cada tipo de gráfico contiene argumentos válidos diferentes. Todas estas funciones se encuentran agrupadas dentro de la función principal <code>ui.Chart</code>. Los objetos básicos que permite graficar GEE son: vectores (<code>ee.Feature</code>), colecciones de vectores (<code>ee.FeatureCollection</code>), imágenes (<code>ee.Image</code>), colecciones de imágenes (<code>ee.ImageCollection</code>), arreglos (<code>ee.Array</code>) y listas (<code>ee.List</code>). Además, para indicar los colores a utilizar en el gráfico o el título del mismo se puede utilizar el método <code>.setOptions</code> sobre el objeto de tipo gráfico.</p>
<div id="ui.chart.feature" class="section level4 unnumbered">
<h4 class="unnumbered">ui.Chart.feature</h4>
<p>Este conjunto de funciones permite obtener distintos tipos de gráficos a partir de un vector o una colección de vectores y mostrar su resultado al imprimirlos en la consola (mediante la función <code>print</code>). Algunas de los métodos disponibles son:</p>
<ul>
<li><code>ui.Chart.feature.byFeature</code>.</li>
<li><code>ui.Chart.feature.byProperty</code>.</li>
<li><code>ui.Chart.feature.groups</code>.</li>
<li><code>ui.Chart.feature.histogram</code>.</li>
</ul>
<p>Por ejemplo:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">feature</span><span class="op">.</span><span class="fu">byProperty</span>({</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Indicar el vector o colección de atributos a partir del cual se </span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">// va a hacer el gráfico</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">feature</span><span class="op">:</span> coleccionAtributos<span class="op">,</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">// La propiedad a colocar en el eje de las x</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">xProperties</span><span class="op">:</span> <span class="st">&#39;Clase&#39;</span><span class="op">,</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<script type="text/javascript">
ui.Chart.feature.byProperty({
  // Indicar el vector o colección de atributos a partir del cual se 
  // va a hacer el gráfico
  feature: coleccionAtributos, 
  // La propiedad a colocar en el eje de las x
  xProperties: 'Clase',
})

</script>
</div>
<div id="ui.chart.image" class="section level4 unnumbered">
<h4 class="unnumbered">ui.Chart.image</h4>
<p>Este conjunto de funciones permiten obtener distintos tipos de gráficos a partir de una imagen o colección de imágenes. Algunas de las funciones que se encuentran disponibles son:</p>
<ul>
<li><code>ui.Chart.image.byClass</code></li>
<li><code>ui.Chart.image.byRegion</code></li>
<li><code>ui.Chart.image.doySeries</code></li>
<li><code>ui.Chart.image.histogram</code></li>
<li><code>ui.Chart.image.seriesByRegion</code>, entre otras.</li>
</ul>
<p>Por ejemplo, para graficar una serie de tiempo a partir de una colección de imágenes se utiliza la función `ui.Chart.image.seriesByRegion``. Este tipo de gráficos permiten graficar las series de tiempo de algunas áreas determinadas utilizando una colección de imágenes.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">seriesByRegion</span>({</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Definir la colección de imágenes a graficar</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">imageCollection</span><span class="op">:</span> coleccionImagenes<span class="op">,</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Definir las regiones sobre las cuales se va a extraer la</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">// información para el gráfico</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">regions</span><span class="op">:</span> areas<span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">eq</span>(<span class="st">&#39;Tipo&#39;</span><span class="op">,</span><span class="st">&#39;Bosque&#39;</span>))<span class="op">,</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">// El reductor a utilizar para resumir la información de la</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">// colección de imágenes en las regiones indicadas</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">mean</span>()<span class="op">,</span> </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">// La banda sobre la cual se quiere construir el gráfico</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">band</span><span class="op">:</span> <span class="st">&#39;NDVI&#39;</span><span class="op">,</span> </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Tamaño en m del píxel para obtener la información</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span> </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Propiedad para nombrar a cada serie</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="dt">seriesProperty</span><span class="op">:</span> <span class="st">&#39;Tipo&#39;</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Bosque&#39;</span><span class="op">,</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">colors</span><span class="op">:</span> [<span class="st">&#39;#EE3A19&#39;</span>]</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
ui.Chart.image.seriesByRegion({
  // Definir la colección de imágenes a graficar
  imageCollection: coleccionImagenes, 
  // Definir las regiones sobre las cuales se va a extraer la
  // información para el gráfico
  regions: areas.filter(ee.Filter.eq('Tipo','Bosque')),
  // El reductor a utilizar para resumir la información de la
  // colección de imágenes en las regiones indicadas
  reducer: ee.Reducer.mean(), 
  // La banda sobre la cual se quiere construir el gráfico
  band: 'NDVI', 
  // Tamaño en m del píxel para obtener la información
  scale: 30, 
  // Propiedad para nombrar a cada serie
  seriesProperty: 'Tipo'
})
  .setOptions({
    title: 'Bosque',
    colors: ['#EE3A19']
  });
</script>
<div class="bluebox2">
<div class="awesomeblock">
<p>El nombre de las funciones para generar gráficos en GEE dan una idea del tipo de gráfica que se puede generar con dicha función y el tipo de insumos que requiere cada tipo de gráfico.</p>
</div>
</div>
</div>
</div>
<div id="exportación-de-objetos-fuera-de-gee" class="section level2" number="3.4">
<h2 number="3.4"><span class="header-section-number">3.4</span> Exportación de objetos fuera de GEE</h2>
<p>Este grupo de funciones permiten exportar algún resultado fuera de GEE para ser manejado en otro programa. Todas estas funciones se encuentran dentro de la biblioteca <code>Export.</code> Sin embargo, sólo existen cuatro formatos válidos para exportar desde GEE: ráster (<code>ee.Image</code>), vector (<code>ee.FeatureCollection</code>), mapa y vídeo.</p>
<div id="export.image" class="section level4 unnumbered">
<h4 class="unnumbered">Export.image</h4>
<p>En el caso de las imágenes (ráster, <code>ee.Image</code>), la función para exportarlas es <code>Export.image</code>. Dentro de GEE hay tres opciones para exportar los resultados de una imagen:</p>
<ul>
<li><code>Export.image.toAsset</code></li>
<li><code>Export.image.toDrive</code></li>
<li><code>Export.image.toCloudStorage</code></li>
</ul>
<p>El primero permite exportar la imagen (ráster) a la sección de Assets, es decir, la sección donde el usuario puede subir su información a GEE. Esta opción es útil para cuando el resultado se va a utilizar en otro procedimiento de GEE. La segunda opción permite exportarlo al Google Drive de la cuenta con la que se tiene acceso a GEE. Esta opción es útil para trabajar con las imágenes (rásters) en algún entorno local, como algún SIG. La última opción permite exportar la imagen al Google Cloud Storage para utilizarla en algún otro proceso a realizar en Google Cloud Platform. La opción que creemos es más común para cualquier usuario será la de <code>Export.image.toDrive</code>. Para exportar información de GEE al Google Drive, se recomienda utilizar distintas carpetas para organizar la información. El nombre de la carpeta se define en el argumento de <code>folder</code>.</p>
<div class="bluebox2">
<div class="awesomeblock">
<p>Sólo se pueden exportar imágenes en formato <code>ee.Image</code>. Sin embargo, no siempre resulta obvio el formato de las imágenes, ya que algunas veces se pueden convertir a un formato de arreglo (<code>ee.Array</code>), tras lo cual hay que volver a convertir la información a formato de imagen (<code>ee.Image</code>) para poder exportarla. La aplicación permite exportar únicamente en formato GeoTiff o TRFrecord (tensores), siendo la primera la opción por defecto.</p>
</div>
</div>
<p>Un ejemplo de cómo exportar una imagen se presenta a continuación.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>Export<span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">toDrive</span>({</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Definir la imagen a exportar</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">image</span><span class="op">:</span> imgDiff<span class="op">,</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Especificar el nombre con el cual se va a guardar la imagen en</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">// el Google Drive</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">description</span><span class="op">:</span> <span class="st">&#39;DiferenciaNDVI_2016-2017&#39;</span><span class="op">,</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Determinar el tamaño del píxel en m de la imagen a exportar</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Exportar la imagen en formato GeoTIFF</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">fileFormat</span><span class="op">:</span> <span class="st">&#39;GeoTIFF&#39;</span><span class="op">,</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Definir la carpeta del Google Drive en la que se va a exportar</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">// la imagen</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="dt">folder</span><span class="op">:</span> <span class="st">&#39;DiferenciaNDVIL8&#39;</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span> </span></code></pre></div>
<script type="text/javascript">
Export.image.toDrive({
  // Definir la imagen a exportar
  image: imgDiff,
  // Especificar el nombre con el cual se va a guardar la imagen en
  // el Google Drive
  description: 'DiferenciaNDVI_2016-2017',
  // Determinar el tamaño del píxel en m de la imagen a exportar
  scale: 30,
  // Exportar la imagen en formato GeoTIFF
  fileFormat: 'GeoTIFF',
  // Definir la carpeta del Google Drive en la que se va a exportar
  // la imagen
  folder: 'DiferenciaNDVIL8'
}); 
</script>
<div class="bluebox2">
<div class="awesomeblock">
<p>En GEE muchas operaciones utilizan el término de <code>scale</code>, sin embargo, este no se refiere a la escala de trabajo en un sentido tradicional (por ejemplo, 1:50000), sino que se refiere al tamaño de píxel expresado en metros.</p>
</div>
</div>
<div class="bluebox2">
<div class="awesomeblock">
<p>En algunas ocasiones, al intentar exportar una imagen muy grande (mayor a 10 000 000 de píxeles), la consola puede mostrar un error indicando que el objeto a exportar tiene un número muy alto de píxeles. En este caso, se debe aumentar el número de píxeles máximo permitido para la exportación. Esto se logra indicando el argumento <code>maxPixels</code> dentro del diccionario que se pasa a <code>Export.image.toDrive</code>. Por ejemplo, <code>maxPixels: 1e10</code>, lo cual permite exportar una imagen con hasta 1 x 10^10 píxeles.</p>
</div>
</div>
</div>
<div id="export.table" class="section level4 unnumbered">
<h4 class="unnumbered">Export.table</h4>
<p>Por su parte, el formato vector (<code>ee.Feature</code>) permite exportar información vector y tablas sin información geográfica. De nuevo, para poder exportar en el formato vector, el objeto exportado debe estar en formato colección de vectores (<code>ee.FeatureCollection</code>). Al igual que en el caso de las imágenes, dentro de GEE hay 3 opciones para exportar objetos de tipo vector:</p>
<ul>
<li><code>Export.table.toAsset</code>.</li>
<li><code>Export.table.toDrive</code>.</li>
<li><code>Export.table.toCloudStorage</code>.</li>
</ul>
<p>Para el caso de las tablas, sin información geográfica asociada, se debe definir el objeto como un objeto vector sin geometría (es decir, <code>null</code>) y en la tabla de atributos anexar la información deseada. Un ejemplo del uso de esta función se presenta a continuación:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>Export<span class="op">.</span><span class="at">table</span><span class="op">.</span><span class="fu">toDrive</span>({</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Definir la colección de vectores a exportar</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">collection</span><span class="op">:</span> feature<span class="op">,</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Especificar el nombre con el que se va a guardar el </span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">// archivo en el Google Drive</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">description</span><span class="op">:</span> <span class="st">&#39;nombreArchivo&#39;</span><span class="op">,</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Determinar la carpeta dentro de Google Drive donde</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">// se va a guardar el archivo</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">folder</span><span class="op">:</span> <span class="st">&#39;mifolder&#39;</span><span class="op">,</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Exportar la información en formato csv (valores </span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">// delimitados por comas)</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="dt">fileFormat</span><span class="op">:</span> <span class="st">&#39;CSV&#39;</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
Export.table.toDrive({
  // Definir la colección de vectores a exportar
  collection: feature,
  // Especificar el nombre con el que se va a guardar el 
  // archivo en el Google Drive
  description: 'nombreArchivo',
  // Determinar la carpeta dentro de Google Drive donde
  // se va a guardar el archivo
  folder: 'mifolder',
  // Exportar la información en formato csv (valores 
  // delimitados por comas)
  fileFormat: 'CSV'
});
</script>
<div class="bluebox2">
<div class="awesomeblock">
<p>GEE permite exportar información en formato vector sólo en formato CSV, GeoJSON, KML, KMZ, SHP, o TFRecord. El primer formato es el formato predeterminado.</p>
</div>
</div>
</div>
<div id="export.video" class="section level4 unnumbered">
<h4 class="unnumbered">Export.video</h4>
<p>Esta opción permite exportar una colección de imágenes como vídeo ya sea al almacenamiento de la nube de Google o al Drive.</p>
<ul>
<li><code>Export.video.toCloudStorage</code>.</li>
<li><code>Export.video.toDrive</code>.</li>
</ul>
<p>Esta función puede resultar atractiva para observar los cambios de un área de interés, a través del tiempo. A continuación se muestra cómo exportar una colección de imágenes en vídeo:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>Export<span class="op">.</span><span class="at">video</span><span class="op">.</span><span class="fu">toDrive</span>({</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Definir la colección de imágenes a exportar</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">collection</span><span class="op">:</span> coleccionImgs<span class="op">,</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Especificar el nombre con el que se va a guardar el vídeo</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">// en el Google Drive</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">description</span><span class="op">:</span> <span class="st">&#39;videoTimelapse&#39;</span><span class="op">,</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Definir la carpeta donde se va a exportar el vídeo</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">folder</span><span class="op">:</span> <span class="st">&#39;mifolder&#39;</span><span class="op">,</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Determinar el número de cuadros por segundo</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">framesPerSecond</span><span class="op">:</span> <span class="dv">24</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a> })<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
Export.video.toDrive({
  // Definir la colección de imágenes a exportar
  collection: coleccionImgs,
  // Especificar el nombre con el que se va a guardar el vídeo
  // en el Google Drive
  description: 'videoTimelapse',
  // Definir la carpeta donde se va a exportar el vídeo
  folder: 'mifolder',
  // Determinar el número de cuadros por segundo
  framesPerSecond: 24
 });
</script>
<!--chapter:end:03-interfazusuario.Rmd-->
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div id="importación-de-información-a-gee" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> Importación de información a GEE</h1>
<p>En la sección de Assets, se pueden importar varios tipos de archivos a GEE para utilizarlos en la API: imágenes, archivos vector (shapefiles), archivos separados por comas (csv), colecciones de imágenes exportadas por el mismo GEE y folders (Fig. 4.1). Para importar cualquier de estos tipos de archivos simplemente se tiene que ingresar a la pestaña de Assets en el panel izquierdo y después dar clic en <code>New</code> (nuevo) e indicar el archivo que se quiere importar a GEE (Fig. 4.2).</p>
<div class="figure" style="text-align: center">
<img src="Img/newAssets.png" alt="Opciones disponibles para importar datos en GEE." width="100%" />
<p class="caption">
(#fig:unnamed-chunk-36)Opciones disponibles para importar datos en GEE.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Img/Asset1.png" alt="Ubicación de la pestaña de importación de datos a GEE." width="100%" />
<p class="caption">
(#fig:unnamed-chunk-37)Ubicación de la pestaña de importación de datos a GEE.
</p>
</div>
<p>Posteriormente se da clic en <code>Select</code> y se seleccionan los archivos que se quieren subir (Fig. 4.3). Directamente en esta ventana se pueden agregar algunos campos a la información. Por último, se da clic en <code>Upload</code> (ubicado en la esquina inferior derecha de esta ventana) para subir los archivos a la cuenta de GEE (ocupando espacio en Google Drive). Recordar que para archivos shapefile sólo se aceptan archivos con las extensiones: shp, zip, dbf, prj, shx, cpg, fix, qix, sbn o shp.xml.</p>
<div class="bluebox2">
<div class="awesomeblock">
<p>Si se agrega algún otro archivo que tenga una extensión distinta a las aceptadas (shp, zip, dbf, prj, shx, cpg, fix, qix, sbn o shp.xml) la consola va a arrojar un error. En este caso hay que evitar seleccionar el archivo con la extensión que está provocando el error (por ejemplo, sbx).</p>
</div>
</div>
<div class="figure" style="text-align: center">
<img src="Img/Asset2.png" alt="Ejemplo de la ventana para importar un vector o tabla." width="100%" />
<p class="caption">
(#fig:unnamed-chunk-38)Ejemplo de la ventana para importar un vector o tabla.
</p>
</div>
<p>Una vez que se haya dado clic en <code>Upload</code>, el progreso en la subida del archivo a GEE se puede consultar en la pestaña de <code>Tasks</code> (Fig. 4.4). Una vez terminado, el archivo podrá ser accesado dentro de la pestaña de Assets. A veces no aparece el archivo recién importado, por lo cual se sugiere refrescar los elementos de esta sección presionando el botón que se encuentra a la derecha de <code>New</code>.</p>
<div class="figure" style="text-align: center">
<img src="Img/Asset3.png" alt="Ejemplo de una importación en proceso." width="100%" />
<p class="caption">
(#fig:unnamed-chunk-39)Ejemplo de una importación en proceso.
</p>
</div>
<div class="bluebox2">
<div class="awesomeblock">
<p>Al igual que en la pestaña donde se organizan los repositorios y los códigos, en la pestaña de Assets se puede organizar la información en carpetas.</p>
</div>
</div>
<p>Para subir un nuevo archivo hay que dar clic en el botón <code>New</code>, seleccionar el tipo de archivo, y seguir las instrucciones:</p>
<ol style="list-style-type: decimal">
<li>Para los archivos ráster, sólo hace falta seleccionar el archivo correspondiente y dar clic en <code>Upload</code>.</li>
<li>Para los archivos tipo .shp es necesario subir los archivos auxiliares (dbf, prj, shx, cpg, fix, qix, sbn, y/o shp.xml) con el mismo nombre. Para los archivos .zip es necesario que contenga los archivos auxiliares.</li>
<li>Para los archivos .csv es necesario que exista una columna de longitud y otra de latitud, las coordenadas deben ser decimales y estar en EPSG:4326 (WGS 84). El nombre de esas columnas se debe indicar en <code>Advanced options</code> / x column - Y column. Además, se debe tener absoluta claridad del tipo de delimitador (ejemplo: coma: , punto y coma: ; u otro diferente) y este debe ser especificado en <code>Advanced options</code> / CSV delimiter.</li>
</ol>
<div class="bluebox2">
<div class="awesomeblock">
<p>El usuario puede compartir sus archivos con otros usuarios de GEE como lector o editor. De esta manera, el archivo compartido podrá ser consultado por los usuarios indicados. Esta opción está disponible al darle clic en el símbolo de compartir a la derecha de cada archivo (aparece una vez que se coloca el puntero sobre el nombre del archivo; Fig. 4.5).</p>
</div>
</div>
<div class="figure" style="text-align: center">
<img src="Img/shareAssets.png" alt="Ubicación del botón para compartir información importada en GEE." width="30%" />
<p class="caption">
(#fig:unnamed-chunk-40)Ubicación del botón para compartir información importada en GEE.
</p>
</div>
<p>Por último, para utilizar cualquier información importada a GEE en un código, se puede realizar de dos maneras. Lo primero que hay que hacer es darle clic a la información importada en la sección de Assets, tras lo cual aparecerá la siguiente ventana (Fig. 4.6).</p>
<div class="figure" style="text-align: center">
<img src="Img/Asset_ruta.png" alt="Ejemplo de la ventana de información importada en GEE y ubicación de la ruta de la misma." width="100%" />
<p class="caption">
(#fig:unnamed-chunk-41)Ejemplo de la ventana de información importada en GEE y ubicación de la ruta de la misma.
</p>
</div>
<p>La primera manera de utilizar dicha información en un código consiste en copiar la ruta de la información y utilizar en cualquier código para definir un objeto (similar a lo que se hizo en ejercicios anteriores con información hospedada en la nube de GEE; Fig. 4.6).</p>
<p>La segunda consiste en acceder al código en el que estamos interesados en utilizar la información. Buscar la información que se desea importar en la pestaña de Assets, darle clic, y al aparecer la misma ventana que en el ejemplo anterior, darle clic en el botón de Import (Fig. 4.7). De esa manera se importa la información en el código en el que se esté trabajando y se le asigna por defecto un nombre.</p>
<div class="figure" style="text-align: center">
<img src="Img/Asset_ruta2.png" alt="Ejemplo de la ventana de información importada en GEE y ubicación del botón para importar la misma a un código previamente abierto." width="100%" />
<p class="caption">
(#fig:unnamed-chunk-42)Ejemplo de la ventana de información importada en GEE y ubicación del botón para importar la misma a un código previamente abierto.
</p>
</div>
<!--chapter:end:04-assets.Rmd-->
<div style="page-break-after: always;"></div>
</div>
<div id="tipos-de-objetos" class="section level1" number="5">
<h1 number="5"><span class="header-section-number">5</span> Tipos de objetos</h1>
<p>Dentro de GEE existe una diversidad amplia de tipos de objetos, por ejemplo, objetos de tipo numérico, listas, cadenas de caracteres, entre otras. Sin embargo, esta variedad de tipos de objetos se puede agrupar en dos grandes rubros: en objetos del lado del cliente y en objetos del servidor, de acuerdo al lado donde se va a llevar a cabo el procedimiento deseado.</p>
<div id="objetos-del-cliente-y-del-servidor" class="section level2" number="5.1">
<h2 number="5.1"><span class="header-section-number">5.1</span> Objetos del cliente y del servidor</h2>
<p>Existen dos lados de la programación de la API de GEE: el del servidor y el del cliente o usuario (Fig. 5.1). De tal manera, un objeto puede ser convertido entre los dos tipos. Por ejemplo, mientras que del lado del cliente una cadena de caracteres puede ser definida simplemente como: <code>“cadena”</code>, para convertirla en objeto del lado del servidor deben utilizarse las funciones del servidor, es decir: <code>ee.String(“cadena”)</code>. Adicionalmente, algunas operaciones se pueden hacer utilizando ambos tipos de sintaxis. Por ejemplo, una suma se puede realizar del lado del cliente mediante <code>1 + 2</code>, mientras que del lado del servidor se utilizará <code>ee.Number(1).add(ee.Number(2))</code>.</p>
<p>En la mayoría de los casos se va a utilizar la programación del lado del servidor, ya que es la que permite hacer todo el procesamiento en GEE. Por ejemplo, para el caso de las condiciones se sugiere utilizar en lugar de <code>if</code> y <code>else</code>, la función <code>ee.Algorithms.If</code>. Sin embargo, cabe aclarar que algunas funciones sólo funcionan del lado del cliente. Por ejemplo, las funciones de la interfaz del usuario, utilizadas para exportar la información a algún archivo (ya sea un ráster, un vector o una tabla) <code>ee.Export...</code>, agregar una capa a la pantalla del mapa <code>Map.addLayer</code> o crear gráficos, así como imprimir información en la consola <code>print</code>. El siguiente diagrama permite visualizar el lado del usuario y del servidor en el funcionamiento de GEE.</p>
<div class="figure" style="text-align: center">
<img src="Img/daigFunc.png" alt="Representación de los dos lados de programación en GEE: del cliente y el servidor." width="100%" />
<p class="caption">
(#fig:unnamed-chunk-43)Representación de los dos lados de programación en GEE: del cliente y el servidor.
</p>
</div>
</div>
<div id="tipos-de-objetos-del-lado-del-cliente" class="section level2" number="5.2">
<h2 number="5.2"><span class="header-section-number">5.2</span> Tipos de objetos del lado del cliente</h2>
<div id="cadenas-de-texto" class="section level4 unnumbered">
<h4 class="unnumbered">Cadenas de texto</h4>
<p>Se refiere a objetos de cadenas de símbolos de tipo alfanumérico. Estos se definen como cualquier cadena de caracteres (número, letras o símbolos) que se encuentren entre un par de comillas bien sean dobles <code>“ ”</code> o sencillas <code>’ ’</code>. Por ejemplo:</p>
<p>Ejercicio 0</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Cadena de texto de solo letras</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> cadena <span class="op">=</span> “Esto es una cadena de caracteres”<span class="op">;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Cadena de texto de solo números</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> telefono<span class="op">=</span> <span class="st">&#39;1234567890&#39;</span><span class="op">;</span>  </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                     </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">// Cadena de texto de letras, números y símbolos</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> direccion <span class="op">=</span> <span class="st">&#39;calle cuarta casa # 16&#39;</span><span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Cadena de texto de solo letras
var cadena = “Esto es una cadena de caracteres”;

// Cadena de texto de solo números
var telefono= '1234567890';  
                     
// Cadena de texto de letras, números y símbolos
var direccion = 'calle cuarta casa # 16';
</script>
<p>Ejercicio 0.1</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Cadena de texto concatenada</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> direccion <span class="op">=</span> direccion <span class="op">+</span> <span class="st">&#39; su número telefónico es:&#39;</span> <span class="op">+</span> telefono<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Cadena de texto concatenada
var direccion = direccion + ' su número telefónico es:' + telefono;
</script>
<div class="bluebox2">
<div class="awesomeblock">
<p>Los números en una cadena de texto no serán interpretados como valores numéricos sino como texto.</p>
</div>
</div>
</div>
<div id="números" class="section level4 unnumbered">
<h4 class="unnumbered">Números</h4>
<p>Se refiere a objetos numéricos que indican un valor. Para números decimales se utiliza el punto decimal y no la coma decimal. Por ejemplo:</p>
<p>Ejercicio 1</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Número entero</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> numero <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Número decimal con punto decimal  </span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> numero2 <span class="op">=</span> <span class="fl">2.5</span><span class="op">;</span>  </span></code></pre></div>
<script type="text/javascript">
// Número entero
var numero = 1; 
 
// Número decimal con punto decimal  
var numero2 = 2.5;  
</script>
<div class="bluebox2">
<div class="awesomeblock">
<p>Para los objetos numéricos no se usan las comillas.</p>
</div>
</div>
</div>
<div id="listas" class="section level4 unnumbered">
<h4 class="unnumbered">Listas</h4>
<p>Las listas se refieren a objetos que contienen varias entradas, las cuales pueden ser numéricas (números), cadenas de texto (texto) o incluso otras listas. Las listas se definen mediante el uso de corchetes <code>[]</code> y cada entrada es separada mediante una coma <code>,</code> . Por ejemplo:</p>
<p>Ejercicio 2</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Lista numérica</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> lista <span class="op">=</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">8</span>]<span class="op">;</span>   </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Lista de texto            </span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> listaA <span class="op">=</span> [“primero”<span class="op">,</span> “segundo”<span class="op">,</span> “tercero”]<span class="op">;</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">// Lista de texto y números  </span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> listaB <span class="op">=</span> [“primero”<span class="op">,</span> “segundo”<span class="op">,</span> “tercero”<span class="op">,</span> <span class="dv">4</span>]<span class="op">;</span> </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">// Lista de listas  </span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> listaC <span class="op">=</span> [lista<span class="op">,</span> listaA<span class="op">,</span> listaB]<span class="op">;</span> </span></code></pre></div>
<script type="text/javascript">
// Lista numérica
var lista = [1, 2, 3, 4, 5, 6, 7, 8];   
  
// Lista de texto            
var listaA = [“primero”, “segundo”, “tercero”]; 
   
// Lista de texto y números  
var listaB = [“primero”, “segundo”, “tercero”, 4]; 

// Lista de listas  
var listaC = [lista, listaA, listaB]; 
</script>
<p>Todas las listas automáticamente asignan, en orden, un número a cada elemento dentro de ellas, siempre empezando desde 0. Entonces se puede consultar un solo elemento dentro de una lista, indicando el número de su posición dentro de ella.</p>
<p>Ejercicio 2.1:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Primer objeto de la lista llamada &quot;lista&quot;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(lista[<span class="dv">0</span>])<span class="op">;</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Segundo objeto de la lista llamada &quot;listaA&quot;</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(listaA[<span class="dv">1</span>])<span class="op">;</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">// Tercer objeto de la lista llamada &quot;listaB&quot;</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(listaB[<span class="dv">2</span>])<span class="op">;</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co">// Lista completa con todos sus elementos</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(listaC)<span class="op">;</span>    </span></code></pre></div>
<script type="text/javascript">
// Primer objeto de la lista llamada "lista"
print(lista[0]); 

// Segundo objeto de la lista llamada "listaA"
print(listaA[1]);

// Tercer objeto de la lista llamada "listaB"
print(listaB[2]);

// Lista completa con todos sus elementos
print(listaC);    
</script>
</div>
<div id="diccionarios" class="section level4 unnumbered">
<h4 class="unnumbered">Diccionarios</h4>
<p>Los diccionarios son objetos que contienen claves (entradas) y valores asociados a estas claves (definiciones). Los diccionarios se definen mediante el uso de llaves <code>{}</code> donde se define cada clave seguida de dos puntos <code>:</code> y la definición del valor, cadena de caracteres, o lista asociada a esa clave. Para ingresar varias entradas, estas deben ir separadas por una coma.</p>
<p>Las claves o entradas siempre serán leídas como cadenas de texto. Se recomienda que no tengan espacios dentro de ellas, en su lugar se recomienda usar guión bajo <code>_</code> o la notación de “lowerCamelCase”. Al hacer <code>print</code> se ordenarán alfabéticamente las claves.</p>
<p>Ejercicio 3</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Se declara un nuevo diccionario.</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">// La primera entrada es el texto &quot;clave1&quot; que está definido con el valor</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">// de 1 (tipo número) la segunda entrada es el texto &quot;clave2&quot;, y su </span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">// definición es la letra &quot;A&quot; (tipo cadena de texto)</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> dicc <span class="op">=</span> {   </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">clave1</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span>      </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">clave2</span><span class="op">:</span> <span class="st">&quot;A&quot;</span>  </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span>            </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>      </span></code></pre></div>
<script type="text/javascript">
// Se declara un nuevo diccionario.
// La primera entrada es el texto "clave1" que está definido con el valor
// de 1 (tipo número) la segunda entrada es el texto "clave2", y su 
// definición es la letra "A" (tipo cadena de texto)
var dicc = {   
  clave1: 1,      
  clave2: "A"  
};            
      
</script>
<p>Para consultar los valores dentro de un diccionario se puede hacer de dos formas:</p>
<ul>
<li>Llamar directamente el nombre de la clave deseada dentro de comillas en un par de corchetes <code>[‘’]</code>.</li>
<li>Utilizar la notación de <code>.</code> seguida del nombre de la clave.</li>
</ul>
<p>Por ejemplo:</p>
<p>Ejercicio 3.1</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Notación de lista, se mostrará en la consola la definición de </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">// &quot;clave1&quot;, es decir el valor 1 </span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dicc[<span class="st">&quot;clave1&quot;</span>])<span class="op">;</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">// Notación de lista, se mostrará en la consola la definición de </span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">// &quot;clave2&quot;, es decir la letra &quot;A&quot;</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dicc[<span class="st">&quot;clave2&quot;</span>])<span class="op">;</span>  </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">// Notación con punto, se mostrará en la consola la definición de </span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co">// &quot;clave1&quot;, es decir el valor 1 </span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dicc<span class="op">.</span><span class="at">clave1</span>)<span class="op">;</span>  </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co">// Notación con punto, se mostrará en la consola la definición de </span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co">// &quot;clave2&quot;, es decir la letra &quot;A&quot;</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dicc<span class="op">.</span><span class="at">clave2</span>)<span class="op">;</span>  </span></code></pre></div>
<script type="text/javascript">
// Notación de lista, se mostrará en la consola la definición de 
// "clave1", es decir el valor 1 
print(dicc["clave1"]); 

// Notación de lista, se mostrará en la consola la definición de 
// "clave2", es decir la letra "A"
print(dicc["clave2"]);  

// Notación con punto, se mostrará en la consola la definición de 
// "clave1", es decir el valor 1 
print(dicc.clave1);  

// Notación con punto, se mostrará en la consola la definición de 
// "clave2", es decir la letra "A"
print(dicc.clave2);  
</script>
<div class="bluebox2">
<div class="awesomeblock">
<p>Para los diccionarios se recomienda utilizar la notación de <code>.</code> seguida del nombre de la clave, ya que es la recomendada por GEE.</p>
</div>
</div>
</div>
<div id="funciones" class="section level4 unnumbered">
<h4 class="unnumbered">Funciones</h4>
<p>Se refiere a objetos que contienen algún proceso que se realizará a alguna variable. Siempre comienzan con <code>function</code> (función) seguida por el objeto al que se le aplicará la función. Este objeto debe escribirse entre paréntesis, y entre llaves se coloca el procedimiento que va a realizar la función. Por último, debe regresar un objeto mediante la función <code>return</code>. Por ejemplo:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">// MaskIm es una nueva función, y su argumento de entrada es &quot;objeto&quot;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> maskIm <span class="op">=</span> <span class="kw">function</span>(objeto){ </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Se define qué &quot;objeto&quot; es una imagen ráster, y se guarda en la </span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co">// variable image</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> image <span class="op">=</span> ee<span class="op">.</span><span class="fu">Image</span>(objeto)     </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co">// Se selecciona solamente la banda de nombre &quot;pixel_qa&quot; de la imagen</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">// image</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> qaImage <span class="op">=</span> image<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;pixel_qa&#39;</span>)<span class="op">;</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">// Se crea una nueva imagen binaria donde será 1 los píxeles con valor </span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co">// igual a 322, y 0 los demás</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> clearData <span class="op">=</span> qaImage<span class="op">.</span><span class="fu">eq</span>(<span class="dv">322</span>)<span class="op">;</span>      </span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co">// Se crea una máscara con la imagen binaria, y se entrega la imagen </span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co">// original enmascarada</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="cf">return</span> image<span class="op">.</span><span class="fu">updateMask</span>(clearData)<span class="op">;</span>      </span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a> }<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// MaskIm es una nueva función, y su argumento de entrada es "objeto"
var maskIm = function(objeto){ 

// Se define qué "objeto" es una imagen ráster, y se guarda en la 
// variable image
var image = ee.Image(objeto)     
 
// Se selecciona solamente la banda de nombre "pixel_qa" de la imagen
// image
var qaImage = image.select('pixel_qa');
     
// Se crea una nueva imagen binaria donde será 1 los píxeles con valor 
// igual a 322, y 0 los demás
var clearData = qaImage.eq(322);      
    
// Se crea una máscara con la imagen binaria, y se entrega la imagen 
// original enmascarada
return image.updateMask(clearData);      
 };
</script>
<p>Aunque las funciones son propiamente objetos del lado del cliente, deben contener únicamente métodos del lado del servidor para que funcionen apropiadamente al trabajar en GEE. Esto permite que GEE interprete cualquier serie de procesos de manera adecuada en sus servidores. Esto quedará más claro después de repasar la siguiente sección.</p>
<div class="bluebox2">
<div class="awesomeblock">
<p>Las funciones que se ejecuten sobre una colección de imágenes o vectores sólo funcionan si regresan un objeto de tipo <code>ee.Feature</code>, <code>ee.FeatureCollection</code>, <code>ee.Image</code> o <code>ee.ImageCollection</code>, por lo cual, a veces, se deben realizar ciertas conversiones para evitar un error.</p>
</div>
</div>
</div>
</div>
<div id="tipo-de-objetos-del-lado-del-servidor" class="section level2" number="5.3">
<h2 number="5.3"><span class="header-section-number">5.3</span> Tipo de objetos del lado del servidor</h2>
<p>Los objetos del lado del servidor, además de permitir llevar a cabo procesos en los servidores de GEE, tienen asociados una serie de métodos particulares por tipo de objeto. Esto quiere decir que al convertir un objeto del lado del cliente al del servidor, automáticamente se abre la posibilidad de utilizar los métodos pre cargadas en GEE para ese tipo de objeto. Toda la información que se encuentra disponible en GEE corresponderá a objetos del servidor, entre los que destacan los objetos de tipo imagen (ráster), vector, colecciones de imágenes y colecciones de vectores.</p>
<div class="bluebox2">
<div class="awesomeblock">
<p>Para saber cuáles objetos son del servidor, resulta útil recordar que todos ellos cuentan con el prefijo <code>ee.</code> (del servidor de Earth Engine) seguido del nombre del tipo de objeto con inicial mayúscula.</p>
</div>
</div>
<p>Los objetos del lado del servidor se pueden conceptualizar como contenedores que le indican al servidor qué tipo de objeto es el que se está enviando. Además, cuando se trabaja del lado del servidor, los objetos necesariamente son enviados al servidor para ser evaluados. A continuación se describen los tipos de objetos que más se usan (Fig. 5.2).</p>
<div class="bluebox2">
<div class="awesomeblock">
<p>En algunos casos, los objetos que se obtienen a partir de ciertos métodos retornan un objeto de tipo indefinido (tipo objeto, <code>ee.Object</code>) como por ejemplo al usar, en casos particulares, los métodos <code>.first</code> ó <code>.get</code>, por lo cual se recomienda meter este objeto indefinido en un contenedor que indique el tipo de objeto del servidor. De no hacerlo, GEE mostrará un error <code>“...is not a function”</code>.</p>
</div>
</div>
<div class="bluebox2">
<div class="awesomeblock">
<p>Para revisar todos los métodos disponibles en GEE clasificados por tipo de objeto del servidor se pueden consultar la sección de Client libraries en el siguiente enlace: <a href="https://developers.google.com/earth-engine/apidocs" class="uri">https://developers.google.com/earth-engine/apidocs</a>
En <code>Client libraries</code> se indican cuáles argumentos acepta cada método o función, así como el tipo de objeto de la salida.</p>
</div>
</div>
<div class="figure" style="text-align: center">
<img src="Img/objetosServ2.png" alt="Diagrama con algunos de los objetos del lado del servidor más utilizados en GEE." width="100%" />
<p class="caption">
(#fig:unnamed-chunk-52)Diagrama con algunos de los objetos del lado del servidor más utilizados en GEE.
</p>
</div>
<div id="ee.string" class="section level4 unnumbered">
<h4 class="unnumbered">ee.String</h4>
<p>Este tipo de objeto es equivalente a la cadena de texto pero del lado del servidor, ya que permite enviar un objeto como cadena de caracteres al servidor. Además, al definir un objeto de este tipo, se puede utilizar cualquier método indicado para objetos de tipo <code>ee.String</code> en la API (ver liga anterior).</p>
<p>Ejercicio 4:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Esta es una cadena de texto del lado del cliente</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> cadena2 <span class="op">=</span> <span class="st">&quot;Esto es una cadena de caracteres&quot;</span><span class="op">;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">// En este paso se convierte el texto del lado del cliente a un ee.String</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">// del lado del servidor</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> cadenaServ <span class="op">=</span> ee<span class="op">.</span><span class="fu">String</span>(cadena2)<span class="op">;</span>                         </span></code></pre></div>
<script type="text/javascript">
// Esta es una cadena de texto del lado del cliente
var cadena2 = "Esto es una cadena de caracteres";
// En este paso se convierte el texto del lado del cliente a un ee.String
// del lado del servidor
var cadenaServ = ee.String(cadena2);                         
</script>
</div>
<div id="ee.number" class="section level4 unnumbered">
<h4 class="unnumbered">ee.Number</h4>
<p>Permite enviar un número como objeto al servidor. Además, al definir un objeto de este tipo, se puede utilizar cualquier método indicado para objetos de tipo <code>ee.Number</code> en la API (ver liga anterior).</p>
<p>Ejercicio 5:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Se define un número como `ee.Number` del servidor</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> numServ <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(<span class="dv">1900</span>)<span class="op">;</span>                              </span></code></pre></div>
<script type="text/javascript">
// Se define un número como `ee.Number` del servidor
var numServ = ee.Number(1900);                              
</script>
</div>
<div id="ee.list" class="section level4 unnumbered">
<h4 class="unnumbered">ee.List</h4>
<p>Este tipo de objetos corresponden a listas del lado del servidor. Al definir un objeto de este tipo, se puede utilizar cualquier método indicado para objetos <code>ee.List</code> (ver enlace anterior).</p>
<p>Ejercicio 6:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Se construye una nueva lista con diferentes tipos de objetos del lado </span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">// del usuario y servidor</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> lista <span class="op">=</span> [<span class="st">&#39;hola&#39;</span><span class="op">,</span><span class="st">&#39;12&#39;</span><span class="op">,</span><span class="st">&#39;5%&#39;</span><span class="op">,</span> ee<span class="op">.</span><span class="fu">String</span>(<span class="st">&#39;servidor&#39;</span>)<span class="op">,</span> ee<span class="op">.</span><span class="fu">Number</span>(<span class="dv">64</span>)<span class="op">,</span> <span class="fl">8.32</span>]<span class="op">;</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co">// Se define una lista como ee.List del servidor </span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> listaServ <span class="op">=</span> ee<span class="op">.</span><span class="fu">List</span>(lista)<span class="op">;</span>             </span></code></pre></div>
<script type="text/javascript">
// Se construye una nueva lista con diferentes tipos de objetos del lado 
// del usuario y servidor
var lista = ['hola','12','5%', ee.String('servidor'), ee.Number(64), 8.32];

// Se define una lista como ee.List del servidor 
var listaServ = ee.List(lista);             
</script>
<p>Para acceder a un elemento de tipo <code>ee.List</code> se utiliza el método <code>.get</code>.</p>
<p>Ejercicio 6.1:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Se llama solamente al primero objeto de la ee.List del servidor</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(listaServ<span class="op">.</span><span class="fu">get</span>(<span class="dv">0</span>))<span class="op">;</span>   </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Se llama solamente al segundo objeto de la ee.List del servidor</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(listaServ<span class="op">.</span><span class="fu">get</span>(<span class="dv">1</span>))<span class="op">;</span> </span></code></pre></div>
<script type="text/javascript">
// Se llama solamente al primero objeto de la ee.List del servidor
print(listaServ.get(0));   

// Se llama solamente al segundo objeto de la ee.List del servidor
print(listaServ.get(1)); 
</script>
</div>
<div id="ee.dictionary" class="section level4 unnumbered">
<h4 class="unnumbered">ee.Dictionary</h4>
<p>Permite enviar un objeto como diccionario al servidor. La definición de objetos <code>ee.Dictionary</code> habilita los métodos disponibles en GEE para este tipo de objetos (ver liga anterior).</p>
<p>Ejercicio 7</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Se construye un diccionario de usuario con diferentes tipos de objetos</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co">// del lado del usuario y servidor</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> dicc <span class="op">=</span> {                                                 </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;texto de usuario&#39;</span><span class="op">:</span><span class="st">&#39;usuario&#39;</span><span class="op">,</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;string del servidor&#39;</span><span class="op">:</span> ee<span class="op">.</span><span class="fu">String</span>(<span class="st">&#39;texto de servidor # 2&#39;</span>)<span class="op">,</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;numero de usuario&#39;</span><span class="op">:</span> <span class="dv">4</span><span class="op">,</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;numero de servidor&#39;</span><span class="op">:</span> ee<span class="op">.</span><span class="fu">Number</span>(<span class="fl">3.1416</span>)<span class="op">,</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;lista de usuario&#39;</span><span class="op">:</span> [<span class="dv">1</span><span class="op">,</span> <span class="st">&#39;ejemplo&#39;</span>]<span class="op">,</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;lista de servidor&#39;</span><span class="op">:</span> ee<span class="op">.</span><span class="fu">List</span>([ee<span class="op">.</span><span class="fu">String</span>(<span class="st">&#39;texto de servidor # 3&#39;</span>)<span class="op">,</span> </span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    ee<span class="op">.</span><span class="fu">Number</span>(<span class="fl">1.44</span>)])</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span> </span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co">// Se define el diccionario de usuario anterior como ee.Dictionary del </span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co">// servidor </span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> diccServ <span class="op">=</span> ee<span class="op">.</span><span class="fu">Dictionary</span>(dicc)<span class="op">;</span>     </span></code></pre></div>
<script type="text/javascript">
// Se construye un diccionario de usuario con diferentes tipos de objetos
// del lado del usuario y servidor
var dicc = {                                                 
  'texto de usuario':'usuario',
  'string del servidor': ee.String('texto de servidor # 2'),
  'numero de usuario': 4,
  'numero de servidor': ee.Number(3.1416),
  'lista de usuario': [1, 'ejemplo'],
  'lista de servidor': ee.List([ee.String('texto de servidor # 3'), 
    ee.Number(1.44)])
}; 

// Se define el diccionario de usuario anterior como ee.Dictionary del 
// servidor 
var diccServ = ee.Dictionary(dicc);     
</script>
<p>Se puede consultar utilizando también el método <code>.get</code> y el nombre de la clave.</p>
<p>Ejercicio 7.1</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Se muestra el valor que contiene la clave &quot;lista_de_servidor&quot;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(diccServ<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;lista_de_servidor&#39;</span>))<span class="op">;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Se muestra el valor que contiene el elemento &quot;numero_de_usuario&quot;   </span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(diccServ<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;numero_de_usuario&#39;</span>))<span class="op">;</span>        </span></code></pre></div>
<script type="text/javascript">
// Se muestra el valor que contiene la clave "lista_de_servidor"
print(diccServ.get('lista_de_servidor'));

// Se muestra el valor que contiene el elemento "numero_de_usuario"   
print(diccServ.get('numero_de_usuario'));        
</script>
<p>Por último, si se desea obtener las claves disponibles en un <code>ee.Dictionary</code> se utiliza el método <code>.keys</code>. Este método devuelve una lista. De igual forma, si se desea obtener los valores disponibles en un <code>ee.Dictionary</code> se utiliza el método <code>.values</code>, la cual devuelve una lista.</p>
<p>Ejercicio 7.2</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Muestra una lista con todas las claves del ee.Dictionary</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;claves&#39;</span><span class="op">,</span>diccServ<span class="op">.</span><span class="fu">keys</span>())<span class="op">;</span>    </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Muestra una lista con todos los valores del ee.Dictionary</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;valores&#39;</span><span class="op">,</span>diccServ<span class="op">.</span><span class="fu">values</span>())<span class="op">;</span>  </span></code></pre></div>
<script type="text/javascript">
// Muestra una lista con todas las claves del ee.Dictionary
print('claves',diccServ.keys());    

// Muestra una lista con todos los valores del ee.Dictionary
print('valores',diccServ.values());  
</script>
</div>
<div id="ee.date" class="section level4 unnumbered">
<h4 class="unnumbered">ee.Date</h4>
<p>Esta es la forma en la que GEE trabaja con fechas. Al definir un objeto de este tipo, se puede utilizar cualquier método indicado para objetos de tipo <code>ee.Date</code> (ver enlace anterior). Hay varias formas de construir una fecha específica:</p>
<ol style="list-style-type: decimal">
<li>Se puede usar un texto de usuario indicando la fecha en el siguiente formato: “YYYY-MM-DD”, esta fecha obligatoriamente debe:</li>
</ol>
<ul>
<li>Usar la función <code>ee.Date</code>.</li>
<li>Indicar la fecha en el orden de Año Mes Día (AAAA-MM-DD).</li>
<li>Usar guiones como separadores <code>-</code>.</li>
<li>Tener meses numéricos de dos dígitos (01, 02, 03, 04, 05, 06, 07, 08, 09, 10, 11, 12).</li>
<li>Tener días de dos dígitos (01, 02, 03 … 09, 10, 11 … 30).</li>
<li>Estar entre comillas, “1989-08-23”.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Usar números de usuario, en este caso se debe:</li>
</ol>
<ul>
<li>Usar el método <code>ee.DatefromYMD</code>.</li>
<li>Ingresar dentro del paréntesis el año, el mes y el día (en ese orden), separados por comas. <code>ee.Date.fromYMD(2015,03,28)</code></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Usar un texto de usuario especificando el formato, para esto se debe:</li>
</ol>
<ul>
<li>Usar el método <code>ee.Date.parse</code>.</li>
<li>Especificar el formato de la fecha con la siguiente clave (YYYY=año, MM=mes, D=día).</li>
<li>Especificar el tipo de separador.</li>
<li>Especificar el orden en el que se ingresará el texto.</li>
<li>Especificar la cantidad de dígitos esperada para cada ítem (año, mes y día).</li>
<li>El formato debe estar entre comillas.</li>
<li>Luego de especificar el formato, se ingresa dentro de comillas el texto a convertir a <code>ee.Date</code> (entre el formato y el texto debe ir una coma).</li>
</ul>
<p>Ejercicio 8:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Fecha como un texto de cliente</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> fechaString <span class="op">=</span> <span class="st">&#39;2001-10&#39;</span><span class="op">;</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Convierte la fecha de texto de cliente a ee.Date del servidor    </span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> fecha <span class="op">=</span> ee<span class="op">.</span><span class="fu">Date</span>(fechaString)<span class="op">;</span>  </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co">// Crea una ee.Date a partir de definir año, mes y dia con números del </span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co">// cliente           </span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> fecha2 <span class="op">=</span> ee<span class="op">.</span><span class="at">Date</span><span class="op">.</span><span class="fu">fromYMD</span>(<span class="dv">2015</span><span class="op">,</span><span class="dv">03</span><span class="op">,</span><span class="dv">28</span>)<span class="op">;</span> </span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="co">// Crea una fecha a partir de un formato especificado y un texto que </span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="co">// cumple con dicho formato, nótese que se especifica el orden del día </span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="co">// año y mes, se especifica cada separador, y si se usan meses como texto</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="co">// deben ser las 3 primeras iniciales del mes en inglés</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> fecha3 <span class="op">=</span> ee<span class="op">.</span><span class="at">Date</span><span class="op">.</span><span class="fu">parse</span>(<span class="st">&#39;DD_YYYY/MMM&#39;</span><span class="op">,</span> <span class="st">&#39;14_1827/jul&#39;</span>)<span class="op">;</span> </span></code></pre></div>
<script type="text/javascript">
// Fecha como un texto de cliente
var fechaString = '2001-10';

// Convierte la fecha de texto de cliente a ee.Date del servidor    
var fecha = ee.Date(fechaString);  

// Crea una ee.Date a partir de definir año, mes y dia con números del 
// cliente           
var fecha2 = ee.Date.fromYMD(2015,03,28); 
   
// Crea una fecha a partir de un formato especificado y un texto que 
// cumple con dicho formato, nótese que se especifica el orden del día 
// año y mes, se especifica cada separador, y si se usan meses como texto
// deben ser las 3 primeras iniciales del mes en inglés
var fecha3 = ee.Date.parse('DD_YYYY/MMM', '14_1827/jul'); 
</script>
</div>
<div id="ee.image" class="section level4 unnumbered">
<h4 class="unnumbered">ee.Image</h4>
<p>La definición de objetos <code>ee.Image</code> (imagen) habilita los métodos disponibles en GEE para el procesamiento de imágenes. Este va a ser el tipo de objetos para trabajar con cualquier elemento de tipo ráster en GEE. Más adelante se explica con mayor detalle.</p>
</div>
<div id="ee.imagecollection" class="section level4 unnumbered">
<h4 class="unnumbered">ee.ImageCollection</h4>
<p>Las colecciones de imágenes (“image collections”) están formadas por imágenes individuales (<code>ee.Image</code>). Al definir un objeto de este tipo, se puede utilizar cualquier método para objetos de tipo <code>ee.ImageCollection</code>. Más adelante se explica este tipo de objetos con mayor detalle.</p>
</div>
<div id="ee.feature" class="section level4 unnumbered">
<h4 class="unnumbered">ee.Feature</h4>
<p>Este va a ser el tipo de objetos para trabajar con cualquier objeto de tipo vector o tabla. Al definir un objeto de este tipo, se puede utilizar cualquier método para objetos <code>ee.Feature</code>. Más adelante se explica este tipo de objeto con mayor detalle.</p>
</div>
<div id="ee.featurecollection" class="section level4 unnumbered">
<h4 class="unnumbered">ee.FeatureCollection</h4>
<p>Las colecciones de vectores (“feature collections”) están formadas por varios vectores (<code>ee.Feature</code>). Además, al definir un objeto como <code>ee.FeatureCollection</code> permite utilizar cualquier método definido para este tipo de objetos. Más adelante se explica estos objetos con mayor detalle.</p>
</div>
<div id="ee.algorithms" class="section level4 unnumbered">
<h4 class="unnumbered">ee.Algorithms</h4>
<p>Este tipo de objetos contienen algoritmos precargados en GEE. Estos algoritmos tienen una gran variedad de aplicaciones, desde operaciones sencillas como una evaluación lógica, por ejemplo, <code>ee.Algorithms.If</code>, hasta algoritmos de segmentación temporal de una serie de imágenes, por ejemplo, <code>ee.Algorithms.TemporalSegmentation.Ccdc</code>.</p>
</div>
<div id="ee.array" class="section level4 unnumbered">
<h4 class="unnumbered">ee.Array</h4>
<p>Este tipo de objetos corresponden a arreglos multidimensionales. Los arreglos se pueden interpretar como matrices de más de dos dimensiones (por ejemplo, filas y columnas). Su uso más común se da en el análisis de series de tiempo o con ordenaciones espectrales. Este tipo de objetos cuentan con una serie de métodos, los cuales se pueden consultar bajo la biblioteca de <code>ee.Array</code> (ver liga anterior).</p>
</div>
<div id="ee.classifier" class="section level4 unnumbered">
<h4 class="unnumbered">ee.Classifier</h4>
<p>Este tipo de objetos corresponden a algoritmos de clasificación supervisada de datos que se encuentran precargados en GEE. Por ejemplo, se encuentra el algoritmo de random forest, disponible mediante la función <code>ee.Classifier.smileRandomForest</code> o MaxEnt, disponible mediante la función <code>ee.Classifier.amnhMaxent</code>, entre otros.</p>
</div>
<div id="ee.clusterer" class="section level4 unnumbered">
<h4 class="unnumbered">ee.Clusterer</h4>
<p>Este tipo de objetos corresponden a algoritmos de clasificación no supervisada de datos que se encuentran precargados en GEE. Por ejemplo, se encuentra el algoritmo de k-means, disponible mediante la función <code>ee.Clusterer.wekaKMeans</code> o Cobweb, disponible mediante la función <code>ee.Clusterer.wekaCobweb</code>.</p>
</div>
<div id="ee.filter" class="section level4 unnumbered">
<h4 class="unnumbered">ee.Filter</h4>
<p>Este tipo de objetos se utilizan para filtrar colecciones, ya sean de vectores o de imágenes. También permiten definir filtros de distintos tipos, ya sean espaciales, temporales o en función de características de las imágenes o vectores (por ejemplo, metadatos). Por último, contienen métodos para combinar filtros.</p>
</div>
<div id="ee.geometry" class="section level4 unnumbered">
<h4 class="unnumbered">ee.Geometry</h4>
<p>Este tipo de objetos corresponden a distintos tipos de geometrías, que incluyen líneas, polígonos y puntos. Además, en GEE se encuentran varios métodos precargados que se pueden aplicar a este tipo de objetos como, por ejemplo, <code>ee.Geometry.MultiPolygon.Simplify</code> para simplificar polígonos múltiples o <code>ee.Geometry.Polygon.area</code> para calcular el área de un polígono.</p>
</div>
<div id="ee.join" class="section level4 unnumbered">
<h4 class="unnumbered">ee.Join</h4>
<p>Este conjunto de métodos permite realizar uniones entre colecciones de vectores, utilizando los campos de estos como las claves para realizar las uniones. Por ejemplo, se pueden unir dos colecciones de vectores mediante <code>ee.Join.merge</code> o unir los campos de una primera colección con los de una segunda mediante <code>ee.Join.inner</code>.</p>
</div>
<div id="ee.reducer" class="section level4 unnumbered">
<h4 class="unnumbered">ee.Reducer</h4>
<p>Los reductores (“reducers”) permiten agregar datos basados en una regla o utilizando una operación matemática determinada. Este tipo de métodos son los utilizados para generar, por ejemplo, una sola imagen a partir de varias imágenes que comparten una misma extensión espacial. El tipo de reductor define el tipo de agregación que se aplique. Por ejemplo, se puede reducir con una sencilla estadística (mínimo, máximo, media, moda, mediana, etc.) o con reductores más complejos (histogramas, enlistar, regresión lineal). También pueden reducirse datos con dimensión temporal (colección de imágenes de diferentes fechas), dimensión espacial, según las bandas de las imágenes o incluso según los atributos de los vectores.</p>
</div>
<div id="ee.terrain" class="section level4 unnumbered">
<h4 class="unnumbered">ee.Terrain</h4>
<p>Este conjunto de métodos permite calcular algunas operaciones topográficas, a partir de un modelo digital de elevación (DEM). Por ejemplo, en GEE se encuentran los métodos <code>ee.Terrain.aspect</code> para calcular el aspecto o <code>ee.Terrain.slope</code> para calcular la pendiente.</p>
<div class="bluebox2">
<div class="awesomeblock">
<p>Los argumentos de cualquier método del servidor se pasan como un diccionario (dentro de llaves <code>{}</code>).</p>
</div>
</div>
<!--chapter:end:05-tiposdeobjetos.Rmd-->
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div id="ee.geometry-1" class="section level1" number="6">
<h1 number="6"><span class="header-section-number">6</span> ee.Geometry</h1>
<p>Las geometrías (<code>ee.Geometry</code>) son objetos que permiten leer y manejar formas geométricas asociadas a un sistema de coordenadas geográficas. En GEE existen diversos tipos de geometrías que incluyen punto, multipunto, línea, multilínea, perímetro, polígono y multipolígono. Las geometrías en GEE corresponden, por defecto, a geometrías geodésicas.</p>
<div id="información-y-metadatos" class="section level2" number="6.1">
<h2 number="6.1"><span class="header-section-number">6.1</span> Información y metadatos</h2>
<p>La información que contienen los objetos de tipo geometría corresponden a puntos, líneas o polígonos definidos por una lista de coordenadas geográficas. Por lo tanto, dependiendo del tipo de geometría, se pueden consultar algunas características de estos como el área de un polígono mediante <code>.area</code>, el tipo de la geometría, mediante <code>.type</code> o las coordenadas mediante <code>.coordinates</code>.</p>
</div>
<div id="creación-de-geometrías" class="section level2" number="6.2">
<h2 number="6.2"><span class="header-section-number">6.2</span> Creación de geometrías</h2>
<p>GEE utiliza el objeto <code>ee.Geometry</code> para leer y manejar formas geométricas, estas incluyen geometrías sin área, como son:</p>
<ul>
<li>Punto (<code>ee.Geometry.Point</code>): una coordenada en X &amp; Y.</li>
<li>Multipunto (<code>ee.Geometry.MultiPoint</code>): una lista de puntos.</li>
<li>Línea (<code>ee.Geometry.LineString</code>): una línea.</li>
<li>Multilínea (<code>ee.Geometry.MultiLineString</code>): una lista de líneas.</li>
<li>Perímetro (<code>ee.Geometry.línearRing</code>): un perímetro (una línea cerrada).</li>
</ul>
<p>Ejercicio 9</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Un punto definido con su coordenada  </span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> punto <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Point</span>(<span class="op">-</span><span class="fl">99.14</span><span class="op">,</span> <span class="fl">19.47</span>)<span class="op">;</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Un MultiPunto definido a partir de una lista de coordenadas de puntos</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> MultiPunto <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">MultiPoint</span>([     </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">74.072</span><span class="op">,</span> <span class="fl">4.754</span><span class="op">,</span>                              </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">75.545</span><span class="op">,</span> <span class="fl">6.285</span><span class="op">,</span>                             </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">76.533</span><span class="op">,</span> <span class="fl">3.461</span><span class="op">,</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">74.819</span><span class="op">,</span> <span class="fl">10.997</span><span class="op">,</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">75.501</span><span class="op">,</span> <span class="fl">10.393</span>])<span class="op">;</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="co">// Una línea definida a partir de una lista de las coordenadas de sus </span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co">// vértices</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> linea <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">LineString</span>([ </span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">117.08</span><span class="op">,</span> <span class="fl">32.04</span><span class="op">,</span>                    </span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">104.25</span><span class="op">,</span> <span class="fl">31.74</span><span class="op">,</span>                    </span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">96.69</span><span class="op">,</span> <span class="fl">25.58</span><span class="op">,</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">95.99</span><span class="op">,</span> <span class="fl">19.74</span><span class="op">,</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">87.2</span><span class="op">,</span> <span class="fl">21.39</span><span class="op">,</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">87.2</span><span class="op">,</span> <span class="fl">16.91</span><span class="op">,</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">82.28</span><span class="op">,</span> <span class="fl">14.88</span><span class="op">,</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">83.15</span><span class="op">,</span> <span class="fl">10.07</span><span class="op">,</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">77.35</span><span class="op">,</span> <span class="fl">8.86</span><span class="op">,</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">71.55</span><span class="op">,</span> <span class="fl">12.66</span>])<span class="op">;</span> </span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a><span class="co">// Una Multilínea definida a partir de una lista de líneas ee.LineString, </span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a><span class="co">// que a su vez están definidas por una lista de las coordenadas de</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a><span class="co">// sus vértices</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> MultiLinea <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">MultiLineString</span>([ </span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>   ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">LineString</span>(                     </span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>     [<span class="op">-</span><span class="fl">76.017</span><span class="op">,</span> <span class="fl">26.173</span><span class="op">,</span> <span class="op">-</span><span class="fl">76.017</span><span class="op">,</span> <span class="fl">16.173</span>])<span class="op">,</span>      </span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">LineString</span>(                      </span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>    [<span class="op">-</span><span class="fl">73.017</span><span class="op">,</span> <span class="fl">26.173</span><span class="op">,</span> <span class="op">-</span><span class="fl">73.017</span><span class="op">,</span> <span class="fl">16.173</span>])<span class="op">,</span>       </span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">LineString</span>(                      </span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>    [<span class="op">-</span><span class="fl">78.434</span><span class="op">,</span> <span class="fl">20.926</span><span class="op">,</span> <span class="op">-</span><span class="fl">70.04</span><span class="op">,</span> <span class="fl">24.401</span>])<span class="op">,</span></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">LineString</span>(</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>    [<span class="op">-</span><span class="fl">78.434</span><span class="op">,</span> <span class="fl">18.926</span><span class="op">,</span> <span class="op">-</span><span class="fl">70.04</span><span class="op">,</span> <span class="fl">22.401</span>])])<span class="op">;</span></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a><span class="co">// Un perímetro definido a partir de una lista  de las coordenadas </span></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a><span class="co">// de los vértices</span></span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> perimetro <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">LinearRing</span>([ </span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">105.732</span><span class="op">,</span> <span class="fl">20.627</span><span class="op">,</span>                      </span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">109.336</span><span class="op">,</span> <span class="fl">26.544</span><span class="op">,</span>                      </span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">113.291</span><span class="op">,</span> <span class="fl">31.274</span><span class="op">,</span></span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">114.829</span><span class="op">,</span> <span class="fl">31.274</span><span class="op">,</span></span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">109.468</span><span class="op">,</span> <span class="fl">23.317</span>])<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Un punto definido con su coordenada  
var punto = ee.Geometry.Point(-99.14, 19.47); 

// Un MultiPunto definido a partir de una lista de coordenadas de puntos
var MultiPunto = ee.Geometry.MultiPoint([     
  -74.072, 4.754,                              
  -75.545, 6.285,                             
  -76.533, 3.461,
  -74.819, 10.997,
  -75.501, 10.393]);

// Una línea definida a partir de una lista de las coordenadas de sus 
// vértices
var linea = ee.Geometry.LineString([ 
  -117.08, 32.04,                    
  -104.25, 31.74,                    
  -96.69, 25.58,
  -95.99, 19.74,
  -87.2, 21.39,
  -87.2, 16.91,
  -82.28, 14.88,
  -83.15, 10.07,
  -77.35, 8.86,
  -71.55, 12.66]); 

// Una Multilínea definida a partir de una lista de líneas ee.LineString, 
// que a su vez están definidas por una lista de las coordenadas de
// sus vértices
var MultiLinea = ee.Geometry.MultiLineString([ 
   ee.Geometry.LineString(                     
     [-76.017, 26.173, -76.017, 16.173]),      
  ee.Geometry.LineString(                      
    [-73.017, 26.173, -73.017, 16.173]),       
  ee.Geometry.LineString(                      
    [-78.434, 20.926, -70.04, 24.401]),
  ee.Geometry.LineString(
    [-78.434, 18.926, -70.04, 22.401])]);

// Un perímetro definido a partir de una lista  de las coordenadas 
// de los vértices
var perimetro = ee.Geometry.LinearRing([ 
  -105.732, 20.627,                      
  -109.336, 26.544,                      
  -113.291, 31.274,
  -114.829, 31.274,
  -109.468, 23.317]);
</script>
<p>También hay geometrías que tienen el componente de área, como son:</p>
<ul>
<li>Rectángulo (<code>ee.Geometry.Rectangle</code>): un rectángulo.</li>
<li>Polígono (<code>ee.Geometry.Polygon</code>): un polígono.</li>
<li>Multipolígono (<code>ee.Geometry.MultiPolygon</code>): una lista de polígonos.</li>
</ul>
<p>Ejercicio 9.1</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Un rectángulo definido por las coordenadas de los vértices opuestos</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> rectangulo <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>( </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">104.12</span><span class="op">,</span> <span class="fl">5.73</span><span class="op">,</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">88.21</span><span class="op">,</span> <span class="op">-</span><span class="fl">0.15</span>)<span class="op">;</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co">// Un polígono definido por las coordenadas de sus vértices</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> poligono <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Polygon</span>( </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">80.348</span><span class="op">,</span> <span class="op">-</span><span class="fl">3.36</span><span class="op">,</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">80.348</span><span class="op">,</span> <span class="op">-</span><span class="fl">3.36</span><span class="op">,</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">78.985</span><span class="op">,</span> <span class="op">-</span><span class="fl">5.113</span><span class="op">,</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">78.019</span><span class="op">,</span> <span class="op">-</span><span class="fl">3.228</span><span class="op">,</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">75.997</span><span class="op">,</span> <span class="op">-</span><span class="fl">2.394</span><span class="op">,</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">75.25</span><span class="op">,</span> <span class="op">-</span><span class="fl">0.901</span><span class="op">,</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">75.865</span><span class="op">,</span> <span class="fl">0.11</span><span class="op">,</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">78.941</span><span class="op">,</span> <span class="fl">1.428</span><span class="op">,</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">80.26</span><span class="op">,</span> <span class="fl">0.725</span><span class="op">,</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">80.919</span><span class="op">,</span> <span class="op">-</span><span class="fl">1.911</span><span class="op">,</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">79.776</span><span class="op">,</span> <span class="op">-</span><span class="fl">2.614</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a><span class="co">// Un multipolígono definido por una lista de polígonos</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> Multipoligono <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">MultiPolygon</span>([</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">// El primer polígono está definido a partir de dos perímetros</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>    ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Polygon</span>(  </span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a><span class="co">// El primer perímetro define el polígono                </span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>      [ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">LinearRing</span>(<span class="op">-</span><span class="fl">113.53</span><span class="op">,</span> <span class="fl">18.81</span><span class="op">,</span> <span class="op">-</span><span class="fl">101.66</span><span class="op">,</span> <span class="fl">10.83</span><span class="op">,-</span><span class="fl">114.9</span><span class="op">,</span> <span class="fl">8.93</span>)<span class="op">,</span>    </span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>      <span class="co">// El segundo perímetro define los huecos dentro del polígono</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">LinearRing</span>(<span class="op">-</span><span class="fl">111.15</span><span class="op">,</span> <span class="fl">14.52</span><span class="op">,</span> <span class="op">-</span><span class="fl">113.09</span><span class="op">,</span> <span class="fl">11.61</span><span class="op">,</span> <span class="op">-</span><span class="fl">115.7</span><span class="op">,</span><span class="fl">13.58</span>)])<span class="op">,</span></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">// El segundo polígono es una lista de coordenadas que forman un </span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>    <span class="co">// triángulo</span></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>    [<span class="op">-</span><span class="fl">95.77</span><span class="op">,</span> <span class="fl">17.2</span><span class="op">,</span></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>     <span class="op">-</span><span class="fl">108.7</span><span class="op">,</span> <span class="fl">17.8</span><span class="op">,</span></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>     <span class="op">-</span><span class="fl">110.0</span><span class="op">,</span> <span class="fl">8.32</span>]<span class="op">,</span></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>    <span class="co">// El tercer polígono es una lista de coordenadas que forman un </span></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>    <span class="co">// triángulo</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>    [<span class="op">-</span><span class="fl">105.6</span><span class="op">,</span> <span class="fl">15.5</span><span class="op">,</span>                </span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>     <span class="op">-</span><span class="fl">105.9</span><span class="op">,</span> <span class="fl">14.2</span><span class="op">,</span></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>     <span class="op">-</span><span class="fl">103.7</span><span class="op">,</span> <span class="fl">13.2</span>]<span class="op">,</span></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>    <span class="co">// El cuarto polígono es una lista de coordenadas que forman un </span></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>    <span class="co">// triángulo</span></span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>    [<span class="op">-</span><span class="fl">94.98</span><span class="op">,</span> <span class="fl">14.6</span><span class="op">,</span>         </span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>     <span class="op">-</span><span class="fl">95.50</span><span class="op">,</span> <span class="fl">13.8</span><span class="op">,</span></span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>     <span class="op">-</span><span class="fl">93.13</span><span class="op">,</span> <span class="fl">11.8</span>]<span class="op">,</span></span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>    <span class="co">// El quinto polígono es una lista de coordenadas que forman un </span></span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>    <span class="co">// triángulo</span></span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>    [<span class="op">-</span><span class="fl">84.52</span><span class="op">,</span> <span class="fl">7.62</span><span class="op">,</span>         </span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>     <span class="op">-</span><span class="fl">85.84</span><span class="op">,</span> <span class="fl">0.17</span><span class="op">,</span></span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>     <span class="op">-</span><span class="fl">78.10</span><span class="op">,</span> <span class="fl">4.74</span>]<span class="op">,</span></span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>    <span class="co">// El sexto polígono es una lista de coordenadas que forman un </span></span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>    <span class="co">// triángulo</span></span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a>    [<span class="op">-</span><span class="fl">67.03</span><span class="op">,</span> <span class="fl">11.0</span><span class="op">,</span>         </span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>     <span class="op">-</span><span class="fl">67.64</span><span class="op">,</span> <span class="fl">6.49</span><span class="op">,</span></span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>     <span class="op">-</span><span class="fl">62.11</span><span class="op">,</span> <span class="fl">2.63</span>]])<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Un rectángulo definido por las coordenadas de los vértices opuestos
var rectangulo = ee.Geometry.Rectangle( 
  -104.12, 5.73,
  -88.21, -0.15); 

// Un polígono definido por las coordenadas de sus vértices
var poligono = ee.Geometry.Polygon( 
  -80.348, -3.36,
  -80.348, -3.36,
  -78.985, -5.113,
  -78.019, -3.228,
  -75.997, -2.394,
  -75.25, -0.901,
  -75.865, 0.11,
  -78.941, 1.428,
  -80.26, 0.725,
  -80.919, -1.911,
  -79.776, -2.614
  );

// Un multipolígono definido por una lista de polígonos
var Multipoligono = ee.Geometry.MultiPolygon([
    // El primer polígono está definido a partir de dos perímetros
    ee.Geometry.Polygon(  
// El primer perímetro define el polígono                
      [ee.Geometry.LinearRing(-113.53, 18.81, -101.66, 10.83,-114.9, 8.93),    
      // El segundo perímetro define los huecos dentro del polígono
ee.Geometry.LinearRing(-111.15, 14.52, -113.09, 11.61, -115.7,13.58)]),
    // El segundo polígono es una lista de coordenadas que forman un 
    // triángulo
    [-95.77, 17.2,
     -108.7, 17.8,
     -110.0, 8.32],
    // El tercer polígono es una lista de coordenadas que forman un 
    // triángulo
    [-105.6, 15.5,                
     -105.9, 14.2,
     -103.7, 13.2],
    // El cuarto polígono es una lista de coordenadas que forman un 
    // triángulo
    [-94.98, 14.6,         
     -95.50, 13.8,
     -93.13, 11.8],
    // El quinto polígono es una lista de coordenadas que forman un 
    // triángulo
    [-84.52, 7.62,         
     -85.84, 0.17,
     -78.10, 4.74],
    // El sexto polígono es una lista de coordenadas que forman un 
    // triángulo
    [-67.03, 11.0,         
     -67.64, 6.49,
     -62.11, 2.63]]);
</script>
<p>Adicionalmente, se pueden crear geometrías directamente dibujando con el cursor en el mapa. Para ello se utilizan las herramientas de la esquina superior izquierda del panel del mapa (Fig. 6.1):</p>
<div class="figure" style="text-align: center">
<img src="Img/geometrias.png" alt="Herramienta de geometrías en la pantalla de mapa." width="30%" />
<p class="caption">
(#fig:unnamed-chunk-63)Herramienta de geometrías en la pantalla de mapa.
</p>
</div>
Para crear puntos (Fig. 6.2):
<div class="figure" style="text-align: center">
<img src="Img/punto.png" alt="Herramienta para crear puntos." width="20%" />
<p class="caption">
(#fig:unnamed-chunk-64)Herramienta para crear puntos.
</p>
</div>
Para crear líneas (Fig. 6.3):
<div class="figure" style="text-align: center">
<img src="Img/linea.png" alt="Herramienta para crear líneas." width="20%" />
<p class="caption">
(#fig:unnamed-chunk-65)Herramienta para crear líneas.
</p>
</div>
Para crear polígonos (Fig. 6.4):
<div class="figure" style="text-align: center">
<img src="Img/poligono.png" alt="Herramienta para crear polígonos." width="20%" />
<p class="caption">
(#fig:unnamed-chunk-66)Herramienta para crear polígonos.
</p>
</div>
Para crear rectángulos (Fig. 6.5):
<div class="figure" style="text-align: center">
<img src="Img/rec.png" alt="Herramienta para crear rectángulos." width="20%" />
<p class="caption">
(#fig:unnamed-chunk-67)Herramienta para crear rectángulos.
</p>
</div>
<p>Todas las geometrías creadas con estas herramientas se importarán automáticamente al código y se podrán ver sobre las líneas del código (Fig. 6.6):</p>
<div class="figure" style="text-align: center">
<img src="Img/import.png" alt="Visualización de la sección de Imports dentro de la pantalla de código." width="50%" />
<p class="caption">
(#fig:unnamed-chunk-68)Visualización de la sección de Imports dentro de la pantalla de código.
</p>
</div>
<p>A estas se les puede cambiar el nombre dando clic en el nombre de la geometría importada.
Usando la mano se pueden mover y modificar las geometrías dibujadas (Fig. 6.7).</p>
<div class="figure" style="text-align: center">
<img src="Img/mano.png" alt="Herramienta para desplazarse en la pantalla de mapas." width="20%" />
<p class="caption">
(#fig:unnamed-chunk-69)Herramienta para desplazarse en la pantalla de mapas.
</p>
</div>
<p>Todas las geometrías dibujadas se importarán como una sola colección, pero si se quiere tener geometrías separadas en diferentes colecciones se debe dar clic en <code>new layer</code>. Este menú aparecerá cuando se pase el cursor sobre la pestaña de geometrías dibujadas (Fig. 6.8).</p>
<div class="figure" style="text-align: center">
<img src="Img/nuevaGeo.png" alt="Herramienta de geometrías en la pantalla de mapas." width="60%" />
<p class="caption">
(#fig:unnamed-chunk-70)Herramienta de geometrías en la pantalla de mapas.
</p>
</div>
<p>Pasando el cursor sobre cada una de las geometrías (en la pestaña de geometrías dibujadas) se podrá bloquear la capa para evitar modificaciones (con el candado), o cambiar la configuración (en el engranaje; Fig. 6.9).</p>
<div class="figure" style="text-align: center">
<img src="Img/dibujarGeo.png" alt="Ubicación de las herramientas de candado y engranaje." width="40%" />
<p class="caption">
(#fig:unnamed-chunk-71)Ubicación de las herramientas de candado y engranaje.
</p>
</div>
<p>Al dar clic en el engranaje se abrirá un menú donde se podrá cambiar el nombre de la geometría al escribir en la caja de texto nombrada “Name” (por defecto es ‘geometry’), elegir el tipo de geometría en el recuadro de “Import as” (geometría <code>ee.Geometry</code>, vector <code>ee.Feature</code> o colección de vectores <code>ee.FeatureCollection</code>), cambiar el color de la geometría dibujada eliminar la geometría (al ingresar el código hexadecimal en la caja nombrada Color o al dar clic sobre un color del recuadro de colores) o añadir manualmente propiedades (al dar clic en el texto azul que dice “+ Property”; Fig. 6.10).</p>
<div class="figure" style="text-align: center">
<img src="Img/menuGeo.png" alt="Ejemplo de modificación de las propiedades de las geometrías." width="80%" />
<p class="caption">
(#fig:unnamed-chunk-72)Ejemplo de modificación de las propiedades de las geometrías.
</p>
</div>
<div class="bluebox2">
<div class="awesomeblock">
<p>Recordar que las geometrías no pueden contener propiedades o atributos, así que la opción de agregar propiedades únicamente estará disponible para objetos de tipo vector (<code>ee.Feature</code>) o colecciones de vectores (<code>ee.FeatureCollection</code>)</p>
</div>
</div>
</div>
<div id="métodos-comunes" class="section level2" number="6.3">
<h2 number="6.3"><span class="header-section-number">6.3</span> Métodos comunes</h2>
<p>La mayoría de los métodos que se pueden utilizar sobre una geometría suelen ser los mismos que sobre vectores, así que dichos métodos sólo se describirán en la sección de vectores.</p>
<!--chapter:end:06-geometrias.Rmd-->
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="ee.feature-1" class="section level1" number="7">
<h1 number="7"><span class="header-section-number">7</span> ee.Feature</h1>
<p>Los vectores (<code>ee.Feature</code>) en GEE son los objetos predeterminados para leer información vectorial o de tablas.
Es importante recalcar que una <code>ee.Feature</code> es un vector individual, de modo que solo puede contener una sola geometría (polígono, línea, punto, multipunto, multipolígono)</p>
<div id="información-y-metadatos-1" class="section level2" number="7.1">
<h2 number="7.1"><span class="header-section-number">7.1</span> Información y metadatos</h2>
<p>Un vector estará compuesto por una geometría (punto, línea, polígono, multipolígono) y los atributos asociados a esa geometría (estos atributos son llamados propiedades y están almacenados en un diccionario; ver Olaya [2020] para una descripción más detallada de un vector). Para obtener información geométrica de los vectores se pueden utilizar los mismos métodos que un objeto <code>ee.Geometry</code>. Para conocer características de las propiedades se puede utilizar el método <code>.propertyNames</code>.</p>
</div>
<div id="visualización-de-vectores" class="section level2" number="7.2">
<h2 number="7.2"><span class="header-section-number">7.2</span> Visualización de vectores</h2>
<p>Las geometrías y vectores pueden ser visualizados en el mapa de GEE. El aspecto predeterminado de los vectores presenta líneas sólidas negras y un relleno semiopaco gris. Sin embargo, se puede especificar el color dentro de un diccionario en la función <code>Map.addLayer</code>, como código hexadecimal.</p>
<div class="bluebox2">
<div class="awesomeblock">
<p>Los cambios de los parámetros de visualización de los vectores no pueden hacerse en las herramientas de capa del mapa, sólo pueden hacerse desde el editor de código. Para consultar el código hexadecimal del color deseado se puede acceder al siguiente enlace: <a href="https://htmlcolorcodes.com/es/" class="uri">https://htmlcolorcodes.com/es/</a></p>
</div>
</div>
<div class="sourceCode" id="cb28"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Especificar el color de la capa </span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(vector <span class="op">,</span> {}<span class="op">,</span> <span class="st">&#39;capa por default&#39;</span>)<span class="op">;</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(vector<span class="op">,</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;2AF116&#39;</span>}<span class="op">,</span> <span class="st">&#39;capa color verde&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Especificar el color de la capa 
Map.addLayer(vector , {}, 'capa por default');
Map.addLayer(vector, {color: '2AF116'}, 'capa color verde');
</script>
</div>
<div id="creación-de-vectores" class="section level2" number="7.3">
<h2 number="7.3"><span class="header-section-number">7.3</span> Creación de Vectores</h2>
<p>Para crear un vector desde cero es necesario definir una geometría y opcionalmente un diccionario de propiedades (atributos) asociados a esa geometría. Por ejemplo:</p>
<p>Ejercicio 10:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Crear un polígono</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> poligono <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Polygon</span>([</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">119.24</span><span class="op">,</span> <span class="fl">32.73</span><span class="op">,</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">115.02</span><span class="op">,</span> <span class="op">-</span><span class="fl">3.29</span><span class="op">,</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">66.5</span><span class="op">,</span> <span class="op">-</span><span class="fl">3.29</span><span class="op">,</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">68.43</span><span class="op">,</span> <span class="fl">32.14</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>])<span class="op">;</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co">// Crear un vector a partir del polígono y un diccionario de atributos.</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> vector <span class="op">=</span> ee<span class="op">.</span><span class="fu">Feature</span>(</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Polígono del vector</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  poligono<span class="op">,</span>                      </span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Diccionario de atributos con 3 atributos</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">anno</span><span class="op">:</span> <span class="dv">1500</span><span class="op">,</span>                    </span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  <span class="dt">tamaño</span><span class="op">:</span> <span class="st">&#39;865 kilometros&#39;</span><span class="op">,</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="dt">nombres</span><span class="op">:</span>[<span class="st">&#39;hugo&#39;</span><span class="op">,</span><span class="st">&#39;paco&#39;</span><span class="op">,</span><span class="st">&#39;luis&#39;</span>]})<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Crear un polígono
var poligono = ee.Geometry.Polygon([
  -119.24, 32.73,
  -115.02, -3.29,
  -66.5, -3.29,
  -68.43, 32.14
]);

// Crear un vector a partir del polígono y un diccionario de atributos.
var vector = ee.Feature(
  // Polígono del vector
  poligono,                      
  // Diccionario de atributos con 3 atributos
  {anno: 1500,                    
  tamaño: '865 kilometros',
  nombres:['hugo','paco','luis']});
</script>
</div>
<div id="métodos-comunes-1" class="section level2" number="7.4">
<h2 number="7.4"><span class="header-section-number">7.4</span> Métodos comunes</h2>
<div id="selección-de-propiedades" class="section level3 unnumbered">
<h3 class="unnumbered">Selección de propiedades</h3>
<p>Una vez revisado los nombres de las propiedades de un vector, se pueden seleccionar ciertos atributos mediante el método <code>.select</code>. Para seleccionar una única propiedad sólo se requiere indicar el nombre de esta (entre comillas dentro de una lista), mientras que si se desea seleccionar varias propiedades, estas deben indicarse dentro de una lista separadas por comas.</p>
<p>Adicionalmente, se pueden renombrar las propiedades del vector. Para ello se inserta primero una lista que contenga las propiedades a las que se les desea cambiar el nombre, seguida de una segunda lista con los nuevos nombres. Por ejemplo:</p>
<p>Ejercicio 10</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vector<span class="op">.</span><span class="fu">select</span>([<span class="st">&#39;anno&#39;</span>]))<span class="op">;</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vector<span class="op">.</span><span class="fu">select</span>([<span class="st">&#39;anno&#39;</span><span class="op">,</span><span class="st">&#39;tamaño&#39;</span>]))<span class="op">;</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vector<span class="op">.</span><span class="fu">select</span>([<span class="st">&#39;anno&#39;</span><span class="op">,</span><span class="st">&#39;tamaño&#39;</span>]<span class="op">,</span>[<span class="st">&#39;year&#39;</span><span class="op">,</span><span class="st">&#39;southamerica&#39;</span>]))<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
print(vector.select(['anno']));
print(vector.select(['anno','tamaño']));
print(vector.select(['anno','tamaño'],['year','southamerica']));
</script>
</div>
<div id="adición-de-nuevas-propiedades-o-modificación-de-propiedades-preexistentes" class="section level3 unnumbered">
<h3 class="unnumbered">Adición de nuevas propiedades o modificación de propiedades preexistentes</h3>
<p>Usando el método <code>.set</code> se pueden modificar las propiedades preexistentes o escribir nuevas propiedades sobre el vector. En este caso, primero se indica el nombre de la clave, seguido del valor correspondiente a la clave indicada. Por ejemplo:</p>
<p>Ejercicio 10.1</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> vector1 <span class="op">=</span> vector<span class="op">.</span><span class="fu">set</span>(<span class="st">&#39;tamaño&#39;</span><span class="op">,</span><span class="st">&#39;neotropico&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
var vector1 = vector.set('tamaño','neotropico');
</script>
</div>
<div id="extracción-y-edición-de-propiedades-de-vectores" class="section level3 unnumbered">
<h3 class="unnumbered">Extracción y edición de propiedades de vectores</h3>
<p>Para extraer ciertas propiedades de un vector se puede utilizar el método <code>.get</code>, especificando la propiedad deseada. En este ejercicio seleccionamos el primer vector (con <code>.first</code>) de una colección de vectores de cuencas (las colecciones de vectores se explican en el siguiente capítulo)</p>
<ol style="list-style-type: decimal">
<li>Usamos el método <code>.propertyNames</code> para obtener una lista de los nombres de los atributos del vector.</li>
<li>Usamos el método <code>.toDictionary</code> para generar un diccionario con todos los atributos(claves) y sus valores del vector.</li>
<li>Usamos el método <code>.get</code> para obtener el valor del atributo ‘COAST’ del vector.</li>
<li>Usando el método <code>.select</code> podemos seleccionar solamente una lista de atributos definidos, y si colocamos una segunda lista entonces los atributos de la primera lista serán renombrados con los nombres de la segunda.</li>
</ol>
<p>Ejercicio 11</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Llamamos una capa de cuencas de alta resolución de GEE</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co">// y se selecciona el primer vector de la colección</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> cuenca <span class="op">=</span> ee<span class="op">.</span><span class="fu">Feature</span>(</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">&quot;WWF/HydroSHEDS/v1/Basins/hybas_12&quot;</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">first</span>())<span class="op">;</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co">// Extraemos los nombres de los atributos del vector como una lista</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> propiedades <span class="op">=</span> cuenca<span class="op">.</span><span class="fu">propertyNames</span>()<span class="op">;</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co">// Extraemos los atributos del vector como un diccionario</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> atributos <span class="op">=</span> cuenca<span class="op">.</span><span class="fu">toDictionary</span>()<span class="op">;</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co">// Extraemos el atributo &#39;COAST&#39;</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> costa <span class="op">=</span> cuenca<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;COAST&#39;</span>)<span class="op">;</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="co">// Extraemos el atributo &#39;COAST&#39; y lo renombramos como &#39;costa maritima&#39;</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> renombre <span class="op">=</span> cuenca<span class="op">.</span><span class="fu">select</span>([<span class="st">&#39;COAST&#39;</span>]<span class="op">,</span>[<span class="st">&#39;costa maritima&#39;</span>])<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Llamamos una capa de cuencas de alta resolución de GEE
// y se selecciona el primer vector de la colección
var cuenca = ee.Feature(
  ee.FeatureCollection("WWF/HydroSHEDS/v1/Basins/hybas_12")
  .first());

// Extraemos los nombres de los atributos del vector como una lista
var propiedades = cuenca.propertyNames();

// Extraemos los atributos del vector como un diccionario
var atributos = cuenca.toDictionary();

// Extraemos el atributo 'COAST'
var costa = cuenca.get('COAST');

// Extraemos el atributo 'COAST' y lo renombramos como 'costa maritima'
var renombre = cuenca.select(['COAST'],['costa maritima']);
</script>
</div>
<div id="intersección-con-otros-vectores" class="section level3 unnumbered">
<h3 class="unnumbered">Intersección con otros vectores</h3>
<p>Se pueden realizar cortes de un vector para quedarse con el área específica que intersecta otro vector utilizando el método <code>.intersection</code>. Por ejemplo:</p>
<p>Ejercicio 12</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Crear dos vectores rectangulares</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> rectangulo1 <span class="op">=</span> ee<span class="op">.</span><span class="fu">Feature</span>(ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">92.0</span><span class="op">,</span><span class="fl">10.6</span><span class="op">,-</span><span class="fl">82.0</span><span class="op">,</span><span class="fl">20.7</span>))<span class="op">;</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> rectangulo2 <span class="op">=</span> ee<span class="op">.</span><span class="fu">Feature</span>(ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">86.03</span><span class="op">,</span><span class="fl">15.6</span><span class="op">,-</span><span class="fl">100.0</span><span class="op">,</span><span class="fl">40.7</span>))<span class="op">;</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co">// Intersección</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> interseccion <span class="op">=</span> rectangulo1<span class="op">.</span><span class="fu">intersection</span>(rectangulo2)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Crear dos vectores rectangulares
var rectangulo1 = ee.Feature(ee.Geometry.Rectangle(-92.0,10.6,-82.0,20.7));
var rectangulo2 = ee.Feature(ee.Geometry.Rectangle(-86.03,15.6,-100.0,40.7));

// Intersección
var interseccion = rectangulo1.intersection(rectangulo2);
</script>
<div class="bluebox2">
<div class="awesomeblock">
<p>Al realizar una intersección, el vector resultante heredará los atributos del vector al que se le aplicó dicho método (es decir, el objeto que queda del lado izquierdo del método <code>.intersection</code>).</p>
</div>
</div>
</div>
<div id="creación-de-un-buffer" class="section level3 unnumbered">
<h3 class="unnumbered">Creación de un buffer</h3>
<p>Para realizar un buffer a partir de un vector se utiliza el método <code>.buffer</code>, en el cual hay que indicar el valor en metros del tamaño del buffer y el error máximo aceptado.</p>
<p>Ejercicio 12.1</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Crear un vector de un  punto</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> punto <span class="op">=</span> ee<span class="op">.</span><span class="fu">Feature</span>(ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Point</span>(<span class="op">-</span><span class="fl">105.24</span><span class="op">,</span> <span class="op">-</span><span class="fl">2.73</span>))<span class="op">;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Calcular un buffer de 500 km alrededor del punto</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> bufferPol <span class="op">=</span> punto<span class="op">.</span><span class="fu">buffer</span>(<span class="dv">500000</span><span class="op">,</span> <span class="fl">0.1</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Crear un vector de un  punto
var punto = ee.Feature(ee.Geometry.Point(-105.24, -2.73));

// Calcular un buffer de 500 km alrededor del punto
var bufferPol = punto.buffer(500000, 0.1);
</script>
</div>
<div id="cálculo-de-área" class="section level3 unnumbered">
<h3 class="unnumbered">Cálculo de área</h3>
<p>Para calcular el área de un vector se utiliza el método <code>.area</code>. En este caso hay que definir el valor máximo de error aceptado. El área siempre se calcula en metros cuadrados.</p>
<p>Ejercicio 12.2</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Calcular el área del buffer</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> area <span class="op">=</span> bufferPol<span class="op">.</span><span class="fu">area</span>(<span class="fl">0.1</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Calcular el área del buffer
var area = bufferPol.area(0.1);
</script>
</div>
<div id="cálculo-de-perímetro" class="section level3 unnumbered">
<h3 class="unnumbered">Cálculo de perímetro</h3>
<p>Podemos calcular el perímetro de un vector usando el método <code>.perimeter</code>, que hace el cálculo en metros.</p>
<p>Ejercicio 12.3</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Calcular el perimetro del buffer</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> perimetro <span class="op">=</span> interseccion<span class="op">.</span><span class="fu">perimeter</span>()<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Calcular el perimetro del buffer
var perimetro = interseccion.perimeter();
</script>
</div>
<div id="disolución-de-polígonos" class="section level3 unnumbered">
<h3 class="unnumbered">Disolución de polígonos</h3>
<p>El método <code>.dissolve</code> une todas las geometrías que se intersectan de un vector en un solo polígono, y si no se intersectan genera un multipolígono.</p>
<p>Ejercicio 12.4</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Crear un vector de multipoligono</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> multi <span class="op">=</span> ee<span class="op">.</span><span class="fu">Feature</span>(ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">MultiPolygon</span>(</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>            [[[[<span class="op">-</span><span class="dv">137</span><span class="op">,</span> <span class="dv">20</span>]<span class="op">,</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>               [<span class="op">-</span><span class="dv">128</span><span class="op">,</span> <span class="dv">9</span>]<span class="op">,</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>               [<span class="op">-</span><span class="dv">116</span><span class="op">,</span> <span class="dv">15</span>]<span class="op">,</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>               [<span class="op">-</span><span class="dv">124</span><span class="op">,</span> <span class="dv">25</span>]]]<span class="op">,</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>             [[[<span class="op">-</span><span class="dv">123</span><span class="op">,</span> <span class="dv">28</span>]<span class="op">,</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>               [<span class="op">-</span><span class="dv">129</span><span class="op">,</span> <span class="dv">30</span>]<span class="op">,</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>               [<span class="op">-</span><span class="dv">139</span><span class="op">,</span> <span class="dv">5</span>]]]<span class="op">,</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>             [[[<span class="op">-</span><span class="dv">113</span><span class="op">,</span> <span class="dv">19</span>]<span class="op">,</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>               [<span class="op">-</span><span class="dv">143</span><span class="op">,</span> <span class="dv">18</span>]<span class="op">,</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>               [<span class="op">-</span><span class="dv">123</span><span class="op">,</span> <span class="dv">4</span>]]]<span class="op">,</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>             [[[<span class="op">-</span><span class="dv">133</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>               [<span class="op">-</span><span class="dv">118</span><span class="op">,</span> <span class="dv">2</span>]<span class="op">,</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>               [<span class="op">-</span><span class="dv">116</span><span class="op">,</span> <span class="dv">24</span>]]]<span class="op">,</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>             [[[<span class="op">-</span><span class="dv">109</span><span class="op">,</span> <span class="dv">5</span>]<span class="op">,</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>               [<span class="op">-</span><span class="dv">103</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>               [<span class="op">-</span><span class="dv">147</span><span class="op">,</span> <span class="dv">9</span>]]]<span class="op">,</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>             [[[<span class="op">-</span><span class="dv">110</span><span class="op">,</span> <span class="dv">14</span>]<span class="op">,</span></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>               [<span class="op">-</span><span class="dv">160</span><span class="op">,</span> <span class="dv">12</span>]<span class="op">,</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>               [<span class="op">-</span><span class="dv">161</span><span class="op">,</span> <span class="dv">7</span>]]]<span class="op">,</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>             [[[<span class="op">-</span><span class="dv">117</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>               [<span class="op">-</span><span class="dv">117</span><span class="op">,</span> <span class="op">-</span><span class="dv">2</span>]<span class="op">,</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>               [<span class="op">-</span><span class="dv">136</span><span class="op">,</span> <span class="op">-</span><span class="dv">9</span>]]]<span class="op">,</span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>             [[[<span class="op">-</span><span class="dv">121</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>               [<span class="op">-</span><span class="dv">123</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>               [<span class="op">-</span><span class="dv">126</span><span class="op">,</span> <span class="op">-</span><span class="dv">18</span>]]]]))<span class="op">;</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a><span class="co">// Disolver sus geometrías</span></span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> disuelto <span class="op">=</span> ee<span class="op">.</span><span class="fu">Feature</span>(multi<span class="op">.</span><span class="fu">dissolve</span>(<span class="fl">0.1</span>))<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Crear un vector de multipoligono
var multi = ee.Feature(ee.Geometry.MultiPolygon(
            [[[[-137, 20],
               [-128, 9],
               [-116, 15],
               [-124, 25]]],
             [[[-123, 28],
               [-129, 30],
               [-139, 5]]],
             [[[-113, 19],
               [-143, 18],
               [-123, 4]]],
             [[[-133, 1],
               [-118, 2],
               [-116, 24]]],
             [[[-109, 5],
               [-103, 10],
               [-147, 9]]],
             [[[-110, 14],
               [-160, 12],
               [-161, 7]]],
             [[[-117, -1],
               [-117, -2],
               [-136, -9]]],
             [[[-121, -1],
               [-123, -1],
               [-126, -18]]]]));
// Disolver sus geometrías
var disuelto = ee.Feature(multi.dissolve(0.1));
</script>
</div>
<div id="unión-de-vectores" class="section level3 unnumbered">
<h3 class="unnumbered">Unión de vectores</h3>
<p>El método <code>.union</code> permite fusionar las geometrías de dos vectores en una sola geometría de un vector. Las geometrías que están intersectadas serán disueltas y las que no lo están se convertirán en un multi-polígono.</p>
<p>Ejercicio 12.5</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Unir geometrías del buffer y un rectángulo </span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> union <span class="op">=</span> rectangulo2<span class="op">.</span><span class="fu">union</span>(bufferPol)</span></code></pre></div>
<script type="text/javascript">
// Unir geometrías del buffer y un rectángulo 
var union = rectangulo2.union(bufferPol)
</script>
<!--chapter:end:07-vectores.Rmd-->
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div id="ee.featurecollection-1" class="section level1" number="8">
<h1 number="8"><span class="header-section-number">8</span> ee.FeatureCollection</h1>
<p>Las colecciones de vectores (<code>ee.FeatureCollection</code>) son objetos de GEE que contienen un conjunto de vectores. La mayoría de los acervos de información vectorial disponibles en GEE van a ser definidos como colecciones de vectores. Para el manejo de varios vectores se recomienda utilizar esta estructura, en lugar de listas u otro tipo de objetos. Esto facilita ejecutar operaciones sobre todo el conjunto de vectores.
Es importante recalcar que una <code>ee.FeatureCollection</code> es un conjunto de vectores, de modo que puede contener distintas <code>ee.Feature</code> con geometrias diferentes (polígono, línea, punto, multipunto, multipolígono)</p>
<div class="bluebox2">
<div class="awesomeblock">
<p>GEE ofrece un catálogo de colecciones de vectores que se puede buscar en la barra de búsqueda. Estas colecciones de vectores se llaman tablas (“tables”).</p>
</div>
</div>
<p>Ejercicio 13</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">// En el buscador se busca una tabla de países &#39;countries&#39;, y se escribe </span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co">// el ID de la tabla, en este caso es una colección de vectores del </span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co">// departamento de estado de Estados Unidos, que contiene las divisiones </span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co">// políticas de los países del mundo  </span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> países <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">&#39;USDOS/LSIB_SIMPLE/2017&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// En el buscador se busca una tabla de países 'countries', y se escribe 
// el ID de la tabla, en este caso es una colección de vectores del 
// departamento de estado de Estados Unidos, que contiene las divisiones 
// políticas de los países del mundo  
var países = ee.FeatureCollection('USDOS/LSIB_SIMPLE/2017');
</script>
<div class="bluebox2">
<div class="awesomeblock">
<p>La búsqueda de información vectorial en los acervos de GEE es más difícil que la búsqueda de imágenes. Eso ocurre porque a pesar de que hay mucha información vectorial disponible (compartida por usuarios), sólo está indexada la información compartida por Google.</p>
</div>
</div>
<div id="información-y-metadatos-2" class="section level2" number="8.1">
<h2 number="8.1"><span class="header-section-number">8.1</span> Información y metadatos</h2>
<p>Las colecciones de vectores contienen los metadatos e información de todos los vectores que contienen. Gracias a ello, se puede utilizar esta información para filtrar y utilizar únicamente los vectores que cumplen con ciertos criterios.</p>
<div class="bluebox2">
<div class="awesomeblock">
<p>Al usar <code>print</code> con las colecciones de vectores, la consola puede mostrar máximo de 5000 vectores. En caso que uno necesite usar <code>print</code> en una colección de más de 5000 vectores, será necesario filtrar la colección previamente. Otra opción es limitar la cantidad de vectores que se vayan a mostrar. Para ello se puede usar el método <code>.limit</code> el cual permite especificar la cantidad de vectores que queremos ver (siempre que sean &lt;= 5000).</p>
</div>
</div>
<p>Ejercicio 14</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Llamamos una capa de cuencas de alta resolución de GEE</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> cuencas <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">&quot;WWF/HydroSHEDS/v1/Basins/hybas_12&quot;</span>)<span class="op">;</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Cantidad de vectores en la colección (1034083)</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> cantidad <span class="op">=</span>cuencas<span class="op">.</span><span class="fu">size</span>()<span class="op">;</span> </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co">// Seleccionamos solo los primero 50 vectores</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> primeras50cuencas<span class="op">=</span> cuencas<span class="op">.</span><span class="fu">limit</span>(<span class="dv">50</span>)<span class="op">;</span> </span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co">// Este comando resultará en un error porque excede los 5000 vectores</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cuencas)<span class="op">;</span> </span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="co">// Esta capa contiene todos los vectores 1034083. Nótese que en el mapa </span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="co">// sí se pueden proyectar más de 5000 vectores, aunque esta capa es un </span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="co">// poco pesada </span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(cuencas<span class="op">,</span>{}<span class="op">,</span><span class="st">&#39;todas las cuencas&#39;</span>)<span class="op">;</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="co">// Esta capa solo contiene las primeras 1000 cuencas y carga mucho más </span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="co">// rápido (Noroccidente de áfrica)</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(cuencas<span class="op">.</span><span class="fu">limit</span>(<span class="dv">1000</span>)<span class="op">,</span>{<span class="dt">color</span><span class="op">:</span><span class="st">&#39;00ff00&#39;</span>}<span class="op">,</span><span class="st">&#39;1000 cuencas filtradas&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Llamamos una capa de cuencas de alta resolución de GEE
var cuencas = ee.FeatureCollection("WWF/HydroSHEDS/v1/Basins/hybas_12");

// Cantidad de vectores en la colección (1034083)
var cantidad =cuencas.size(); 
// Seleccionamos solo los primero 50 vectores
var primeras50cuencas= cuencas.limit(50); 
// Este comando resultará en un error porque excede los 5000 vectores
print(cuencas); 

// Esta capa contiene todos los vectores 1034083. Nótese que en el mapa 
// sí se pueden proyectar más de 5000 vectores, aunque esta capa es un 
// poco pesada 
Map.addLayer(cuencas,{},'todas las cuencas');
// Esta capa solo contiene las primeras 1000 cuencas y carga mucho más 
// rápido (Noroccidente de áfrica)
Map.addLayer(cuencas.limit(1000),{color:'00ff00'},'1000 cuencas filtradas');
</script>
</div>
<div id="creación-de-colecciones-de-vectores" class="section level2" number="8.2">
<h2 number="8.2"><span class="header-section-number">8.2</span> Creación de colecciones de vectores</h2>
<p>Una colección de vectores se define a partir del método <code>ee.FeatureCollection</code> y puede contener geometrías, vectores, o colección de vectores. Una colección de geometrías puede contener un solo vector o una sola geometría. No es relevante si los elementos de la colección tienen o no atributos.</p>
<p>Ejercicio 15</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Crear una colección de vectores con un solo punto, sin atributos </span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> coleccion <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Point</span>(<span class="fl">16.37</span><span class="op">,</span> <span class="fl">48.225</span>))<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Crear una colección de vectores con un solo punto, sin atributos 
var coleccion = ee.FeatureCollection(ee.Geometry.Point(16.37, 48.225));
</script>
<p>Una colección de vectores puede construirse con vectores de geometrías diferentes. En el siguiente ejemplo se crearán diferentes vectores a partir de geometrías variadas y todos con una serie de atributos asociados:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">//  Información adicional para el ejemplo, creación de </span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co">// distintos vectores (ee.Feature),</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co">//  cada cual con diferentes tipos de geometrías y distintos</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co">// atributos.</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co">//  esto para mostrar que una ee.FeatureCollection, no </span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co">// requiere que todos sus elementos (ee.Feature)</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co">//  tengan los mismos atributos, ni geometrías</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> Punto <span class="op">=</span> ee<span class="op">.</span><span class="fu">Feature</span>(ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Point</span>(<span class="op">-</span><span class="fl">99.1362</span><span class="op">,</span> <span class="fl">19.4352</span>)<span class="op">,</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">pais</span><span class="op">:</span><span class="st">&#39;Mexico&#39;</span><span class="op">,</span><span class="dt">capital</span><span class="op">:</span><span class="st">&#39;cdmx&#39;</span>})<span class="op">;</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> Multipunto <span class="op">=</span> ee<span class="op">.</span><span class="fu">Feature</span>(</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">MultiPoint</span>([<span class="op">-</span><span class="fl">90.496</span><span class="op">,</span> <span class="fl">14.605</span><span class="op">,</span>                               </span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>                        <span class="op">-</span><span class="fl">88.717</span><span class="op">,</span> <span class="fl">17.245</span><span class="op">,</span>                              </span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>                        <span class="op">-</span><span class="fl">87.157</span><span class="op">,</span> <span class="fl">14.094</span><span class="op">,</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>                        <span class="op">-</span><span class="fl">89.2275</span><span class="op">,</span> <span class="fl">13.6937</span><span class="op">,</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>                        <span class="op">-</span><span class="fl">86.273</span><span class="op">,</span> <span class="fl">12.115</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>                        <span class="op">-</span><span class="fl">84.097</span><span class="op">,</span> <span class="fl">9.958</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>                        <span class="op">-</span><span class="fl">79.527</span><span class="op">,</span> <span class="fl">8.983</span>])<span class="op">,</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">pais</span><span class="op">:</span> [<span class="st">&#39;Guatemala&#39;</span><span class="op">,</span> </span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Belice&#39;</span><span class="op">,</span> </span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Honduras&#39;</span><span class="op">,</span> </span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;El Salvador&#39;</span><span class="op">,</span> </span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Nicaragua&#39;</span><span class="op">,</span> </span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Costa Rica&#39;</span><span class="op">,</span> </span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Panama&#39;</span>]<span class="op">,</span></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>      <span class="dt">capital</span><span class="op">:</span>  [<span class="st">&#39;cdad. de Guatemala&#39;</span><span class="op">,</span> </span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Belmopan&#39;</span><span class="op">,</span> </span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Tegucigalpa&#39;</span><span class="op">,</span> </span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;San Salvador&#39;</span><span class="op">,</span> </span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Managua&#39;</span><span class="op">,</span> </span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;San Jose&#39;</span><span class="op">,</span> </span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;cdad. de Panama&#39;</span>]})<span class="op">;</span></span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> línea <span class="op">=</span> ee<span class="op">.</span><span class="fu">Feature</span>(ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">LineString</span>([<span class="op">-</span><span class="fl">66.865</span><span class="op">,</span> <span class="fl">10.479</span><span class="op">,</span>                    </span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>                            <span class="op">-</span><span class="fl">74.072</span><span class="op">,</span><span class="fl">4.732</span>])<span class="op">,</span></span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>        {<span class="dt">pais</span><span class="op">:</span> <span class="st">&#39;Venezuela - Colombia&#39;</span><span class="op">,</span> </span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a><span class="dt">capital</span><span class="op">:</span> <span class="st">&#39;Caracas - Bogota&#39;</span>})<span class="op">;</span> </span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> Multilinea <span class="op">=</span> ee<span class="op">.</span><span class="fu">Feature</span>(ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">MultiLineString</span>([  </span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>    ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">LineString</span>([<span class="op">-</span><span class="fl">76.803</span><span class="op">,</span> <span class="fl">18.021</span><span class="op">,</span> <span class="op">-</span><span class="fl">82.362</span><span class="op">,</span> <span class="fl">23.121</span>])<span class="op">,</span>      </span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>    ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">LineString</span>([<span class="op">-</span><span class="fl">72.31</span><span class="op">,</span> <span class="fl">18.69</span><span class="op">,</span> <span class="op">-</span><span class="fl">69.98</span><span class="op">,</span> <span class="fl">18.44</span>])<span class="op">,</span>        </span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>    ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">LineString</span>([<span class="op">-</span><span class="fl">66.103</span><span class="op">,</span> <span class="fl">18.4597</span><span class="op">,</span> <span class="op">-</span><span class="fl">61.8558</span><span class="op">,</span> <span class="fl">17.1315</span>])<span class="op">,</span></span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>    ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">LineString</span>([<span class="op">-</span><span class="fl">55.165</span><span class="op">,</span> <span class="fl">5.861</span><span class="op">,</span> <span class="op">-</span><span class="fl">58.149</span><span class="op">,</span> <span class="fl">6.822</span>])])<span class="op">,</span></span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">pais</span><span class="op">:</span>  [<span class="st">&#39;Jamacia - Cuba&#39;</span><span class="op">,</span></span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Haiti - Republica Dominicana&#39;</span><span class="op">,</span></span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Puerto Rico - Antigua y Barbuda&#39;</span><span class="op">,</span></span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Surinam - Guyana&#39;</span>]<span class="op">,</span></span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a>    <span class="dt">capital</span><span class="op">:</span>[<span class="st">&#39;Kingston - La Habana&#39;</span><span class="op">,</span></span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Puerto Principe - Santo Domingo&#39;</span><span class="op">,</span></span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;San Juan - saint John&#39;</span><span class="op">,</span></span>
<span id="cb42-53"><a href="#cb42-53" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Paramaribo - Georgetown&#39;</span>]})<span class="op">;</span></span>
<span id="cb42-54"><a href="#cb42-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-55"><a href="#cb42-55" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> perimetro <span class="op">=</span> ee<span class="op">.</span><span class="fu">Feature</span>(ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">LinearRing</span>([<span class="op">-</span><span class="fl">79.354</span><span class="op">,</span><span class="fl">27.32</span><span class="op">,</span></span>
<span id="cb42-56"><a href="#cb42-56" aria-hidden="true" tabindex="-1"></a>                                   <span class="op">-</span><span class="fl">79.332</span><span class="op">,</span> <span class="fl">23.661</span><span class="op">,</span></span>
<span id="cb42-57"><a href="#cb42-57" aria-hidden="true" tabindex="-1"></a>                                   <span class="op">-</span><span class="fl">74.19</span><span class="op">,</span> <span class="fl">21.161</span><span class="op">,</span></span>
<span id="cb42-58"><a href="#cb42-58" aria-hidden="true" tabindex="-1"></a>                                   <span class="op">-</span><span class="fl">72.235</span><span class="op">,</span> <span class="fl">23.165</span><span class="op">,</span></span>
<span id="cb42-59"><a href="#cb42-59" aria-hidden="true" tabindex="-1"></a>                                   <span class="op">-</span><span class="fl">78.039</span><span class="op">,</span> <span class="fl">27.859</span>])<span class="op">,</span></span>
<span id="cb42-60"><a href="#cb42-60" aria-hidden="true" tabindex="-1"></a>        {<span class="dt">pais</span><span class="op">:</span><span class="st">&#39;Bahamas&#39;</span><span class="op">,</span></span>
<span id="cb42-61"><a href="#cb42-61" aria-hidden="true" tabindex="-1"></a><span class="dt">capital</span><span class="op">:</span> <span class="st">&#39;Nasau&#39;</span>})<span class="op">;</span></span>
<span id="cb42-62"><a href="#cb42-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-63"><a href="#cb42-63" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> rectangulo <span class="op">=</span> ee<span class="op">.</span><span class="fu">Feature</span>(ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">127.97</span><span class="op">,</span> <span class="fl">50.25</span><span class="op">,</span></span>
<span id="cb42-64"><a href="#cb42-64" aria-hidden="true" tabindex="-1"></a>                                  <span class="op">-</span><span class="fl">68.2</span><span class="op">,</span> <span class="fl">27.63</span>)<span class="op">,</span></span>
<span id="cb42-65"><a href="#cb42-65" aria-hidden="true" tabindex="-1"></a>        {<span class="dt">pais</span><span class="op">:</span><span class="st">&#39;eeuu&#39;</span><span class="op">,</span> </span>
<span id="cb42-66"><a href="#cb42-66" aria-hidden="true" tabindex="-1"></a><span class="dt">capital</span><span class="op">:</span><span class="st">&#39;Washington&#39;</span>})<span class="op">;</span> </span>
<span id="cb42-67"><a href="#cb42-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-68"><a href="#cb42-68" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> poligono <span class="op">=</span> ee<span class="op">.</span><span class="fu">Feature</span>(ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Polygon</span>(<span class="op">-</span><span class="fl">80.348</span><span class="op">,</span> <span class="op">-</span><span class="fl">3.36</span><span class="op">,</span> <span class="op">-</span><span class="fl">80.348</span><span class="op">,</span> <span class="op">-</span><span class="fl">3.36</span><span class="op">,</span></span>
<span id="cb42-69"><a href="#cb42-69" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span>                             <span class="fl">78.985</span><span class="op">,</span> <span class="op">-</span><span class="fl">5.11</span><span class="op">,</span> <span class="op">-</span><span class="fl">78.019</span><span class="op">,</span> <span class="op">-</span><span class="fl">3.228</span><span class="op">,</span></span>
<span id="cb42-70"><a href="#cb42-70" aria-hidden="true" tabindex="-1"></a>                                <span class="op">-</span><span class="fl">75.99</span><span class="op">,</span> <span class="op">-</span><span class="fl">2.394</span><span class="op">,</span> <span class="op">-</span><span class="fl">75.25</span><span class="op">,</span> <span class="op">-</span><span class="fl">0.901</span><span class="op">,</span></span>
<span id="cb42-71"><a href="#cb42-71" aria-hidden="true" tabindex="-1"></a>                                <span class="op">-</span><span class="fl">75.865</span><span class="op">,</span> <span class="fl">0.11</span><span class="op">,</span> <span class="op">-</span><span class="fl">78.941</span><span class="op">,</span> <span class="fl">1.428</span><span class="op">,</span></span>
<span id="cb42-72"><a href="#cb42-72" aria-hidden="true" tabindex="-1"></a>                                <span class="op">-</span><span class="fl">80.26</span><span class="op">,</span> <span class="fl">0.725</span><span class="op">,</span> <span class="op">-</span><span class="fl">80.919</span><span class="op">,</span> <span class="op">-</span><span class="fl">1.911</span><span class="op">,</span></span>
<span id="cb42-73"><a href="#cb42-73" aria-hidden="true" tabindex="-1"></a>                                <span class="op">-</span><span class="fl">79.776</span><span class="op">,</span> <span class="op">-</span><span class="fl">2.614</span>)<span class="op">,</span></span>
<span id="cb42-74"><a href="#cb42-74" aria-hidden="true" tabindex="-1"></a>{<span class="dt">pais</span><span class="op">:</span><span class="st">&#39;Ecuador&#39;</span><span class="op">,</span> </span>
<span id="cb42-75"><a href="#cb42-75" aria-hidden="true" tabindex="-1"></a><span class="dt">capital</span><span class="op">:</span><span class="st">&#39;Quito&#39;</span>})<span class="op">;</span></span>
<span id="cb42-76"><a href="#cb42-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-77"><a href="#cb42-77" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> Multipoligono <span class="op">=</span> ee<span class="op">.</span><span class="fu">Feature</span>(ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">MultiPolygon</span>([</span>
<span id="cb42-78"><a href="#cb42-78" aria-hidden="true" tabindex="-1"></a>                ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Polygon</span>([<span class="op">-</span><span class="fl">61.955</span><span class="op">,</span> <span class="fl">10.146</span><span class="op">,</span>         </span>
<span id="cb42-79"><a href="#cb42-79" aria-hidden="true" tabindex="-1"></a>                                        <span class="op">-</span><span class="fl">61.713</span><span class="op">,</span> <span class="fl">10.967</span><span class="op">,</span></span>
<span id="cb42-80"><a href="#cb42-80" aria-hidden="true" tabindex="-1"></a>                                        <span class="op">-</span><span class="fl">60.593</span><span class="op">,</span> <span class="fl">10.881</span><span class="op">,</span></span>
<span id="cb42-81"><a href="#cb42-81" aria-hidden="true" tabindex="-1"></a>                                           <span class="op">-</span><span class="fl">60.68</span><span class="op">,</span> <span class="fl">10.081</span>])<span class="op">,</span></span>
<span id="cb42-82"><a href="#cb42-82" aria-hidden="true" tabindex="-1"></a>                            ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Polygon</span>([<span class="op">-</span><span class="fl">61.779</span><span class="op">,</span> <span class="fl">12.269</span><span class="op">,</span>     </span>
<span id="cb42-83"><a href="#cb42-83" aria-hidden="true" tabindex="-1"></a>                                       <span class="op">-</span><span class="fl">61.504</span><span class="op">,</span> <span class="fl">12.205</span><span class="op">,</span></span>
<span id="cb42-84"><a href="#cb42-84" aria-hidden="true" tabindex="-1"></a>                                       <span class="op">-</span><span class="fl">61.57</span><span class="op">,</span> <span class="fl">11.968</span><span class="op">,</span></span>
<span id="cb42-85"><a href="#cb42-85" aria-hidden="true" tabindex="-1"></a>                                       <span class="op">-</span><span class="fl">61.845</span><span class="op">,</span> <span class="fl">12.044</span>])<span class="op">,</span></span>
<span id="cb42-86"><a href="#cb42-86" aria-hidden="true" tabindex="-1"></a>                            ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Polygon</span>([<span class="op">-</span><span class="fl">59.703</span><span class="op">,</span> <span class="fl">13.042</span><span class="op">,</span>         </span>
<span id="cb42-87"><a href="#cb42-87" aria-hidden="true" tabindex="-1"></a>                                       <span class="op">-</span><span class="fl">59.417</span><span class="op">,</span> <span class="fl">13.032</span><span class="op">,</span></span>
<span id="cb42-88"><a href="#cb42-88" aria-hidden="true" tabindex="-1"></a>                                       <span class="op">-</span><span class="fl">59.45</span><span class="op">,</span> <span class="fl">13.32</span><span class="op">,</span></span>
<span id="cb42-89"><a href="#cb42-89" aria-hidden="true" tabindex="-1"></a>                                       <span class="op">-</span><span class="fl">59.736</span><span class="op">,</span> <span class="fl">13.342</span>])<span class="op">,</span></span>
<span id="cb42-90"><a href="#cb42-90" aria-hidden="true" tabindex="-1"></a>                            ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Polygon</span>([<span class="op">-</span><span class="fl">61.526</span><span class="op">,</span> <span class="fl">15.671</span><span class="op">,</span>          </span>
<span id="cb42-91"><a href="#cb42-91" aria-hidden="true" tabindex="-1"></a>                                       <span class="op">-</span><span class="fl">61.087</span><span class="op">,</span> <span class="fl">15.512</span><span class="op">,</span></span>
<span id="cb42-92"><a href="#cb42-92" aria-hidden="true" tabindex="-1"></a>                                       <span class="op">-</span><span class="fl">61.274</span><span class="op">,</span> <span class="fl">15.194</span><span class="op">,</span></span>
<span id="cb42-93"><a href="#cb42-93" aria-hidden="true" tabindex="-1"></a>                                       <span class="op">-</span><span class="fl">61.438</span><span class="op">,</span> <span class="fl">15.279</span>])])<span class="op">,</span></span>
<span id="cb42-94"><a href="#cb42-94" aria-hidden="true" tabindex="-1"></a>        {<span class="dt">pais</span><span class="op">:</span>[<span class="st">&#39;Trinidad y Tobago&#39;</span><span class="op">,</span></span>
<span id="cb42-95"><a href="#cb42-95" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Granada&#39;</span><span class="op">,</span></span>
<span id="cb42-96"><a href="#cb42-96" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Barbados&#39;</span><span class="op">,</span></span>
<span id="cb42-97"><a href="#cb42-97" aria-hidden="true" tabindex="-1"></a>            <span class="st">&#39;Dominica&#39;</span>]<span class="op">,</span></span>
<span id="cb42-98"><a href="#cb42-98" aria-hidden="true" tabindex="-1"></a>        <span class="dt">capital</span><span class="op">:</span>[<span class="st">&#39;Puerto España&#39;</span><span class="op">,</span></span>
<span id="cb42-99"><a href="#cb42-99" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;Chantimelle&#39;</span><span class="op">,</span></span>
<span id="cb42-100"><a href="#cb42-100" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;Bridgetown&#39;</span><span class="op">,</span></span>
<span id="cb42-101"><a href="#cb42-101" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;Roseau&#39;</span>]})<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
//  Información adicional para el ejemplo, creación de 
// distintos vectores (ee.Feature),
//  cada cual con diferentes tipos de geometrías y distintos
// atributos.
//  esto para mostrar que una ee.FeatureCollection, no 
// requiere que todos sus elementos (ee.Feature)
//  tengan los mismos atributos, ni geometrías


var Punto = ee.Feature(ee.Geometry.Point(-99.1362, 19.4352),
    {pais:'Mexico',capital:'cdmx'});

var Multipunto = ee.Feature(
ee.Geometry.MultiPoint([-90.496, 14.605,                               
                        -88.717, 17.245,                              
                        -87.157, 14.094,
                        -89.2275, 13.6937,
                        -86.273, 12.115
                        -84.097, 9.958
                        -79.527, 8.983]),
    { pais: ['Guatemala', 
        'Belice', 
        'Honduras', 
        'El Salvador', 
        'Nicaragua', 
        'Costa Rica', 
        'Panama'],
      capital:  ['cdad. de Guatemala', 
            'Belmopan', 
            'Tegucigalpa', 
            'San Salvador', 
            'Managua', 
            'San Jose', 
            'cdad. de Panama']});

var línea = ee.Feature(ee.Geometry.LineString([-66.865, 10.479,                    
                            -74.072,4.732]),
        {pais: 'Venezuela - Colombia', 
capital: 'Caracas - Bogota'}); 

var Multilinea = ee.Feature(ee.Geometry.MultiLineString([  
    ee.Geometry.LineString([-76.803, 18.021, -82.362, 23.121]),      
    ee.Geometry.LineString([-72.31, 18.69, -69.98, 18.44]),        
    ee.Geometry.LineString([-66.103, 18.4597, -61.8558, 17.1315]),
    ee.Geometry.LineString([-55.165, 5.861, -58.149, 6.822])]),
    {pais:  ['Jamacia - Cuba',
            'Haiti - Republica Dominicana',
            'Puerto Rico - Antigua y Barbuda',
            'Surinam - Guyana'],
    capital:['Kingston - La Habana',
            'Puerto Principe - Santo Domingo',
            'San Juan - saint John',
            'Paramaribo - Georgetown']});

var perimetro = ee.Feature(ee.Geometry.LinearRing([-79.354,27.32,
                                   -79.332, 23.661,
                                   -74.19, 21.161,
                                   -72.235, 23.165,
                                   -78.039, 27.859]),
        {pais:'Bahamas',
capital: 'Nasau'});

var rectangulo = ee.Feature(ee.Geometry.Rectangle(-127.97, 50.25,
                                  -68.2, 27.63),
        {pais:'eeuu', 
capital:'Washington'}); 

var poligono = ee.Feature(ee.Geometry.Polygon(-80.348, -3.36, -80.348, -3.36,
  -                             78.985, -5.11, -78.019, -3.228,
                                -75.99, -2.394, -75.25, -0.901,
                                -75.865, 0.11, -78.941, 1.428,
                                -80.26, 0.725, -80.919, -1.911,
                                -79.776, -2.614),
{pais:'Ecuador', 
capital:'Quito'});

var Multipoligono = ee.Feature(ee.Geometry.MultiPolygon([
                ee.Geometry.Polygon([-61.955, 10.146,         
                                        -61.713, 10.967,
                                        -60.593, 10.881,
                                           -60.68, 10.081]),
                            ee.Geometry.Polygon([-61.779, 12.269,     
                                       -61.504, 12.205,
                                       -61.57, 11.968,
                                       -61.845, 12.044]),
                            ee.Geometry.Polygon([-59.703, 13.042,         
                                       -59.417, 13.032,
                                       -59.45, 13.32,
                                       -59.736, 13.342]),
                            ee.Geometry.Polygon([-61.526, 15.671,          
                                       -61.087, 15.512,
                                       -61.274, 15.194,
                                       -61.438, 15.279])]),
        {pais:['Trinidad y Tobago',
            'Granada',
            'Barbados',
            'Dominica'],
        capital:['Puerto España',
              'Chantimelle',
              'Bridgetown',
              'Roseau']});
</script>
<p>Ejercicio 16</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Crear una lista que incluya todos los vectores</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> coleccionVectores <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>([Multipoligono<span class="op">,</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  poligono<span class="op">,</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  rectangulo<span class="op">,</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  perimetro<span class="op">,</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  Multilínea<span class="op">,</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  linea<span class="op">,</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  Multipunto<span class="op">,</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  Punto])<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Crear una lista que incluya todos los vectores
var coleccionVectores = ee.FeatureCollection([Multipoligono,
  poligono,
  rectangulo,
  perimetro,
  Multilínea,
  linea,
  Multipunto,
  Punto]);
</script>
</div>
<div id="visualización-de-colecciones-de-vectores" class="section level2" number="8.3">
<h2 number="8.3"><span class="header-section-number">8.3</span> Visualización de colecciones de vectores</h2>
<p>Al igual que los vectores, las colecciones de vectores se pueden agregar a la pantalla de mapas mediante la función <code>Map.addLayer</code>.</p>
<p>Ejercicio 17</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> ecoregiones <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">&quot;RESOLVE/ECOREGIONS/2017&quot;</span>)<span class="op">;</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co">// Especificar el color de la capa </span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(ecoregiones<span class="op">,</span> {}<span class="op">,</span> <span class="st">&#39;capa por default&#39;</span>)<span class="op">;</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(ecoregiones<span class="op">,</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;2AF116&#39;</span>}<span class="op">,</span> <span class="st">&#39;capa color verde&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
var ecoregiones = ee.FeatureCollection("RESOLVE/ECOREGIONS/2017");

// Especificar el color de la capa 
Map.addLayer(ecoregiones, {}, 'capa por default');
Map.addLayer(ecoregiones, {color: '2AF116'}, 'capa color verde');
</script>
<p>Adicionalmente, sólo para las colecciones de vectores se pueden especificar parámetros adicionales con el método <code>.draw</code> (el cual transforma la colección de vectores en una imagen y permite así especificar tamaño del punto <code>pointRadius</code> y grosor <code>strokeWidth</code> de la línea). Esto se logra con el método <code>.draw</code>.</p>
<p>Ejercicio 17.1</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(ecoregiones<span class="op">.</span><span class="fu">draw</span>({<span class="dt">color</span><span class="op">:</span> <span class="st">&#39;FF6969&#39;</span><span class="op">,</span> <span class="dt">strokeWidth</span><span class="op">:</span><span class="dv">10</span> })<span class="op">,</span> {}<span class="op">,</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;capa color rosa, y linea gruesa&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
Map.addLayer(ecoregiones.draw({color: 'FF6969', strokeWidth:10 }), {},
  'capa color rosa, y linea gruesa');
</script>
<p>Si queremos visualizar sólo los contornos de los vectores puede usar el siguiente código, el cual dibuja con el método <code>.paint</code> los contornos de los vectores sobre una imagen vacía (<code>ee.Image</code>), y luego proyecta esa imagen:</p>
<p>Ejercicio 17.2</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Crear una imagen vacía</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> vacia <span class="op">=</span> ee<span class="op">.</span><span class="fu">Image</span>()<span class="op">.</span><span class="fu">byte</span>()<span class="op">;</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Sobre la imagen vacía, dibujar los bordes de los vectores</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> contornos <span class="op">=</span> vacia<span class="op">.</span><span class="fu">paint</span>({</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Definir los vectores a dibujar</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">featureCollection</span><span class="op">:</span> ecoregiones<span class="op">,</span>  </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Definir un atributo de los vectores para agrupar vectores por color </span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">// según este atributo (puede omitirse)</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">color</span><span class="op">:</span><span class="st">&#39;BIOME_NUM&#39;</span><span class="op">,</span>  </span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Definir el grosor (si no se especifica este parámetro se dibujarán los   </span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">// vectores con color sólido)       </span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> <span class="dv">3</span>                          </span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="co">// Mostrar la imagen con los vectores dibujados y especificar la paleta de</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a><span class="co">// color (la cual en este caso es de un solo color, por lo tanto todos los</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a><span class="co">// contornos serán del mismo color)</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(contornos<span class="op">,</span> {<span class="dt">palette</span><span class="op">:</span> <span class="st">&#39;6e00ff&#39;</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">14</span>}<span class="op">,</span> </span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;bordes morados&#39;</span>)<span class="op">;</span> </span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a><span class="co">// Mostrar la imagen con los vectores dibujados y especificar la paleta de</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a><span class="co">// color en una lista [rojo, verde, azul]. Esto permite que los vectores </span></span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a><span class="co">// se dibujen de diferentes colores según el atributo &#39;color&#39; de la </span></span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a><span class="co">// variable &#39;contorno&#39;</span></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(contornos<span class="op">,</span> {<span class="dt">palette</span><span class="op">:</span> [<span class="st">&#39;FF0000&#39;</span><span class="op">,</span> <span class="st">&#39;00FF00&#39;</span><span class="op">,</span> <span class="st">&#39;0000FF&#39;</span>]<span class="op">,</span> </span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>  <span class="dt">max</span><span class="op">:</span> <span class="dv">14</span>}<span class="op">,</span> <span class="st">&#39;bordes de colores&#39;</span>)<span class="op">;</span> </span></code></pre></div>
<script type="text/javascript">
// Crear una imagen vacía
var vacia = ee.Image().byte();

// Sobre la imagen vacía, dibujar los bordes de los vectores
var contornos = vacia.paint({
  // Definir los vectores a dibujar
  featureCollection: ecoregiones,  
  // Definir un atributo de los vectores para agrupar vectores por color 
  // según este atributo (puede omitirse)
  color:'BIOME_NUM',  
  // Definir el grosor (si no se especifica este parámetro se dibujarán los   
  // vectores con color sólido)       
  width: 3                          
});

// Mostrar la imagen con los vectores dibujados y especificar la paleta de
// color (la cual en este caso es de un solo color, por lo tanto todos los
// contornos serán del mismo color)
Map.addLayer(contornos, {palette: '6e00ff', max: 14}, 
  'bordes morados'); 

// Mostrar la imagen con los vectores dibujados y especificar la paleta de
// color en una lista [rojo, verde, azul]. Esto permite que los vectores 
// se dibujen de diferentes colores según el atributo 'color' de la 
// variable 'contorno'
Map.addLayer(contornos, {palette: ['FF0000', '00FF00', '0000FF'], 
  max: 14}, 'bordes de colores'); 
</script>
</div>
<div id="métodos-comunes-2" class="section level2" number="8.4">
<h2 number="8.4"><span class="header-section-number">8.4</span> Métodos comunes</h2>
<div id="filtración-de-una-colección-de-vectores" class="section level3 unnumbered">
<h3 class="unnumbered">Filtración de una colección de vectores</h3>
<p>Filtrar una colección de vectores permite seleccionar los vectores deseados. Se puede filtrar por fecha o por localización, pero de todas formas si se necesitan filtros más avanzados se pueden configurar. Para filtrar por localización se usa el método <code>.filterBounds</code>, el cual permite seleccionar todos los vectores de la colección que se intersecten con la geometría indicada por el usuario. En el ejercicio se va a filtrar espacialmente una colección de vectores que contiene las áreas protegidas del mundo para seleccionar únicamente las áreas que se intersecten con un rectángulo que abarca el país de Costa Rica.</p>
<p>Ejercicio 18</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Table dentro de GEE que contiene vectores de áreas protegidas globales</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> areasProtegidas <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">&#39;WCMC/WDPA/current/polygons&#39;</span>)<span class="op">;</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Dibujar una geometría (puede ser cualquier tipo de geometría }, en este</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co">// caso escogimos un rectángulo sobre Costa Rica)</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> RecCostaRica <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">86.16</span><span class="op">,</span> <span class="fl">11.235</span><span class="op">,</span> <span class="op">-</span><span class="fl">82.601</span><span class="op">,</span> <span class="fl">8.073</span>)<span class="op">;</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co">// Áreas protegidas que se intersectan con el rectángulo dibujado</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> filtro <span class="op">=</span> areasProtegidas<span class="op">.</span><span class="fu">filterBounds</span>(RecCostaRica)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Table dentro de GEE que contiene vectores de áreas protegidas globales
var areasProtegidas = ee.FeatureCollection('WCMC/WDPA/current/polygons'); 

// Dibujar una geometría (puede ser cualquier tipo de geometría }, en este
// caso escogimos un rectángulo sobre Costa Rica)
var RecCostaRica = ee.Geometry.Rectangle(-86.16, 11.235, -82.601, 8.073);

// Áreas protegidas que se intersectan con el rectángulo dibujado
var filtro = areasProtegidas.filterBounds(RecCostaRica);
</script>
<p>Para filtrar por atributos de los vectores se puede realizar mediante el método <code>.filterMetadata</code>. De esta forma, todos los vectores de la colección que cumplan con una condición deseada serán seleccionados. Para usar <code>.filterMetadata</code> se debe indicar dentro del paréntesis (separado por comas): el nombre entre comillas del atributo a evaluar y el tipo de comparación a hacer, de acuerdo con ciertos operadores lógicos. Los operadores lógicos aceptados en este método son:</p>
<ul>
<li><code>equals</code> (igual a),</li>
<li><code>less_than</code> (menor que),</li>
<li><code>greater_than</code> (mayor que),</li>
<li><code>not_equals</code> (no igual a o diferente de),</li>
<li><code>not_less_than</code> (no menor que),</li>
<li><code>not_greater_than</code> (no mayor que),</li>
<li><code>starts_with</code> (empieza con),</li>
<li><code>ends_with</code> (termina con),</li>
<li><code>not_starts_with</code> (no empieza con),</li>
<li><code>not_ends_with</code> (no termina con),</li>
<li><code>contains</code> (contiene),</li>
<li><code>not_contains</code> (no contiene).</li>
</ul>
<p>y finalmente el valor con el que se hará la comparación.</p>
<p>En el siguiente ejercicio vamos a filtrar la colección de áreas protegidas según el atributo ‘ISO3’ que es un código de 3 letras para cada país del mundo, en el caso de Costa Rica su código es ‘CRI’.</p>
<p>Ejercicio 18.1</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">// En este caso cada vector de la colección de áreas protegidas, tiene un </span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co">// atributo llamado &#39;ISO3&#39;, basándonos en ese atributo, vamos a buscar </span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co">// todos los vectores que tengan (para ese atributo) un valor exactamente </span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co">// igual (&#39;equals&#39;) a &#39;CRI&#39; (abreviación de Costa Rica)</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> AreasProCRI <span class="op">=</span> areasProtegidas<span class="op">.</span><span class="fu">filterMetadata</span>(<span class="st">&#39;ISO3&#39;</span><span class="op">,</span><span class="st">&#39;equals&#39;</span><span class="op">,</span><span class="st">&#39;CRI&#39;</span>)<span class="op">;</span> </span></code></pre></div>
<script type="text/javascript">
// En este caso cada vector de la colección de áreas protegidas, tiene un 
// atributo llamado 'ISO3', basándonos en ese atributo, vamos a buscar 
// todos los vectores que tengan (para ese atributo) un valor exactamente 
// igual ('equals') a 'CRI' (abreviación de Costa Rica)
var AreasProCRI = areasProtegidas.filterMetadata('ISO3','equals','CRI'); 
</script>
<p>El método para filtrar por fecha es <code>.filterDate</code> ,sólo aplica en caso que los vectores tengan un atributo llamado ‘system:time_start’ y en ese atributo se encuentre la fecha en formato ‘AAAA-MM-DD’. En caso que los vectores no tengan ese atributo pero sí tengan un atributo de fecha, entonces será necesario renombrar dicho atributo de fecha a ‘system:time_start’ para ello se puede usar el método <code>.set</code> y el método <code>.map</code> (el método <code>.map</code> se explicara con mayor detalle más adelante en la sección 7.5.8).</p>
</div>
<div id="funciones-de-usuario" class="section level3 unnumbered">
<h3 class="unnumbered">Funciones de usuario</h3>
<p>En el siguiente ejercicio vamos a crear una función para extraer de cada vector de la colección, el valor de año del atributo ‘STATUS_YR’, y guardarlo en un nuevo atributo llamado ‘system:time_start’. Una vez estén todos los vectores listos. Procederemos a filtrar las áreas protegidas establecidas entre el 2020 y 2021.</p>
<p>Ejercicio 17.2</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Map es un método que nos permite ejecutar una operación sobre todos </span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co">// los vectores de la colección</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> Areasfecha <span class="op">=</span> AreasProCRI<span class="op">.</span><span class="fu">map</span>( <span class="kw">function</span>(vector){ </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Fecha extrae el valor del atributo &#39;STATUS_YEAR&#39;</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> fecha <span class="op">=</span> vector<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;STATUS_YR&#39;</span>)<span class="op">;</span>   </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Cada vector se entrega con una nueva propiedad &#39;system:time_start&#39; </span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">// que tiene fecha</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> vector<span class="op">.</span><span class="fu">set</span>(<span class="st">&#39;system:time_start&#39;</span><span class="op">,</span>fecha)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span> </span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="co">// Ahora ya se puede aplicar el filtro de fecha filtrando solo las áreas </span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="co">// protegidas de Costa Rica declaradas en el año 2020</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> filtroFechas <span class="op">=</span> Areasfecha<span class="op">.</span><span class="fu">filterDate</span>(<span class="dv">2020</span><span class="op">,</span><span class="dv">2021</span>)<span class="op">;</span> </span></code></pre></div>
<script type="text/javascript">
// Map es un método que nos permite ejecutar una operación sobre todos 
// los vectores de la colección
var Areasfecha = AreasProCRI.map( function(vector){ 
  // Fecha extrae el valor del atributo 'STATUS_YEAR'
  var fecha = vector.get('STATUS_YR');   
  // Cada vector se entrega con una nueva propiedad 'system:time_start' 
  // que tiene fecha
  return vector.set('system:time_start',fecha)
}); 

// Ahora ya se puede aplicar el filtro de fecha filtrando solo las áreas 
// protegidas de Costa Rica declaradas en el año 2020
var filtroFechas = Areasfecha.filterDate(2020,2021); 
</script>
<p>Los filtros compuestos permiten combinar los filtros disponibles bajo la biblioteca de <code>ee.Filter</code>. En el ejercicio 18.3 se mostrará solo un ejemplo de este filtro, para filtrar vectores que cumplan con todas las condiciones. El ejercicio consta de los siguientes pasos:</p>
<ol style="list-style-type: decimal">
<li>El método <code>.filter</code> es para indicar que vamos a realizar un filtro.</li>
<li><code>ee.Filter.and</code> es para indicar que se debn cumplir todas las condiciones para filtrar</li>
<li><code>ee.Filter.gte</code> es para seleccionar mediante la condición mayor o igual a (“greater than or equal”).</li>
<li>Después se utiliza una coma para indicar otro filtro.</li>
<li><code>ee.Filter.stringContains</code> es un filtro, para seleccionar basado en una cadena de texo que se encuentre dentro de un atributo</li>
<li>Después se usa otra coma para indicar otro filtro.</li>
<li><code>ee.Filter.rangeContains</code> es para seleccionar todo lo que se encuentre en un rango de valores.</li>
</ol>
<p>Ejercicio 18.3</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Se declara que se ejecutará un filtro</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> areasProMar <span class="op">=</span> areasProtegidas<span class="op">.</span><span class="fu">filter</span>( </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ee.Filter.and indica que se crea un filtro compuesto en donde se </span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">// deben cumplir TODAS las siguientes condiciones para seleccionar un </span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">// vector</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">and</span>(    </span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">//  Un filtro donde se indica el atributo a utilizar (&#39;MARINE&#39;). Este </span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">// es un un atributo donde 1 es área costera, y 2 son áreas marinas.</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">//  Por lo tanto al llamar `ee.Filter.gte` con el valor 1, se </span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">// seleccionarán todas las áreas con un valor de 1 o 2, que indican</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">// áreas que están protegiendo un área marina.</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">gte</span>(<span class="st">&#39;MARINE&#39;</span><span class="op">,</span><span class="dv">1</span>)<span class="op">,</span>   </span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">//  Se filtran las áreas protegidas que en su atributo &#39;NAME&#39; (el </span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">// nombre del área protegida), contengan la  palabra manglar es así</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">// para seleccionar solo las áreas protegidas que en su nombre incluya </span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">// la palabra manglar.</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">stringContains</span>(<span class="st">&#39;NAME&#39;</span><span class="op">,</span> <span class="st">&#39;Manglar&#39;</span>)<span class="op">,</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">//  &#39;GIS_M_AREA&#39; es un atributo de las áreas protegidas que indica el </span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">// área marina protegida calculada con un SIG.    10 es el valor mínimo </span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">// del rango de área marina que queremos filtrar. 100 es el valor </span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">// máximo del rango de área marina que queremos filtrar.</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">rangeContains</span>(<span class="st">&#39;GIS_M_AREA&#39;</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span><span class="dv">100</span>)))<span class="op">;</span> </span></code></pre></div>
<script type="text/javascript">
// Se declara que se ejecutará un filtro
var areasProMar = areasProtegidas.filter( 
  // ee.Filter.and indica que se crea un filtro compuesto en donde se 
  // deben cumplir TODAS las siguientes condiciones para seleccionar un 
  // vector
  ee.Filter.and(    
  //  Un filtro donde se indica el atributo a utilizar ('MARINE'). Este 
  // es un un atributo donde 1 es área costera, y 2 son áreas marinas.
  //  Por lo tanto al llamar `ee.Filter.gte` con el valor 1, se 
  // seleccionarán todas las áreas con un valor de 1 o 2, que indican
  // áreas que están protegiendo un área marina.
  ee.Filter.gte('MARINE',1),   
  //  Se filtran las áreas protegidas que en su atributo 'NAME' (el 
  // nombre del área protegida), contengan la  palabra manglar es así
  // para seleccionar solo las áreas protegidas que en su nombre incluya 
  // la palabra manglar.
  ee.Filter.stringContains('NAME', 'Manglar'),
  //  'GIS_M_AREA' es un atributo de las áreas protegidas que indica el 
  // área marina protegida calculada con un SIG.    10 es el valor mínimo 
  // del rango de área marina que queremos filtrar. 100 es el valor 
  // máximo del rango de área marina que queremos filtrar.
  ee.Filter.rangeContains('GIS_M_AREA', 10,100))); 
</script>
</div>
<div id="selección-de-atributos" class="section level3 unnumbered">
<h3 class="unnumbered">Selección de atributos</h3>
<p>Al igual que con los vectores, se puede utilizar el método <code>.select</code> para seleccionar un conjunto de atributos de los vectores en la colección. De igual manera que con los vectores individuales, para seleccionar una única banda sólo se requiere indicar el nombre del atributo, mientras que si se desea seleccionar varios atributos, éstos deben indicarse dentro de una lista. Por ejemplo:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>ee<span class="op">.</span><span class="at">FeatureCollection</span><span class="op">.</span><span class="fu">select</span>([<span class="st">&#39;atributo&#39;</span>])<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
ee.FeatureCollection.select(['atributo']);
</script>
</div>
<div id="creación-de-puntos-aleatorios" class="section level3 unnumbered">
<h3 class="unnumbered">Creación de puntos aleatorios</h3>
<p>GEE ofrece la herramienta para generar una colección de vectores, compuesta por puntos aleatorios en una región especificada. Para ello se utiliza el método <code>.randomPoints</code> luego se especifica un área donde dibujar los puntos, y la cantidad de puntos deseados.</p>
<p>Ejercicio 19</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Determinar una región específica donde se quiere lanzar puntos </span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co">// aleatorios</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> region <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">61.36</span><span class="op">,</span> <span class="fl">31.2</span><span class="op">,</span> <span class="op">-</span><span class="fl">16.54</span><span class="op">,</span> <span class="fl">1.93</span>)<span class="op">;</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co">// Crear 1000 puntos aleatorios en la región especificada</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> puntos <span class="op">=</span> ee<span class="op">.</span><span class="at">FeatureCollection</span><span class="op">.</span><span class="fu">randomPoints</span>(region<span class="op">,</span><span class="dv">1000</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Determinar una región específica donde se quiere lanzar puntos 
// aleatorios
var region = ee.Geometry.Rectangle(-61.36, 31.2, -16.54, 1.93);

// Crear 1000 puntos aleatorios en la región especificada
var puntos = ee.FeatureCollection.randomPoints(region,1000);
</script>
</div>
<div id="obtención-del-primer-vector" class="section level3 unnumbered">
<h3 class="unnumbered">Obtención del primer vector</h3>
<p>En algunas ocasiones resulta útil obtener el primer vector de una colección de vectores para ver si se llevó a cabo el procedimiento deseado sobre la colección. Para ello, se utiliza el método <code>.first</code> que devuelve el primer vector que se encuentra en la colección y permite agregarlo en la pantalla de mapas para analizarla más a detalle. Al usar este método sobre un colección de vectores (<code>ee.FeatureCollection</code>), el resultado devuelto será un vector (<code>ee.Feature</code>).</p>
<p>Ejercicio 20</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Llamamos una capa de cuencas de alta resolución de GEE</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> CUENCAS_MUNDIAL <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;WWF/HydroSHEDS/v1/Basins/hybas_12&quot;</span>)<span class="op">;</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co">// Filtramos la colección solo al primer vector y lo convertimos de una</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co">// colección de un solo elemento (ee.FeatureCollection) a un vector </span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co">// independiente (ee.Feature)</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> cuenca <span class="op">=</span> ee<span class="op">.</span><span class="fu">Feature</span>(CUENCAS_MUNDIAL<span class="op">.</span><span class="fu">first</span>())<span class="op">;</span> </span></code></pre></div>
<script type="text/javascript">
// Llamamos una capa de cuencas de alta resolución de GEE
var CUENCAS_MUNDIAL = ee.FeatureCollection(
  "WWF/HydroSHEDS/v1/Basins/hybas_12");
 
// Filtramos la colección solo al primer vector y lo convertimos de una
// colección de un solo elemento (ee.FeatureCollection) a un vector 
// independiente (ee.Feature)
var cuenca = ee.Feature(CUENCAS_MUNDIAL.first()); 
</script>
</div>
<div id="extracción-de-metadatos-de-una-colección-de-vectores" class="section level3 unnumbered">
<h3 class="unnumbered">Extracción de metadatos de una colección de vectores</h3>
<p>Para extraer los nombres de los metadatos de una colección de vectores se usa el método <code>.propertyNames</code>. Para extraer algún metadato en particular de una colección de vectores se debe utilizar el método de <code>.get</code>, indicando dentro de los paréntesis el nombre de la propiedad que se desea extraer.</p>
<div class="bluebox2">
<div class="awesomeblock">
<p>Los metadatos de una colección de vectores no son los mismos que los de los vectores que la conforman.</p>
</div>
</div>
<p>Ejercicio 20.1</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Mostrar un metadato de la colección de vectores</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> IDcoleccion <span class="op">=</span> CUENCAS_MUNDIAL<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;system:id&#39;</span>) </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co">// Se muestran los metadatos de la  colección de vectores</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> metadatosCOL <span class="op">=</span> CUENCAS_MUNDIAL<span class="op">.</span><span class="fu">propertyNames</span>()</span></code></pre></div>
<script type="text/javascript">
// Mostrar un metadato de la colección de vectores
var IDcoleccion = CUENCAS_MUNDIAL.get('system:id') 
// Se muestran los metadatos de la  colección de vectores
var metadatosCOL = CUENCAS_MUNDIAL.propertyNames()
</script>
</div>
<div id="extracción-de-listas-con-atributos-de-vectores" class="section level3 unnumbered">
<h3 class="unnumbered">Extracción de listas con atributos de vectores</h3>
<p>Para obtener una lista con los atributos de los vectores que conforman una colección de vectores se utiliza el método <code>.aggregate</code>. Este método tiene varias formas de obtener y resumir los atributos de una colección: extraer una propiedad de los vectores (<code>.aggregate_array</code>), extraer y calcular la media por propiedad (<code>.aggregate_mean</code>), extraer y calcular un histograma (<code>.aggregte_histogram</code>), o extraer y obtener estadísticas descriptivas de las propiedades (<code>.aggregate_stats</code>).</p>
<p>Ejercicio 20.2</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Rectángulo que abarca las islas canarias</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> canaria <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">18.89</span><span class="op">,</span><span class="fl">27.46</span><span class="op">,</span> <span class="op">-</span><span class="fl">13.26</span><span class="op">,</span><span class="fl">29.93</span>)<span class="op">;</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co">// Arroja una lista con todos los ID de las cuencas de esta zona</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> IDcuencasCana <span class="op">=</span> CUENCAS_MUNDIAL<span class="op">.</span><span class="fu">filterBounds</span>(canaria)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="fu">aggregate_array</span>(<span class="st">&#39;HYBAS_ID&#39;</span>)<span class="op">;</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="co">// Arroja el dato del área subsuperficial promedio de las cuencas de </span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="co">// esta zona</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> areaCuencasCana <span class="op">=</span> CUENCAS_MUNDIAL<span class="op">.</span><span class="fu">filterBounds</span>(canaria)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="fu">aggregate_mean</span>(<span class="st">&#39;SUB_AREA&#39;</span>)<span class="op">;</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="co">// Arroja el dato de frecuencias de cada uno de los posibles valores de</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="co">// COAST (1=si tiene costa, 0 =no tiene costa)</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> costaCana <span class="op">=</span> CUENCAS_MUNDIAL<span class="op">.</span><span class="fu">filterBounds</span>(canaria)</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="fu">aggregate_histogram</span>(<span class="st">&#39;COAST&#39;</span>)<span class="op">;</span> </span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="co">// Arroja las estadísticas descriptivas del área superficial de las</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a><span class="co">// cuencas de la zona</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> estadisticas <span class="op">=</span> CUENCAS_MUNDIAL<span class="op">.</span><span class="fu">filterBounds</span>(canaria)</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="fu">aggregate_stats</span>(<span class="st">&#39;UP_AREA&#39;</span>)<span class="op">;</span> </span></code></pre></div>
<script type="text/javascript">
// Rectángulo que abarca las islas canarias
var canaria = ee.Geometry.Rectangle(-18.89,27.46, -13.26,29.93); 
// Arroja una lista con todos los ID de las cuencas de esta zona
var IDcuencasCana = CUENCAS_MUNDIAL.filterBounds(canaria)
.aggregate_array('HYBAS_ID');

// Arroja el dato del área subsuperficial promedio de las cuencas de 
// esta zona
var areaCuencasCana = CUENCAS_MUNDIAL.filterBounds(canaria)
.aggregate_mean('SUB_AREA');

// Arroja el dato de frecuencias de cada uno de los posibles valores de
// COAST (1=si tiene costa, 0 =no tiene costa)
var costaCana = CUENCAS_MUNDIAL.filterBounds(canaria)
.aggregate_histogram('COAST'); 

// Arroja las estadísticas descriptivas del área superficial de las
// cuencas de la zona
var estadisticas = CUENCAS_MUNDIAL.filterBounds(canaria)
.aggregate_stats('UP_AREA'); 
</script>
</div>
<div id="ejecución-de-una-función-sobre-todos-los-vectores-una-colección" class="section level3 unnumbered">
<h3 class="unnumbered">Ejecución de una función sobre todos los vectores una colección</h3>
<p>Para aplicar una operación en todos los vectores de una colección se usa el método <code>.map</code>.</p>
<div class="bluebox2">
<div class="awesomeblock">
<p>Para poder ejecutar el método <code>.map</code> es necesario antes definir una función (del usuario). Para definir una función es necesario tener en cuenta varias cosas:</p>
<ol style="list-style-type: decimal">
<li>Usar el comando <code>function</code>.</li>
<li>Definir un nombre cualquiera, que representara el objeto de entrada de la función (insumo).</li>
<li>Definir un diccionario dentro del cual se especifiquen los procedimientos a realizar sobre el insumo.</li>
<li>Antes de cerrar el diccionario especificar el producto de salida (resultado de la función) usando el comando <code>return</code>.</li>
</ol>
</div>
</div>
<p>En el siguiente ejercicio se realizarán los siguientes pasos:</p>
<ul>
<li>Llamamos a una colección con los límites políticos de los países.</li>
<li>Seleccionamos a ‘Peru’.</li>
<li>Generamos 100 puntos aleatorios en Perú.</li>
<li>Le añadimos a cada punto un nuevo atributo llamado ‘aleatorio’.</li>
<li>Definimos una función del usuario en la que para cada punto se genera un buffer con tamaño aleatorio.</li>
<li>Ejecutamos la función sobre todos los puntos aleatorios</li>
<li>Usando el método <code>.map</code> ejecutamos la función <code>bufferAleatorio</code> sobre todos los puntos aleatorios.</li>
</ul>
<p>Ejercicio 21</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Se llama una tabla de GEE con colección de vectores de países </span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> paises <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">&quot;USDOS/LSIB/2017&quot;</span>)<span class="op">;</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co">//  Seleccionamos el vector cuyo atributo &#39;COUNTRY_NAME&#39; es igual </span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="co">// (&#39;equals&#39;) a &#39;Peru&#39;.Filtrando así solo a Perú </span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> peru <span class="op">=</span> paises<span class="op">.</span><span class="fu">filterMetadata</span>(<span class="st">&#39;COUNTRY_NA&#39;</span><span class="op">,</span><span class="st">&#39;equals&#39;</span><span class="op">,</span><span class="st">&#39;Peru&#39;</span>)<span class="op">;</span> </span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="co">// Creamos una colección de vectores de 100 puntos aleatorios en Perú, y </span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="co">// usando el método .randomColumn le asignamos a cada punto un nuevo </span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="co">// atributo llamado &#39;aleatorio&#39; cuyo valor es aleatorio (entre 0-1)</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> puntos <span class="op">=</span>ee<span class="op">.</span><span class="at">FeatureCollection</span><span class="op">.</span><span class="fu">randomPoints</span>(peru<span class="op">,</span> <span class="dv">100</span>)</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">randomColumn</span>(<span class="st">&#39;aleatorio&#39;</span>)<span class="op">;</span>  </span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a><span class="co">//  Definimos una función del usuario (con el método `function`) llamada </span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a><span class="co">//  &#39;bufferAleatorio&#39; en la que el dato de entrada (insumo) será un </span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a><span class="co">//  vector (y el nombre genérico que le asignamos al insumo es (punto)):</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a><span class="co">//  -Abrimos un diccionario donde especificaremos los procedimiento a </span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a><span class="co">//  realizarle al vector (punto).</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> bufferAleatorio <span class="op">=</span> <span class="kw">function</span>(punto){   </span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">//  -Extraemos el número aleatorio del vector que se encuentra en el </span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">//  atributo &#39;aleatorio&#39;.</span></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> numero <span class="op">=</span> punto<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;aleatorio&#39;</span>)<span class="op">;</span>  </span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">//  -Convertimos el número extraído en el paso anterior en un </span></span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">// `ee.Number` del servidor.</span></span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> NumServidor <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(numero)<span class="op">;</span>   </span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">//  -Multiplicamos ese `ee.Number` por 100 000.</span></span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> multiplicar <span class="op">=</span> NumServidor<span class="op">.</span><span class="fu">multiply</span>(<span class="dv">100000</span>)<span class="op">;</span> </span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">//  -Redondeamos el resultado de la multiplicación en el número entero </span></span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">//  mayor o igual más cercano.</span></span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> redondear <span class="op">=</span> multiplicar<span class="op">.</span><span class="fu">ceil</span>()<span class="op">;</span> </span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a>  <span class="co">//  -Creamos un buffer (area) alrededor del vector de entrada de </span></span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a>  <span class="co">// longitud definida según el número redondeado (redondear).</span></span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> area <span class="op">=</span> punto<span class="op">.</span><span class="fu">buffer</span>(redondear)<span class="op">;</span></span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-39"><a href="#cb56-39" aria-hidden="true" tabindex="-1"></a>  <span class="co">//  -Le asignamos al buffer (area) un nuevo atributo llamado &#39;radio del</span></span>
<span id="cb56-40"><a href="#cb56-40" aria-hidden="true" tabindex="-1"></a>  <span class="co">//  buffer&#39; con el número redondeado (metros usados para calcular el </span></span>
<span id="cb56-41"><a href="#cb56-41" aria-hidden="true" tabindex="-1"></a>  <span class="co">// buffer).</span></span>
<span id="cb56-42"><a href="#cb56-42" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> tamaño <span class="op">=</span> area<span class="op">.</span><span class="fu">set</span>(<span class="st">&#39;radio del buffer&#39;</span><span class="op">,</span>redondear)<span class="op">;</span>  </span>
<span id="cb56-43"><a href="#cb56-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-44"><a href="#cb56-44" aria-hidden="true" tabindex="-1"></a>  <span class="co">//  -Le asignamos al buffer (tamaño) otro atributo llamado &#39;area&#39;, en </span></span>
<span id="cb56-45"><a href="#cb56-45" aria-hidden="true" tabindex="-1"></a>  <span class="co">// donde calculamos el área del buffer usando el método `.area`.</span></span>
<span id="cb56-46"><a href="#cb56-46" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> circulo <span class="op">=</span> tamaño<span class="op">.</span><span class="fu">set</span>(<span class="st">&#39;area&#39;</span><span class="op">,</span>tamaño<span class="op">.</span><span class="fu">area</span>())<span class="op">;</span>  </span>
<span id="cb56-47"><a href="#cb56-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-48"><a href="#cb56-48" aria-hidden="true" tabindex="-1"></a>  <span class="co">//  Usando el método return especificamos que el buffer (circulo) con </span></span>
<span id="cb56-49"><a href="#cb56-49" aria-hidden="true" tabindex="-1"></a>  <span class="co">// los dos nuevos atributos será el resultado de esta función. </span></span>
<span id="cb56-50"><a href="#cb56-50" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> circulo<span class="op">;</span></span>
<span id="cb56-51"><a href="#cb56-51" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb56-52"><a href="#cb56-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-53"><a href="#cb56-53" aria-hidden="true" tabindex="-1"></a><span class="co">// Ejecutamos la función &#39;bufferAleatorio&#39; sobre todos los vectores de la</span></span>
<span id="cb56-54"><a href="#cb56-54" aria-hidden="true" tabindex="-1"></a><span class="co">// colección, cada punto de la colección entonces entrará como insumo de </span></span>
<span id="cb56-55"><a href="#cb56-55" aria-hidden="true" tabindex="-1"></a><span class="co">// la función bufferAleatorio</span></span>
<span id="cb56-56"><a href="#cb56-56" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> circulos <span class="op">=</span> puntos<span class="op">.</span><span class="fu">map</span>(bufferAleatorio)<span class="op">;</span> </span></code></pre></div>
<script type="text/javascript">
// Se llama una tabla de GEE con colección de vectores de países 
var paises = ee.FeatureCollection("USDOS/LSIB/2017"); 

//  Seleccionamos el vector cuyo atributo 'COUNTRY_NAME' es igual 
// ('equals') a 'Peru'.Filtrando así solo a Perú 
var peru = paises.filterMetadata('COUNTRY_NA','equals','Peru'); 

// Creamos una colección de vectores de 100 puntos aleatorios en Perú, y 
// usando el método .randomColumn le asignamos a cada punto un nuevo 
// atributo llamado 'aleatorio' cuyo valor es aleatorio (entre 0-1)
var puntos =ee.FeatureCollection.randomPoints(peru, 100)
  .randomColumn('aleatorio');  

//  Definimos una función del usuario (con el método `function`) llamada 
//  'bufferAleatorio' en la que el dato de entrada (insumo) será un 
//  vector (y el nombre genérico que le asignamos al insumo es (punto)):
//  -Abrimos un diccionario donde especificaremos los procedimiento a 
//  realizarle al vector (punto).
var bufferAleatorio = function(punto){   
  //  -Extraemos el número aleatorio del vector que se encuentra en el 
  //  atributo 'aleatorio'.
  var numero = punto.get('aleatorio');  
 
  //  -Convertimos el número extraído en el paso anterior en un 
  // `ee.Number` del servidor.
    var NumServidor = ee.Number(numero);   

  //  -Multiplicamos ese `ee.Number` por 100 000.
  var multiplicar = NumServidor.multiply(100000); 
 
  //  -Redondeamos el resultado de la multiplicación en el número entero 
  //  mayor o igual más cercano.
  var redondear = multiplicar.ceil(); 
  
  //  -Creamos un buffer (area) alrededor del vector de entrada de 
  // longitud definida según el número redondeado (redondear).
  var area = punto.buffer(redondear);

  //  -Le asignamos al buffer (area) un nuevo atributo llamado 'radio del
  //  buffer' con el número redondeado (metros usados para calcular el 
  // buffer).
  var tamaño = area.set('radio del buffer',redondear);  

  //  -Le asignamos al buffer (tamaño) otro atributo llamado 'area', en 
  // donde calculamos el área del buffer usando el método `.area`.
  var circulo = tamaño.set('area',tamaño.area());  

  //  Usando el método return especificamos que el buffer (circulo) con 
  // los dos nuevos atributos será el resultado de esta función. 
  return circulo;
};

// Ejecutamos la función 'bufferAleatorio' sobre todos los vectores de la
// colección, cada punto de la colección entonces entrará como insumo de 
// la función bufferAleatorio
var circulos = puntos.map(bufferAleatorio); 
</script>
</div>
<div id="reducción-de-una-colección-de-vectores" class="section level3 unnumbered">
<h3 class="unnumbered">Reducción de una colección de vectores</h3>
<p>Las colecciones también permiten agregar atributos de sus vectores en los metadatos de la colección, esta agregación se llama Reducir. Los reductores de atributos, tomarán el valor del atributo de todos los vectores y los convertirán en un solo valor para toda la colección. Depende el usuario, escoger la operación matemática que se utilizará para la reducción ya sea promedio, mínimo, máximo, mediana, entre otros. Estos reductores entregarán como resultado un diccionario. En el siguiente ejercicio se realizarán los siguientes pasos:</p>
<ul>
<li>Importamos una capa de cuencas, la filtramos con un rectángulo sobre Hawaii.</li>
<li>Definimos una función del usuario (<code>function</code>) llamada ‘areaDife’ en la que el dato de entrada (insumo) será un vector (y el nombre genérico que le asignamos al insumo es (cuenca)).</li>
<li>Abrimos un diccionario donde especificaremos los procedimientos a realizarle al vector (cuenca).</li>
<li>Calculamos el área del vector (con el método <code>.area</code>), y lo dividimos por 1 000 000 para convertir a km2.</li>
<li>Con <code>.get</code> extraemos el valor del atributo ‘areasqkm’ (el cual es una cadena de texto).</li>
<li>Con <code>.parse</code> convertimos el valor extraído anteriormente a un número del servidor (<code>ee.Number</code>).</li>
<li>Usando el método <code>.subtract</code> restamos el área calculada con el método <code>.area</code> menos el área reportada según el atributo del vector.</li>
<li>Usando el método <code>return</code> especificamos que el vector sea devuelto con un nuevo atributo llamado ‘diferencia’ (el cual contiene el valor de la resta elevado al cuadrado usando el método <code>.pow</code>).</li>
<li>Ejecutamos la función ‘areaDife’ sobre todos los vectores de la colección ‘cuencasHawaii’.</li>
<li>Usando el método <code>.reduceColumns</code> declaramos que usaremos un reductor sobre toda la colección enfocándonos en un atributo de los vectores.</li>
<li>Con <code>ee.Reducer.mean</code> declaramos que el reductor a utilizar será uno promedio. Por lo que el resultado será el promedio del atributo ‘diferencia’.</li>
<li>Con <code>.get</code> extraemos el valor del reductor que por defecto se llama ‘mean’.</li>
<li>Con <code>.sqrt</code> calculamos la raíz cuadrada del promedio calculado.</li>
</ul>
<p>Ejercicio 22</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Importar una capa de cuencas</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> cuencasHawaii <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">&#39;USGS/WBD/2017/HUC06&#39;</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filterBounds</span>(ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">160.969</span><span class="op">,</span> <span class="fl">23.104</span><span class="op">,</span> <span class="op">-</span><span class="fl">154.136</span><span class="op">,</span> <span class="fl">18.733</span>))<span class="op">;</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="co">// Definir una función que ejecute la diferencia entre el área reportada </span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="co">// en el atributo vector y la calculada en GEE</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> areaDife <span class="op">=</span> <span class="kw">function</span>(cuenca) {</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> area <span class="op">=</span> cuenca<span class="op">.</span><span class="fu">area</span>()<span class="op">.</span><span class="fu">divide</span>(<span class="dv">1000000</span>)<span class="op">;</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> dife <span class="op">=</span> area<span class="op">.</span><span class="fu">subtract</span>(ee<span class="op">.</span><span class="at">Number</span><span class="op">.</span><span class="fu">parse</span>(cuenca<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;areasqkm&#39;</span>)))<span class="op">;</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> cuenca<span class="op">.</span><span class="fu">set</span>(<span class="st">&#39;diferencia&#39;</span><span class="op">,</span> dife<span class="op">.</span><span class="fu">pow</span>(<span class="dv">2</span>))<span class="op">;</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a><span class="co">// Calcular el error cuadrático medio de toda la colección.</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> RECM <span class="op">=</span> ee<span class="op">.</span><span class="fu">Number</span>(</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>  cuencasHawaii<span class="op">.</span><span class="fu">map</span>(areaDife)</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">reduceColumns</span>(ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">mean</span>()<span class="op">,</span> [<span class="st">&#39;diferencia&#39;</span>])</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;mean&#39;</span>))<span class="op">.</span><span class="fu">sqrt</span>()<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Importar una capa de cuencas
var cuencasHawaii = ee.FeatureCollection('USGS/WBD/2017/HUC06')
  .filterBounds(ee.Geometry.Rectangle(-160.969, 23.104, -154.136, 18.733));

// Definir una función que ejecute la diferencia entre el área reportada 
// en el atributo vector y la calculada en GEE
var areaDife = function(cuenca) {
 
  var area = cuenca.area().divide(1000000);
  var dife = area.subtract(ee.Number.parse(cuenca.get('areasqkm')));
  return cuenca.set('diferencia', dife.pow(2));
};

// Calcular el error cuadrático medio de toda la colección.
var RECM = ee.Number(
  cuencasHawaii.map(areaDife)
  .reduceColumns(ee.Reducer.mean(), ['diferencia'])
  .get('mean')).sqrt();
</script>
<p>También, se puede usar una colección de vectores para reducir la información ráster de una imagen. Por ejemplo, se puede tomar una imagen de precipitación y ver cuál es el valor de diferentes variables climáticas, para cada vector. Este procedimiento se revisa con mayor detalle en el capítulo 11. En este caso se realizará el siguiente procedimiento:</p>
<ul>
<li>Filtramos las cuencas de Puerto Rico.</li>
<li>Obtener la suma de los valores de todos los píxeles que caigan en cada cuenca</li>
</ul>
<p>Ejercicio 23</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Importar una imagen de clima de WorldClim</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> clima <span class="op">=</span> ee<span class="op">.</span><span class="fu">Image</span>(<span class="st">&quot;WORLDCLIM/V1/BIO&quot;</span>)<span class="op">;</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co">//  Importar una capa de cuencas y filtramos las cuencas con un rectángulo </span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co">//  sobre Puerto Rico.</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> cuencasPuertorRico <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">&#39;USGS/WBD/2017/HUC06&#39;</span>)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filterBounds</span>(ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">79.906</span><span class="op">,</span> <span class="fl">25.196</span><span class="op">,</span> <span class="op">-</span><span class="fl">59.6</span><span class="op">,</span> <span class="fl">9.776</span>))<span class="op">;</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="co">//  Usando el método `.reduceRegions` declaramos que usaremos un reductor </span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="co">//  espacial en el área de las cuencas de Puerto Rico.</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="co">//    -Con `ee.Reducer.sum` especificamos que se desea obtener la la suma</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="co">//    de los valores de los atributos de todos los píxeles que caigan en </span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="co">//    cada vector.</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> cuencaClima <span class="op">=</span> clima<span class="op">.</span><span class="fu">reduceRegions</span>(cuencasPuertorRico<span class="op">,</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">sum</span>())<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Importar una imagen de clima de WorldClim
var clima = ee.Image("WORLDCLIM/V1/BIO");

//  Importar una capa de cuencas y filtramos las cuencas con un rectángulo 
//  sobre Puerto Rico.
var cuencasPuertorRico = ee.FeatureCollection('USGS/WBD/2017/HUC06')
  .filterBounds(ee.Geometry.Rectangle(-79.906, 25.196, -59.6, 9.776));
//  Usando el método `.reduceRegions` declaramos que usaremos un reductor 
//  espacial en el área de las cuencas de Puerto Rico.
//    -Con `ee.Reducer.sum` especificamos que se desea obtener la la suma
//    de los valores de los atributos de todos los píxeles que caigan en 
//    cada vector.
var cuencaClima = clima.reduceRegions(cuencasPuertorRico, ee.Reducer.sum());
</script>
</div>
<div id="conversión-de-vector-a-imagen" class="section level3 unnumbered">
<h3 class="unnumbered">Conversión de vector a imagen</h3>
<p>Para rasterizar un vector se usa el método <code>.reduceToImage</code>. Este método asigna bajo cada vector los píxeles del valor del atributo especificado. Para usar <code>.reduceToImage</code> indicamos el atributo que corresponderá al valor de los píxeles del raster como ‘área’. Por último, con el método <code>ee.Reducer.first</code> especificamos que el primer valor que encuentre en ese atributo sea asignado al valor del píxel.</p>
<p>Ejercicio 24</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Definir un área en la Antártida</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> rectangulo <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">158.63</span><span class="op">,-</span><span class="fl">81.47</span><span class="op">,-</span><span class="fl">40.51</span><span class="op">,-</span><span class="fl">59.12</span>)<span class="op">;</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Importar una colección de vectores de GEe con datos de glaciares</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> hielo <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">&quot;GLIMS/current&quot;</span>)<span class="op">.</span><span class="fu">filterBounds</span>(rectangulo)<span class="op">;</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="co">// Crear una imagen raster de las áreas de los glaciares.</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> areaGlaciar <span class="op">=</span> hielo</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="co">// Seleccionar vectores cuyo atributo área no esté vacío</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">notNull</span>([<span class="st">&#39;area&#39;</span>])) </span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="co">// Rasterizar  </span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="fu">reduceToImage</span>({</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Atributo del vector para rasterizar</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">properties</span><span class="op">:</span> [<span class="st">&#39;area&#39;</span>]<span class="op">,</span> </span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Tomar el primer valor</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">first</span>()  </span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Definir un área en la Antártida
var rectangulo = ee.Geometry.Rectangle(-158.63,-81.47,-40.51,-59.12);

// Importar una colección de vectores de GEe con datos de glaciares
var hielo = ee.FeatureCollection("GLIMS/current").filterBounds(rectangulo);

// Crear una imagen raster de las áreas de los glaciares.
var areaGlaciar = hielo
// Seleccionar vectores cuyo atributo área no esté vacío
    .filter(ee.Filter.notNull(['area'])) 
    
// Rasterizar  
.reduceToImage({
    // Atributo del vector para rasterizar
    properties: ['area'], 
    // Tomar el primer valor
    reducer: ee.Reducer.first()  
    });
</script>
</div>
<div id="unión-de-colecciones-de-vectores" class="section level3 unnumbered">
<h3 class="unnumbered">Unión de colecciones de vectores</h3>
<p>Para unir diferentes colecciones de vectores, mediante los valores de sus atributos, se usan las funciones de <code>ee.Join</code>. El resultado de estas funciones suele constar de una colección de vectores que contendrá los atributos de otra colección de vectores. Para determinar el tipo de relación entre los atributos de los vectores de ambas colecciones se utilizar un filtro (<code>.filter</code>).</p>
<p>Adicionalmente, se debe definir el tipo de unión a realizar entre los vectores. Los diferentes tipos de uniones se pueden consultar en la biblioteca <code>ee.Join</code>. En el siguiente ejercicio realizaremos un tipo de unión espacial de tipo <code>saveALL</code>, pero lo usaremos con dos filtros diferentes (uno de intersección y otro de distancia).</p>
<p>En este ejercicio se busca encontrar cuáles áreas protegidas se encuentran a menos de 10 km de una planta de energía, y ver cuáles áreas protegidas tienen una planta de energía dentro de sus límites.</p>
<p>Ejercicio 25</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Importar una colección de vectores: área protegidas de Guatemala</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> APGuatemala <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">&quot;WCMC/WDPA/current/polygons&quot;</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">eq</span>(<span class="st">&#39;PARENT_ISO&#39;</span><span class="op">,</span> <span class="st">&#39;GTM&#39;</span>))<span class="op">;</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="co">// Importar otra colección de vectores plantas de energía</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> plantas <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">&#39;WRI/GPPD/power_plants&#39;</span>)<span class="op">;</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="co">// Define un filtro espacial con distancia de 10 km. El .geo se utiliza </span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="co">// para indicar que se comparan geometrías</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> distFiltro <span class="op">=</span> ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">withinDistance</span>({</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">distance</span><span class="op">:</span> <span class="dv">10000</span><span class="op">,</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Geometría de la primera colección</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>  <span class="dt">leftField</span><span class="op">:</span> <span class="st">&#39;.geo&#39;</span><span class="op">,</span> </span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Geometría de la segunda colección</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>  <span class="dt">rightField</span><span class="op">:</span> <span class="st">&#39;.geo&#39;</span><span class="op">,</span> </span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>  <span class="dt">maxError</span><span class="op">:</span> <span class="dv">10</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a><span class="co">// Define un filtro espacial de intersección el .geo se utiliza para </span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a><span class="co">// indicar que se compararán geometrías</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> interFiltro <span class="op">=</span> ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">intersects</span>({</span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Geometría de la primera colección</span></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>  <span class="dt">leftField</span><span class="op">:</span> <span class="st">&#39;.geo&#39;</span><span class="op">,</span> </span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Geometría de la segunda colección</span></span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>  <span class="dt">rightField</span><span class="op">:</span> <span class="st">&#39;.geo&#39;</span><span class="op">,</span> </span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>  <span class="dt">maxError</span><span class="op">:</span> <span class="fl">0.1</span></span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a><span class="co">// Definir la forma de unión el Join</span></span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> Union <span class="op">=</span> ee<span class="op">.</span><span class="at">Join</span><span class="op">.</span><span class="fu">saveAll</span>({</span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>  <span class="dt">matchesKey</span><span class="op">:</span> <span class="st">&#39;plantas_energia_PA&#39;</span><span class="op">,</span></span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a>  <span class="dt">measureKey</span><span class="op">:</span> <span class="st">&#39;metros&#39;</span></span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a><span class="co">// Ejecutar la unión por distancia</span></span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> AP_cerca_PE <span class="op">=</span> Union<span class="op">.</span><span class="fu">apply</span>(APGuatemala<span class="op">,</span> plantas<span class="op">,</span> distFiltro)<span class="op">;</span></span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a><span class="co">// Ejecutar la unión por intersección</span></span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> AP_dentro_PE <span class="op">=</span> Union<span class="op">.</span><span class="fu">apply</span>(APGuatemala<span class="op">,</span> plantas<span class="op">,</span> interFiltro)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Importar una colección de vectores: área protegidas de Guatemala
var APGuatemala = ee.FeatureCollection("WCMC/WDPA/current/polygons")
  .filter(ee.Filter.eq('PARENT_ISO', 'GTM'));

// Importar otra colección de vectores plantas de energía
var plantas = ee.FeatureCollection('WRI/GPPD/power_plants');

// Define un filtro espacial con distancia de 10 km. El .geo se utiliza 
// para indicar que se comparan geometrías
var distFiltro = ee.Filter.withinDistance({
  distance: 10000,
  // Geometría de la primera colección
  leftField: '.geo', 
  // Geometría de la segunda colección
  rightField: '.geo', 
  maxError: 10
});

// Define un filtro espacial de intersección el .geo se utiliza para 
// indicar que se compararán geometrías
var interFiltro = ee.Filter.intersects({
  // Geometría de la primera colección
  leftField: '.geo', 
  // Geometría de la segunda colección
  rightField: '.geo', 
  maxError: 0.1
});

// Definir la forma de unión el Join
var Union = ee.Join.saveAll({
  matchesKey: 'plantas_energia_PA',
  measureKey: 'metros'
});

// Ejecutar la unión por distancia
var AP_cerca_PE = Union.apply(APGuatemala, plantas, distFiltro);

// Ejecutar la unión por intersección
var AP_dentro_PE = Union.apply(APGuatemala, plantas, interFiltro);
</script>
</div>
<div id="exportación-de-colecciones-de-vectores" class="section level3 unnumbered">
<h3 class="unnumbered">Exportación de colecciones de vectores</h3>
<p>GEE permite exportar vectores a la sección de Assets, al Google Drive o al GoogleCloud. Como GoogleCloud es un servicio de cobro no lo vamos a explicar.</p>
<p>Para exportar vectores es necesario usar la función <code>Export.table</code> y especificar si va a ser para drive <code>.toDrive</code> o para los assets <code>.toAsset</code>. Sus argumentos en común son:</p>
<ul>
<li>Collection (colección): obligatoriamente una colección de vectores <code>ee.FeatureCollection</code>. Si se quiere exportar un solo vector se deberá convertir en una colección de un solo elemento.</li>
<li>Description (descripción): es una cadena de texto de usuario (no debe contener espacios, ni símbolos; sólo letras, números y guión bajo <code>_</code> ). Esta cadena de texto es una descripción que el usuario quiera darle a la tarea de exportar.</li>
</ul>
<div class="bluebox2">
<div class="awesomeblock">
<p>Es importante recordar que no se podrán exportar vectores a los Assets sin geometrías, ni vectores con geometría <code>NULL</code>. Siempre que se quiera exportar una colección de vectores a la sección de Assets será necesario especificar alguna geometría por vector de la colección.</p>
</div>
</div>
<p>Los argumentos adicionales específicos para exportar a drive <code>Export.table.toDrive</code> son:</p>
<ul>
<li><p>Folder (carpeta): cadena de texto del usuario que será el nombre de la carpeta donde se guardará el vector dentro del drive. Si no se especifica este argumento, se guarda en el drive sin carpeta, aunque si se especifica un nombre de una carpeta que no existe, dicha carpeta se creará automáticamente.</p></li>
<li><p>FileNamePrefix (prefijo del archivo): el nombre que le pondremos al vector guardado en drive.</p></li>
<li><p>FileFormat (formato del archivo): el tipo de formato en el que se exportará la colección de archivos. GEE permite las siguientes opciones:</p>
<ul>
<li>“CSV”, valor por defecto, vectores separados por comas. Este formato consta de valores separados por comas, en el que cada coma indica una columna distinta. Este format es el más utilizado para exportar colecciones de vectores sin geometrías (es decir una simple tabla de atributos).</li>
<li>“GeoJSON” (“Geographic javaScript Object Notation”). Formato basado en el lenguaje JSON (“JavaScript Object Notation”) para almacenar datos vectoriales y sus atributos.</li>
<li>“KML” (“keyhole markup language”). Formato utilizado sobre todo por Google para almacenar datos espaciales y tablas de atributos asociados a ellos.</li>
<li>“KMZ” (“kml zipped”). Formato que consta de de un KML comprimido.</li>
<li>“SHP” (“shapefile”). Formato utilizado sobre todo por ESRI para almacenar vectores y tablas de atributos asociados a ellos.</li>
<li>“TFRecord” ("tensorflow record). Formato utilizado por Tensorflow para almacenar datos tanto vectoriales como ráster.</li>
</ul></li>
</ul>
<p>El argumento adicional para exportar a los Assets <code>Export.table.toAssets</code> es ‘AssetID’, que corresponde el nombre que le pondremos al nuevo archivo.</p>
<p>Ejercicio 26</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Determinamos un área de estudio con un polígono</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> poligono <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Polygon</span>(</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>        [<span class="op">-</span><span class="fl">79.59</span><span class="op">,</span> <span class="fl">7.00</span><span class="op">,</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>          <span class="op">-</span><span class="fl">85.02</span><span class="op">,</span> <span class="fl">8.14</span><span class="op">,</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>          <span class="op">-</span><span class="fl">88.04</span><span class="op">,</span> <span class="fl">10.68</span><span class="op">,</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>          <span class="op">-</span><span class="fl">93.69</span><span class="op">,</span> <span class="fl">9.44</span><span class="op">,</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>          <span class="op">-</span><span class="fl">98.51</span><span class="op">,</span> <span class="fl">4.69</span><span class="op">,</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>          <span class="op">-</span><span class="fl">94.24</span><span class="op">,</span> <span class="op">-</span><span class="fl">2.93</span><span class="op">,</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>          <span class="op">-</span><span class="fl">92.70</span><span class="op">,</span> <span class="fl">0.56</span><span class="op">,</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>          <span class="op">-</span><span class="fl">89.13</span><span class="op">,</span> <span class="fl">0.82</span><span class="op">,</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>          <span class="op">-</span><span class="fl">87.57</span><span class="op">,</span> <span class="op">-</span><span class="fl">1.55</span><span class="op">,</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>          <span class="op">-</span><span class="fl">82.31</span><span class="op">,</span> <span class="op">-</span><span class="fl">0.08</span><span class="op">,</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>          <span class="op">-</span><span class="fl">79.64</span><span class="op">,</span> <span class="fl">3.24</span>])<span class="op">;</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a><span class="co">// Creamos la colección de vectores de puntos de ejemplo</span></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> puntos <span class="op">=</span> ee<span class="op">.</span><span class="at">FeatureCollection</span><span class="op">.</span><span class="fu">randomPoints</span>(poligono<span class="op">,</span> <span class="dv">4000</span>)<span class="op">;</span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a><span class="co">// Exportamos a los assets dentro de la nube</span></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>Export<span class="op">.</span><span class="at">table</span><span class="op">.</span><span class="fu">toAsset</span>({</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>  <span class="dt">collection</span><span class="op">:</span> punto<span class="op">,</span></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>  <span class="dt">description</span><span class="op">:</span> <span class="st">&#39;exportar_puntos_asset&#39;</span><span class="op">,</span></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>  <span class="dt">assetId</span><span class="op">:</span> <span class="st">&#39;puntos_exportados&#39;</span></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a><span class="co">// Exportamos al drive personal</span></span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>Export<span class="op">.</span><span class="at">table</span><span class="op">.</span><span class="fu">toDrive</span>({</span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>  <span class="dt">collection</span><span class="op">:</span>punto<span class="op">,</span> </span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>  <span class="dt">description</span><span class="op">:</span><span class="st">&#39;exportar_puntos_drive&#39;</span><span class="op">,</span></span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>  <span class="dt">folder</span><span class="op">:</span><span class="st">&#39;carpeta_clase_GEE&#39;</span><span class="op">,</span></span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a>  <span class="dt">fileNamePrefix</span><span class="op">:</span><span class="st">&#39;puntos_ejemplo&#39;</span><span class="op">,</span></span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>  <span class="dt">fileFormat</span><span class="op">:</span><span class="st">&#39;SHP&#39;</span></span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Determinamos un área de estudio con un polígono
var poligono = ee.Geometry.Polygon(
        [-79.59, 7.00,
          -85.02, 8.14,
          -88.04, 10.68,
          -93.69, 9.44,
          -98.51, 4.69,
          -94.24, -2.93,
          -92.70, 0.56,
          -89.13, 0.82,
          -87.57, -1.55,
          -82.31, -0.08,
          -79.64, 3.24]);

// Creamos la colección de vectores de puntos de ejemplo
var puntos = ee.FeatureCollection.randomPoints(poligono, 4000);

// Exportamos a los assets dentro de la nube
Export.table.toAsset({
  collection: punto,
  description: 'exportar_puntos_asset',
  assetId: 'puntos_exportados'
});

// Exportamos al drive personal
Export.table.toDrive({
  collection:punto, 
  description:'exportar_puntos_drive',
  folder:'carpeta_clase_GEE',
  fileNamePrefix:'puntos_ejemplo',
  fileFormat:'SHP'
});
</script>
Es importante recordar que es necesario dar clic a las tareas en la pestaña Tasks para que se lleva a cabo la exportación.
<div class="figure" style="text-align: center">
<img src="Img/boton_run.png" alt="ubicacion del boton 'Run? para ejecutar las tareas en 'Task'." width="100%" />
<p class="caption">
(#fig:unnamed-chunk-107)ubicacion del boton ‘Run? para ejecutar las tareas en ’Task’.
</p>
</div>
<!--chapter:end:08-coleccionvectores.Rmd-->
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div id="ee.image-1" class="section level1" number="9">
<h1 number="9"><span class="header-section-number">9</span> ee.Image</h1>
<p>Las imágenes (<code>ee.Image</code>) en GEE generalmente se encuentran disponibles en colecciones de imágenes, aunque también existen fuentes de datos particulares que constan de una sola imagen. Las imágenes corresponden a información en formato ráster que cuenta con una resolución espacial, espectral y radiométrica particular (ver Olaya [2020] para una descripción más detallada de un ráster). Los metadatos de cada imagen se encuentran como propiedades de esta. A diferencia de las imágenes a las que posiblemente el usuario esté acostumbrado a manejar, GEE permite el manejo de imágenes donde cada banda puede tener una resolución de píxel o tipo de datos distinta (Integer, Float, 16 bits, etc.). Esto no afecta el uso de estas imágenes, pero es importante a considerar para exportar imágenes cuyas bandas tienen distinta resolución espacial (por ejemplo, Sentinel-2), ya que al exportar una imagen multibanda, todas sus bandas deben tener la misma resolución y tipo de datos.</p>
<p>Para ejemplificar esta sección se cargará una imagen global de la altura del dosel para áreas con cobertura arbórea en el 2005.</p>
<p>Ejercicio 27</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Cargar la imagen global de la altura del dosel para áreas con cobertura </span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co">// arbórea en el 2005</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> CHM <span class="op">=</span> ee<span class="op">.</span><span class="fu">Image</span>(<span class="st">&quot;NASA/JPL/global_forest_canopy_height_2005&quot;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Cargar la imagen global de la altura del dosel para áreas con cobertura 
// arbórea en el 2005
var CHM = ee.Image("NASA/JPL/global_forest_canopy_height_2005");
</script>
<div id="información-adicional-para-los-ejemplos" class="section level2" number="9.1">
<h2 number="9.1"><span class="header-section-number">9.1</span> Información adicional para los ejemplos</h2>
<p>Para realizar los ejercicios de este apartado, se cargarán dos fuentes de información adicionales para aplicar algunos de los métodos disponibles para imágenes. La primera consta de una simple geometría de una región de interés, mientras que la segunda, es un vector que contiene el polígono de la superficie de México.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Cargar un polígono con el área de interés</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> roi1 <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Polygon</span>(</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>        [[[<span class="op">-</span><span class="fl">101.90832388457699</span><span class="op">,</span> <span class="fl">20.455157626721274</span>]<span class="op">,</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>          [<span class="op">-</span><span class="fl">101.90832388457699</span><span class="op">,</span> <span class="fl">19.422397223570666</span>]<span class="op">,</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>          [<span class="op">-</span><span class="fl">100.56799185332699</span><span class="op">,</span> <span class="fl">19.422397223570666</span>]<span class="op">,</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>          [<span class="op">-</span><span class="fl">100.56799185332699</span><span class="op">,</span> <span class="fl">20.455157626721274</span>]]]<span class="op">,</span> <span class="kw">null</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="co">// Cargar la colección de atributos de los polígonos de la superficie de </span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="co">// los países</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> MX <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">&quot;USDOS/LSIB_SIMPLE/2017&quot;</span>)</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Filtrar por la propiedad country_co para elegir México</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">eq</span>(<span class="st">&#39;country_co&#39;</span><span class="op">,</span><span class="st">&#39;MX&#39;</span>))<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Cargar un polígono con el área de interés
var roi1 = ee.Geometry.Polygon(
        [[[-101.90832388457699, 20.455157626721274],
          [-101.90832388457699, 19.422397223570666],
          [-100.56799185332699, 19.422397223570666],
          [-100.56799185332699, 20.455157626721274]]], null, false);

// Cargar la colección de atributos de los polígonos de la superficie de 
// los países
var MX = ee.FeatureCollection("USDOS/LSIB_SIMPLE/2017")
  // Filtrar por la propiedad country_co para elegir México
  .filter(ee.Filter.eq('country_co','MX'));
</script>
<p>Adicionalmente, se cargará la primera imagen de una colección de imágenes (Landsat 7). Este procedimiento se verá más a detalle en el siguiente capítulo sobre colecciones de imágenes. Por el momento, cabe aclarar que el método <code>.first</code> permite extraer la primera imagen de una colección de imágenes, tras lo cual el objeto resultante es una imagen (<code>ee.Image</code>). Ya que las imágenes multiespectrales sólo se encuentran dentro de colecciones de imágenes, el uso de esta imagen de Landsat 7 nos permitirá ejemplificar algunos de los métodos más utilizados sobre imágenes multiespectrales.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Obtener la primera imagen Landsat 7 de una colección de imágenes.</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co">// Cargar colección de imágenes de Landsat 7          </span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> landsat7im <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&quot;LANDSAT/LE07/C01/T1_SR&quot;</span>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Filtrar por fecha</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filterDate</span>(<span class="st">&#39;2020-01-01&#39;</span><span class="op">,</span><span class="st">&#39;2020-02-01&#39;</span>)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Filtrar imágenes para mantener únicamente las que se sobrelapen con </span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">// el área de interés</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filterBounds</span>(roi1)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Obtener la primera imagen de la colección</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">first</span>()<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Obtener la primera imagen Landsat 7 de una colección de imágenes.
// Cargar colección de imágenes de Landsat 7          
var landsat7im = ee.ImageCollection("LANDSAT/LE07/C01/T1_SR")
  // Filtrar por fecha
  .filterDate('2020-01-01','2020-02-01')
  // Filtrar imágenes para mantener únicamente las que se sobrelapen con 
  // el área de interés
  .filterBounds(roi1)
  // Obtener la primera imagen de la colección
  .first();
</script>
</div>
<div id="información-y-metadatos-3" class="section level2" number="9.2">
<h2 number="9.2"><span class="header-section-number">9.2</span> Información y metadatos</h2>
<p>Los metadatos de la imagen se encuentran como propiedades. Para consultarlas se puede utilizar el siguiente comando: <code>.propertyNames</code>. Otros comandos que facilitan la consulta de algunos elementos particulares son: <code>.bandNames</code>, <code>.projection</code>, <code>.projection().nominalScale</code>, para conocer el nombre de las bandas de la imágenes, su proyección y el tamaño de píxel en m que presenta, respectivamente.</p>
<p>Ejercicio 27.1</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Obtener las propiedades de la imagen</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>CHM<span class="op">.</span><span class="fu">propertyNames</span>()<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Obtener las propiedades de la imagen
CHM.propertyNames();
</script>
<div class="bluebox2">
<div class="awesomeblock">
<p>El sistema de coordenadas de referencia de trabajo para todas las capas es EPSG:4326. Si se requiere cambiar de proyección se puede utilizar el método <code>.reproject</code>, aunque no se recomienda utilizarla, a menos que sea estrictamente necesario.</p>
</div>
</div>
<p>Por otro lado, la información almacenada en un ráster, usualmente está organizada en distintas bandas. Para consultar los nombres de las bandas de una imagen se utiliza el método <code>.bandNames</code>.</p>
<p>Ejercicio 27.2</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Obtener los nombres de las bandas de la imagen</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>CHM<span class="op">.</span><span class="fu">bandNames</span>()<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Obtener los nombres de las bandas de la imagen
CHM.bandNames();
</script>
</div>
<div id="visualización-de-una-imagen" class="section level2" number="9.3">
<h2 number="9.3"><span class="header-section-number">9.3</span> Visualización de una imagen</h2>
<p>De igual manera que los vectores y las colecciones de vectores, las imágenes se pueden agregar a la pantalla de mapas mediante la función <code>Map.addLayer</code>.</p>
<p>Ejercicio 27.3</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Cargar la imagen a la pantalla de mapas</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(CHM<span class="op">,</span> </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Definir los valores mínimos y máximos de la imagen para su </span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">// visualización</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">32</span>}<span class="op">,</span> </span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Definir el nombre con el que se desea cargar la imagen a la pantalla </span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">// de mapas</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;primera imagen&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Cargar la imagen a la pantalla de mapas
Map.addLayer(CHM, 
  // Definir los valores mínimos y máximos de la imagen para su 
  // visualización
  {min: 0, max: 32}, 
  // Definir el nombre con el que se desea cargar la imagen a la pantalla 
  // de mapas
  'primera imagen');
</script>
<div class="bluebox2">
<div class="awesomeblock">
<p>La información ráster en GEE se almacena en un esquema piramidal, es decir, que existen varias copias de la imagen, en la que cada una corresponde a una escala distinta. Al visualizar una imagen en la pantalla de mapas, la imagen mostrada será la de la escala que se encuentre más cercana al nivel del zoom de la pantalla de mapas. Por ello, en algunas ocasiones al usar el Inspector y mover el zoom, el valor de un píxel puede cambiar, ya que se están consultando valores de distintas imágenes (cada una asociada a una escala distinta). Para mayores detalles visitar: <a href="https://developers.google.com/earth-engine/guides/scale" class="uri">https://developers.google.com/earth-engine/guides/scale</a></p>
</div>
</div>
</div>
<div id="métodos-comunes-3" class="section level2" number="9.4">
<h2 number="9.4"><span class="header-section-number">9.4</span> Métodos comunes</h2>
<div id="selección-de-bandas" class="section level3 unnumbered">
<h3 class="unnumbered">Selección de bandas</h3>
<p>Una vez revisado los nombres de las bandas de una imagen, se pueden seleccionar ciertas bandas mediante el método <code>.select</code>. Para seleccionar una única banda sólo se requiere indicar el nombre de la banda, mientras que si se desea seleccionar varias bandas, éstas deben indicarse dentro de una lista. Por ejemplo:</p>
<p>Ejercicio 27.4</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Seleccionar la banda 1 de la imagen (que es la única)</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> banda1 <span class="op">=</span> CHM<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;1&#39;</span>)<span class="op">;</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Seleccionar sólo las primeras cuatro bandas de la imagen</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> landsat7imBands <span class="op">=</span> landsat7im<span class="op">.</span><span class="fu">select</span>([<span class="st">&#39;B1&#39;</span><span class="op">,</span><span class="st">&#39;B2&#39;</span><span class="op">,</span><span class="st">&#39;B3&#39;</span><span class="op">,</span><span class="st">&#39;B4&#39;</span>])<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Seleccionar la banda 1 de la imagen (que es la única)
var banda1 = CHM.select('1');

// Seleccionar sólo las primeras cuatro bandas de la imagen
var landsat7imBands = landsat7im.select(['B1','B2','B3','B4']);
</script>
</div>
<div id="adición-de-nuevas-propiedades-o-modificación-de-propiedades-preexistentes-1" class="section level3 unnumbered">
<h3 class="unnumbered">Adición de nuevas propiedades o modificación de propiedades preexistentes</h3>
<p>Además, usando el método <code>.set</code> se pueden modificar las propiedades preexistentes, o escribir nuevas propiedades sobre la imagen. En este caso, primero se indica el nombre de la clave, seguido de su valor correspondiente. Por ejemplo.</p>
<p>Ejercicio 27.5</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Agregar una nueva propiedad</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> CHMprop1 <span class="op">=</span> CHM<span class="op">.</span><span class="fu">set</span>(<span class="st">&#39;miPropiedad&#39;</span><span class="op">,</span><span class="st">&#39;miImagen&#39;</span>)<span class="op">;</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Modificar una propiedad preexistente</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> CHMprop2 <span class="op">=</span> CHM<span class="op">.</span><span class="fu">set</span>(<span class="st">&#39;title&#39;</span><span class="op">,</span><span class="st">&#39;miTítulo&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Agregar una nueva propiedad
var CHMprop1 = CHM.set('miPropiedad','miImagen');

// Modificar una propiedad preexistente
var CHMprop2 = CHM.set('title','miTítulo');
</script>
<div class="bluebox2">
<div class="awesomeblock">
<p>Nótese que se puede sobreescribir la misma variable, pero hay que tener cuidado porque la información anterior se pierde.</p>
</div>
</div>
</div>
<div id="sustitución-de-nombres-de-bandas" class="section level3 unnumbered">
<h3 class="unnumbered">Sustitución de nombres de bandas</h3>
<p>Por defecto, el nombre de las bandas de las imágenes suelen corresponder a la letra ‘B’ más un número que indica el número de banda. Por ejemplo, ‘B1’, ‘B2’,‘B3’, etc. En algunos casos, el usuario puede preferir sustituir estos nombres con letras que indiquen la longitud de onda que contiene cada banda. Para ello, se puede utilizar el método <code>.rename</code>. En caso de que la imagen de interés conste de una sola banda y un solo nombre, se puede indicar directamente el nuevo nombre, sino, se debe pasar una lista con el nuevo nombre para cada banda. Por ejemplo:</p>
<p>Ejercicio 27.6</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Cambiar el nombre de la banda </span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>banda1 <span class="op">=</span> banda1<span class="op">.</span><span class="fu">rename</span>(<span class="st">&quot;chm&quot;</span>)<span class="op">;</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> landsat7imBandsRename <span class="op">=</span> landsat7imBands<span class="op">.</span><span class="fu">rename</span>([<span class="st">&#39;B&#39;</span><span class="op">,</span><span class="st">&#39;G&#39;</span><span class="op">,</span><span class="st">&#39;R&#39;</span><span class="op">,</span><span class="st">&#39;NIR&#39;</span>])<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Cambiar el nombre de la banda 
banda1 = banda1.rename("chm");
var landsat7imBandsRename = landsat7imBands.rename(['B','G','R','NIR']);
</script>
</div>
<div id="realización-de-cortes" class="section level3 unnumbered">
<h3 class="unnumbered">Realización de cortes</h3>
<p>Para obtener el área de una imagen únicamente de una región de interés se puede realizar mediante el método <code>.clip</code>. Por ejemplo:</p>
<p>Ejercicio 27.7</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Cortar la imagen a la extensión del polígono de México</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> chmMx <span class="op">=</span> banda1<span class="op">.</span><span class="fu">clip</span>(MX)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Cortar la imagen a la extensión del polígono de México
var chmMx = banda1.clip(MX);
</script>
<p>Esto permite trabajar únicamente con la región de interés (en el ejemplo anterior, especificada en el objeto roi).</p>
<div class="bluebox2">
<div class="awesomeblock">
<p>Se sugiere evitar el uso del método <code>.clip</code> a menos que sea estrictamente necesario, ya que aumenta el tiempo de procesamiento. En muchos casos, se puede indicar el área de interés hasta el último paso del procesamiento, que suele implicar la exportación del resultado fuera de GEE (ver última sección de este capítulo: Exportación de una imagen).</p>
</div>
</div>
</div>
<div id="cálculo-de-operaciones-matemáticas" class="section level3 unnumbered">
<h3 class="unnumbered">Cálculo de operaciones matemáticas</h3>
<p>Dentro de GEE se puede realizar cualquier operación matemática entre bandas o entre imágenes. Los operadores para realizar esta operaciones son: <code>.subtract, .add, .divide, .multiply</code> para restar, sumar, dividir y multiplicar, respectivamente.</p>
<p>Ejercicio 27.8</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Multiplicar la imagen por 100 para obtener el valor en cm</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> chmCmMx <span class="op">=</span> chmMx<span class="op">.</span><span class="fu">multiply</span>(<span class="dv">100</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Multiplicar la imagen por 100 para obtener el valor en cm
var chmCmMx = chmMx.multiply(100);
</script>
<p>Además, GEE cuenta con un método de <code>.normalizedDifference</code> para calcular un índice normalizado a partir de las bandas que se indiquen. Por ejemplo, para calcular el NDVI primero se indica la banda del infrarrojo y luego la del rojo. Si se quiere realizar un índice un poco más complicado se puede calcular mediante el método <code>.expression</code>. En este método se indica primero la fórmula del cálculo que se va a realizar (en formato cadena de texto) y posteriormente se indica en un diccionario la equivalencia de los términos utilizados en la fórmula y los nombres de las bandas de la imagen. Las siguientes dos formas de calcular el NDVI obtienen el mismo resultado:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Calcular el ndvi con la imagen de landsat 7 obtenida previamente</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> ndvi<span class="op">=</span> landsat7imBands<span class="op">.</span><span class="fu">expression</span>( <span class="st">&#39;(NIR - R) / (NIR + R)&#39;</span><span class="op">,</span> {</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;NIR&#39;</span> <span class="op">=</span> landsat7imBands<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;B4&#39;</span>)<span class="op">,</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;R&#39;</span> <span class="op">=</span> landsat7imBands<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;B3&#39;</span>)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Renombrar la banda como &#39;ndvi&#39;</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">rename</span>(<span class="st">&#39;ndvi&#39;</span>)<span class="op">;</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> ndvi2 <span class="op">=</span> landsat7imBands<span class="op">.</span><span class="fu">normalizedDifference</span>(<span class="st">&#39;B4&#39;</span><span class="op">,</span><span class="st">&#39;B3&#39;</span>)</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Renombrar la banda como &#39;ndvi&#39;</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">rename</span>(<span class="st">&#39;ndvi&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Calcular el ndvi con la imagen de landsat 7 obtenida previamente
var ndvi= landsat7imBands.expression( '(NIR - R) / (NIR + R)', {
  'NIR' = landsat7imBands.select('B4'),
  'R' = landsat7imBands.select('B3')
})
  // Renombrar la banda como 'ndvi'
  .rename('ndvi');
  
var ndvi2 = landsat7imBands.normalizedDifference('B4','B3')
  // Renombrar la banda como 'ndvi'
  .rename('ndvi');
</script>
<div class="bluebox2">
<div class="awesomeblock">
<p>Si no se cambia el nombre de la banda producida por <code>.normalizedDifference</code>, por defecto, ésta va a recibir el nombre de ‘nd’.</p>
</div>
</div>
<p>Dentro de las fórmulas utilizadas dentro de <code>expression</code> se puede utilizar la notación estándar matemática (<code>+</code>, <code>-</code>, <code>/</code>, <code>*</code>), módulo (<code>%</code>), exponente (<code>**</code>), relacionales(<code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>!=</code>, <code>==</code>), lógicos (<code>&amp;&amp;</code>, <code>||</code>, <code>!</code>, <code>^</code>), o if then else (<code>?:</code>).</p>
</div>
<div id="uso-de-operaciones-relacionales-condicionales-y-booleanas" class="section level3 unnumbered">
<h3 class="unnumbered">Uso de operaciones relacionales, condicionales y booleanas</h3>
<p>Se pueden utilizar operadores relacionales, condicionales, booleanos sobre las imágenes para crear clases o máscaras. Para ello, se utilizan las siguientes notaciones <code>.lt</code>, <code>.lte</code>, <code>.gt</code>, <code>.gte</code>, <code>.eq</code>, <code>.neq</code>, que equivalen a menor que (“less than”), menor que o igual (“less than or equal”), mayor que (“greater than”), mayor que o igual (“greater than or equal”), igual (“equal2) o no igual (”not equal"), respectivamente. Además se pueden utilizar operadores relacionales para unir dos condiciones mediante <code>.and</code> u <code>.or</code>, es decir, y u o. Por ejemplo, la siguiente línea permite crear una máscara de las áreas que tengan valores menores o iguales a 0.2 y mayores o iguales a 0:</p>
<p>Ejercicio 27.9</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Crear una imagen de los píxeles que cumplen con la condición de tener </span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="co">// valores mayores o iguales a 20</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="co">// Nótese que se utiliza la imagen con valores en m</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> chmMXMask20 <span class="op">=</span> chmMx<span class="op">.</span><span class="fu">gte</span>(<span class="dv">20</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Crear una imagen de los píxeles que cumplen con la condición de tener 
// valores mayores o iguales a 20
// Nótese que se utiliza la imagen con valores en m
var chmMXMask20 = chmMx.gte(20);
</script>
<p>Otra forma de crear máscaras es indicando valores por bits. En este caso, se indica el valor del bit de interés y después se evalúa una condición sobre una banda determinada. Por ejemplo, para Landsat 8, la banda de evaluación de la calidad de la imagen corresponde a la banda ‘pixel_qa’. En esta banda, el bit 5 indica una cobertura de nubes, así que primero se define una variable que indique que el bit 5 es el que será evaluado. Después se selecciona la banda ‘pixel_qa’ para después evaluar una condición sobre ella. En este caso, se crea una máscara que tenga valores a conservar (1) en áreas donde el bit 5 sea 0; por el contrario, contendrá valores a eliminar (0) en áreas donde el bit 5 no sea 0.</p>
<p>Ejercicio 27.10</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Definir la regla en bits de la imagen de los valores que se desean </span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="co">// enmascarar</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> nubesBit <span class="op">=</span> (<span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="dv">5</span>)<span class="op">;</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="co">// Seleccionar la banda de evaluación de la calidad de la imagen</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> qa <span class="op">=</span> landsat7im<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;pixel_qa&#39;</span>)<span class="op">;</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="co">// Definir una máscara donde las áreas a mantener (1) serán las áreas </span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="co">// donde el bit 5 tenga valores iguales a cero</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> mask <span class="op">=</span> qa<span class="op">.</span><span class="fu">bitwiseAnd</span>(nubesBit)<span class="op">.</span><span class="fu">eq</span>(<span class="dv">0</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Definir la regla en bits de la imagen de los valores que se desean 
// enmascarar
var nubesBit = (1 << 5);

// Seleccionar la banda de evaluación de la calidad de la imagen
var qa = landsat7im.select('pixel_qa');

// Definir una máscara donde las áreas a mantener (1) serán las áreas 
// donde el bit 5 tenga valores iguales a cero
var mask = qa.bitwiseAnd(nubesBit).eq(0);
</script>
</div>
<div id="enmascaramiento" class="section level3 unnumbered">
<h3 class="unnumbered">Enmascaramiento</h3>
<p>El método <code>.updateMask</code> permite enmascarar los píxeles de una imagen, utilizando otra imagen como máscara que indique cuáles píxeles se deben conservar (valores de 1) y cuáles enmascarar (valores de 0).</p>
<p>Ejercicio 27.11</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Utilizar la máscara de valores que tienen alturas &gt;= 20 y aplicarla a </span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="co">// la imagen con los valores de alturas</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> chmMxMayor20 <span class="op">=</span> chmMx<span class="op">.</span><span class="fu">updateMask</span>(chmMXMask20)<span class="op">;</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Aplicar la máscara a la imagen original</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> landsat7imMask <span class="op">=</span> landsat7im<span class="op">.</span><span class="fu">updateMask</span>(mask)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Utilizar la máscara de valores que tienen alturas >= 20 y aplicarla a 
// la imagen con los valores de alturas
var chmMxMayor20 = chmMx.updateMask(chmMXMask20);
// Aplicar la máscara a la imagen original
var landsat7imMask = landsat7im.updateMask(mask);
</script>
<div class="bluebox2">
<div class="awesomeblock">
<p>Aunque en GEE existe el método <code>.mask</code> para enmascarar áreas de una imagen, se sugiere siempre utilizar <code>.updateMask</code>. El método <code>.mask</code> simplemente sustituye la máscara original de la imagen, mientras que <code>.updateMask</code> combina la máscara anterior con la nueva. Por ello, el usar <code>.updateMask</code> evita desenmascarar áreas que podrían no ser de interés para el usuario.</p>
</div>
</div>
</div>
<div id="adición-de-bandas" class="section level3 unnumbered">
<h3 class="unnumbered">Adición de bandas</h3>
<p>El usuario puede estar interesado en agregar una banda al conjunto de bandas que contiene por defecto una imagen. Por ejemplo, se podría agregar una banda que contenga algún índice calculado con las bandas originales de la imagen. Esto se puede lograr utilizando el método <code>.addBands</code>. Por ejemplo:</p>
<p>Ejercicio 27.12</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Agregar la banda de alturas en cm a la banda original en m</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>chmMx2Bands <span class="op">=</span> chmMx<span class="op">.</span><span class="fu">addBands</span>(chmCmMx<span class="op">.</span><span class="fu">rename</span>(<span class="st">&#39;chmCm&#39;</span>))<span class="op">;</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Agregar la banda de ndvi a la imagen original</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>landsat7im <span class="op">=</span> landsat7im<span class="op">.</span><span class="fu">addBands</span>(ndvi)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Agregar la banda de alturas en cm a la banda original en m
chmMx2Bands = chmMx.addBands(chmCmMx.rename('chmCm'));

// Agregar la banda de ndvi a la imagen original
landsat7im = landsat7im.addBands(ndvi);
</script>
</div>
<div id="conversión-de-imagen-a-vector" class="section level3 unnumbered">
<h3 class="unnumbered">Conversión de imagen a vector</h3>
<p>En algunos casos puede ser conveniente transformar una imagen a un vector, o parte de una imagen a un vector. El método para convertir una imagen en vector es <code>.reduceToVectors</code> y se utiliza de la siguiente manera:</p>
<p>Ejercicio 27.13</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Convertir la máscara de valores que tienen valores de altura &gt;= 20 a </span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="co">// vector</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> chmMxMayor20Vec <span class="op">=</span> chmMXMask20<span class="op">.</span><span class="fu">reduceToVectors</span>({</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>     <span class="co">// Usar el polígono de México para definir el área a convertir a </span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>     <span class="co">// vector</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">geometry</span><span class="op">:</span> MX<span class="op">,</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="co">// Definir el tipo de geometría que se desea</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">geometryType</span><span class="op">:</span> <span class="st">&#39;polygon&#39;</span><span class="op">,</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="co">// Definir el tamaño de píxel en m con el cual se va a crear el vector</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">1200</span><span class="op">,</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a><span class="co">// Definir el tamaño máximo de píxeles a procesar</span></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>  <span class="dt">maxPixels</span><span class="op">:</span> <span class="fl">1e11</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Convertir la máscara de valores que tienen valores de altura >= 20 a 
// vector
var chmMxMayor20Vec = chmMXMask20.reduceToVectors({
     // Usar el polígono de México para definir el área a convertir a 
     // vector
  geometry: MX,
// Definir el tipo de geometría que se desea
  geometryType: 'polygon',
// Definir el tamaño de píxel en m con el cual se va a crear el vector
  scale: 1200,
// Definir el tamaño máximo de píxeles a procesar
  maxPixels: 1e11
});
</script>
<div class="bluebox2">
<div class="awesomeblock">
<p>En operaciones como la anterior, donde se debe indicar el tamaño del píxel para realizar el proceso, el argumento de scale le indica a GEE la escala de la representación piramidal de una imagen de la cual va a tomar los valores para realizar la operación. Ver sección 8.3.</p>
</div>
</div>
</div>
<div id="exportación-de-una-imagen" class="section level3 unnumbered">
<h3 class="unnumbered">Exportación de una imagen</h3>
<p>En GEE se pueden exportar imágenes a los Assets, al Google Drive o al GoogleCloud. Debido a que el servicio más común será el de drive es el que se explicará. La función para realizar dicha exportación es <code>Export.imageToDrive</code> (ver Sección 3.4). Los argumentos de esta función son: image (la imagen a exportar), description (el nombre con el que se desea guardar el archivo), folder (la carpeta donde se desea guardar la imagen), scale (la escala para exportar la imagen), maxPixels (el número máximo de píxeles permitido), format (el formato de imagen deseado), región (región que se desea exportar, suele corresponder al área de interés) y crs (sistema de coordenadas de referencia). La función es capaz de aceptar otros argumentos que se pueden consultar en la sección de Reference o en la pestaña de Docs, así como los valores por defecto de cada uno de estos parámetros. Cabe mencionar que todos los argumentos son opcionales, excepto la imagen a exportar, sin embargo, se recomienda siempre definir por lo menos los argumentos de descripción, carpeta, escala y región.</p>
<p>Ejercicio 27.14</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Exportación al drive personal</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>Export<span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">toDrive</span>({</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Nombre de la imagen a exportar en GEE</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">image</span><span class="op">:</span>chmMx<span class="op">,</span> </span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Nombre con el que se va a guardar la imagen en el drive</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">description</span><span class="op">:</span><span class="st">&#39;CanopyHeightModelMX&#39;</span><span class="op">,</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Folder dentro del drive en el cual se va a exportar la imagen</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">folder</span><span class="op">:</span><span class="st">&#39;carpeta_clase_GEE&#39;</span><span class="op">,</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Tamaño en m del píxel de la imagen a exportar</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Tamaño en m del píxel de la imagen a exportar</span></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>  <span class="dt">maxPixels</span><span class="op">:</span><span class="fl">1e12</span><span class="op">,</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Formato en el cual se va a exportar la imagen</span></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>  <span class="dt">fileFormat</span><span class="op">:</span> <span class="st">&#39;GeoTIFF&#39;</span><span class="op">,</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Región de la imagen a exportar</span></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>  <span class="dt">region</span><span class="op">:</span> roi1<span class="op">,</span></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Definir sistema de coordenadas de referencia</span></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>  <span class="dt">crs</span><span class="op">:</span> <span class="st">&#39;EPSG:4326&#39;</span></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Exportación al drive personal
Export.image.toDrive({
  // Nombre de la imagen a exportar en GEE
  image:chmMx, 
  // Nombre con el que se va a guardar la imagen en el drive
  description:'CanopyHeightModelMX',
  // Folder dentro del drive en el cual se va a exportar la imagen
  folder:'carpeta_clase_GEE',
  // Tamaño en m del píxel de la imagen a exportar
  scale: 30,
  // Tamaño en m del píxel de la imagen a exportar
  maxPixels:1e12,
  // Formato en el cual se va a exportar la imagen
  fileFormat: 'GeoTIFF',
  // Región de la imagen a exportar
  region: roi1,
  // Definir sistema de coordenadas de referencia
  crs: 'EPSG:4326'
});
</script>
<div class="bluebox2">
<div class="awesomeblock">
<p>En experiencia de los autores el valor máximo de píxeles que permite exportar GEE es 1e13, es decir, un uno seguido de trece ceros.</p>
</div>
</div>
<div class="bluebox2">
<div class="awesomeblock">
<p>El sistema de coordenadas de referencia (CRS, por sus siglas en inglés) usado en el ejemplo anterior se definió de acuerdo a un código EPSG. Estos pueden consultarse en el siguiente enlace: <a href="https://epsg.io/" class="uri">https://epsg.io/</a>. Por defecto, el sistema de coordenadas de referencia de la información almacenada en GEE corresponde a coordenadas geográficas WGS84 (EPSG:4326) con un tamaño de píxel de un grado. Recordar que para mostrar la información en la pantalla de mapas, esta se proyecta a un CRS con la clave EPSG:3857, sin embargo, dicha proyección únicamente se hace para desplegar la información, mas no transforma la información con la que el usuario está trabajando. Por lo tanto, puede haber pequeñas diferencias entra la información visualizada en la pantalla de mapas y la información exportada.</p>
</div>
</div>
<p>Es importante recordar que es necesario dar clic a las tareas en la pestaña Tasks para que se lleva a cabo la exportación.</p>
<div id="ejercicio-consulta-y-procesamiento-de-una-imagen-ejercicio-a" class="section level4 unnumbered">
<h4 class="unnumbered">Ejercicio: Consulta y procesamiento de una imagen (Ejercicio A)</h4>
<p>En GEE hay algunos objetos que constan de imágenes únicas, por lo tanto, se pueden utilizar directamente sobre ellas los métodos para el procesamiento de imágenes. Un ejemplo muy utilizado de este tipo de objetos es el modelo digital de elevación (DEM) producido por la misión SRTM (Shuttle Radar Topography Mission). Para buscar cuál es la localización para acceder a esta información se puede ir a la barra de búsqueda (<code>Search</code>) y escribir SRTM. Debería aparecer una ventana así (Fig. 9.1):</p>
<div class="figure" style="text-align: center">
<img src="Img/SRTM.png" alt="Ejemplo de búsqueda de información en la barra de búsqueda." width="100%" />
<p class="caption">
(#fig:unnamed-chunk-126)Ejemplo de búsqueda de información en la barra de búsqueda.
</p>
</div>
<p>Posteriormente se da clic sobre el primer resultado y debería abrirse la siguiente ventana (Fig. 9.2).</p>
<div class="figure" style="text-align: center">
<img src="Img/SRTM_prop.png" alt="Consulta de información de una imagen del repositorio de GEE." width="100%" />
<p class="caption">
(#fig:unnamed-chunk-127)Consulta de información de una imagen del repositorio de GEE.
</p>
</div>
<p>En dicha ventana, se puede copiar la ubicación de la imagen del DEM de SRTM en los servidores de Google. Posteriormente, en la pantalla de rutinas se puede escribir la siguiente línea para guardar la imagen SRTM en un objeto nuevo llamado dem.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Cargar la imagen con el DEM de SRTM</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> dem <span class="op">=</span> ee<span class="op">.</span><span class="fu">Image</span>(<span class="st">&quot;CGIAR/SRTM90_V4&quot;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Cargar la imagen con el DEM de SRTM
var dem = ee.Image("CGIAR/SRTM90_V4");
</script>
<p>Posteriormente, se corta el DEM a la extensión que nos interesa. En este caso se utilizará la colección con los límites políticos del mundo que se encuentra cargada en GEE. Esta se puede buscar de igual manera que la capa de SRTM en la barra de búsqueda. Posteriormente, se puede consultar la información que contiene la capa en la pestaña de ‘TABLE SCHEMA’. Por último, se aplica un filtro para seleccionar el país que nos interesa, en este caso México.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Cargar la colección de atributos con polígonos de la superficie de los </span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="co">// países</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> MX <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">&quot;USDOS/LSIB_SIMPLE/2017&quot;</span>)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>   <span class="co">// Filtrar para seleccionar únicamente México</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">eq</span>(<span class="st">&#39;country_co&#39;</span><span class="op">,</span><span class="st">&#39;MX&#39;</span>))<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Cargar la colección de atributos con polígonos de la superficie de los 
// países
var MX = ee.FeatureCollection("USDOS/LSIB_SIMPLE/2017")
   // Filtrar para seleccionar únicamente México
  .filter(ee.Filter.eq('country_co','MX'));
</script>
<p>Y se corta la imagen a la extensión del polígono de interés.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Cortar el DEM con el polígono de México</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> demCortado <span class="op">=</span> dem<span class="op">.</span><span class="fu">clip</span>(MX)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Cortar el DEM con el polígono de México
var demCortado = dem.clip(MX);
</script>
<p>Para comparar el DEM antes y después de cortar la imagen a la extensión del polígono de interés, se cargan los dos objetos: dem y demCortado.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Cargar el DEM global y el cortado (sólo MX), indicando valores máximos </span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="co">// y mínimos en m</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(dem<span class="op">,</span> {<span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span><span class="dv">4000</span>}<span class="op">,</span> <span class="st">&#39;dem&#39;</span>)<span class="op">;</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(demCortado<span class="op">,</span> {<span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span><span class="dv">4000</span>}<span class="op">,</span> <span class="st">&#39;demMX&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Cargar el DEM global y el cortado (sólo MX), indicando valores máximos 
// y mínimos en m
Map.addLayer(dem, {min: 0, max:4000}, 'dem');
Map.addLayer(demCortado, {min: 0, max:4000}, 'demMX');
</script>
<p>Posteriormente, se define una máscara de todas las áreas que tengan una elevación menor o igual a 2500 m s.n.m. y mayor o igual a 1000 m s.n.m. Después, se aplica esta máscara al DEM cortado para mantener únicamente las áreas que cumplan con el criterio anterior.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Crear máscara de zona de interés</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> mascara <span class="op">=</span> demCortado<span class="op">.</span><span class="fu">lte</span>(<span class="dv">2500</span>)<span class="op">.</span><span class="fu">and</span>(demCortado<span class="op">.</span><span class="fu">gte</span>(<span class="dv">1000</span>))<span class="op">;</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="co">// Aplicar máscara al DEM de México</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> imgEnmascarada <span class="op">=</span> demCortado<span class="op">.</span><span class="fu">updateMask</span>(mascara)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Crear máscara de zona de interés
var mascara = demCortado.lte(2500).and(demCortado.gte(1000));
// Aplicar máscara al DEM de México
var imgEnmascarada = demCortado.updateMask(mascara);
</script>
<p>A continuación, se renombrará la banda de la imagen de ‘elevation’ a ‘elevacion’ y se agrega la imagen a la pantalla de mapas.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Cambiar el nombre de la banda de la imagen enmascarada a elevacion</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>imgEnmascarada <span class="op">=</span> imgEnmascarada<span class="op">.</span><span class="fu">rename</span>(<span class="st">&#39;elevacion&#39;</span>)<span class="op">;</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co">// Agregar imagen enmascarada a la pantalla de mapas</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(imgEnmascarada<span class="op">,</span>{<span class="dt">min</span><span class="op">:</span> <span class="dv">1000</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">2500</span>}<span class="op">,</span> <span class="st">&#39;imgEnmascarada&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Cambiar el nombre de la banda de la imagen enmascarada a elevacion
imgEnmascarada = imgEnmascarada.rename('elevacion');
// Agregar imagen enmascarada a la pantalla de mapas
Map.addLayer(imgEnmascarada,{min: 1000, max: 2500}, 'imgEnmascarada');
</script>
<p>Por último, se generará un gráfico para obtener un histograma de los valores de elevación del DEM. Para hacer esto, se utiliza la función <code>ui.Chart.image.histogram</code> y se indica la imagen de la cual se quiere obtener el histograma (<code>image</code>), la escala en metros a la que se quiere obtener los valores del histograma (<code>scale</code>) y el número máximo de clases (<code>maxBuckets</code>). Por último, se agrega este gráfico a la consola con un <code>print</code> (Fig. 9.3).</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Crear gráfico de histograma de los valores del DEM enmascarado</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> graficoHistograma <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">histogram</span>({</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>     <span class="co">// Indicar imagen de la cual se va a crear el histograma  </span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">image</span><span class="op">:</span> imgEnmascarada<span class="op">,</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Indicar la escala en m a la que se va a muestrear la información para  </span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">// obtener el histograma</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">9000</span><span class="op">,</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Indicar el número máximo de categorías (en eje x) para crear el </span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">// histograma</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">maxBuckets</span><span class="op">:</span> <span class="dv">10</span></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(graficoHistograma<span class="op">,</span><span class="st">&#39;gráfico Histograma&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Crear gráfico de histograma de los valores del DEM enmascarado
var graficoHistograma = ui.Chart.image.histogram({
     // Indicar imagen de la cual se va a crear el histograma  
  image: imgEnmascarada,
  // Indicar la escala en m a la que se va a muestrear la información para  
  // obtener el histograma
  scale: 9000,
  // Indicar el número máximo de categorías (en eje x) para crear el 
  // histograma
  maxBuckets: 10
  });

print(graficoHistograma,'gráfico Histograma');
</script>
<div class="figure" style="text-align: center">
<img src="Img/histElevacion.png" alt="Histograma de valores del DEM." width="100%" />
<p class="caption">
(#fig:unnamed-chunk-135)Histograma de valores del DEM.
</p>
</div>
<p>Por último, se puede exportar el resultado al Google Drive del usuario. En este caso se definirá un valor de <code>scale</code> de 9000 para acelerar el tiempo demorado en la exportación.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>Export<span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">toDrive</span>({</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">image</span><span class="op">:</span>imgEnmascarada<span class="op">,</span> </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">description</span><span class="op">:</span><span class="st">&#39;MX_DEM1000-2500msnm&#39;</span><span class="op">,</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">folder</span><span class="op">:</span><span class="st">&#39;carpeta_clase_GEE&#39;</span><span class="op">,</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">9000</span><span class="op">,</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">maxPixels</span><span class="op">:</span><span class="fl">1e12</span><span class="op">,</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">fileFormat</span><span class="op">:</span> <span class="st">&#39;GeoTIFF&#39;</span><span class="op">,</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">region</span><span class="op">:</span> MX<span class="op">,</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">crs</span><span class="op">:</span> <span class="st">&#39;EPSG:4326&#39;</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
Export.image.toDrive({
  image:imgEnmascarada, 
  description:'MX_DEM1000-2500msnm',
  folder:'carpeta_clase_GEE',
  scale: 9000,
  maxPixels:1e12,
  fileFormat: 'GeoTIFF',
  region: MX,
  crs: 'EPSG:4326'
});
</script>
<p>Una vez corrido el código, hay que irse a la pestaña de Tasks para darle clic en Run y comenzar a exportar la imagen al Google Drive. A continuación aparece una pantalla, en la cual podemos confirmar los parámetros utilizados para la exportación de la imagen, tras lo cual, se vuelve a dar clic en Run . Por último, el producto exportado aparecerá en la pestaña de Tasks con un símbolo de un engranaje girando, el cual indica que el proceso está corriendo. Además, en esta pestaña se puede consultar el tiempo de demora del trabajo de exportación. Ya que la imagen haya sido exportada al Drive, la tarea cambiará a color azul y el engranaje en movimiento cambiará a una palomita indicando el tiempo demorado en exportar la imagen al Drive (ver Fig. 2.22).</p>
<!--chapter:end:09-imagen.Rmd-->
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
</div>
<div id="ee.imagecollection-1" class="section level1" number="10">
<h1 number="10"><span class="header-section-number">10</span> ee.ImageCollection</h1>
<p>Las colecciones de imágenes (<code>ee.ImageCollection</code>) son objetos de GEE que contienen un conjunto de imágenes. La mayoría de los acervos de imágenes disponibles en GEE van a ser definidos como este tipo de objetos. Para el manejo de varias imágenes se recomienda utilizar esta estructura, en lugar de listas u otro tipo de objetos. La mayoría de las colecciones de imágenes disponibles en GEE incluyen acervos de imágenes gratuitas como Landsat 1-5 y 7-8, MODIS, Sentinel 1-3 y 5, ASTER, entre otras (Gorelick et al., 2017; Radočaj et al., 2020). Por ejemplo, para cargar la colección de reflectancia de la superficie de imágenes Sentinel-2 se usaría el siguiente código:</p>
<p>Ejercicio 28</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Cargar la colección de Sentinel-2 reflectancia de la superficie</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> S2 <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&quot;COPERNICUS/S2_SR&quot;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Cargar la colección de Sentinel-2 reflectancia de la superficie
var S2 = ee.ImageCollection("COPERNICUS/S2_SR");
</script>
<div id="información-adicional-para-los-ejemplos-1" class="section level2" number="10.1">
<h2 number="10.1"><span class="header-section-number">10.1</span> Información adicional para los ejemplos</h2>
<p>Como información adicional para este capítulo se definirá una geometría de un área de interés.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Definición de un área de interés</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> roi <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Polygon</span>(</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>        [[[<span class="op">-</span><span class="fl">101.80582759131487</span><span class="op">,</span> <span class="fl">20.274503120947937</span>]<span class="op">,</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>          [<span class="op">-</span><span class="fl">101.80582759131487</span><span class="op">,</span> <span class="fl">19.35462236718103</span>]<span class="op">,</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>          [<span class="op">-</span><span class="fl">100.61930415381487</span><span class="op">,</span> <span class="fl">19.35462236718103</span>]<span class="op">,</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>          [<span class="op">-</span><span class="fl">100.61930415381487</span><span class="op">,</span> <span class="fl">20.274503120947937</span>]]]<span class="op">,</span> <span class="kw">null</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Definición de un área de interés
var roi = ee.Geometry.Polygon(
        [[[-101.80582759131487, 20.274503120947937],
          [-101.80582759131487, 19.35462236718103],
          [-100.61930415381487, 19.35462236718103],
          [-100.61930415381487, 20.274503120947937]]], null, false);
</script>
</div>
<div id="información-y-metadatos-4" class="section level2" number="10.2">
<h2 number="10.2"><span class="header-section-number">10.2</span> Información y metadatos</h2>
<p>Las colecciones de imágenes contienen los metadatos e información de todas las imágenes que contienen. De tal manera, se puede utilizar esta información para filtrar las imágenes y utilizar únicamente las que cumplen con ciertos criterios. Es importante recalcar que los metadatos y propiedades de una colección de imágenes no corresponde a las propiedades de las imágenes que la componen. Para consultar las propiedades de una colección de imágenes se usa el método <code>.propertyNames</code>.</p>
<p>Ejercicio 28.1</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Obtener las propiedades de la colección deimágenes</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> S2Prop <span class="op">=</span> S2<span class="op">.</span><span class="fu">propertyNames</span>()<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Obtener las propiedades de la colección deimágenes
var S2Prop = S2.propertyNames();
</script>
<div class="bluebox2">
<div class="awesomeblock">
<p>No se puede escribir o cambiar los objetos que se encuentran directamente hospedados en GEE. Por ejemplo, si se quiere mapear (<code>.map</code>) una función que sobreescriba alguna característica de las colecciones de imágenes en GEE, se debe hacer una copia de éstas para que se pueda sobreescribir la propiedad de interés.</p>
</div>
</div>
</div>
<div id="creación-de-colecciones-de-imágenes" class="section level2" number="10.3">
<h2 number="10.3"><span class="header-section-number">10.3</span> Creación de colecciones de imágenes</h2>
<p>En ciertas ocasiones, el usuario puede estar interesado en crear nuevas colecciones de imágenes, a partir de resultados generados dentro del mismo GEE. En este caso, se pueden crear nuevas colecciones de imágenes mediante el método <code>ee.ImageCollection.fromImages</code>, indicando como argumentos la lista de las imágenes a partir de la que se quiere crear dicha colección.</p>
<p>Ejercicio 28.2</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Filtrar colección de Sentinel-2 por fechas</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> im1 <span class="op">=</span> S2<span class="op">.</span><span class="fu">filterDate</span>(<span class="st">&#39;2019-01-01&#39;</span><span class="op">,</span><span class="st">&#39;2019-05-01&#39;</span>)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Aplicar filtro espacial</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a> <span class="op">.</span><span class="fu">filterBounds</span>(roi)</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a> <span class="co">// Obtener la primera imagen</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a> <span class="op">.</span><span class="fu">first</span>()<span class="op">;</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="co">// Crear otra imagen de igual manera que la imagen anterior pero con </span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="co">// fechas distintas</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> im2 <span class="op">=</span> S2<span class="op">.</span><span class="fu">filterDate</span>(<span class="st">&#39;2020-01-01&#39;</span><span class="op">,</span><span class="st">&#39;2020-05-01&#39;</span>)</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a> <span class="op">.</span><span class="fu">filterBounds</span>(roi)</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a> <span class="op">.</span><span class="fu">first</span>()<span class="op">;</span></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a><span class="co">// Crear colección a partir de dos imágenes</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> imColl <span class="op">=</span> ee<span class="op">.</span><span class="at">ImageCollection</span><span class="op">.</span><span class="fu">fromImages</span>([im1<span class="op">,</span> im2])<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Filtrar colección de Sentinel-2 por fechas
var im1 = S2.filterDate('2019-01-01','2019-05-01')
  // Aplicar filtro espacial
 .filterBounds(roi)
 // Obtener la primera imagen
 .first();

// Crear otra imagen de igual manera que la imagen anterior pero con 
// fechas distintas
var im2 = S2.filterDate('2020-01-01','2020-05-01')
 .filterBounds(roi)
 .first();

// Crear colección a partir de dos imágenes
var imColl = ee.ImageCollection.fromImages([im1, im2]);
</script>
</div>
<div id="visualización-de-colecciones-de-imágenes" class="section level2" number="10.4">
<h2 number="10.4"><span class="header-section-number">10.4</span> Visualización de colecciones de imágenes</h2>
<p>De igual manera que los vectores y las colecciones de vectores, las colecciones de imágenes se pueden visualizar en la pantalla de mapas mediante la función <code>Map.addLayer</code>. Usualmente, al agregar una colección de imágenes a la pantalla de mapas, se van a mostrar los elementos con fecha de registro más reciente. Por ejemplo, en este caso muestra la imagen más reciente por cada escena dentro de la colección.</p>
<p>Ejercicio 28.3</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Filtrar colección de Sentinel-2 utilizando fechas</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> imCol3 <span class="op">=</span> S2<span class="op">.</span><span class="fu">filterDate</span>(<span class="st">&#39;2019-01-01&#39;</span><span class="op">,</span><span class="st">&#39;2019-05-01&#39;</span>)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Aplicar filtro espacial</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a> <span class="op">.</span><span class="fu">filterBounds</span>(roi)<span class="op">;</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="co">// Agregar colección de imágenes a la pantalla de mapas</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(imCol3<span class="op">,</span> {<span class="dt">bands</span><span class="op">:</span> [<span class="st">&#39;B4&#39;</span><span class="op">,</span><span class="st">&#39;B3&#39;</span><span class="op">,</span><span class="st">&#39;B2&#39;</span>]<span class="op">,</span> <span class="dt">min</span><span class="op">:</span><span class="dv">200</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">2000</span>}<span class="op">,</span> </span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;S2 Mich&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Filtrar colección de Sentinel-2 utilizando fechas
var imCol3 = S2.filterDate('2019-01-01','2019-05-01')
  // Aplicar filtro espacial
 .filterBounds(roi);

// Agregar colección de imágenes a la pantalla de mapas
Map.addLayer(imCol3, {bands: ['B4','B3','B2'], min:200, max: 2000}, 
  'S2 Mich');
</script>
</div>
<div id="métodos-comunes-4" class="section level2" number="10.5">
<h2 number="10.5"><span class="header-section-number">10.5</span> Métodos comunes</h2>
<div id="filtración-de-colecciones-de-imágenes" class="section level3 unnumbered">
<h3 class="unnumbered">Filtración de colecciones de imágenes</h3>
<p>Las colecciones de imágenes se pueden filtrar a partir de los metadatos de las imágenes que contiene. De tal manera, se puede filtrar por: superposición con algún polígono de interés, fecha de registro, metadatos de las escenas (path, row, porcentaje de nubosidad), entre otras. Para filtrar una colección de imágenes se van a utilizar los objetos <code>ee.Filter</code>. Existen diversos tipos de filtros, algunos ya se encuentran precargados, pero otros se pueden definir manualmente. Por ejemplo, para filtrar por fecha se puede utilizar <code>.filterDate</code>:</p>
<p>Ejercicio 28.4</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Filtrar colección de imágenes por fecha</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> imCol4 <span class="op">=</span> S2<span class="op">.</span><span class="fu">filterDate</span>(<span class="st">&#39;2019-01-01&#39;</span><span class="op">,</span><span class="st">&#39;2019-05-01&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Filtrar colección de imágenes por fecha
var imCol4 = S2.filterDate('2019-01-01','2019-05-01');
</script>
<p>Por otro lado para filtrar espacialmente con la extensión de un polígono se puede realizar mediante <code>.filterBounds</code>:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Filtrar colección de acuerdo a sobrelape con polígono de región de </span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="co">// interés</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>imCol4 <span class="op">=</span> imCol4<span class="op">.</span><span class="fu">filterBounds</span>(roi)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Filtrar colección de acuerdo a sobrelape con polígono de región de 
// interés
imCol4 = imCol4.filterBounds(roi);
</script>
<p>Si se desea filtrar por alguna característica de los metadatos de las imágenes se puede hacer mediante <code>.filter</code> y después definiendo el filtro del metadato con <code>ee.Filter</code>. Otra forma de realizar este proceso es mediante <code>.filterMetadata</code>. Las siguientes dos líneas son equivalentes ya qye obtienen el mismo resultado.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Obtener el nombre de las propiedades de una imágen de la colección de </span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="co">// imágenes</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> imProperties <span class="op">=</span> im1<span class="op">.</span><span class="fu">propertyNames</span>()<span class="op">;</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="co">// Filtrar a partir de las propiedades de las imágenes</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>imCol4 <span class="op">=</span> imCol4<span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">lt</span>(<span class="st">&#39;CLOUD_COVERAGE_ASSESSMENT&#39;</span><span class="op">,</span> <span class="dv">50</span>))<span class="op">;</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>imCol4 <span class="op">=</span> imCol4<span class="op">.</span><span class="fu">filterMetadata</span>(<span class="st">&#39;CLOUD_COVERAGE_ASSESSMENT&#39;</span><span class="op">,</span><span class="st">&#39;less_than&#39;</span><span class="op">,</span> <span class="dv">50</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Obtener el nombre de las propiedades de una imágen de la colección de 
// imágenes
var imProperties = im1.propertyNames();

// Filtrar a partir de las propiedades de las imágenes
imCol4 = imCol4.filter(ee.Filter.lt('CLOUD_COVERAGE_ASSESSMENT', 50));
imCol4 = imCol4.filterMetadata('CLOUD_COVERAGE_ASSESSMENT','less_than', 50);
</script>
<div class="bluebox2">
<div class="awesomeblock">
<p>Recordar que para filtar una colección de imágenes utilizando metadatos se debe filtrar de acuerdo a las propiedades de las imágenes, no de la colección.</p>
</div>
</div>
<div class="bluebox2">
<div class="awesomeblock">
<p>Para trabajar con una colección de imágenes se sugiere que primero se apliquen los filtros espaciales y temporales (<code>.filter</code>), así como la selección de las bandas a utilizar (<code>.select</code>), antes de realizar operaciones sobre todas las imágenes de la colección (<code>.map</code>).</p>
</div>
</div>
<div class="bluebox2">
<div class="awesomeblock">
<p>Para combinar varios filtros se utiliza <code>ee.Filter.and</code> o <code>ee.Filter.or</code> dependiendo de si se desea que se cumplan todas las condiciones indicadas (<code>and</code>) o alguna de ellas (<code>or</code>).</p>
</div>
</div>
</div>
<div id="selección-de-bandas-1" class="section level3 unnumbered">
<h3 class="unnumbered">Selección de bandas</h3>
<p>Al igual que con las imágenes, se puede utilizar el método <code>.select</code> para seleccionar un conjunto de bandas de todas las imágenes que se encuentran en la colección. De igual manera que con las imágenes individuales, para seleccionar una única banda sólo se requiere indicar el nombre de la banda, mientras que si se desea seleccionar varias bandas, éstas deben indicarse dentro de una lista. Por ejemplo:</p>
<p>Ejercicio 28.5</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Obtener el nombre de las bandas de una imagen de una colección de </span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="co">// imágenes</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> imBandNames <span class="op">=</span> im1<span class="op">.</span><span class="fu">bandNames</span>()<span class="op">;</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="co">// Seleccionar ciertas bandas de todas las imágenes que conforman la </span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="co">// colección</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> imCol5 <span class="op">=</span> imCol4<span class="op">.</span><span class="fu">select</span>([<span class="st">&#39;B4&#39;</span><span class="op">,</span><span class="st">&#39;B3&#39;</span><span class="op">,</span><span class="st">&#39;B2&#39;</span>])<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Obtener el nombre de las bandas de una imagen de una colección de 
// imágenes
var imBandNames = im1.bandNames();

// Seleccionar ciertas bandas de todas las imágenes que conforman la 
// colección
var imCol5 = imCol4.select(['B4','B3','B2']);

</script>
<div class="bluebox2">
<div class="awesomeblock">
<p>Recordar que para seleccionar ciertas bandas en una colección de imágenes, éstas corresponden a bandas de las imágenes, no de la colección. Esto es útil para revisar los nombres de las bandas.</p>
</div>
</div>
</div>
<div id="ordenación-de-una-colección" class="section level3 unnumbered">
<h3 class="unnumbered">Ordenación de una colección</h3>
<p>El método <code>.sort</code> permite ordenar una colección de imágenes por alguna propiedad de las imágenes. Por defecto, las colecciones de imágenes están ordenadas cronológicamente. Sin embargo, se puede cambiar este orden para que las ordene por alguna característica de las imágenes, por ejemplo, por orden de menor a mayor cobertura de nubes. Por defecto, el método <code>.sort</code> ordena la colección de imágenes en orden ascendente, de acuerdo al valor de la característica indicada. Sin embargo, si se desea ordenar de manera descendente, esto se puede indicar utilizando el argumento <code>ascending: false</code>. En el siguiente ejemplo, primero se ordena la colección en orden ascendente y en el segundo, descendente.</p>
<p>Ejercicio 28.6</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Cambiar el orden de la colección en función de la propiedad de las </span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="co">// imágenes de cobertura de nubes en sentido descendente</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>imCol5 <span class="op">=</span> imCol5<span class="op">.</span><span class="fu">sort</span>({<span class="dt">property</span><span class="op">:</span> <span class="st">&#39;CLOUD_COVERAGE_ASSESSMENT&#39;</span><span class="op">,</span> </span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">ascending</span><span class="op">:</span> <span class="kw">false</span>})<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Cambiar el orden de la colección en función de la propiedad de las 
// imágenes de cobertura de nubes en sentido descendente
imCol5 = imCol5.sort({property: 'CLOUD_COVERAGE_ASSESSMENT', 
  ascending: false});
</script>
</div>
<div id="obtención-de-la-primera-imagen" class="section level3 unnumbered">
<h3 class="unnumbered">Obtención de la primera imagen</h3>
<p>En algunas ocasiones resulta útil obtener la primera imagen de una colección de imágenes para ver si se llevó a cabo el procedimiento deseado sobre la colección. Para ello, se utiliza el método <code>.first</code> que devuelve la primera imagen que se encuentra en la colección y permite visualizarla en la pantalla de mapas para analizarla más a detalle. Al utilizar el método <code>.first</code> sobre una colección de imágenes (<code>ee.ImageCollection</code>) el resultado corresponderá a una imagen (<code>ee.Image</code>).</p>
<p>Ejercicio 28.7</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Obtener la primera imagen de una colección</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> primera <span class="op">=</span> imCol3<span class="op">.</span><span class="fu">first</span>()</span></code></pre></div>
<script type="text/javascript">
// Obtener la primera imagen de una colección
var primera = imCol3.first()
</script>
</div>
<div id="extracción-de-listas-con-atributos-de-imágenes" class="section level3 unnumbered">
<h3 class="unnumbered">Extracción de listas con atributos de imágenes</h3>
<p>Para obtener una lista con los atributos de las imágenes que conforman una colección de imágenes se utiliza el método <code>.aggregate</code>. Este método tiene varias formas de obtener y resumir los atributos de los vectores que conforman una colección: extraer una propiedad de los vectores (<code>.aggregate_array</code>), extraer y calcular la media por propiedad (<code>.aggregate_mean</code>), extraer y calcular un histograma (<code>.aggregte_histogram</code>), o extraer y obtener estadísticas descriptivas de las propiedades (<code>.aggregate_stats</code>). Por ejemplo, para obtener una lista con la propiedad ‘CLOUD_COVERAGE_ASSESSMENT’ de todas las imágenes contenidas en una colección de imágenes se puede realizar de la siguiente manera:</p>
<p>Ejercicio 28.8</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Obtener una lista de con los valores de la propiedad de cobertura de </span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="co">// nubes de todas las imágenes de la colección</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> listMetadatos <span class="op">=</span> imCol5<span class="op">.</span><span class="fu">aggregate_array</span>(<span class="st">&#39;CLOUD_COVERAGE_ASSESSMENT&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Obtener una lista de con los valores de la propiedad de cobertura de 
// nubes de todas las imágenes de la colección
var listMetadatos = imCol5.aggregate_array('CLOUD_COVERAGE_ASSESSMENT');
</script>
</div>
<div id="conteo-de-observaciones-por-pixel" class="section level3 unnumbered">
<h3 class="unnumbered">Conteo de observaciones por pixel</h3>
<p>Para conocer el número de valores sin enmascarar por píxel en la colección de imágenes se utiliza el método <code>.count</code>. El resultado de este procedimiento consta de una imagen con las mismas bandas que las imágenes a partir de las cuales se calculó el número de observaciones por píxel.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Obtener el número de observaciones válidas para un píxel dentro de una </span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="co">// colección de imágenes</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> conteoImgs <span class="op">=</span> imCol5<span class="op">.</span><span class="fu">count</span>()<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Obtener el número de observaciones válidas para un píxel dentro de una 
// colección de imágenes
var conteoImgs = imCol5.count();
</script>
</div>
<div id="conocer-tamaño-de-la-colección" class="section level3 unnumbered">
<h3 class="unnumbered">Conocer tamaño de la colección</h3>
<p>Para conocer el tamaño de la colección en número de imágenes incluidas se utiliza el método <code>.size</code>.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Obtener el número de observaciones válidas para un píxel dentro de una </span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="co">// colección de imágenes</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> numImgs <span class="op">=</span> imCol5<span class="op">.</span><span class="fu">size</span>()<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Obtener el número de observaciones válidas para un píxel dentro de una 
// colección de imágenes
var numImgs = imCol5.size();
</script>
</div>
<div id="unión-de-más-de-una-colección" class="section level3 unnumbered">
<h3 class="unnumbered">Unión de más de una colección</h3>
<p>Para unir una colección de imágenes con otra, se utiliza el método <code>.merge</code>. Un caso típico de tal operación sería unir dos colecciones de Landsat, por ejemplo, Landsat 7 y 8.</p>
<div class="bluebox2">
<div class="awesomeblock">
<p>Las colecciones Landsat 7 y 8 no tienen las mismas bandas, ni los nombres de las bandas corresponden entre sí. Por ejemplo, la banda 1 de Landsat 7 corresponde al espectro del azul (“blue”), mientras que en Landsat 8, la banda 1 corresponde al azul de costa (“coastal blue”). En este caso, conviene primero filtrar y renombrar las bandas a unir para asegurarse que el nombre de las bandas a unir en una colección corresponda con las de la otra.</p>
</div>
</div>
<p>La unión de una colección de Sentinel-2 se podría hacer de la siguiente manera:</p>
<p>Ejercicio 28.9</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Aplicar un filtro por fechas a la colección de Sentinel-2</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> imCol6 <span class="op">=</span> S2<span class="op">.</span><span class="fu">filterDate</span>(<span class="st">&#39;2019-01-01&#39;</span><span class="op">,</span><span class="st">&#39;2019-05-01&#39;</span>)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Aplicar filtro espacial</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filterBounds</span>(roi)<span class="op">;</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="co">// Hacer lo mismo que en el caso anterior, pero cambiando las fechas</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> imCol7 <span class="op">=</span> S2<span class="op">.</span><span class="fu">filterDate</span>(<span class="st">&#39;2020-06-01&#39;</span><span class="op">,</span><span class="st">&#39;2020-11-01&#39;</span>)</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filterBounds</span>(roi)<span class="op">;</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a><span class="co">// Unir las dos colecciones de imágenes en una sola  </span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> imCol8 <span class="op">=</span> imCol6<span class="op">.</span><span class="fu">merge</span>(imCol7)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Aplicar un filtro por fechas a la colección de Sentinel-2
var imCol6 = S2.filterDate('2019-01-01','2019-05-01')
  // Aplicar filtro espacial
  .filterBounds(roi);

// Hacer lo mismo que en el caso anterior, pero cambiando las fechas
var imCol7 = S2.filterDate('2020-06-01','2020-11-01')
  .filterBounds(roi);

// Unir las dos colecciones de imágenes en una sola  
var imCol8 = imCol6.merge(imCol7);
</script>
</div>
<div id="ejecución-de-una-función-sobre-todas-las-imágenes-de-una-colección" class="section level3 unnumbered">
<h3 class="unnumbered">Ejecución de una función sobre todas las imágenes de una colección</h3>
<p>Para realizar alguna operación sobre todas las imágenes de una <code>ee.ImageCollection</code> se utiliza el método <code>.map</code>. Esto va a aplicar el procedimiento o función que se defina en el interior de ella a cada imagen dentro de la colección. Por ejemplo, si quisiéramos agregar una banda con un índice de vegetación a todas las imágenes, se podría hacer de la siguiente manera:</p>
<p>Ejercicio 28.10</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Definir una función que calcule el ndvi de una imagen</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> ndviCalc <span class="op">=</span> <span class="kw">function</span>(image){</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Calcular el ndvi utilizando las bandas del NIR, B8 y R, B4</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> ndvi <span class="op">=</span> image<span class="op">.</span><span class="fu">normalizedDifference</span>([<span class="st">&#39;B8&#39;</span><span class="op">,</span><span class="st">&#39;B4&#39;</span>])<span class="op">;</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Regresar la imagen con la nueva banda de ndvi</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> image<span class="op">.</span><span class="fu">addBands</span>(ndvi)<span class="op">;</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a><span class="co">// Aplicar la función sobre todas las imágenes de una colección</span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> imCol9 <span class="op">=</span> imCol4<span class="op">.</span><span class="fu">map</span>(ndviCalc)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Definir una función que calcule el ndvi de una imagen
var ndviCalc = function(image){
  // Calcular el ndvi utilizando las bandas del NIR, B8 y R, B4
  var ndvi = image.normalizedDifference(['B8','B4']);
  // Regresar la imagen con la nueva banda de ndvi
  return image.addBands(ndvi);
};

// Aplicar la función sobre todas las imágenes de una colección
var imCol9 = imCol4.map(ndviCalc);
</script>
<div class="bluebox2">
<div class="awesomeblock">
<p>Nótese que el método <code>.map</code> es distinto de la función <code>Map</code> que permite agregar objetos a la pantalla de mapas. Recordar que Javascript es un lenguaje sensible a mayúsculas y minúsculas.</p>
</div>
</div>
<div class="bluebox2">
<div class="awesomeblock">
<p>GEE recomienda el uso de <code>.map</code> para realizar operaciones de tipo ciclo, en lugar de otras funciones de ciclo (por ejemplo, <code>for</code>).</p>
</div>
</div>
<div class="bluebox2">
<div class="awesomeblock">
<p>El método <code>.map</code> requiere del uso de funciones del lado del servidor, así que se recomienda evitar el uso de funciones del lado del cliente como <code>print</code>, <code>Map</code>, <code>Export</code> y <code>Chart</code>.</p>
</div>
</div>
</div>
<div id="reducción-de-una-colección-de-imágenes" class="section level3 unnumbered">
<h3 class="unnumbered">Reducción de una colección de imágenes</h3>
<p>Los reductores permiten crear un compuesto (una sola imagen), a partir de una colección de imágenes. Por ello, el resultado obtenido tras una redicción sobre una colección de imágenes (<code>ee.ImageCollection</code>) será una imagen (<code>ee.Image</code>). Estos son muy útiles para hacer mosaicos multitemporales u obtener información de la colección de imágenes. Para reducir una colección de imágenes se utilizará el método <code>.reduce</code>, indicando la operación matemática a utilizar mediante un objeto tipo <code>ee.Reducer</code>. De tal manera, se puede indicar si el resultado corresponderá a la media <code>ee.Reducer.mean</code>, mediana, <code>ee.Reducer.median</code>, moda, <code>ee.Reducer.mode</code>, mínimo, <code>ee.Reducer.min</code>, máximo, <code>ee.Reducer.max</code> o inclusive la media de un intervalo determinado de observaciones, <code>ee.Reducer.intervalMean</code>. Otra forma de realizar estas mismas reducciones es utilizando directamente los métodos de <code>.min, .max, .mean, .mode, .median</code>. Las siguientes dos líneas realizan exactamente el mismo proceso:</p>
<p>Ejercicio 28.11</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Calcular el valor promedio de reflectancia para cada una de las bandas </span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="co">// de las imágenes que conforman la colección</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> imRedMean <span class="op">=</span> imCol9<span class="op">.</span><span class="fu">mean</span>()<span class="op">;</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="co">// Realizar lo mismo pero utilizando explícitamente la definición del </span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="co">// reductor</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> imRedMean2 <span class="op">=</span> imCol9<span class="op">.</span><span class="fu">reduce</span>(ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">mean</span>())<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Calcular el valor promedio de reflectancia para cada una de las bandas 
// de las imágenes que conforman la colección
var imRedMean = imCol9.mean();

// Realizar lo mismo pero utilizando explícitamente la definición del 
// reductor
var imRedMean2 = imCol9.reduce(ee.Reducer.mean());
</script>
<div class="bluebox2">
<div class="awesomeblock">
<p>Al aplicar una reducción a una colección de imágenes mediante el método <code>.reduce</code>, el nombre de las bandas será el mismo que el de las bandas de cada imagen con un sufijo que indica la operación matemática utilizada para hacer la reducción. Por ejemplo, al utilizar <code>ee.Reducer.mean</code> sobre una colección de imágenes cuyas bandas se llaman ‘B1’ y ‘B2’, las bandas de la imagen producto de la reducción se llamarán ‘B1_mean’ y ‘B2_mean’.</p>
</div>
</div>
</div>
<div id="creación-de-compuestos-y-mosaicos" class="section level3 unnumbered">
<h3 class="unnumbered">Creación de compuestos y mosaicos</h3>
<p>Si se desean hacer mosaicos a partir de varias imágenes se puede realizar en GEE mediante dos métodos: <code>.mosaic</code> y <code>.qualityMosaic</code>. La principal diferencia entre estos dos procesos radica en que la primera simplemente pega las imágenes de acuerdo al orden que tienen en la colección (es decir, la última hasta arriba). Por el contrario, el método de <code>.qualityMosaic</code> permite priorizar el píxel que quedará en el mosaico final a partir del valor más alto de alguna banda. Esto puede ser útil para realizar, por ejemplo, un mosaico del píxel con mayor valor de NDVI. En el caso de <code>.qualityMosaic</code> hay que indicar la banda que se utilizará como la banda de calidad para crear el mosaico.</p>
<p>Ejercicio 28.12</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Crear un mosaico de las imágenes contenidas en una colección. </span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="co">// Generalmente en áreas de sobrelape se tomarán los valores de las </span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="co">// imágenes más recientes</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> imRedMosaic <span class="op">=</span> imCol9<span class="op">.</span><span class="fu">mosaic</span>()<span class="op">;</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="co">// Crear un mosaico utilizando como banda de calidad &#39;nd&#39; que en este caso</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="co">//corresponde al ndvi</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="co">// Este método permite obtener mosaicos, por ejemplo, del valor del píxel</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="co">//de mayor verdor o mayor valor de ndvi</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> imRedQualMosaic <span class="op">=</span> imCol9<span class="op">.</span><span class="fu">qualityMosaic</span>(<span class="st">&#39;nd&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Crear un mosaico de las imágenes contenidas en una colección. 
// Generalmente en áreas de sobrelape se tomarán los valores de las 
// imágenes más recientes
var imRedMosaic = imCol9.mosaic();

// Crear un mosaico utilizando como banda de calidad 'nd' que en este caso
//corresponde al ndvi
// Este método permite obtener mosaicos, por ejemplo, del valor del píxel
//de mayor verdor o mayor valor de ndvi
var imRedQualMosaic = imCol9.qualityMosaic('nd');
</script>
<div id="ejercicio-filtro-de-colección-de-imágenes-y-visualización-ejercicio-b" class="section level4 unnumbered">
<h4 class="unnumbered">Ejercicio: Filtro de colección de imágenes y visualización (Ejercicio B)</h4>
<p>Este ejercicio integra elementos de los ejercicios 28.4 28.5 28.6 y 28.7, de modo que puedan remitirse a estos ejercicios si necesitan mayor aclaración</p>
<p>Para filtrar la colección de reflectancia de la superficie de imágenes de Landsat 8 de mayor calidad (“tier 1”) por fecha, porcentaje de cobertura de nubes de las imágenes, así como por su “path” y “row” se puede realizar en un solo paso aplicando múltiples filtros. En este caso, primero se indica la ruta de la colección que se desea utilizar. Para encontrar esta ruta se puede buscar la colección de interés en la barra de búsqueda (<code>Search</code>), después se le da clic y del lado izquierdo aparecerá la ruta de la colección. Por otro lado, en esta misma ventana, en la pestaña de <strong>BANDS</strong> se puede consultar las bandas y los nombres de las bandas que contiene cada imagen. Por su parte, en la pestaña de <strong>IMAGE PROPERTIES</strong> se pueden consultar los metadatos que contienen las imágenes de esta colección (Fig. 10.1).</p>
<div class="figure" style="text-align: center">
<img src="Img/Ruta_coleccion.png" alt="Consulta de propiedades de las imágenes contenidas en una colección de imágenes." width="100%" />
<p class="caption">
(#fig:unnamed-chunk-155)Consulta de propiedades de las imágenes contenidas en una colección de imágenes.
</p>
</div>
<p>Una vez que se conoce la ruta de la colección de interés, se llama dicha colección y se especifican los filtros. En este caso, primero se filtra por fecha, en formato YYYY-MM-DD (año, mes, día), seguido de filtros de los metadatos de las imágenes:</p>
<ul>
<li>‘CLOUD_COVER_LAND’,</li>
<li>‘WRS_PATH’,</li>
<li>‘WRS_ROW’.</li>
</ul>
<p>Para realizar este filtro se deben escribir exactamente igual el nombre de las propiedades (por ejemeplo, CLOUD_COVER_LAND) y en la definición del filtro se debe explicitar si se desea utilizar los valores que sean iguales (<code>eq</code>), distintos (<code>neq</code>), mayores (<code>gt</code>), menores (<code>lt</code>), mayores o igual (<code>gte</code>) o menores o iguales(<code>lte</code>).</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Filtrado de la colección</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> L8imgCol <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&quot;LANDSAT/LC08/C01/T1_SR&quot;</span>)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filterDate</span>(<span class="st">&#39;2015-01-01&#39;</span><span class="op">,</span><span class="st">&#39;2016-01-01&#39;</span>)</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">lte</span>(<span class="st">&#39;CLOUD_COVER_LAND&#39;</span><span class="op">,</span><span class="dv">50</span>))</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">eq</span>(<span class="st">&#39;WRS_PATH&#39;</span><span class="op">,</span><span class="dv">28</span>))</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">eq</span>(<span class="st">&#39;WRS_ROW&#39;</span><span class="op">,</span><span class="dv">46</span>))<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Filtrado de la colección
var L8imgCol = ee.ImageCollection("LANDSAT/LC08/C01/T1_SR")
  .filterDate('2015-01-01','2016-01-01')
  .filter(ee.Filter.lte('CLOUD_COVER_LAND',50))
  .filter(ee.Filter.eq('WRS_PATH',28))
  .filter(ee.Filter.eq('WRS_ROW',46));
</script>
<p>Para explorar algunas características de la colección de imágenes filtradas podemos escribir el siguiente comando para ver sus características en la consola.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(L8imgCol)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
print(L8imgCol);
</script>
<p>Una vez pasado el comando anterior, en la consola se puede consultar cuántas imágenes cumplieron con los filtros indicados. En este ejemplo, la colección filtrada incluye 17 imágenes. Después, se pueden consultar las características de las imágenes. Para ello, en la consola se le da:</p>
<ul>
<li>Un clic a la colección en la consola .</li>
<li>Luego un clic a features.</li>
<li>Después un clic a cualquier imagen (<code>Image</code>) .</li>
<li>Por último a Properties. Ahí se pueden ver los metadatos de cada imagen y por lo tanto, los campos de información que se pueden utilizar para filtrar una colección de imágenes, basado en los metadatos de las imágenes. Esta información es la misma que se puede obtener en la barra de búsqueda (Fig. 10.2).</li>
</ul>
<div class="figure" style="text-align: center">
<img src="Img/CamposImgCol.png" alt="Ejemplo de una consulta de información de la colección de imágenes en la consola." width="100%" />
<p class="caption">
(#fig:unnamed-chunk-158)Ejemplo de una consulta de información de la colección de imágenes en la consola.
</p>
</div>
<p>A continuación se ordena la colección de manera ascendente de acuerdo a la propiedad de ‘CLOUD_COVER_LAND’. Se selecciona la primera imagen, es decir, la de menor cobertura de nubes. Nótese que en este paso al definir la variable <code>L8imgFirst</code>, ya únicamente seleccionamos una sola imagen, por lo tanto, éste va a ser un objeto <code>ee.Image</code>.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Ordenar imágenes y obtener la primera</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>L8imgCol <span class="op">=</span> L8imgCol<span class="op">.</span><span class="fu">sort</span>(<span class="st">&#39;CLOUD_COVER_LAND&#39;</span>)<span class="op">;</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> L8imgFirst <span class="op">=</span> L8imgCol<span class="op">.</span><span class="fu">first</span>()<span class="op">;</span> </span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(L8imgFirst)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Ordenar imágenes y obtener la primera
L8imgCol = L8imgCol.sort('CLOUD_COVER_LAND');
var L8imgFirst = L8imgCol.first(); 
print(L8imgFirst);
</script>
<p>Además, se puede agregar esta imagen a la ventana de mapas para visualizar su información (Fig. 10.3). Esto se puede realizar de dos maneras. En el primer caso, se agrega la información sin pasar más argumentos. En el segundo caso, se indican las bandas y el orden que se desea cargar, así como los valores mínimos y máximos del histograma y un nombre para la capa.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Agregar a la pantalla de mapa</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(L8imgFirst)<span class="op">;</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(L8imgFirst<span class="op">,</span>{<span class="dt">bands</span><span class="op">:</span> [<span class="st">&#39;B4&#39;</span><span class="op">,</span><span class="st">&#39;B3&#39;</span><span class="op">,</span><span class="st">&#39;B2&#39;</span>]<span class="op">,</span> <span class="dt">min</span><span class="op">:</span> <span class="dv">95</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">1288</span>}<span class="op">,</span> </span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;RGB menos nubes L8&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Agregar a la pantalla de mapa
Map.addLayer(L8imgFirst);
Map.addLayer(L8imgFirst,{bands: ['B4','B3','B2'], min: 95, max: 1288}, 
  'RGB menos nubes L8');
</script>
<div class="figure" style="text-align: center">
<img src="Img/RGBIm.png" alt="Visualización de la primera imagen de la colección de imágenes." width="100%" />
<p class="caption">
(#fig:unnamed-chunk-161)Visualización de la primera imagen de la colección de imágenes.
</p>
</div>
</div>
<div id="ejercicio-enmascaramiento-de-nubes-cálculo-de-índices-y-reducción-ejercicio-c" class="section level4 unnumbered">
<h4 class="unnumbered">Ejercicio: Enmascaramiento de nubes, cálculo de índices y reducción (Ejercicio C)</h4>
<p>Este ejercicio integra elementos de los ejercicios 28.8 28.9 de modo que puedan remitirse a estos ejercicios si necesitan mayor aclaración</p>
<p>Utilizando la colección que ya se filtró en el ejercicio anterior se hará un mapeo y una reducción. En este ejercicio se obtendrá el ndvi promedio entre 2015 y 2016.</p>
<p>Para calcular el ndvi promedio lo primero que hay que hacer es aplicar la máscara de nubes que viene en la misma colección de imágenes de Landsat 8. Al aplicar esta máscara se eliminarán los píxeles cuya información provenga de nubes o sombras. Después, se definirá una función para calcular el ndvi de cada imagen contenida en la colección de imágenes. Para ello se utiliza el método <code>.normalizedDifference</code>, indicando las bandas del infrarrojo cercano (NIR) y rojo (R). También, se utilizará el método <code>.rename</code> para cambiar el nombre dado por defecto a la nueva banda calculada. Posteriormente, se agrega esta banda a la imagen con el método <code>.addBands</code> y se utiliza el método <code>.map</code> para aplicarla a cada una de las imágenes.</p>
<p>En este procedimiento, primero se define la función para enmascarar las nubes. Para ello, se indican los bits que corresponden a nubes y a sombras, es decir, los bits 5 y 3 respectivamente. Después se selecciona la banda que contiene la información de la máscara de nubes, la cual en Landsat 8 se llama ‘pixel_qa’. Se selecciona esta banda y se evalúa que en los dos bits antes mencionados el valor sea igual a cero, es decir, que sea un píxel clasificado como despejado. En este procedimiento se indica que la consulta de los valores se debe hacer por bits (<code>.bitwiseAnd</code>) y que las dos evaluaciones deben de ser cero (<code>.and</code>). Posteriormente, se define una máscara en función de esos valores y se actualiza la máscara (<code>.updateMask</code>).</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Crear función para enmascarar nubes</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">maskL8sr</span>(image) {</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> cloudShadowBitMask <span class="op">=</span> (<span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="dv">3</span>)<span class="op">;</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> cloudsBitMask <span class="op">=</span> (<span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="dv">5</span>)<span class="op">;</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> qa <span class="op">=</span> image<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;pixel_qa&#39;</span>)<span class="op">;</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> mask <span class="op">=</span> qa<span class="op">.</span><span class="fu">bitwiseAnd</span>(cloudShadowBitMask)<span class="op">.</span><span class="fu">eq</span>(<span class="dv">0</span>)</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>                 <span class="op">.</span><span class="fu">and</span>(qa<span class="op">.</span><span class="fu">bitwiseAnd</span>(cloudsBitMask)<span class="op">.</span><span class="fu">eq</span>(<span class="dv">0</span>))<span class="op">;</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> image<span class="op">.</span><span class="fu">updateMask</span>(mask)<span class="op">;</span></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<script type="text/javascript">
// Crear función para enmascarar nubes
function maskL8sr(image) {
  var cloudShadowBitMask = (1 << 3);
  var cloudsBitMask = (1 << 5);
  var qa = image.select('pixel_qa');
  var mask = qa.bitwiseAnd(cloudShadowBitMask).eq(0)
                 .and(qa.bitwiseAnd(cloudsBitMask).eq(0));
  return image.updateMask(mask);
}
</script>
<p>Se define la función para calcular el NDVI de todas las imágenes.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Crear función para calcular NDVI</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> ndviCalc <span class="op">=</span> <span class="kw">function</span>(image){</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> ndvi <span class="op">=</span> image<span class="op">.</span><span class="fu">normalizedDifference</span>([<span class="st">&#39;B5&#39;</span><span class="op">,</span><span class="st">&#39;B4&#39;</span>])<span class="op">;</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  ndvi <span class="op">=</span> ndvi<span class="op">.</span><span class="fu">rename</span>(<span class="st">&#39;ndvi&#39;</span>)<span class="op">;</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> image<span class="op">.</span><span class="fu">addBands</span>(ndvi)<span class="op">;</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Crear función para calcular NDVI
var ndviCalc = function(image){
  var ndvi = image.normalizedDifference(['B5','B4']);
  ndvi = ndvi.rename('ndvi');
    return image.addBands(ndvi);
};
</script>
<p>Para ver una muestra de cómo se ve la primer imagen con y sin la máscara de nubes, primero se agregará la imagen con nubes a la pantalla de mapa (Fig. 10.4).</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Agregar la primera imagen a la pantalla de mapa</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(L8imgCol<span class="op">.</span><span class="fu">first</span>()<span class="op">,</span> </span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">bands</span><span class="op">:</span>[<span class="st">&#39;B4&#39;</span><span class="op">,</span><span class="st">&#39;B3&#39;</span><span class="op">,</span><span class="st">&#39;B2&#39;</span>]<span class="op">,</span> <span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">1300</span>}<span class="op">,</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;Imagen con nubes&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Agregar la primera imagen a la pantalla de mapa
Map.addLayer(L8imgCol.first(), 
  {bands:['B4','B3','B2'], min: 0, max: 1300},
  'Imagen con nubes');
</script>
<div class="figure" style="text-align: center">
<img src="Img/imNubes.png" alt="Ejemplo de una imagen con nubes." width="100%" />
<p class="caption">
(#fig:unnamed-chunk-165)Ejemplo de una imagen con nubes.
</p>
</div>
<p>A continuación se aplican las dos funciones utilizando <code>.map</code> y sobreescribir el objeto L8imgCol.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Aplicar las dos funciones a la colección</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>L8imgCol <span class="op">=</span> L8imgCol</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>(maskL8sr)</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>(ndviCalc)<span class="op">;</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(L8imgCol)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Aplicar las dos funciones a la colección
L8imgCol = L8imgCol
  .map(maskL8sr)
  .map(ndviCalc);
print(L8imgCol);
</script>
<p>Se muestra la primera imagen sin nubes (Fig. 10.5).</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Visualizar la primera imagen</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(L8imgCol<span class="op">.</span><span class="fu">first</span>()<span class="op">,</span> </span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">bands</span><span class="op">:</span>[<span class="st">&#39;B4&#39;</span><span class="op">,</span><span class="st">&#39;B3&#39;</span><span class="op">,</span><span class="st">&#39;B2&#39;</span>]<span class="op">,</span> <span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">1300</span>}<span class="op">,</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;Imagen sin nubes&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Visualizar la primera imagen
Map.addLayer(L8imgCol.first(), 
  {bands:['B4','B3','B2'], min: 0, max: 1300},
  'Imagen sin nubes');
</script>
<div class="figure" style="text-align: center">
<img src="Img/imSinNubes.png" alt="Ejemplo de una imagen donde se enmascararon las nubes." width="100%" />
<p class="caption">
(#fig:unnamed-chunk-168)Ejemplo de una imagen donde se enmascararon las nubes.
</p>
</div>
<p>En la consola se puede observar que todas las imágenes ahora contienen una nueva banda llamada ‘ndvi’ (Fig. 10.6).</p>
<div class="figure" style="text-align: center">
<img src="Img/imConNDVI.png" alt="Consulta de información en la consola para verificar que la colección de imágenes contiene la banda NDVI." width="100%" />
<p class="caption">
(#fig:unnamed-chunk-169)Consulta de información en la consola para verificar que la colección de imágenes contiene la banda NDVI.
</p>
</div>
<p>Posteriormente, se reduce la colección de imágenes para formar una sola imagen que represente el valor promedio de NDVI en el periodo de la colección (2015 - 2016). Para ello se utiliza el método <code>.reduce</code>. También se calculará la desviación estándar de los valores de NDVI. Estas dos imágenes se guardarán en dos nuevos objetos.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Seleccionar la banda ndvi y hacer dos reducciones</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>L8imgCol <span class="op">=</span> L8imgCol<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;ndvi&#39;</span>)<span class="op">;</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> L8imgMean <span class="op">=</span> L8imgCol<span class="op">.</span><span class="fu">reduce</span>(ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">mean</span>())<span class="op">;</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> L8imgSD <span class="op">=</span> L8imgCol<span class="op">.</span><span class="fu">reduce</span>(ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">stdDev</span>())<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Seleccionar la banda ndvi y hacer dos reducciones
L8imgCol = L8imgCol.select('ndvi');
var L8imgMean = L8imgCol.reduce(ee.Reducer.mean());
var L8imgSD = L8imgCol.reduce(ee.Reducer.stdDev());
</script>
<p>A continuación, agregamos los dos resultados a la pantalla de mapas (Fig. 10.7).</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Visualizar las imágenes</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(L8imgMean<span class="op">,</span> {<span class="dt">min</span><span class="op">:-</span><span class="fl">0.14</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span><span class="fl">0.15</span>}<span class="op">,</span> <span class="st">&#39;NDVI mean 2015 - 2016&#39;</span>)<span class="op">;</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(L8imgSD<span class="op">,</span> {<span class="dt">min</span><span class="op">:</span><span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span><span class="fl">0.13</span>}<span class="op">,</span> <span class="st">&#39;NDVI SD 2015 - 2016&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Visualizar las imágenes
Map.addLayer(L8imgMean, {min:-0.14, max:0.15}, 'NDVI mean 2015 - 2016');
Map.addLayer(L8imgSD, {min:0, max:0.13}, 'NDVI SD 2015 - 2016');
</script>
<p>El resultado se ve así (Fig. 10.8):</p>
<div class="figure" style="text-align: center">
<img src="Img/imNDVI.png" alt="Visualización de la imagen de NDVI promedio." width="100%" />
<p class="caption">
(#fig:unnamed-chunk-172)Visualización de la imagen de NDVI promedio.
</p>
</div>
<p>Además, se puede conocer el número de observaciones sin enmascarar por píxel utilizando el método <code>count</code>. Debido a que ya se enmascararon las nubes en todas las imágenes de la colección, esta imagen contendrá el número de observaciones sin nube por píxel. Esta información nos permite conocer a partir de cuántas observaciones por píxel se calcularon las imágenes anteriores, es decir, las imágenes con del promedio y desviación estándar de NDVI.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Obtener la imagen del número de observaciones por píxel sin enmascarar </span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> numObsPixel <span class="op">=</span> L8imgCol<span class="op">.</span><span class="fu">count</span>()<span class="op">;</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(numObsPixel<span class="op">,</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>  {<span class="dt">min</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">17</span>}<span class="op">,</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;Número de observaciones sin enmascarar por píxel&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Obtener la imagen del número de observaciones por píxel sin enmascarar 
var numObsPixel = L8imgCol.count();

Map.addLayer(numObsPixel,
  {min: 1, max: 17},
  'Número de observaciones sin enmascarar por píxel');
</script>
<p>La imagen con el número de observaciones por píxel sin enmascarar se ve así (Fig. 10.9):</p>
<div class="figure" style="text-align: center">
<img src="Img/ImCount.png" alt="Visualización de la imagen con el número de observaciones sin enmascarar por píxel." width="100%" />
<p class="caption">
(#fig:unnamed-chunk-174)Visualización de la imagen con el número de observaciones sin enmascarar por píxel.
</p>
</div>
<div class="bluebox2">
<div class="awesomeblock">
<p>Se pueden prender y apagar las capas de la pantalla de mapas utilizando el menú que se despliega al posicionar el puntero sobre el letrero de layers y prendiendo y apagando las capas con las palomitas a la izquierda de cada capa.</p>
</div>
</div>
<p>El último paso será cortar la imagen a una extensión de interés. En este caso primero se define un área de interés mediante coordenadas:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Cargar el polígono del área de interés</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> geometry <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Polygon</span>(</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>        [[[<span class="op">-</span><span class="fl">101.82737418916153</span><span class="op">,</span> <span class="fl">19.836437094032178</span>]<span class="op">,</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>          [<span class="op">-</span><span class="fl">101.82737418916153</span><span class="op">,</span> <span class="fl">19.368119068204525</span>]<span class="op">,</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>          [<span class="op">-</span><span class="fl">101.15171500947403</span><span class="op">,</span> <span class="fl">19.368119068204525</span>]<span class="op">,</span></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>          [<span class="op">-</span><span class="fl">101.15171500947403</span><span class="op">,</span> <span class="fl">19.836437094032178</span>]]]<span class="op">,</span> <span class="kw">null</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Cargar el polígono del área de interés
var geometry = ee.Geometry.Polygon(
        [[[-101.82737418916153, 19.836437094032178],
          [-101.82737418916153, 19.368119068204525],
          [-101.15171500947403, 19.368119068204525],
          [-101.15171500947403, 19.836437094032178]]], null, false);
</script>
<p>Para después cortar las dos imágenes y mostrarlas en la pantalla de mapas.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Cortar la imágenes</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>L8imgMean <span class="op">=</span> L8imgMean<span class="op">.</span><span class="fu">clip</span>(geometry)<span class="op">;</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>L8imgSD <span class="op">=</span> L8imgSD<span class="op">.</span><span class="fu">clip</span>(geometry)<span class="op">;</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="co">// Visualizarlas</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(L8imgMean<span class="op">,</span> {<span class="dt">min</span><span class="op">:</span><span class="fl">0.2</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span><span class="fl">0.8</span>}<span class="op">,</span> <span class="st">&#39;NDVI mean 2015 - 2016 clip&#39;</span>)<span class="op">;</span></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(L8imgSD<span class="op">,</span> {<span class="dt">min</span><span class="op">:</span><span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span><span class="fl">0.3</span>}<span class="op">,</span> <span class="st">&#39;NDVI SD 2015 - 2016 clip&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Cortar la imágenes
L8imgMean = L8imgMean.clip(geometry);
L8imgSD = L8imgSD.clip(geometry);

// Visualizarlas
Map.addLayer(L8imgMean, {min:0.2, max:0.8}, 'NDVI mean 2015 - 2016 clip');
Map.addLayer(L8imgSD, {min:0, max:0.3}, 'NDVI SD 2015 - 2016 clip');
</script>
</div>
<div id="ejercicio-cáculo-de-diferencia-de-dos-imágenes-y-exportación-de-resultado.ejercicio-d" class="section level4 unnumbered">
<h4 class="unnumbered">Ejercicio: Cáculo de diferencia de dos imágenes y exportación de resultado.(Ejercicio D)</h4>
<p>Se utilizarán las funciones previamente definidas para generar un mosaico igual al ya generado, pero ahora con fechas de 2016-01-01 al 2017-01-01. Primero se filtra la colección de imágenes y se mapean las funciones para enmascarar las nubes y agregar el NDVI a las imágenes.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Filtrado en tiempo 2</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> L8imgColT2 <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&quot;LANDSAT/LC08/C01/T1_SR&quot;</span>)</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filterDate</span>(<span class="st">&#39;2016-01-01&#39;</span><span class="op">,</span><span class="st">&#39;2017-01-01&#39;</span>)</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">lte</span>(<span class="st">&#39;CLOUD_COVER_LAND&#39;</span><span class="op">,</span><span class="dv">50</span>))</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">eq</span>(<span class="st">&#39;WRS_PATH&#39;</span><span class="op">,</span><span class="dv">28</span>))</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">eq</span>(<span class="st">&#39;WRS_ROW&#39;</span><span class="op">,</span><span class="dv">46</span>))<span class="op">;</span></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>L8imgColT2 <span class="op">=</span> L8imgColT2</span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>(maskL8sr)</span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>(ndviCalc)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Filtrado en tiempo 2
var L8imgColT2 = ee.ImageCollection("LANDSAT/LC08/C01/T1_SR")
  .filterDate('2016-01-01','2017-01-01')
  .filter(ee.Filter.lte('CLOUD_COVER_LAND',50))
  .filter(ee.Filter.eq('WRS_PATH',28))
  .filter(ee.Filter.eq('WRS_ROW',46));

L8imgColT2 = L8imgColT2
  .map(maskL8sr)
  .map(ndviCalc);
</script>
<p>Después, se seleccionan únicamente las bandas de NDVI y se reduce la colección de imágenes para generar una imagen del valor promedio de NDVI. Posteriormente, se recorta la imagen a la extensión del polígono del área de interés. A esta imagen se le restarán los valores de la imagen del 2015-01-01 al 2016-01-01. De esta manera, los valores más negativos representarán valores más bajos de NDVI en el año 2 respecto al año 1.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Seleccionar NDVI y reducción</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>L8imgColT2 <span class="op">=</span> L8imgColT2<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;ndvi&#39;</span>)<span class="op">;</span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> L8imgMeanT2 <span class="op">=</span> L8imgColT2<span class="op">.</span><span class="fu">reduce</span>(ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">mean</span>())<span class="op">;</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="co">// Cortar imagen a área de interés</span></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>L8imgMeanT2 <span class="op">=</span> L8imgMeanT2<span class="op">.</span><span class="fu">clip</span>(geometry)<span class="op">;</span></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a><span class="co">// Restar media T1 a T2</span></span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> imgDiff <span class="op">=</span> L8imgMeanT2<span class="op">.</span><span class="fu">subtract</span>(L8imgMean)<span class="op">;</span>  </span></code></pre></div>
<script type="text/javascript">
// Seleccionar NDVI y reducción
L8imgColT2 = L8imgColT2.select('ndvi');
var L8imgMeanT2 = L8imgColT2.reduce(ee.Reducer.mean());

// Cortar imagen a área de interés
L8imgMeanT2 = L8imgMeanT2.clip(geometry);

// Restar media T1 a T2
var imgDiff = L8imgMeanT2.subtract(L8imgMean);  
</script>
<p>Posteriormente se agrega el resultado a la pantalla de mapas (Fig. 10.10).</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Visualizar imagen resultante</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(imgDiff<span class="op">,</span>{<span class="dt">min</span><span class="op">:-</span><span class="fl">0.3</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span> </span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">palette</span><span class="op">:</span>[<span class="st">&#39;FF0000&#39;</span><span class="op">,</span> <span class="st">&#39;FFFF00&#39;</span><span class="op">,</span> <span class="st">&#39;008000&#39;</span>] }<span class="op">,</span> </span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;Diferencia NDVI 2015 vs 2016&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Visualizar imagen resultante
Map.addLayer(imgDiff,{min:-0.3, max: 0.1, 
  palette:['FF0000', 'FFFF00', '008000'] }, 
  'Diferencia NDVI 2015 vs 2016');
</script>
<div class="figure" style="text-align: center">
<img src="Img/imDifNDVI.png" alt="Imagen de diferencia de NDVI entre dos años." width="100%" />
<p class="caption">
(#fig:unnamed-chunk-180)Imagen de diferencia de NDVI entre dos años.
</p>
</div>
<p>Por último, para exportar el resultado se ingresan varios parámetros a la función que incluyen: la imagen a exportar, el nombre para guardar el archivo, la escala de la imagen (tamaño de píxel en metros), formato a utilizar y si se desea guardar dentro de una carpeta del Google Drive. Estos argumentos, al igual que otras funciones en GEE se pasan dentro de un diccionario.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Exportar imagen a Google Drive</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>Export<span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">toDrive</span>({</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">image</span><span class="op">:</span> imgDiff<span class="op">,</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">description</span><span class="op">:</span> <span class="st">&#39;DiferenciaNDVI_2016-2017&#39;</span><span class="op">,</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">maxPixels</span><span class="op">:</span> <span class="fl">1e12</span><span class="op">,</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">fileFormat</span><span class="op">:</span> <span class="st">&#39;GeoTIFF&#39;</span><span class="op">,</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">folder</span><span class="op">:</span> <span class="st">&#39;DiferenciaNDVIL8&#39;</span><span class="op">,</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">region</span><span class="op">:</span> roi<span class="op">,</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">crs</span><span class="op">:</span> <span class="st">&#39;EPSG:4326</span></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span> </span></code></pre></div>
<script type="text/javascript">
// Exportar imagen a Google Drive
Export.image.toDrive({
  image: imgDiff,
  description: 'DiferenciaNDVI_2016-2017',
  scale: 30,
  maxPixels: 1e12,
  fileFormat: 'GeoTIFF',
  folder: 'DiferenciaNDVIL8',
  region: roi,
  crs: 'EPSG:4326
}); 
</script>
<!--chapter:end:10-coleccionimagenes.Rmd-->
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
</div>
<div id="uso-conjunto-de-vectores-e-imágenes" class="section level1" number="11">
<h1 number="11"><span class="header-section-number">11</span> Uso conjunto de vectores e imágenes</h1>
<p>Además de los métodos que existen en GEE para realizar operaciones sobre imágenes, colecciones de imágenes, vectores o colecciones de vectores, existen algunos métodos que permiten combinar estos dos tipos de información para realizar ciertos procesos. Los dos tipos de procesos más comúnmente utilizados son el muestreo de una imagen por vectores o la reducción de una imagen por vectores.</p>
<div id="métodos-comunes-5" class="section level2" number="11.1">
<h2 number="11.1"><span class="header-section-number">11.1</span> Métodos comunes</h2>
<div id="muestreo-por-vectores" class="section level3 unnumbered">
<h3 class="unnumbered">Muestreo por vector(es)</h3>
<p>Este tipo de operaciones normalmente se utilizan para muestrear los datos de una imagen y obtener, por ejemplo, muestras por clases de coberturas para después entrenar un clasificador o para obtener los valores de un ráster en formato de vector (como puntos). En GEE, existen tres métodos para hacer este proceso, para un ráster completo, <code>.sample</code> o para un rectángulo <code>.sampleRectangle</code> o para varias regiones <code>.sampleRegions</code>. Por ejemplo, el método <code>.sample</code> toma como argumentos el vector utilizado para determinar el área de muestreo, así como la escala a la que se desea realizar el muestreo. En este ejemplo, primero se define una geometría y después se hace el muestreo.</p>
<p>Ejercicio 29</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Definir región a muestrear</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> bosque1 <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">101.53892</span><span class="op">,</span> <span class="fl">19.74148</span><span class="op">,</span> </span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">101.51906</span><span class="op">,</span><span class="fl">19.72362</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Definir región a muestrear
var bosque1 = ee.Geometry.Rectangle(-101.53892, 19.74148, 
  -101.51906,19.72362);
</script>
<div class="sourceCode" id="cb125"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Muestrear imagen</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> muestreo <span class="op">=</span> L8imgMean</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">sample</span>({</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">region</span><span class="op">:</span> bosque1<span class="op">,</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">scale</span><span class="op">:</span><span class="dv">30</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(muestreo<span class="op">,</span> <span class="st">&#39;muestreo&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Muestrear imagen
var muestreo = L8imgMean
  .sample({
    region: bosque1,
    scale:30
  });

print(muestreo, 'muestreo');
</script>
<div class="bluebox2">
<div class="awesomeblock">
<p>Si se desea obtener la información de un muestreo de una imagen con su correspondiente información espacial, se puede utilizar el argumento <code>geometries: true</code>. Esto dará como resultado una tabla con la misma información, pero con las coordenadas geográficas de los centros de los píxeles de la imagen muestreada.</p>
</div>
</div>
</div>
<div id="reducción-de-una-imagen-por-regiónes" class="section level3 unnumbered">
<h3 class="unnumbered">Reducción de una imagen por región(es)</h3>
<p>Este tipo de operaciones normalmente se utilizan para resumir los valores de algún ráster por áreas de interés. En GEE, existen dos métodos para realizar este proceso, para una única región <code>.reduceRegion</code> o para varias regiones <code>.reduceRegions</code>. Por ejemplo, el método <code>.reduceRegion</code> permite obtener estadísticas de la imagen en la extensión indicada por un área de interés (geometry). En este caso, además hay que indicar el reducer (reductor) y el tamaño de píxel para realizar la operación (scale).</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Reducción por región</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> reduccion <span class="op">=</span> ee<span class="op">.</span><span class="fu">Image</span>(L8imgMean)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">reduceRegion</span>({</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Reductor a utilizar</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">mean</span>()<span class="op">,</span></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Definir el área de interés a resumir</span></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">geometry</span><span class="op">:</span> bosque1<span class="op">,</span></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Tamaño de píxel</span></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">scale</span><span class="op">:</span> <span class="dv">30</span></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(reduccion<span class="op">,</span> <span class="st">&#39;reduccion&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Reducción por región
var reduccion = ee.Image(L8imgMean)
  .reduceRegion({
    // Reductor a utilizar
    reducer: ee.Reducer.mean(),
    // Definir el área de interés a resumir
    geometry: bosque1,
    // Tamaño de píxel
    scale: 30
  });
  
print(reduccion, 'reduccion');
</script>
<div class="bluebox2">
<div class="awesomeblock">
<p>En algunas ocasiones, los procesos de <code>.reduceRegions</code> o <code>.sampleRegions</code> pueden demandar muchos recursos computacionales y arrojar un error de ‘computation timed out’. En estos casos, se pueden utilizar los argumentos de <code>scale</code> o <code>tileScale</code> para lograr que este corra. <code>Scale</code> permite aumentar el tamaño de píxel al que se va a resumir la información, por lo cual permite reducir los costos computacionales. De igual manera, <code>tileScale</code> permite definir un factor de escalamiento que permite reducir la carga computacional de un proceso.</p>
</div>
</div>
</div>
</div>
<div id="interpolación-de-vector-a-imagen" class="section level2" number="11.2">
<h2 number="11.2"><span class="header-section-number">11.2</span> Interpolación de vector a Imagen</h2>
<p>Este procedimiento consiste en tomar los datos numéricos de un vector e interpolarlos a áreas fuera de los vectores. Lo cual resulta en una imagen con el valor numérico interpolado del vector.</p>
<div id="ponderación-de-distancia-inversa" class="section level3 unnumbered">
<h3 class="unnumbered">Ponderación de distancia inversa</h3>
<p>Este método interpola al píxel de interés un valor según cada uno de los puntos más cercanos y los pondera según su distancia, generando un promedio de esos valores. Esto provoca que los píxeles más cercanos tendrán más influencia en el resultado de la interpolación que los píxeles alejados. Este método es descrito por Basso (et al. 1999). Esta interpolación se realiza con el método <code>.inverseDistance</code> donde hay que especificar al menos:</p>
<ul>
<li>El radio a interpolar alrededor de cada vector.</li>
<li>El atributo (la propiedad) numérica del vector, que se interpolará.</li>
<li>El promedio global de la variable.</li>
<li>La desviación estándar global de la variable.</li>
</ul>
<p>El siguiente ejercicio tiene como objetivo interpolar valores de CH4 para el norte de México.
La imagen Sentinel que se utilizara, no tiene los valores de CH4 completos, muchos de los pixeles se encuentran sin valores o enmascarados, es por ello que queremos interpolar la imagen, para poder tener valores continuos en toda el área de estudio
Para ello se generarán 10000 muestras (puntos), que consisten en el valor de CH4 de 10000 píxeles aleatorios dentro del norte de México, de una imagen satelital Sentinel.
Con la ayuda de unos reductores extraemos el promedio y la desviación estándar de todas las muestras (puntos)
y finalmente interpolamos las muestras en buffers de 70 km, usando como argumento el promedio y la desviación estándar.</p>
<p>Ejercicio 30</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Importamos datos de metano de 5 días, los filtramos y sacamos el </span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="co">// promedio.</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> ch4 <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&#39;COPERNICUS/S5P/OFFL/L3_CH4&#39;</span>)</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;CH4_column_volume_mixing_ratio_dry_air&#39;</span>)</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filterDate</span>(<span class="st">&#39;2020-01-01&#39;</span><span class="op">,</span> <span class="st">&#39;2020-01-05&#39;</span>)</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">mean</span>()</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">rename</span>(<span class="st">&#39;ch4&#39;</span>)<span class="op">;</span></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a><span class="co">// Definimos un rectangulo de area de estudio al norte de México.</span></span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> norteMex <span class="op">=</span></span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">117.33</span><span class="op">,</span> <span class="fl">32.753</span><span class="op">,</span> <span class="op">-</span><span class="fl">97.773</span><span class="op">,</span> <span class="fl">22.634</span>)<span class="op">;</span></span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a><span class="co">// Crear una colección de vectores para interpolar.</span></span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a><span class="co">// Se crean dos bandas adicionales para la imagen indicando la </span></span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a><span class="co">// longitud y latitud de cada píxel</span></span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> muestras <span class="op">=</span> ch4<span class="op">.</span><span class="fu">addBands</span>(ee<span class="op">.</span><span class="at">Image</span><span class="op">.</span><span class="fu">pixelLonLat</span>()) </span>
<span id="cb127-17"><a href="#cb127-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Se crean una colección </span></span>
<span id="cb127-18"><a href="#cb127-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">// de vectores (sin geometria) en la región norteMex y aproximadamente </span></span>
<span id="cb127-19"><a href="#cb127-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">// cuantos puntos generar</span></span>
<span id="cb127-20"><a href="#cb127-20" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">sample</span>({<span class="dt">region</span><span class="op">:</span> norteMex<span class="op">,</span> <span class="dt">numPixels</span><span class="op">:</span> <span class="dv">10000</span><span class="op">,</span> </span>
<span id="cb127-21"><a href="#cb127-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">// resolución de la imagen en metros por píxel</span></span>
<span id="cb127-22"><a href="#cb127-22" aria-hidden="true" tabindex="-1"></a>    <span class="dt">scale</span><span class="op">:</span><span class="dv">1000</span>}) </span>
<span id="cb127-23"><a href="#cb127-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Función para cada punto generado</span></span>
<span id="cb127-24"><a href="#cb127-24" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(sample) { </span>
<span id="cb127-25"><a href="#cb127-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Tomar el valor del punto de latitud</span></span>
<span id="cb127-26"><a href="#cb127-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> lat <span class="op">=</span> sample<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;latitude&#39;</span>)<span class="op">;</span> </span>
<span id="cb127-27"><a href="#cb127-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Tomar el valor del punto de Longitud</span></span>
<span id="cb127-28"><a href="#cb127-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> lon <span class="op">=</span> sample<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;longitude&#39;</span>)<span class="op">;</span> </span>
<span id="cb127-29"><a href="#cb127-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Tomar el valor del punto de metano</span></span>
<span id="cb127-30"><a href="#cb127-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> ch4 <span class="op">=</span> sample<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;ch4&#39;</span>)<span class="op">;</span> </span>
<span id="cb127-31"><a href="#cb127-31" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Crear una geometría para el vector asignandole el valor de metano</span></span>
<span id="cb127-32"><a href="#cb127-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ee<span class="op">.</span><span class="fu">Feature</span>(ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Point</span>([lon<span class="op">,</span> lat])<span class="op">,</span> {<span class="dt">ch4</span><span class="op">:</span> ch4})<span class="op">;</span></span>
<span id="cb127-33"><a href="#cb127-33" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb127-34"><a href="#cb127-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-35"><a href="#cb127-35" aria-hidden="true" tabindex="-1"></a><span class="co">// Combinar un reductor de promedio y desviación estándar</span></span>
<span id="cb127-36"><a href="#cb127-36" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> Reductores <span class="op">=</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">mean</span>()<span class="op">.</span><span class="fu">combine</span>({</span>
<span id="cb127-37"><a href="#cb127-37" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer2</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">stdDev</span>()<span class="op">,</span></span>
<span id="cb127-38"><a href="#cb127-38" aria-hidden="true" tabindex="-1"></a>  <span class="dt">sharedInputs</span><span class="op">:</span> <span class="kw">true</span>})<span class="op">;</span></span>
<span id="cb127-39"><a href="#cb127-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-40"><a href="#cb127-40" aria-hidden="true" tabindex="-1"></a><span class="co">// Estimar el promedio y la desviación estándar de metano de los puntos.</span></span>
<span id="cb127-41"><a href="#cb127-41" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> stats <span class="op">=</span> muestras<span class="op">.</span><span class="fu">reduceColumns</span>({</span>
<span id="cb127-42"><a href="#cb127-42" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> Reductores<span class="op">,</span></span>
<span id="cb127-43"><a href="#cb127-43" aria-hidden="true" tabindex="-1"></a>  <span class="dt">selectors</span><span class="op">:</span> [<span class="st">&#39;ch4&#39;</span>]})<span class="op">;</span></span>
<span id="cb127-44"><a href="#cb127-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-45"><a href="#cb127-45" aria-hidden="true" tabindex="-1"></a><span class="co">// Interpolar para 70 km.</span></span>
<span id="cb127-46"><a href="#cb127-46" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> interpolado <span class="op">=</span> muestras<span class="op">.</span><span class="fu">inverseDistance</span>({</span>
<span id="cb127-47"><a href="#cb127-47" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Rango de interpolación para cada punto</span></span>
<span id="cb127-48"><a href="#cb127-48" aria-hidden="true" tabindex="-1"></a>  <span class="dt">range</span><span class="op">:</span> <span class="dv">70000</span><span class="op">,</span> </span>
<span id="cb127-49"><a href="#cb127-49" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Atributo numerico a interpolar</span></span>
<span id="cb127-50"><a href="#cb127-50" aria-hidden="true" tabindex="-1"></a>  <span class="dt">propertyName</span><span class="op">:</span> <span class="st">&#39;ch4&#39;</span><span class="op">,</span> </span>
<span id="cb127-51"><a href="#cb127-51" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Promedio (parametro para el método)</span></span>
<span id="cb127-52"><a href="#cb127-52" aria-hidden="true" tabindex="-1"></a>  <span class="dt">mean</span><span class="op">:</span> stats<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;mean&#39;</span>)<span class="op">,</span> </span>
<span id="cb127-53"><a href="#cb127-53" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Desviación estándar (parámetro para la método)</span></span>
<span id="cb127-54"><a href="#cb127-54" aria-hidden="true" tabindex="-1"></a>  <span class="dt">stdDev</span><span class="op">:</span> stats<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;stdDev&#39;</span>)<span class="op">,</span> </span>
<span id="cb127-55"><a href="#cb127-55" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span> </span></code></pre></div>
<script type="text/javascript">
// Importamos datos de metano de 5 días, los filtramos y sacamos el 
// promedio.
var ch4 = ee.ImageCollection('COPERNICUS/S5P/OFFL/L3_CH4')
  .select('CH4_column_volume_mixing_ratio_dry_air')
  .filterDate('2020-01-01', '2020-01-05')
  .mean()
  .rename('ch4');

// Definimos un rectangulo de area de estudio al norte de México.
var norteMex =
  ee.Geometry.Rectangle(-117.33, 32.753, -97.773, 22.634);

// Crear una colección de vectores para interpolar.
// Se crean dos bandas adicionales para la imagen indicando la 
// longitud y latitud de cada píxel
var muestras = ch4.addBands(ee.Image.pixelLonLat()) 
  // Se crean una colección 
  // de vectores (sin geometria) en la región norteMex y aproximadamente 
  // cuantos puntos generar
  .sample({region: norteMex, numPixels: 10000, 
    // resolución de la imagen en metros por píxel
    scale:1000}) 
  // Función para cada punto generado
  .map(function(sample) { 
    // Tomar el valor del punto de latitud
    var lat = sample.get('latitude'); 
    // Tomar el valor del punto de Longitud
    var lon = sample.get('longitude'); 
    // Tomar el valor del punto de metano
    var ch4 = sample.get('ch4'); 
    // Crear una geometría para el vector asignandole el valor de metano
    return ee.Feature(ee.Geometry.Point([lon, lat]), {ch4: ch4});
  });

// Combinar un reductor de promedio y desviación estándar
var Reductores = ee.Reducer.mean().combine({
  reducer2: ee.Reducer.stdDev(),
  sharedInputs: true});

// Estimar el promedio y la desviación estándar de metano de los puntos.
var stats = muestras.reduceColumns({
  reducer: Reductores,
  selectors: ['ch4']});

// Interpolar para 70 km.
var interpolado = muestras.inverseDistance({
  // Rango de interpolación para cada punto
  range: 70000, 
  // Atributo numerico a interpolar
  propertyName: 'ch4', 
  // Promedio (parametro para el método)
  mean: stats.get('mean'), 
  // Desviación estándar (parámetro para la método)
  stdDev: stats.get('stdDev'), 
  }); 
</script>
</div>
<div id="kriging" class="section level3 unnumbered">
<h3 class="unnumbered">Kriging</h3>
<p>Es un método de interpolación que utiliza un estimado de la semivarianza, para crear una imagen de valores interpolados que sea una combinación óptima de los datos conocidos. En este método hay que especificar algunos parámetros que describen la forma de la función de semivarianza ajustada a los datos conocidos. Algunos de estos parámetros incluyen el intervalo de la varianza (range), la meseta (sill), el valor del efecto pepita (nugget), la distancia máxima a analizar (maxDistance) y la función a utilizar como reductor (reducer).</p>
<p>Ejercicio 31</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Importar una imagen de temperatura marina superficial</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> temperatura <span class="op">=</span> ee<span class="op">.</span><span class="fu">Image</span>(<span class="st">&#39;NOAA/AVHRR_Pathfinder_V52_L3/20120802025048&#39;</span>)</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;sea_surface_temperature&#39;</span>)</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">rename</span>(<span class="st">&#39;temperatura&#39;</span>)</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">divide</span>(<span class="dv">100</span>)<span class="op">;</span></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a><span class="co">// Definir una geometría donde muestrear puntos</span></span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> geometria <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>([<span class="op">-</span><span class="fl">65.60</span><span class="op">,</span> <span class="fl">31.75</span><span class="op">,</span> <span class="op">-</span><span class="fl">52.18</span><span class="op">,</span> <span class="fl">43.12</span>])<span class="op">;</span></span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a><span class="co">// Muestrear las temperaturas en 1000 localizaciones aleatorias.</span></span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> muestras <span class="op">=</span> temperatura<span class="op">.</span><span class="fu">addBands</span>(ee<span class="op">.</span><span class="at">Image</span><span class="op">.</span><span class="fu">pixelLonLat</span>())</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">sample</span>({<span class="dt">region</span><span class="op">:</span> geometria<span class="op">,</span> <span class="dt">numPixels</span><span class="op">:</span> <span class="dv">1000</span>})</span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(sample) {</span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> lat <span class="op">=</span> sample<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;latitude&#39;</span>)<span class="op">;</span></span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> lon <span class="op">=</span> sample<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;longitude&#39;</span>)<span class="op">;</span></span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> temperatura1 <span class="op">=</span> sample<span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;temperatura&#39;</span>)<span class="op">;</span></span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ee<span class="op">.</span><span class="fu">Feature</span>(ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Point</span>([lon<span class="op">,</span> lat])<span class="op">,</span> </span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">temperaturaMarina</span><span class="op">:</span> temperatura1})<span class="op">;</span></span>
<span id="cb128-19"><a href="#cb128-19" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb128-20"><a href="#cb128-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-21"><a href="#cb128-21" aria-hidden="true" tabindex="-1"></a><span class="co">// Interpolate SST from the sampled points.</span></span>
<span id="cb128-22"><a href="#cb128-22" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> interpolar <span class="op">=</span> muestras<span class="op">.</span><span class="fu">kriging</span>({</span>
<span id="cb128-23"><a href="#cb128-23" aria-hidden="true" tabindex="-1"></a>  <span class="dt">propertyName</span><span class="op">:</span> <span class="st">&#39;temperaturaMarina&#39;</span><span class="op">,</span></span>
<span id="cb128-24"><a href="#cb128-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Forma de la función de la varianza de los datos</span></span>
<span id="cb128-25"><a href="#cb128-25" aria-hidden="true" tabindex="-1"></a>  <span class="dt">shape</span><span class="op">:</span> <span class="st">&#39;exponential&#39;</span><span class="op">,</span> </span>
<span id="cb128-26"><a href="#cb128-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Rango de la varianza</span></span>
<span id="cb128-27"><a href="#cb128-27" aria-hidden="true" tabindex="-1"></a>  <span class="dt">range</span><span class="op">:</span> <span class="dv">100</span> <span class="op">*</span> <span class="dv">1000</span><span class="op">,</span> </span>
<span id="cb128-28"><a href="#cb128-28" aria-hidden="true" tabindex="-1"></a>  <span class="dt">sill</span><span class="op">:</span> <span class="fl">1.0</span><span class="op">,</span></span>
<span id="cb128-29"><a href="#cb128-29" aria-hidden="true" tabindex="-1"></a>  <span class="dt">nugget</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span></span>
<span id="cb128-30"><a href="#cb128-30" aria-hidden="true" tabindex="-1"></a>  <span class="dt">maxDistance</span><span class="op">:</span> <span class="dv">100</span> <span class="op">*</span> <span class="dv">1000</span><span class="op">,</span></span>
<span id="cb128-31"><a href="#cb128-31" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> <span class="st">&#39;mean&#39;</span><span class="op">,</span></span>
<span id="cb128-32"><a href="#cb128-32" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Importar una imagen de temperatura marina superficial
var temperatura = ee.Image('NOAA/AVHRR_Pathfinder_V52_L3/20120802025048')
  .select('sea_surface_temperature')
  .rename('temperatura')
  .divide(100);

// Definir una geometría donde muestrear puntos
var geometria = ee.Geometry.Rectangle([-65.60, 31.75, -52.18, 43.12]);

// Muestrear las temperaturas en 1000 localizaciones aleatorias.
var muestras = temperatura.addBands(ee.Image.pixelLonLat())
  .sample({region: geometria, numPixels: 1000})
  .map(function(sample) {
    var lat = sample.get('latitude');
    var lon = sample.get('longitude');
    var temperatura1 = sample.get('temperatura');
    return ee.Feature(ee.Geometry.Point([lon, lat]), 
    {temperaturaMarina: temperatura1});
  });

// Interpolate SST from the sampled points.
var interpolar = muestras.kriging({
  propertyName: 'temperaturaMarina',
  // Forma de la función de la varianza de los datos
  shape: 'exponential', 
  // Rango de la varianza
  range: 100 * 1000, 
  sill: 1.0,
  nugget: 0.1,
  maxDistance: 100 * 1000,
  reducer: 'mean',
});
</script>
<!--chapter:end:11-usoconjunto.Rmd-->
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div id="clasificación-supervisada" class="section level1" number="12">
<h1 number="12"><span class="header-section-number">12</span> Clasificación supervisada</h1>
<p>Una clasificación supervisada se refiere al proceso en el cual se genera un mapa temático a partir de imágenes satelitales u otro tipo de información obtenida mediante sensores remotos. Este tipo de procedimiento tiene el objetivo de asociarle una etiqueta a cada píxel de una imagen, que puede constar de por ejemplo, una clase de tipo de vegetación o uso de suelo (Chuvieco, 1995). Las clasificaciones se pueden ver como una interpretación de la reflectancia de una imagen en un sistema de clases de interés. Adicionalmente, las clasificaciones supervisadas constan de procedimientos en los cuales se entrena un algoritmo a reconocer las clases de interés a partir de muestras otorgadas por el usuario (Chuvieco, 1995). Generalmente, el proceso de una clasificación supervisada implica los siguientes pasos: 1) obtención de los datos de entrenamiento, 2) selección del clasificador, 3) entrenamiento del clasificador basado en los datos de entrenamiento, 4) obtención de la clasificación, 5) registro de los datos de verificación y 6) verificación o de la clasificación.</p>
<p>Dentro de GEE se pueden hacer clasificaciones supervisadas con algunos algoritmos populares como CART (Classification and Regression Trees; Breiman et al., 1984), Random Forests (Breiman, 2001), Naive Bayes (Webb, 2011), Gradient Tree Boost (Friedman, 2001), Support Vector Machine (Cortes y Vapnik 1995), MaxEnt (Maximum Entropy; Phillips et al., 2004) y Decision Trees (Quinlan, 1986). Como todos los demás objetos dentro de GEE tienen su propio tipo de objetos del servidor.</p>
<div id="clasificadores" class="section level2" number="12.1">
<h2 number="12.1"><span class="header-section-number">12.1</span> Clasificadores</h2>
<p>Los objetos <code>ee.Classifier</code> son los objetos que van a permitir trabajar con clasificadores dentro de GEE. Algunos ejemplos de estos son: <code>ee.Classifier.smileCART, ee.Classifier.smileRandomForest, ee.Classifier.amnhMaxent</code>, entre otros. De nuevo, todos los algoritmos disponibles en GEE, así como los argumentos que aceptan, se pueden consultar en la página de ayuda, en la pestaña de referencia (<code>Reference</code>) en el apartado de bibliotecas del cliente (<code>Client libraries</code>), o también en la pestaña <code>Docs</code> bajo <code>ee.Classifier</code>. Cabe destacar que cada clasificador tiene diferentes argumentos.</p>
<p>Ejercicio 32</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> rfClassif <span class="op">=</span> ee<span class="op">.</span><span class="at">Classifier</span><span class="op">.</span><span class="fu">smileRandomForest</span>()<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
var rfClassif = ee.Classifier.smileRandomForest();
</script>
</div>
<div id="realización-de-la-fase-de-entrenamiento" class="section level2" number="12.2">
<h2 number="12.2"><span class="header-section-number">12.2</span> Realización de la fase de entrenamiento</h2>
<p>Debido a que estos clasificadores trabajan en un esquema supervisado, requieren de la provisión de muestras de entrenamiento para entrenar al algoritmo. Esto se puede hacer directamente en la API, aunque quizás no sea lo más cómodo para el usuario. En este paso se recomienda capturar los datos de entrenamiento en algún SIG, por ejemplo, QGIS, y luego importar el archivo vector a GEE (ver sección de importación de información a GEE). Una vez definido el clasificador que se va a utilizar, para entrenar al clasificador se utiliza el método <code>.train</code>. Los argumentos de este método indican los vectores utilizados como áreas de entrenamiento, el nombre del campo que indica el esquema de clasificación dentro de la colección de vectores, así como las bandas a utilizar de la imagen.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> trainedClassifier <span class="op">=</span> rfClassif<span class="op">.</span><span class="fu">train</span>({</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">features</span><span class="op">:</span> training<span class="op">,</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">classProperty</span><span class="op">:</span> <span class="st">&#39;clase&#39;</span><span class="op">,</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">inputProperties</span><span class="op">:</span> [<span class="st">&#39;CB&#39;</span><span class="op">,</span><span class="st">&#39;B&#39;</span><span class="op">,</span><span class="st">&#39;G&#39;</span><span class="op">,</span><span class="st">&#39;R&#39;</span><span class="op">,</span><span class="st">&#39;NIR&#39;</span><span class="op">,</span><span class="st">&#39;SWIR1&#39;</span><span class="op">,</span><span class="st">&#39;SWIR2&#39;</span>]</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
var trainedClassifier = rfClassif.train({
  features: training,
  classProperty: 'clase',
  inputProperties: ['CB','B','G','R','NIR','SWIR1','SWIR2']
});
</script>
</div>
<div id="obtención-de-la-clasificación" class="section level2" number="12.3">
<h2 number="12.3"><span class="header-section-number">12.3</span> Obtención de la clasificación</h2>
<p>Una vez que se tiene entrenando el clasificador, el siguiente paso consta de clasificar la imagen completa en las clases de interés. Para ello, se utiliza el método <code>.classify</code>, el cual permite hacer predicciones sobre la clase de cada píxel, a partir de los insumos indicados en la fase de entrenamiento. Por ejemplo:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> classifiedImg <span class="op">=</span> imagen<span class="op">.</span><span class="fu">classify</span>(trainedClassifier)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
var classifiedImg = imagen.classify(trainedClassifier);
</script>
</div>
<div id="evaluación-de-la-clasificación" class="section level2" number="12.4">
<h2 number="12.4"><span class="header-section-number">12.4</span> Evaluación de la clasificación</h2>
<p>La última fase de una clasificación consta de la evaluación de los resultados utilizando otro conjunto de datos que no haya sido utilizado en la fase de entrenamiento. Comúnmente a estos datos se le conoce como los datos de validación o verificación. En este caso, primero se extrae la información de las clases predichas para los datos de validación y después se compara con la información de referencia. Comúnmente, se utiliza una matriz de confusión para realizar dicha evaluación. En GEE se puede obtener esta matriz mediante el método <code>.errorMatrix</code>. Además, para calcular la precisión total de la clasificación sobre los datos de validación se utiliza el método <code>.accuracy</code>. Por ejemplo:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> validErrMat <span class="op">=</span> validacion<span class="op">.</span><span class="fu">errorMatrix</span>(<span class="st">&#39;claseRef&#39;</span><span class="op">,</span> <span class="st">&#39;clasePred&#39;</span>)<span class="op">;</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> validAcc <span class="op">=</span> validacion<span class="op">.</span><span class="fu">accuracy</span>()<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
var validErrMat = validacion.errorMatrix('claseRef', 'clasePred');
var validAcc = validacion.accuracy();
</script>
<div id="ejercicio-clasificación-ejercicio-e" class="section level3 unnumbered">
<h3 class="unnumbered">Ejercicio: Clasificación (Ejercicio E)</h3>
<p>En este ejercicio se hará una clasificación supervisada utilizando el algoritmo Random Forests. Para ello se utilizarán siete polígonos como sitios de entrenamiento, pertenecientes a cuatro clases: Bosque, No bosque, Agua y Urbano. Estos polígonos se definirán directamente en la API a través de sus coordenadas como objetos <code>ee.Geometry</code> de tipo rectángulo. Posteriormente, cada polígono se transforma en un objeto de tipo vector (<code>ee.Feature</code>) y se le asigna la propiedad de ‘clase’ como número a través de un diccionario. Por último, se hace una colección de vectores.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Definición de datos de entrenamiento</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> bosque1 <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">101.53892</span><span class="op">,</span> <span class="fl">19.74148</span><span class="op">,</span> </span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">101.51906</span><span class="op">,</span><span class="fl">19.72362</span>)<span class="op">;</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> bosque2 <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">101.64826</span><span class="op">,</span> <span class="fl">19.49264</span><span class="op">,</span> </span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">101.62839</span><span class="op">,</span><span class="fl">19.47545</span>)<span class="op">;</span></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> noBosque1 <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">101.35448</span><span class="op">,</span> <span class="fl">19.65992</span><span class="op">,</span> </span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">101.34509</span><span class="op">,</span><span class="fl">19.64990</span>)<span class="op">;</span></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> noBosque2 <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">101.56907</span><span class="op">,</span> <span class="fl">19.58312</span><span class="op">,</span> </span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">101.54939</span><span class="op">,</span><span class="fl">19.56435</span>)<span class="op">;</span></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> urbano <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">101.20999</span><span class="op">,</span> <span class="fl">19.71300</span><span class="op">,</span> </span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">101.19688</span><span class="op">,</span><span class="fl">19.70338</span>)<span class="op">;</span></span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> agua1 <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">101.60826</span><span class="op">,</span> <span class="fl">19.66885</span><span class="op">,</span> </span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">101.58569</span><span class="op">,</span><span class="fl">19.64316</span>)<span class="op">;</span></span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> agua2 <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">101.74686</span><span class="op">,</span> <span class="fl">19.43937</span><span class="op">,</span> </span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">101.733453</span><span class="op">,</span><span class="fl">19.427012</span>)<span class="op">;</span></span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a><span class="co">// Definición de colección de vectores</span></span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> poligonos <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>([</span>
<span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="fu">Feature</span>(noBosque1<span class="op">,</span> {<span class="st">&#39;clase&#39;</span><span class="op">:</span> <span class="dv">0</span>})<span class="op">,</span></span>
<span id="cb133-20"><a href="#cb133-20" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="fu">Feature</span>(noBosque2<span class="op">,</span> {<span class="st">&#39;clase&#39;</span><span class="op">:</span> <span class="dv">0</span>})<span class="op">,</span></span>
<span id="cb133-21"><a href="#cb133-21" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="fu">Feature</span>(bosque1<span class="op">,</span> {<span class="st">&#39;clase&#39;</span><span class="op">:</span> <span class="dv">1</span>})<span class="op">,</span></span>
<span id="cb133-22"><a href="#cb133-22" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="fu">Feature</span>(bosque2<span class="op">,</span> {<span class="st">&#39;clase&#39;</span><span class="op">:</span> <span class="dv">1</span>})<span class="op">,</span></span>
<span id="cb133-23"><a href="#cb133-23" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="fu">Feature</span>(agua1<span class="op">,</span> {<span class="st">&#39;clase&#39;</span><span class="op">:</span> <span class="dv">2</span>})<span class="op">,</span></span>
<span id="cb133-24"><a href="#cb133-24" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="fu">Feature</span>(agua2<span class="op">,</span> {<span class="st">&#39;clase&#39;</span><span class="op">:</span> <span class="dv">2</span>})<span class="op">,</span></span>
<span id="cb133-25"><a href="#cb133-25" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="fu">Feature</span>(urbano<span class="op">,</span> {<span class="st">&#39;clase&#39;</span><span class="op">:</span> <span class="dv">3</span>})<span class="op">,</span></span>
<span id="cb133-26"><a href="#cb133-26" aria-hidden="true" tabindex="-1"></a>])<span class="op">;</span></span>
<span id="cb133-27"><a href="#cb133-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-28"><a href="#cb133-28" aria-hidden="true" tabindex="-1"></a><span class="co">// Agregar a pantalla de mapas</span></span>
<span id="cb133-29"><a href="#cb133-29" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(poligonos<span class="op">,</span> {}<span class="op">,</span> <span class="st">&#39;polígonosEntrenamiento&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Definición de datos de entrenamiento
var bosque1 = ee.Geometry.Rectangle(-101.53892, 19.74148, 
  -101.51906,19.72362);
var bosque2 = ee.Geometry.Rectangle(-101.64826, 19.49264, 
  -101.62839,19.47545);
var noBosque1 = ee.Geometry.Rectangle(-101.35448, 19.65992, 
  -101.34509,19.64990);
var noBosque2 = ee.Geometry.Rectangle(-101.56907, 19.58312, 
  -101.54939,19.56435);
var urbano = ee.Geometry.Rectangle(-101.20999, 19.71300, 
  -101.19688,19.70338);
var agua1 = ee.Geometry.Rectangle(-101.60826, 19.66885, 
  -101.58569,19.64316);
var agua2 = ee.Geometry.Rectangle(-101.74686, 19.43937, 
  -101.733453,19.427012);

// Definición de colección de vectores
var poligonos = ee.FeatureCollection([
  ee.Feature(noBosque1, {'clase': 0}),
  ee.Feature(noBosque2, {'clase': 0}),
  ee.Feature(bosque1, {'clase': 1}),
  ee.Feature(bosque2, {'clase': 1}),
  ee.Feature(agua1, {'clase': 2}),
  ee.Feature(agua2, {'clase': 2}),
  ee.Feature(urbano, {'clase': 3}),
]);

// Agregar a pantalla de mapas
Map.addLayer(poligonos, {}, 'polígonosEntrenamiento');
</script>
<p>Antes de pasar al filtrado de la colección de Landsat 8 y enmascarar las nubes, habrá que volver a definir la función <code>maskL8sr</code>, que es la misma que se definió en la sección 9.5.11.2. Ejercicio: Enmascaramiento de nubes, cálculo de índices y reducción (Ejercicio C), como:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Crear función para enmascarar nubes</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">maskL8sr</span>(image) {</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> cloudShadowBitMask <span class="op">=</span> (<span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="dv">3</span>)<span class="op">;</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> cloudsBitMask <span class="op">=</span> (<span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="dv">5</span>)<span class="op">;</span></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> qa <span class="op">=</span> image<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;pixel_qa&#39;</span>)<span class="op">;</span></span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> mask <span class="op">=</span> qa<span class="op">.</span><span class="fu">bitwiseAnd</span>(cloudShadowBitMask)<span class="op">.</span><span class="fu">eq</span>(<span class="dv">0</span>)</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>                 <span class="op">.</span><span class="fu">and</span>(qa<span class="op">.</span><span class="fu">bitwiseAnd</span>(cloudsBitMask)<span class="op">.</span><span class="fu">eq</span>(<span class="dv">0</span>))<span class="op">;</span></span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> image<span class="op">.</span><span class="fu">updateMask</span>(mask)<span class="op">;</span></span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<script type="text/javascript">
// Crear función para enmascarar nubes
function maskL8sr(image) {
  var cloudShadowBitMask = (1 << 3);
  var cloudsBitMask = (1 << 5);
  var qa = image.select('pixel_qa');
  var mask = qa.bitwiseAnd(cloudShadowBitMask).eq(0)
                 .and(qa.bitwiseAnd(cloudsBitMask).eq(0));
  return image.updateMask(mask);
}
</script>
<p>A continuación se vuelve a filtrar la colección de Landsat 8 por fecha, porcentaje de nubosidad sobre la superficie terrestre y un filtro espacial. En este caso, se usa el método <code>.filterBounds</code> que permite filtrar espacialmente la colección de acuerdo a la extensión del polígono de interés. Por último, se aplica la función para enmascarar nubes a todas las imágenes de la colección usando <code>.map</code>.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Filtrar colección y aplicar máscara de nubes</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> L8imgCol <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>(<span class="st">&quot;LANDSAT/LC08/C01/T1_SR&quot;</span>)</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filterBounds</span>(poligonos)</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filterDate</span>(<span class="st">&#39;2015-01-01&#39;</span><span class="op">,</span><span class="st">&#39;2016-01-01&#39;</span>)</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">lte</span>(<span class="st">&#39;CLOUD_COVER_LAND&#39;</span><span class="op">,</span><span class="dv">50</span>))</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>(maskL8sr)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Filtrar colección y aplicar máscara de nubes
var L8imgCol = ee.ImageCollection("LANDSAT/LC08/C01/T1_SR")
  .filterBounds(poligonos)
  .filterDate('2015-01-01','2016-01-01')
  .filter(ee.Filter.lte('CLOUD_COVER_LAND',50))
  .map(maskL8sr);
</script>
<p>El siguiente paso consta de reducir la colección para generar una sola imagen con el valor promedio para todas las bandas. Ya que no se van a utilizar todas las bandas de la imagen para la clasificación, se indica el nombre de las bandas que se van a utilizar dentro de una lista. Por último, se van a renombrar las bandas para recordar más fácilmente el espectro de cada banda.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Reducir, cortar, seleccionar y renombrar bandas</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> L8imgMean <span class="op">=</span> L8imgCol<span class="op">.</span><span class="fu">reduce</span>(ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">mean</span>())</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">select</span>([<span class="st">&#39;B1_mean&#39;</span><span class="op">,</span><span class="st">&#39;B2_mean&#39;</span><span class="op">,</span><span class="st">&#39;B3_mean&#39;</span><span class="op">,</span><span class="st">&#39;B4_mean&#39;</span><span class="op">,</span><span class="st">&#39;B5_mean&#39;</span><span class="op">,</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;B6_mean&#39;</span><span class="op">,</span><span class="st">&#39;B7_mean&#39;</span>])</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">rename</span>([<span class="st">&#39;CB&#39;</span><span class="op">,</span><span class="st">&#39;B&#39;</span><span class="op">,</span><span class="st">&#39;G&#39;</span><span class="op">,</span><span class="st">&#39;R&#39;</span><span class="op">,</span><span class="st">&#39;NIR&#39;</span><span class="op">,</span><span class="st">&#39;SWIR1&#39;</span><span class="op">,</span><span class="st">&#39;SWIR2&#39;</span>])</span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(L8imgMean)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Reducir, cortar, seleccionar y renombrar bandas
var L8imgMean = L8imgCol.reduce(ee.Reducer.mean())
  .select(['B1_mean','B2_mean','B3_mean','B4_mean','B5_mean',
  'B6_mean','B7_mean'])
  .rename(['CB','B','G','R','NIR','SWIR1','SWIR2'])

print(L8imgMean);
</script>
<p>Posteriormente se va a cortar la imagen para quedarnos únicamente con el área de interés. Para ello, primero se define un área de interés y después se corta la imagen con ese objeto.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Definir el área de interés</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> geometry <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Polygon</span>(</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>        [[[<span class="op">-</span><span class="fl">101.82737418916153</span><span class="op">,</span> <span class="fl">19.836437094032178</span>]<span class="op">,</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>          [<span class="op">-</span><span class="fl">101.82737418916153</span><span class="op">,</span> <span class="fl">19.368119068204525</span>]<span class="op">,</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>          [<span class="op">-</span><span class="fl">101.15171500947403</span><span class="op">,</span> <span class="fl">19.368119068204525</span>]<span class="op">,</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>          [<span class="op">-</span><span class="fl">101.15171500947403</span><span class="op">,</span> <span class="fl">19.836437094032178</span>]]])<span class="op">;</span></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a><span class="co">// Cortar la imagen a la geometría del área de interés</span></span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>L8imgMean <span class="op">=</span> L8imgMean<span class="op">.</span><span class="fu">clip</span>(geometry)</span></code></pre></div>
<script type="text/javascript">
// Definir el área de interés
var geometry = ee.Geometry.Polygon(
        [[[-101.82737418916153, 19.836437094032178],
          [-101.82737418916153, 19.368119068204525],
          [-101.15171500947403, 19.368119068204525],
          [-101.15171500947403, 19.836437094032178]]]);
          
// Cortar la imagen a la geometría del área de interés
L8imgMean = L8imgMean.clip(geometry)
</script>
<p>Una vez que ya se tiene la imagen sobre la que se va a hacer la clasificación, se muestrean los valores de los píxeles que se encuentren dentro de cada polígono de los datos de entrenamiento utilizando el método <code>.sampleRegions</code>. Para este proceso hay que indicar la colección de vectores que se va a utilizar, así como su propiedad que indica la clase y la escala a la que se van a muestrear los píxeles en metros. El resultado de este procedimiento corresponde a una colección de vectores, en la cual, cada vector corresponde a un píxel dentro de un polígono de entrenamiento. De tal manera, para cada vector se indica la clase a la que pertenece, así como el valor en cada una de las bandas en la imagen muestreada.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Muestrear regiones </span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> training <span class="op">=</span> L8imgMean</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">sampleRegions</span>({</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// colección de vectores a utilizar</span></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">collection</span><span class="op">:</span> poligonos<span class="op">,</span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// propiedad que se desea mantener los vectores de la colección</span></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">properties</span><span class="op">:</span> [<span class="st">&#39;clase&#39;</span>]<span class="op">,</span></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// tamaño de píxel</span></span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">scale</span><span class="op">:</span> <span class="dv">30</span></span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Muestrear regiones 
var training = L8imgMean
  .sampleRegions({
    // colección de vectores a utilizar
    collection: poligonos,
    // propiedad que se desea mantener los vectores de la colección
    properties: ['clase'],
    // tamaño de píxel
    scale: 30
  });
</script>
<p>El siguiente paso es entrenar al clasificador utilizando la colección de vectores anterior. En este caso, se va a utilizar el algoritmo Random Forests (Breiman, 2001). Para llamar este algoritmo se utiliza <code>ee.Classifier.smileRandomForest</code>. En este caso, se utilizarán 30 árboles de clasificación, que es el único argumento obligatorio. Los demás argumentos opcionales pueden ser consultados en la sección de Reference o en la pestaña de Docs, e incluyen parámetros como el número de variables a utilizar por división, el número máximo de nodos, entre otros. Posteriormente, se entrena este algoritmo mediante el método <code>.train</code>. Los argumentos para <code>.train</code> se pasan como un diccionario, el cual indica la colección de vectores a utilizar para el entrenamiento (features), el nombre de la clase objetivo (classProperty) y el nombre de las propiedades de la imagen (inputProperties), es decir, el nombre de las bandas.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Entrenamiento del clasificador</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> trainedClassifier <span class="op">=</span> ee<span class="op">.</span><span class="at">Classifier</span><span class="op">.</span><span class="fu">smileRandomForest</span>(<span class="dv">30</span>)<span class="op">.</span><span class="fu">train</span>({</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Vectores con la información extraida en el paso anterior</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">features</span><span class="op">:</span> training<span class="op">,</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Propiedad que indica la clase de cobertura</span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">classProperty</span><span class="op">:</span> <span class="st">&#39;clase&#39;</span><span class="op">,</span></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Nombres de las propiedades de la imagen</span></span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">inputProperties</span><span class="op">:</span> [<span class="st">&#39;CB&#39;</span><span class="op">,</span><span class="st">&#39;B&#39;</span><span class="op">,</span><span class="st">&#39;G&#39;</span><span class="op">,</span><span class="st">&#39;R&#39;</span><span class="op">,</span><span class="st">&#39;NIR&#39;</span><span class="op">,</span><span class="st">&#39;SWIR1&#39;</span><span class="op">,</span><span class="st">&#39;SWIR2&#39;</span>]</span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Entrenamiento del clasificador
var trainedClassifier = ee.Classifier.smileRandomForest(30).train({
  // Vectores con la información extraida en el paso anterior
  features: training,
  // Propiedad que indica la clase de cobertura
  classProperty: 'clase',
  // Nombres de las propiedades de la imagen
  inputProperties: ['CB','B','G','R','NIR','SWIR1','SWIR2']
});
</script>
<div class="bluebox2">
<div class="awesomeblock">
<p>Generalmente se menciona que el utilizar un mayor número de árboles en el algoritmo Random Forest permite obtener mejores resultados, sin embargo, dependiendo del conjunto de datos utilizado existe un umbral a partir del cual aumentar el número de árboles no resulta en una mejoría significativa de la clasificación. Consultar Oshiro et al. (2012) para ver una evaluación del efecto del número de árboles sobre las capacidades de clasificación.</p>
</div>
</div>
<div class="bluebox2">
<div class="awesomeblock">
<p>Usando al final el método <code>.setOutputMode</code> se puede cambiar la forma que el clasificador entrega los resultados para ello dentro de los paréntesis del método toca escribir entre comillas cualquiera de las siguientes opciones:</p>
<ul>
<li>Classification (clasificación, por defecto): devuelve una variable nominal (clases).</li>
<li>Regresion (regresión): devuelve una variable numérica.</li>
<li>Probability (probabilidad): devuelve la probabilidad de que la clasificación sea correcta.</li>
<li>Multiprobability (multiprobabilidad): devuelve un arreglo de probabilidades para cada una de las clases.</li>
<li>Raw (crudo): devuelve un arreglo con la representación interna del proceso de clasificación. Por ejemplo los votos crudos de un modelo de múltiples árboles de decisión como random forests.</li>
<li>Raw_regression (regresión cruda): devuelve un arreglo con la representación interna del proceso de regresión. Por ejemplo, las predicciones crudas de los múltiples arboles de regresión.
Resulta importante recordar que dependiendo del clasificador, algunas de estas opciones de resultado estarán disponibles o no.</li>
</ul>
</div>
</div>
<p>Una vez entrenado el clasificador, se puede clasificar la imagen completa utilizando el método <code>.classify</code>. Como argumentos se indica el clasificador entrenado que se desea utilizar. El resultado de <code>.classify</code> va a ser un objeto de tipo <code>ee.Image</code> que contiene la clase predicha en el campo ‘classification’. Por último, se visualiza en la pantalla de mapas para ver los resultados (Fig. 12.1).</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Usar el clasificador entrenado sobre toda la imagen</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> classifiedImg <span class="op">=</span> L8imgMean<span class="op">.</span><span class="fu">classify</span>(trainedClassifier)<span class="op">;</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Visualizar resultado</span></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(classifiedImg<span class="op">,</span>{<span class="dt">min</span><span class="op">:</span><span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span><span class="dv">3</span><span class="op">,</span> </span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">palette</span><span class="op">:</span>[<span class="st">&#39;#fcff21&#39;</span><span class="op">,</span><span class="st">&#39;#20da25&#39;</span><span class="op">,</span><span class="st">&#39;#05a9da&#39;</span><span class="op">,</span><span class="st">&#39;#dadada&#39;</span>]}<span class="op">,</span></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;Clasificación RF L8&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Usar el clasificador entrenado sobre toda la imagen
var classifiedImg = L8imgMean.classify(trainedClassifier);

// Visualizar resultado
Map.addLayer(classifiedImg,{min:0, max:3, 
  palette:['#fcff21','#20da25','#05a9da','#dadada']},
  'Clasificación RF L8');
</script>
<div class="figure" style="text-align: center">
<img src="Img/RFClass.png" alt="Visualización de la clasificación." width="100%" />
<p class="caption">
(#fig:unnamed-chunk-199)Visualización de la clasificación.
</p>
</div>
<p>Posteriormente, se puede hacer un gráfico para analizar el perfil espectral de las clases de interés. Para hacer esto, primero se agrega la banda con la clasificación a la imagen que contiene la media de la reflectancia de la superficie (<code>L8imgMean</code>). Después, se utiliza la función <code>ui.Chart.image.byClass</code> para crear un gráfico por clase. Como argumentos a esta función se indica la imagen a utilizar (image), el nombre de la banda que contiene las categorías de la clasificación (classBand), el reductor que se va a utilizar para resumir los valores por clase (reducer), las regiones de las cuales se va a obtener esta información (region), las etiquetas de las clases (classLabels), la escala en m de trabajo para aplicar el reductor (scale) y algunas opciones para ponerle título y asignar los colores al gráfico (argumentos dentro de <code>.setOptions</code>). Por último, hay que imprimir el gráfico con la función de <code>print</code> y el gráfico aparecerá en la consola (Fig. 12.2).</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Agregar clasificación como banda</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> imgConClass <span class="op">=</span> L8imgMean<span class="op">.</span><span class="fu">addBands</span>(classifiedImg)<span class="op">;</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Hacer gráfico de barras</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> chartClassSpec <span class="op">=</span> ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">image</span><span class="op">.</span><span class="fu">byClass</span>({</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Imagen a utilizar para construir el gráfico</span></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">image</span><span class="op">:</span> imgConClass<span class="op">,</span></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Banda que contiene las clases</span></span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">classBand</span><span class="op">:</span> <span class="st">&#39;classification&#39;</span><span class="op">,</span></span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Reductor a utilizar</span></span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">mean</span>()<span class="op">,</span></span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Regiones a partir de las cuales se va a construir el </span></span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">// gráfico</span></span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a>  <span class="dt">region</span><span class="op">:</span> poligonos<span class="op">,</span></span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Etiquetas de las clases</span></span>
<span id="cb141-16"><a href="#cb141-16" aria-hidden="true" tabindex="-1"></a>  <span class="dt">classLabels</span><span class="op">:</span> [<span class="st">&#39;NoBosque&#39;</span><span class="op">,</span><span class="st">&#39;Bosque&#39;</span><span class="op">,</span><span class="st">&#39;Agua&#39;</span><span class="op">,</span><span class="st">&#39;Urbano&#39;</span>]<span class="op">,</span></span>
<span id="cb141-17"><a href="#cb141-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Tamaño de píxel</span></span>
<span id="cb141-18"><a href="#cb141-18" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">240</span></span>
<span id="cb141-19"><a href="#cb141-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Definir más opciones para el gráfico</span></span>
<span id="cb141-20"><a href="#cb141-20" aria-hidden="true" tabindex="-1"></a>})<span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb141-21"><a href="#cb141-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Título del gráfico</span></span>
<span id="cb141-22"><a href="#cb141-22" aria-hidden="true" tabindex="-1"></a>  <span class="dt">title</span><span class="op">:</span> <span class="st">&#39;Perfil espectral por clase&#39;</span><span class="op">,</span></span>
<span id="cb141-23"><a href="#cb141-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Colores a utilizar</span></span>
<span id="cb141-24"><a href="#cb141-24" aria-hidden="true" tabindex="-1"></a>  <span class="dt">colors</span><span class="op">:</span> [<span class="st">&#39;#fcff21&#39;</span><span class="op">,</span><span class="st">&#39;#20da25&#39;</span><span class="op">,</span><span class="st">&#39;#05a9da&#39;</span><span class="op">,</span><span class="st">&#39;#dadada&#39;</span>]</span>
<span id="cb141-25"><a href="#cb141-25" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb141-26"><a href="#cb141-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-27"><a href="#cb141-27" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chartClassSpec)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Agregar clasificación como banda
var imgConClass = L8imgMean.addBands(classifiedImg);

// Hacer gráfico de barras
var chartClassSpec = ui.Chart.image.byClass({
  // Imagen a utilizar para construir el gráfico
  image: imgConClass,
  // Banda que contiene las clases
  classBand: 'classification',
  // Reductor a utilizar
  reducer: ee.Reducer.mean(),
  // Regiones a partir de las cuales se va a construir el 
  // gráfico
  region: poligonos,
  // Etiquetas de las clases
  classLabels: ['NoBosque','Bosque','Agua','Urbano'],
  // Tamaño de píxel
  scale: 240
  // Definir más opciones para el gráfico
}).setOptions({
  // Título del gráfico
  title: 'Perfil espectral por clase',
  // Colores a utilizar
  colors: ['#fcff21','#20da25','#05a9da','#dadada']
});

print(chartClassSpec);
</script>
<div class="figure" style="text-align: center">
<img src="Img/SpectralSignClass.png" alt="Perfil espectral promedio por clase." width="100%" />
<p class="caption">
(#fig:unnamed-chunk-201)Perfil espectral promedio por clase.
</p>
</div>
<p>Una vez que se tiene la clasificación del área de interés, se van a cargar los datos de verificación para calcular la matriz de error y la precisión total de la clasificación. Primero se carga la información de los polígonos de verificación.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Definción de áreas de verificación</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> bosque3 <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">101.62016</span><span class="op">,</span><span class="fl">19.61895</span><span class="op">,</span> </span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">101.60543</span><span class="op">,</span><span class="fl">19.60492</span>)<span class="op">;</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> noBosque3 <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">101.313746</span><span class="op">,</span><span class="fl">19.716531</span><span class="op">,</span> </span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">101.306380</span><span class="op">,</span><span class="fl">19.709505</span>)<span class="op">;</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> urbano2 <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">101.609880</span><span class="op">,</span><span class="fl">19.517665</span><span class="op">,</span> </span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">101.602523</span><span class="op">,</span><span class="fl">19.510752</span>)<span class="op">;</span></span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> agua3 <span class="op">=</span> ee<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">Rectangle</span>(<span class="op">-</span><span class="fl">101.272720</span><span class="op">,</span><span class="fl">19.612100</span><span class="op">,</span> </span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">101.272668</span><span class="op">,</span><span class="fl">19.611594</span>)<span class="op">;</span></span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a><span class="co">// Creación de colección de verificación</span></span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> poligonosVerif <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>([</span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="fu">Feature</span>(noBosque3<span class="op">,</span> {<span class="st">&#39;clase&#39;</span><span class="op">:</span> <span class="dv">0</span>})<span class="op">,</span></span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="fu">Feature</span>(bosque3<span class="op">,</span> {<span class="st">&#39;clase&#39;</span><span class="op">:</span> <span class="dv">1</span>})<span class="op">,</span></span>
<span id="cb142-15"><a href="#cb142-15" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="fu">Feature</span>(agua3<span class="op">,</span> {<span class="st">&#39;clase&#39;</span><span class="op">:</span> <span class="dv">2</span>})<span class="op">,</span></span>
<span id="cb142-16"><a href="#cb142-16" aria-hidden="true" tabindex="-1"></a>  ee<span class="op">.</span><span class="fu">Feature</span>(urbano2<span class="op">,</span> {<span class="st">&#39;clase&#39;</span><span class="op">:</span> <span class="dv">3</span>})<span class="op">,</span></span>
<span id="cb142-17"><a href="#cb142-17" aria-hidden="true" tabindex="-1"></a>])<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Definción de áreas de verificación
var bosque3 = ee.Geometry.Rectangle(-101.62016,19.61895, 
  -101.60543,19.60492);
var noBosque3 = ee.Geometry.Rectangle(-101.313746,19.716531, 
  -101.306380,19.709505);
var urbano2 = ee.Geometry.Rectangle(-101.609880,19.517665, 
  -101.602523,19.510752);
var agua3 = ee.Geometry.Rectangle(-101.272720,19.612100, 
  -101.272668,19.611594);

// Creación de colección de verificación
var poligonosVerif = ee.FeatureCollection([
  ee.Feature(noBosque3, {'clase': 0}),
  ee.Feature(bosque3, {'clase': 1}),
  ee.Feature(agua3, {'clase': 2}),
  ee.Feature(urbano2, {'clase': 3}),
]);
</script>
<p>El siguiente paso es extraer la información de la imagen clasificada, de acuerdo con la extensión de los datos de verificación. Este paso es exactamente igual al que se hizo con los datos de entrenamiento, pero ahora utilizando los datos de verificación y la imagen clasificada en lugar de la imagen de reflectancia. De igual manera, el resultado de este paso es una colección de vectores.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Muestrear imagen</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> validating <span class="op">=</span> classifiedImg</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">sampleRegions</span>({</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">collection</span><span class="op">:</span> poligonosVerif<span class="op">,</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">properties</span><span class="op">:</span> [<span class="st">&#39;clase&#39;</span>]<span class="op">,</span></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Muestrear imagen
var validating = classifiedImg
  .sampleRegions({
  collection: poligonosVerif,
  properties: ['clase'],
  scale: 30,
});
</script>
<p>A continuación, se calcula la matriz de error mediante el método <code>.errorMatrix</code> indicando en primer lugar el campo de la clase de referencia (‘clase’) y en segundo lugar el campo de la predicción (‘classification’). Después, se van a mostrar estos dos objetos en la consola mediante <code>print</code> para inspeccionar su contenido.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Obtener matriz de confusión y precisión</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> validErrMat <span class="op">=</span> validating<span class="op">.</span><span class="fu">errorMatrix</span>(<span class="st">&#39;clase&#39;</span><span class="op">,</span> <span class="st">&#39;classification&#39;</span>)<span class="op">;</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> validAcc <span class="op">=</span> validErrMat<span class="op">.</span><span class="fu">accuracy</span>()<span class="op">;</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Validation error matrix: &#39;</span><span class="op">,</span> validErrMat)<span class="op">;</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Validation overall accuracy: &#39;</span><span class="op">,</span> validAcc)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Obtener matriz de confusión y precisión
var validErrMat = validating.errorMatrix('clase', 'classification');
var validAcc = validErrMat.accuracy();

print('Validation error matrix: ', validErrMat);
print('Validation overall accuracy: ', validAcc);
</script>
<div class="bluebox2">
<div class="awesomeblock">
<p>Por defecto la imagen que se obtiene de un método <code>.classify</code> obtiene el nombre de ‘classification’, por eso la propiedad que se muestrea en el paso de <code>.sampleRegions</code> y con la que se hace la matriz de error <code>.errorMatrix</code> se llama ‘classification’.</p>
</div>
</div>
<p>Para exportar estos resultados primero hay que pasar los datos a tipo vector. Para ello, se va a crear un vector sin geometría (que es lo que indica el <code>null</code> en el primer campo del <code>ee.Feature</code>), seguido de un diccionario que contiene los datos que se desean exportar (que podrían interpretarse como una tabla de atributos). En el caso de la matriz de error, primero se debe convertir a un arreglo mediante el método <code>.array</code>.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Transformarlos en vectores</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> expConfMatrix <span class="op">=</span>  ee<span class="op">.</span><span class="fu">Feature</span>(<span class="kw">null</span><span class="op">,</span> {<span class="dt">matrix</span><span class="op">:</span> validErrMat<span class="op">.</span><span class="fu">array</span>()})<span class="op">;</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> expAccuracy <span class="op">=</span> ee<span class="op">.</span><span class="fu">Feature</span>(<span class="kw">null</span><span class="op">,</span> ee<span class="op">.</span><span class="fu">Dictionary</span>({<span class="dt">Accuracy</span><span class="op">:</span> validAcc}))<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Transformarlos en vectores
var expConfMatrix =  ee.Feature(null, {matrix: validErrMat.array()});
var expAccuracy = ee.Feature(null, ee.Dictionary({Accuracy: validAcc}));
</script>
<p>Posteriormente se define una función para exportar (<code>ExportTable</code>) y se utiliza para exportar la matriz de error y el valor de precisión total. Esta función toma dos argumentos, el objeto a exportar y el nombre que se le va a dar al archivo a exportar. Debido a que la función <code>Export.table.toDrive</code> sólo permite exportar objetos de tipo <code>ee.FeatureCollection</code>, se debe meter a los objetos de tipo <code>ee.Feature</code> en un contenedor <code>ee.FeatureCollection</code>. Por último, se debe indicar que el formato para guardar el archivo es uno separado por comas (CSV) y se puede indicar la carpeta dentro del que se quiere guardar la tabla exportada.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Definir función de exportación</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> exportTable <span class="op">=</span> <span class="kw">function</span>(feature<span class="op">,</span> name){</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>  Export<span class="op">.</span><span class="at">table</span><span class="op">.</span><span class="fu">toDrive</span>({</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Colección de vectores a exportar</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">collection</span><span class="op">:</span> feature<span class="op">,</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Nombre para guardar el archivo</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">description</span><span class="op">:</span> name<span class="op">,</span></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Carpeta donde se guardará el archivo</span></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">folder</span><span class="op">:</span> <span class="st">&#39;Clasificacion_RF&#39;</span><span class="op">,</span></span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Formato del archivo</span></span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fileFormat</span><span class="op">:</span> <span class="st">&#39;CSV&#39;</span></span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a> })<span class="op">;</span></span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a><span class="co">// Exportar a Google Drive</span></span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true" tabindex="-1"></a><span class="co">// Usar la función exportTable</span></span>
<span id="cb146-17"><a href="#cb146-17" aria-hidden="true" tabindex="-1"></a><span class="fu">exportTable</span>(ee<span class="op">.</span><span class="fu">FeatureCollection</span>(expConfMatrix)<span class="op">,</span> <span class="st">&#39;confMatrix&#39;</span>)<span class="op">;</span></span>
<span id="cb146-18"><a href="#cb146-18" aria-hidden="true" tabindex="-1"></a><span class="fu">exportTable</span>(ee<span class="op">.</span><span class="fu">FeatureCollection</span>(expAccuracy)<span class="op">,</span> <span class="st">&#39;validAcc&#39;</span>)<span class="op">;</span></span></code></pre></div>
<script type="text/javascript">
// Definir función de exportación
var exportTable = function(feature, name){
  Export.table.toDrive({
    // Colección de vectores a exportar
    collection: feature,
    // Nombre para guardar el archivo
    description: name,
    // Carpeta donde se guardará el archivo
    folder: 'Clasificacion_RF',
    // Formato del archivo
    fileFormat: 'CSV'
 });
};

// Exportar a Google Drive
// Usar la función exportTable
exportTable(ee.FeatureCollection(expConfMatrix), 'confMatrix');
exportTable(ee.FeatureCollection(expAccuracy), 'validAcc');
</script>
<!--chapter:end:12-clasificación.Rmd-->
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div id="cierre" class="section level1" number="13">
<h1 number="13"><span class="header-section-number">13</span> Cierre</h1>
<p>Seguramente el aprendizaje de la programación en GEE será lenta en un inicio, pero como cualquier otro lenguaje de programación, una vez aprendida lo lógica y sintaxis básica del programa, el avance será mucho más rápido. Esperamos que esta manual haya motivado a los usuarios a adentrarse en el uso de GEE, que haya brindado herramientas para entender las cuestiones básicas sobre el funcionamiento de GEE, así como ofrecido ejemplos de diferentes funciones y métodos disponibles en la API que puedan ser utilizadas en los futuros proyectos de nuestros lectores.</p>
<p>A pesar de que GEE es una herramienta muy poderosa para realizar análisis geomáticos, hay que tener presente que como cualquier otro programa tiene sus propias limitaciones. Por lo tanto, habrá procesos para los cuales resulte muy conveniente realizarlos en GEE, pero para algunos otros no. Por ejemplo, a pesar de que GEE permite crear mapas (inclusive con leyendas), consideramos que sus capacidades son bastante limitadas. Por ello, consideramos que se pueden obtener resultados personalizados de manera más sencilla en otros Sistemas de Información Geográfica. Este ejemplo, sirve para mostrar que no todos los procesos se podrán realizar más fácilmente ni rápidamente en GEE. Sin embargo, con la práctica el usuario podrá aprender qué procesos resulta más conveniente realizarlo en GEE y cuáles no.</p>
<div style="page-break-after: always;"></div>
<div id="agradecimientos" class="section level2 unnumbered">
<h2 class="unnumbered">Agradecimientos</h2>
<p>Agradecemos a Andrea Pamela Flores, Victoria Nazarena Guzmán, Sandra Lucía Hernández Zetina y Xanat Antonio Némiga por sus comentarios para mejorar este manual.</p>
<p>También agradecemos al Proyecto PE117519 – Programa de Apoyo a Proyectos para la Innovación y Mejoramiento a la Enseñanza, PAPIME, UNAM.</p>
<!--chapter:end:13-cierre.Rmd-->
</div>
</div>
<div id="referencias" class="section level1" number="14">
<h1 number="14"><span class="header-section-number">14</span> Referencias</h1>
<div class="line-block">Amani, M., Ghorbanian, A., Ahmadi, S. A., Moghaddam, A., Mahdavi, S., Ghahremanloo, M., … Brisco, B. (2020). Google Earth Engine Cloud Computing Platform for Remote Sensing Big Data Applications : A Comprehensive Review. IEEE Journal of Selected Topics in Applied Earth Observations and Remote Sensing, 13, 5326–5350. <a href="https://doi.org/10.1109/JSTARS.2020.3021052" class="uri">https://doi.org/10.1109/JSTARS.2020.3021052</a></div>
<div class="line-block">Arévalo, P., Bullock, E. L., Woodcock, C. E., &amp; Olofsson, P. (2020). A Suite of Tools for Continuous Land Change Monitoring in Google Earth Engine. Frontiers in Climate, 2, 576740. <a href="https://doi.org/10.3389/fclim.2020.576740" class="uri">https://doi.org/10.3389/fclim.2020.576740</a></div>
<div class="line-block">Arruda, V. L. S., Piontekowski, V. J., Alencar, A., Pereira, R. S., &amp; Matricardi, E. A. T. (2021). An alternative approach for mapping burn scars using Landsat imagery, Google Earth Engine, and Deep Learning in the Brazilian Savanna. Remote Sensing Applications: Society and Environment, 22, 100472. <a href="https://doi.org/10.1016/j.rsase.2021.100472" class="uri">https://doi.org/10.1016/j.rsase.2021.100472</a></div>
<div class="line-block">Basso, K., De Avila Zingano, P. R., &amp; Dal Sasso Freitas, C. M. (1999). Interpolation of scattered data: investigating alternatives for the modified Shepard method, XII Brazilian Symposium on Computer Graphics and Image Processing (Cat. No.PR00481), 39-47. <a href="https://doi.org/10.1109/SIBGRA.1999.805606" class="uri">https://doi.org/10.1109/SIBGRA.1999.805606</a>.</div>
<div class="line-block">Breiman, L. (2001). Random Forests. Machine Learning, 45, 5-32.</div>
<div class="line-block">Breiman, L., Friedman, J. H., Olshen, R. A., Stone, C. J. (1984). Classification and regression trees. Wadsworth, Belmont, EUA.</div>
<div class="line-block">Campos-Taberner, M., Moreno-Martínez, Á., García-Haro, F. J., Camps-Valls, G., Robinson, N. P., Kattge, J., &amp; Running, S. W. (2018). Global estimation of biophysical variables from Google Earth Engine platform. Remote Sensing, 10, 1167. <a href="https://doi.org/10.3390/rs10081167" class="uri">https://doi.org/10.3390/rs10081167</a></div>
<div class="line-block">Chuvieco, E. (1995). Fundamentos de Teledetección Espacial. Segunda edición. Ediciones RIALP, Madrid, España.</div>
<div class="line-block">Cortes, C., Vapnik, V. (1995). Support-vector networks. Machine Learning, 20(3), 273–297.</div>
<div class="line-block">Dong, J., Xiao, X., Menarguez, M. A., Zhang, G., Qin, Y., Thau, D., … Moore, B. (2016). Mapping paddy rice planting area in northeastern Asia with Landsat 8 images, phenology-based algorithm and Google Earth Engine. Remote Sensing of Environment, 185, 142–154. <a href="https://doi.org/10.1016/j.rse.2016.02.016" class="uri">https://doi.org/10.1016/j.rse.2016.02.016</a></div>
<div class="line-block">Friedman, J. H. (2001). Greedy function approximation: a gradient boosting machine. Annals of Statistics, 1189–1232.</div>
<div class="line-block">Gorelick, N., Hancher, M., Dixon, M., Ilyushchenko, S., Thau, D., &amp; Moore, R. (2017). Google Earth Engine: Planetary-scale geospatial analysis for everyone. Remote Sensing of Environment, 202(2016), 18–27. <a href="https://doi.org/10.1016/j.rse.2017.06.031" class="uri">https://doi.org/10.1016/j.rse.2017.06.031</a></div>
<div class="line-block">Hamunyela, E., Rosca, S., Mirt, A., Engle, E., Herold, M., Gieseke, F., &amp; Verbesselt, J. (2020). Implementation of BFASTmonitor Algorithm on Google Earth Engine to Support Large-Area and Sub-Annual Change Monitoring Using Earth Observation Data. Remote Sensing, 12, 2953. <a href="https://doi.org/10.3390/rs12182953" class="uri">https://doi.org/10.3390/rs12182953</a></div>
<div class="line-block">Hansen, M. C., Potapov, P. V, Moore, R., Turubanova, S. A., Tyukavina, A., Thau, D., … Townshend, J. R. G. (2013). High-Resolution Global Maps of 21st-Century Forest Cover Change. Science, 342(6160), 850–853. <a href="https://doi.org/http://doi.org/10.1126/science.1244693" class="uri">https://doi.org/http://doi.org/10.1126/science.1244693</a></div>
<div class="line-block">Kumar, L., Mutanga, O., Kumar, L., &amp; Mutanga, O. (2018). Google Earth Engine Applications Since Inception: Usage, Trends, and Potential. Remote Sensing, 10, 1509. <a href="https://doi.org/10.3390/rs10101509" class="uri">https://doi.org/10.3390/rs10101509</a></div>
<div class="line-block">Lee, J. S. H., Wich, S., Widayati, A., &amp; Koh, L. P. (2016). Detecting industrial oil palm plantations on Landsat images with Google Earth Engine. Remote Sensing Applications: Society and Environment, 4, 219–224. <a href="https://doi.org/10.1016/j.rsase.2016.11.003" class="uri">https://doi.org/10.1016/j.rsase.2016.11.003</a></div>
<div class="line-block">Mateo-García, G., Gómez-Chova, L., Amorós-López, J., Muñoz-Marí, J., &amp; Camps-Valls, G. (2018). Multitemporal cloud masking in the Google Earth Engine. Remote Sensing, 10(7), 1079. <a href="https://doi.org/10.3390/rs10071079" class="uri">https://doi.org/10.3390/rs10071079</a></div>
<div class="line-block">Olaya, V. (2020). Sistemas de Información Geográfica. CreateSpace Independent Publishing Platform, España. <a href="https://volaya.github.io/libro-sig/" class="uri">https://volaya.github.io/libro-sig/</a></div>
<div class="line-block">Oshiro, T. M., Perez, P. S., Baranauskas, J. A. (2012). How Many Trees in a Random Forest?. En: Perner, P. (eds) Machine Learning and Data Mining in Pattern Recognition. MLDM 2012. Lecture Notes in Computer Science, 7376. Springer, Berlin, Alemania. <a href="https://doi.org/10.1007/978-3-642-31537-4_13" class="uri">https://doi.org/10.1007/978-3-642-31537-4_13</a></div>
<div class="line-block">Perilla, G. A., &amp; Mas, J. F. (2020). Google Earth Engine (GEE): una poderosa herramienta que vincula el potencial de los datos masivos y la eficacia del procesamiento en la nube. Investigaciones Geográficas, 101, e59929. <a href="https://doi.org/10.14350/rig.59929" class="uri">https://doi.org/10.14350/rig.59929</a></div>
<div class="line-block">Phillips, S. J., Dudík, M., Schapire, R. E. (2004). A maximum entropy approach to species distribution modeling. En: Proceedings of the twenty-first international conference on Machine learning (p. 83).</div>
<div class="line-block">Quinlan, J. R. (1986). Induction of Decision Trees. Machine Learning 1(1), 81–106. <a href="https://doi.org/10.1023/A:1022643204877" class="uri">https://doi.org/10.1023/A:1022643204877</a></div>
<div class="line-block">Radočaj, D., Obhođaš, J., Jurišić, M., Gašparović, M. (2020). Global open data remote sensing satellite missions for land monitoring and conservation: A review. Land, 9(11), 1–24. <a href="https://doi.org/10.3390/land9110402" class="uri">https://doi.org/10.3390/land9110402</a></div>
<div class="line-block">Ravanelli, R., Nascetti, A., Cirigliano, R., Di Rico, C., Leuzzi, G., Monti, P., &amp; Crespi, M. (2018). Monitoring the Impact of Land Cover Change on Surface Urban Heat Island through Google Earth Engine: Proposal of a Global Methodology, First Applications and Problems. Remote Sensing, 10, 1488. <a href="http://dx.doi.org/10.3390/rs10091488" class="uri">http://dx.doi.org/10.3390/rs10091488</a></div>
<div class="line-block">Sazib, N., Mladenova, I., &amp; Bolten, J. (2018). Leveraging the google earth engine for drought assessment using global soil moisture data. Remote Sensing, 10, 1265. <a href="https://doi.org/10.3390/rs10081265" class="uri">https://doi.org/10.3390/rs10081265</a></div>
<div class="line-block">Slagter, B., Tsendbazar, N.-E., Vollrath, A., &amp; Reiche, J. (2020). Mapping wetland characteristics using temporally dense Sentinel-1 and Sentinel-2 data: A case study in the St. Lucia wetlands, South Africa. International Journal of Applied Earth Observation and Geoinformation, 86, 102009. <a href="https://doi.org/10.1016/j.jag.2019.102009" class="uri">https://doi.org/10.1016/j.jag.2019.102009</a></div>
<div class="line-block">Solórzano, J. V., Gallardo-Cruz, J. A., &amp; Peralta-Carreta, C. (2020). Potencial del acervo de imágenes Landsat disponible en Google Earth Engine para el estudio del territorio mexicano. Investigaciones Geográficas, 101, e59821. <a href="https://doi.org/10.14350/rig.59821" class="uri">https://doi.org/10.14350/rig.59821</a></div>
<div class="line-block">Solórzano, J. V., Mas, J. F., Gao, Y., &amp; Gallardo-Cruz, J. A. (2020). Patrones espaciotemporales de las observaciones de Sentinel-2 a nivel de imagen y píxel sobre el territorio mexicano entre 2015 y 2019. Revista de Teledetección, 56(Número especial), 103–115. <a href="https://doi.org/10.4995/raet.2020.14044" class="uri">https://doi.org/10.4995/raet.2020.14044</a></div>
<div class="line-block">Trianni, G., Angiuli, E., Lisini, G., &amp; Gamba, P. (2014). Human settlements from Landsat data using Google Earth Engine. Geoscience and Remote Sensing Symposium, 1473–1476. <a href="https://doi.org/10.1109/IGARSS.2014.6946715" class="uri">https://doi.org/10.1109/IGARSS.2014.6946715</a></div>
<div class="line-block">Wagle, N., Acharya, T. D., Kolluru, V., Huang, H., &amp; Lee, D. H. (2020). Multi-Temporal Land Cover Change Mapping Using Google Earth Engine and Ensemble Learning Methods. Applied Sciences, 10, 8083. <a href="https://doi.org/10.3390/app10228083" class="uri">https://doi.org/10.3390/app10228083</a></div>
<div class="line-block">Webb, G. I. (2011). Naïve Bayes. En: Sammut, C., Webb, G. I. (eds) Encyclopedia of Machine Learning. Springer, Boston, EUA. <a href="https://doi.org/10.1007/978-0-387-30164-8_576" class="uri">https://doi.org/10.1007/978-0-387-30164-8_576</a></div>
<div class="line-block">Xiong, J., Thenkabail, P. S., Gumma, M. K., Teluguntla, P., Poehnelt, J., Congalton, R. G., … Thau, D. (2017). Automated cropland mapping of continental Africa using Google Earth Engine cloud computing. ISPRS Journal of Photogrammetry and Remote Sensing, 126, 225–244. <a href="https://doi.org/10.1016/j.isprsjprs.2017.01.019" class="uri">https://doi.org/10.1016/j.isprsjprs.2017.01.019</a></div>
<!--chapter:end:14-referencias.Rmd-->
</div>
<!--bookdown:body:end-->


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
